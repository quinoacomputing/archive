
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [<a href=https://github.com/quinoacomputing/quinoa/commit/de8827343>Quinoa_v0.3-557-gde8827343</a>]</title>
    <link rel="stylesheet" href="style.css">
    <style>
pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script>
      function getStyle(el, styleProp) {
        var y;

        if (el.currentStyle) {
          y = el.currentStyle[styleProp];
        } else if (window.getComputedStyle) {
          y = document.defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);
        }

        return y;
      }

      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;

        if (el.style.display === "block") {
          el.style.display = "none";
          mark.textContent = "[+]";
        } else {
          el.style.display = "block";
          mark.textContent = "[-]";
        }
      }

      function initExpandables() {
        var elements = document.querySelectorAll(".expandable");

        for (var i = 0, len = elements.length; i < len; i++) {
          var el = elements[i];
          var clickable = el.querySelector("span");
          var marker = clickable.querySelector(".marker");
          var content = el.querySelector(".content");
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.addEventListener("click", toggle);
        }
      }

      function toggleDisplay(id) {
        var elements = document.querySelectorAll("." + id);

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("d-none");
        }
      }

      function toggleAll() {
        var elements = document.querySelectorAll("input");

        // starting from 1 since 0 is the "toggle all" input
        for (var i = 1, len = elements.length; i < len; i++) {
          var el = elements[i];

          if (el.checked) {
            el.checked = false;
          } else {
            el.checked = true;
          }

          toggleDisplay(el.id);
        }
      }
      window.addEventListener("load", initExpandables);
    </script>
  </head>
  <body>
    <div id="header" class="header">
      <h1>Cppcheck report - [<a href=https://github.com/quinoacomputing/quinoa/commit/de8827343>Quinoa_v0.3-557-gde8827343</a>]: /tmp/TeamCity-3/work/821a9fd6f64749d9/src/DiffEq/Dirichlet/MixDirichlet.hpp</h1>
    </div>
    <div class="wrapper">
      <div id="menu">
       <p id="filename"><a href="index.html">Defects:</a> MixDirichlet.hpp</p>
<a href="8.html#line-237"> constParameter 237</a>
    </div>
    <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="c1">// *****************************************************************************</span>
<a name="line-2"></a><span class="cm">/*!</span>
<a name="line-3"></a><span class="cm">  \file      src/DiffEq/Dirichlet/MixDirichlet.hpp</span>
<a name="line-4"></a><span class="cm">  \copyright 2012-2015 J. Bakosi,</span>
<a name="line-5"></a><span class="cm">             2016-2018 Los Alamos National Security, LLC.,</span>
<a name="line-6"></a><span class="cm">             2019-2021 Triad National Security, LLC.</span>
<a name="line-7"></a><span class="cm">             All rights reserved. See the LICENSE file for details.</span>
<a name="line-8"></a><span class="cm">  \brief     Mixture Dirichlet SDE</span>
<a name="line-9"></a><span class="cm">  \details   This file implements the time integration of a system of stochastic</span>
<a name="line-10"></a><span class="cm">    differential equations (SDEs), whose invariant is the [Dirichlet</span>
<a name="line-11"></a><span class="cm">    distribution](http://en.wikipedia.org/wiki/Dirichlet_distribution), with</span>
<a name="line-12"></a><span class="cm">    various constraints to model multi-material mixing process in turbulent</span>
<a name="line-13"></a><span class="cm">    flows.</span>
<a name="line-14"></a>
<a name="line-15"></a><span class="cm">    In a nutshell, the equation integrated governs a set of scalars,</span>
<a name="line-16"></a><span class="cm">    \f$0\!\le\!Y_\alpha\f$, \f$\alpha\!=\!1,\dots,N-1\f$,</span>
<a name="line-17"></a><span class="cm">    \f$\sum_{\alpha=1}^{N-1}Y_\alpha\!\le\!1\f$, as</span>
<a name="line-18"></a>
<a name="line-19"></a><span class="cm">    @m_class{m-show-m}</span>
<a name="line-20"></a>
<a name="line-21"></a><span class="cm">    \f[</span>
<a name="line-22"></a><span class="cm">       \mathrm{d}Y_\alpha(t) = \frac{b_\alpha}{2}\big[S_\alpha Y_N -</span>
<a name="line-23"></a><span class="cm">       (1-S_\alpha)Y_\alpha\big]\mathrm{d}t + \sqrt{\kappa_\alpha Y_\alpha</span>
<a name="line-24"></a><span class="cm">       Y_N}\mathrm{d}W_\alpha(t), \qquad \alpha=1,\dots,N-1</span>
<a name="line-25"></a><span class="cm">    \f]</span>
<a name="line-26"></a>
<a name="line-27"></a><span class="cm">    @m_class{m-hide-m}</span>
<a name="line-28"></a>
<a name="line-29"></a><span class="cm">    \f[</span>
<a name="line-30"></a><span class="cm">       \begin{split}</span>
<a name="line-31"></a><span class="cm">       \mathrm{d}Y_\alpha(t) = \frac{b_\alpha}{2}\big[S_\alpha Y_N -</span>
<a name="line-32"></a><span class="cm">       (1-S_\alpha)Y_\alpha\big]\mathrm{d}t + \sqrt{\kappa_\alpha Y_\alpha</span>
<a name="line-33"></a><span class="cm">       Y_N}\mathrm{d}W_\alpha(t), \\ \alpha=1,\dots,N-1</span>
<a name="line-34"></a><span class="cm">       \end{split}</span>
<a name="line-35"></a><span class="cm">    \f]</span>
<a name="line-36"></a>
<a name="line-37"></a><span class="cm">    with parameter vectors \f$b_\alpha &gt; 0\f$, \f$\kappa_\alpha &gt; 0\f$, and \f$0</span>
<a name="line-38"></a><span class="cm">    &lt; S_\alpha &lt; 1\f$, and \f$Y_N = 1-\sum_{\alpha=1}^{N-1}Y_\alpha\f$. Here</span>
<a name="line-39"></a><span class="cm">    \f$\mathrm{d}W_\alpha(t)\f$ is an isotropic vector-valued [Wiener</span>
<a name="line-40"></a><span class="cm">    process](http://en.wikipedia.org/wiki/Wiener_process) with independent</span>
<a name="line-41"></a><span class="cm">    increments. The invariant distribution is the Dirichlet distribution,</span>
<a name="line-42"></a><span class="cm">    provided the parameters of the drift and diffusion terms satisfy</span>
<a name="line-43"></a><span class="cm">    \f[</span>
<a name="line-44"></a><span class="cm">      (1-S_1) b_1 / \kappa_1 = \dots = (1-S_{N-1}) b_{N-1} / \kappa_{N-1}.</span>
<a name="line-45"></a><span class="cm">    \f]</span>
<a name="line-46"></a><span class="cm">    To keep the invariant distribution Dirichlet, the above constraint on the</span>
<a name="line-47"></a><span class="cm">    coefficients must be satisfied. For more details on the Dirichlet SDE, see</span>
<a name="line-48"></a><span class="cm">    https://doi.org/10.1155/2013/842981.</span>
<a name="line-49"></a><span class="cm">*/</span>
<a name="line-50"></a><span class="c1">// *****************************************************************************</span>
<a name="line-51"></a><span class="cp">#ifndef MixDirichlet_h</span>
<a name="line-52"></a><span class="cp">#define MixDirichlet_h</span>
<a name="line-53"></a>
<a name="line-54"></a><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp"></span>
<a name="line-55"></a><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp"></span>
<a name="line-56"></a><span class="cp">#include</span> <span class="cpf">&lt;cfenv&gt;</span><span class="cp"></span>
<a name="line-57"></a>
<a name="line-58"></a><span class="cp">#include</span> <span class="cpf">&quot;InitPolicy.hpp&quot;</span><span class="cp"></span>
<a name="line-59"></a><span class="cp">#include</span> <span class="cpf">&quot;MixDirichletCoeffPolicy.hpp&quot;</span><span class="cp"></span>
<a name="line-60"></a><span class="cp">#include</span> <span class="cpf">&quot;RNG.hpp&quot;</span><span class="cp"></span>
<a name="line-61"></a><span class="cp">#include</span> <span class="cpf">&quot;Particles.hpp&quot;</span><span class="cp"></span>
<a name="line-62"></a>
<a name="line-63"></a><span class="k">namespace</span> <span class="n">walker</span> <span class="p">{</span>
<a name="line-64"></a>
<a name="line-65"></a><span class="k">extern</span> <span class="n">ctr</span><span class="o">::</span><span class="n">InputDeck</span> <span class="n">g_inputdeck</span><span class="p">;</span>
<a name="line-66"></a><span class="k">extern</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">ctr</span><span class="o">::</span><span class="n">RawRNGType</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">RNG</span> <span class="o">&gt;</span> <span class="n">g_rng</span><span class="p">;</span>
<a name="line-67"></a>
<a name="line-68"></a><span class="c1">//! \brief MixDirichlet SDE used polymorphically with DiffEq</span>
<a name="line-69"></a><span class="c1">//! \details The template arguments specify policies and are used to configure</span>
<a name="line-70"></a><span class="c1">//!   the behavior of the class. The policies are:</span>
<a name="line-71"></a><span class="c1">//!   - Init - initialization policy, see DiffEq/InitPolicy.h</span>
<a name="line-72"></a><span class="c1">//!   - Coefficients - coefficients policy, see DiffEq/DirCoeffPolicy.h</span>
<a name="line-73"></a><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">Init</span><span class="p">,</span> <span class="k">class</span> <span class="nc">Coefficients</span> <span class="o">&gt;</span>
<a name="line-74"></a><span class="k">class</span> <span class="nc">MixDirichlet</span> <span class="p">{</span>
<a name="line-75"></a>
<a name="line-76"></a>  <span class="k">private</span><span class="o">:</span>
<a name="line-77"></a>    <span class="k">using</span> <span class="n">ncomp_t</span> <span class="o">=</span> <span class="n">tk</span><span class="o">::</span><span class="n">ctr</span><span class="o">::</span><span class="n">ncomp_t</span><span class="p">;</span>
<a name="line-78"></a>    <span class="k">using</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">tag</span><span class="o">::</span><span class="n">mixdirichlet</span><span class="p">;</span>
<a name="line-79"></a>
<a name="line-80"></a>  <span class="k">public</span><span class="o">:</span>
<a name="line-81"></a>    <span class="c1">//! Number of derived variables computed by the MixDirichlet SDE</span>
<a name="line-82"></a>    <span class="c1">//! \details Derived variables: Nth scalar, density, specific volume.</span>
<a name="line-83"></a>    <span class="k">static</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">NUMDERIVED</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<a name="line-84"></a>
<a name="line-85"></a>    <span class="c1">//! \brief Constructor</span>
<a name="line-86"></a>    <span class="c1">//! \param[in] c Index specifying which MixDirichlet SDE to construct. There</span>
<a name="line-87"></a>    <span class="c1">//!   can be multiple dirichlet ... end blocks in a control file. This index</span>
<a name="line-88"></a>    <span class="c1">//!   specifies which MixDirichlet SDE to instantiate. The index corresponds</span>
<a name="line-89"></a>    <span class="c1">//!   to the order in which the dirichlet ... end blocks are given the</span>
<a name="line-90"></a>    <span class="c1">//!   control file.</span>
<a name="line-91"></a>    <span class="k">explicit</span> <span class="nf">MixDirichlet</span><span class="p">(</span> <span class="n">ncomp_t</span> <span class="n">c</span> <span class="p">)</span> <span class="o">:</span>
<a name="line-92"></a>      <span class="n">m_c</span><span class="p">(</span> <span class="n">c</span> <span class="p">),</span>
<a name="line-93"></a>      <span class="n">m_depvar</span><span class="p">(</span> <span class="n">g_inputdeck</span><span class="p">.</span><span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">param</span><span class="p">,</span> <span class="n">eq</span><span class="p">,</span> <span class="n">tag</span><span class="o">::</span><span class="n">depvar</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">at</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">),</span>
<a name="line-94"></a>      <span class="c1">// subtract the number of derived variables computed, see advance()</span>
<a name="line-95"></a>      <span class="n">m_ncomp</span><span class="p">(</span> <span class="n">g_inputdeck</span><span class="p">.</span><span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">component</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">get</span><span class="o">&lt;</span> <span class="n">eq</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">at</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span>
<a name="line-96"></a>               <span class="n">NUMDERIVED</span> <span class="p">),</span>
<a name="line-97"></a>      <span class="n">m_offset</span><span class="p">(</span>
<a name="line-98"></a>        <span class="n">g_inputdeck</span><span class="p">.</span><span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">component</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">offset</span><span class="o">&lt;</span> <span class="n">eq</span> <span class="o">&gt;</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">),</span>
<a name="line-99"></a>      <span class="n">m_rng</span><span class="p">(</span> <span class="n">g_rng</span><span class="p">.</span><span class="n">at</span><span class="p">(</span> <span class="n">tk</span><span class="o">::</span><span class="n">ctr</span><span class="o">::</span><span class="n">raw</span><span class="p">(</span>
<a name="line-100"></a>        <span class="n">g_inputdeck</span><span class="p">.</span><span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">param</span><span class="p">,</span> <span class="n">eq</span><span class="p">,</span> <span class="n">tag</span><span class="o">::</span><span class="n">rng</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">at</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">),</span>
<a name="line-101"></a>      <span class="n">m_norm</span><span class="p">(</span> <span class="n">g_inputdeck</span><span class="p">.</span><span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">param</span><span class="p">,</span> <span class="n">eq</span><span class="p">,</span> <span class="n">tag</span><span class="o">::</span><span class="n">normalization</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">at</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">),</span>
<a name="line-102"></a>      <span class="n">m_b</span><span class="p">(),</span>
<a name="line-103"></a>      <span class="n">m_S</span><span class="p">(),</span>
<a name="line-104"></a>      <span class="n">m_kprime</span><span class="p">(),</span>
<a name="line-105"></a>      <span class="n">m_k</span><span class="p">(),</span>
<a name="line-106"></a>      <span class="n">m_rho</span><span class="p">(),</span>
<a name="line-107"></a>      <span class="n">m_r</span><span class="p">(),</span>
<a name="line-108"></a>      <span class="n">coeff</span><span class="p">(</span> <span class="n">m_ncomp</span><span class="p">,</span>
<a name="line-109"></a>             <span class="n">m_norm</span><span class="p">,</span>
<a name="line-110"></a>             <span class="n">g_inputdeck</span><span class="p">.</span><span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">param</span><span class="p">,</span> <span class="n">eq</span><span class="p">,</span> <span class="n">tag</span><span class="o">::</span><span class="n">b</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">at</span><span class="p">(</span><span class="n">c</span><span class="p">),</span>
<a name="line-111"></a>             <span class="n">g_inputdeck</span><span class="p">.</span><span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">param</span><span class="p">,</span> <span class="n">eq</span><span class="p">,</span> <span class="n">tag</span><span class="o">::</span><span class="n">S</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">at</span><span class="p">(</span><span class="n">c</span><span class="p">),</span>
<a name="line-112"></a>             <span class="n">g_inputdeck</span><span class="p">.</span><span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">param</span><span class="p">,</span> <span class="n">eq</span><span class="p">,</span> <span class="n">tag</span><span class="o">::</span><span class="n">kappaprime</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">at</span><span class="p">(</span><span class="n">c</span><span class="p">),</span>
<a name="line-113"></a>             <span class="n">g_inputdeck</span><span class="p">.</span><span class="n">get</span><span class="o">&lt;</span> <span class="n">tag</span><span class="o">::</span><span class="n">param</span><span class="p">,</span> <span class="n">eq</span><span class="p">,</span> <span class="n">tag</span><span class="o">::</span><span class="n">rho</span> <span class="o">&gt;</span><span class="p">().</span><span class="n">at</span><span class="p">(</span><span class="n">c</span><span class="p">),</span>
<a name="line-114"></a>             <span class="n">m_b</span><span class="p">,</span> <span class="n">m_S</span><span class="p">,</span> <span class="n">m_kprime</span><span class="p">,</span> <span class="n">m_rho</span><span class="p">,</span> <span class="n">m_r</span><span class="p">,</span> <span class="n">m_k</span> <span class="p">)</span> <span class="p">{}</span>
<a name="line-115"></a>
<a name="line-116"></a>    <span class="c1">//! Initalize SDE, prepare for time integration</span>
<a name="line-117"></a>    <span class="c1">//! \param[in] stream Thread (or more precisely stream) ID </span>
<a name="line-118"></a>    <span class="c1">//! \param[in,out] particles Array of particle properties </span>
<a name="line-119"></a>    <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span> <span class="kt">int</span> <span class="n">stream</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">Particles</span><span class="o">&amp;</span> <span class="n">particles</span> <span class="p">)</span> <span class="p">{</span>
<a name="line-120"></a>
<a name="line-121"></a>      <span class="c1">// Ensure the size of the parameter vector holding the pure-fluid</span>
<a name="line-122"></a>      <span class="c1">// densities is N = K+1 = m_ncomp+1</span>
<a name="line-123"></a>      <span class="n">Assert</span><span class="p">(</span> <span class="n">m_rho</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="n">m_ncomp</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Size mismatch&quot;</span> <span class="p">);</span>
<a name="line-124"></a>
<a name="line-125"></a>      <span class="c1">//! Set initial conditions using initialization policy</span>
<a name="line-126"></a>      <span class="n">Init</span><span class="o">::</span><span class="k">template</span> <span class="n">init</span><span class="o">&lt;</span> <span class="n">eq</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">g_inputdeck</span><span class="p">,</span> <span class="n">m_rng</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">particles</span><span class="p">,</span> <span class="n">m_c</span><span class="p">,</span>
<a name="line-127"></a>                                 <span class="n">m_ncomp</span><span class="p">,</span> <span class="n">m_offset</span> <span class="p">);</span>
<a name="line-128"></a>
<a name="line-129"></a>      <span class="n">fenv_t</span> <span class="n">fe</span><span class="p">;</span>
<a name="line-130"></a>      <span class="n">feholdexcept</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">fe</span> <span class="p">);</span>
<a name="line-131"></a>
<a name="line-132"></a>      <span class="k">const</span> <span class="k">auto</span> <span class="n">npar</span> <span class="o">=</span> <span class="n">particles</span><span class="p">.</span><span class="n">nunk</span><span class="p">();</span>
<a name="line-133"></a>      <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">p</span><span class="o">=</span><span class="k">decltype</span><span class="p">(</span><span class="n">npar</span><span class="p">){</span><span class="mi">0</span><span class="p">};</span> <span class="n">p</span><span class="o">&lt;</span><span class="n">npar</span><span class="p">;</span> <span class="o">++</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
<a name="line-134"></a>        <span class="c1">// Violating boundedness here is a hard error as indicates a problem</span>
<a name="line-135"></a>        <span class="c1">// with the initial conditions</span>
<a name="line-136"></a>        <span class="k">for</span> <span class="p">(</span><span class="n">ncomp_t</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">m_ncomp</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
<a name="line-137"></a>          <span class="k">auto</span> <span class="n">y</span> <span class="o">=</span> <span class="n">particles</span><span class="p">(</span> <span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m_offset</span> <span class="p">);</span>
<a name="line-138"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="o">||</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">)</span> <span class="n">Throw</span><span class="p">(</span> <span class="s">&quot;IC scalar out of bounds&quot;</span> <span class="p">);</span>
<a name="line-139"></a>        <span class="p">}</span>
<a name="line-140"></a>        <span class="c1">// Initialize derived instantaneous variables</span>
<a name="line-141"></a>        <span class="n">derived</span><span class="p">(</span> <span class="n">particles</span><span class="p">,</span> <span class="n">p</span> <span class="p">);</span>
<a name="line-142"></a>      <span class="p">}</span>
<a name="line-143"></a>
<a name="line-144"></a>      <span class="n">feclearexcept</span><span class="p">(</span> <span class="n">FE_UNDERFLOW</span> <span class="p">);</span>
<a name="line-145"></a>      <span class="n">feupdateenv</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">fe</span> <span class="p">);</span>
<a name="line-146"></a>    <span class="p">}</span>
<a name="line-147"></a>
<a name="line-148"></a>    <span class="c1">//! \brief Advance particles according to the MixDirichlet SDE</span>
<a name="line-149"></a>    <span class="c1">//! \param[in,out] particles Array of particle properties</span>
<a name="line-150"></a>    <span class="c1">//! \param[in] stream Thread (or more precisely stream) ID</span>
<a name="line-151"></a>    <span class="c1">//! \param[in] dt Time step size</span>
<a name="line-152"></a>    <span class="c1">//! \param[in] moments Map of statistical moments</span>
<a name="line-153"></a>    <span class="kt">void</span> <span class="nf">advance</span><span class="p">(</span> <span class="n">tk</span><span class="o">::</span><span class="n">Particles</span><span class="o">&amp;</span> <span class="n">particles</span><span class="p">,</span>
<a name="line-154"></a>                  <span class="kt">int</span> <span class="n">stream</span><span class="p">,</span>
<a name="line-155"></a>                  <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">dt</span><span class="p">,</span>
<a name="line-156"></a>                  <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span>
<a name="line-157"></a>                  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">ctr</span><span class="o">::</span><span class="n">Product</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;&amp;</span> <span class="n">moments</span> <span class="p">)</span>
<a name="line-158"></a>    <span class="p">{</span>
<a name="line-159"></a>      <span class="c1">// Update SDE coefficients</span>
<a name="line-160"></a>      <span class="n">coeff</span><span class="p">.</span><span class="n">update</span><span class="p">(</span> <span class="n">m_depvar</span><span class="p">,</span> <span class="n">m_ncomp</span><span class="p">,</span> <span class="n">m_norm</span><span class="p">,</span> <span class="n">DENSITY_OFFSET</span><span class="p">,</span> <span class="n">VOLUME_OFFSET</span><span class="p">,</span>
<a name="line-161"></a>                    <span class="n">moments</span><span class="p">,</span> <span class="n">m_rho</span><span class="p">,</span> <span class="n">m_r</span><span class="p">,</span> <span class="n">m_kprime</span><span class="p">,</span> <span class="n">m_b</span><span class="p">,</span> <span class="n">m_k</span><span class="p">,</span> <span class="n">m_S</span> <span class="p">);</span>
<a name="line-162"></a>
<a name="line-163"></a>      <span class="n">fenv_t</span> <span class="n">fe</span><span class="p">;</span>
<a name="line-164"></a>      <span class="n">feholdexcept</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">fe</span> <span class="p">);</span>
<a name="line-165"></a>
<a name="line-166"></a>      <span class="c1">// Advance particles</span>
<a name="line-167"></a>      <span class="k">const</span> <span class="k">auto</span> <span class="n">npar</span> <span class="o">=</span> <span class="n">particles</span><span class="p">.</span><span class="n">nunk</span><span class="p">();</span>
<a name="line-168"></a>      <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">p</span><span class="o">=</span><span class="k">decltype</span><span class="p">(</span><span class="n">npar</span><span class="p">){</span><span class="mi">0</span><span class="p">};</span> <span class="n">p</span><span class="o">&lt;</span><span class="n">npar</span><span class="p">;</span> <span class="o">++</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
<a name="line-169"></a>        <span class="c1">// Generate Gaussian random numbers with zero mean and unit variance</span>
<a name="line-170"></a>        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="n">dW</span><span class="p">(</span> <span class="n">m_ncomp</span> <span class="p">);</span>
<a name="line-171"></a>        <span class="n">m_rng</span><span class="p">.</span><span class="n">gaussian</span><span class="p">(</span> <span class="n">stream</span><span class="p">,</span> <span class="n">m_ncomp</span><span class="p">,</span> <span class="n">dW</span><span class="p">.</span><span class="n">data</span><span class="p">()</span> <span class="p">);</span>
<a name="line-172"></a>
<a name="line-173"></a>        <span class="c1">// Advance all m_ncomp (=N=K+1) scalars</span>
<a name="line-174"></a>        <span class="k">auto</span><span class="o">&amp;</span> <span class="n">yn</span> <span class="o">=</span> <span class="n">particles</span><span class="p">(</span> <span class="n">p</span><span class="p">,</span> <span class="n">m_ncomp</span><span class="p">,</span> <span class="n">m_offset</span> <span class="p">);</span>
<a name="line-175"></a>        <span class="k">for</span> <span class="p">(</span><span class="n">ncomp_t</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">m_ncomp</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
<a name="line-176"></a>          <span class="k">auto</span><span class="o">&amp;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">particles</span><span class="p">(</span> <span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m_offset</span> <span class="p">);</span>
<a name="line-177"></a>          <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">d</span> <span class="o">=</span> <span class="n">m_k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">yn</span> <span class="o">*</span> <span class="n">dt</span><span class="p">;</span>
<a name="line-178"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<a name="line-179"></a>          <span class="n">d</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">d</span> <span class="p">);</span>
<a name="line-180"></a>          <span class="k">auto</span> <span class="n">dy</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m_b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span> <span class="n">m_S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">yn</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">m_S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">y</span> <span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">dW</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a name="line-181"></a>          <span class="n">y</span> <span class="o">+=</span> <span class="n">dy</span><span class="p">;</span>
<a name="line-182"></a>          <span class="n">yn</span> <span class="o">-=</span> <span class="n">dy</span><span class="p">;</span>
<a name="line-183"></a>        <span class="p">}</span>
<a name="line-184"></a>        <span class="c1">// Compute derived instantaneous variables</span>
<a name="line-185"></a>        <span class="n">derived</span><span class="p">(</span> <span class="n">particles</span><span class="p">,</span> <span class="n">p</span> <span class="p">);</span>
<a name="line-186"></a>      <span class="p">}</span>
<a name="line-187"></a>
<a name="line-188"></a>      <span class="n">feclearexcept</span><span class="p">(</span> <span class="n">FE_UNDERFLOW</span> <span class="p">);</span>
<a name="line-189"></a>      <span class="n">feupdateenv</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">fe</span> <span class="p">);</span>
<a name="line-190"></a>    <span class="p">}</span>
<a name="line-191"></a>
<a name="line-192"></a>  <span class="k">private</span><span class="o">:</span>
<a name="line-193"></a>    <span class="c1">//! Offset of particle density in solution array relative to YN</span>
<a name="line-194"></a>    <span class="k">static</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">DENSITY_OFFSET</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<a name="line-195"></a>    <span class="c1">//! Offset of particle specific volume in solution array relative to YN</span>
<a name="line-196"></a>    <span class="k">static</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">VOLUME_OFFSET</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<a name="line-197"></a>
<a name="line-198"></a>    <span class="k">const</span> <span class="n">ncomp_t</span> <span class="n">m_c</span><span class="p">;</span>                  <span class="c1">//!&lt; Equation system index</span>
<a name="line-199"></a>    <span class="k">const</span> <span class="kt">char</span> <span class="n">m_depvar</span><span class="p">;</span>                <span class="c1">//!&lt; Dependent variable</span>
<a name="line-200"></a>    <span class="k">const</span> <span class="n">ncomp_t</span> <span class="n">m_ncomp</span><span class="p">;</span>              <span class="c1">//!&lt; Number of components, K = N-1</span>
<a name="line-201"></a>    <span class="k">const</span> <span class="n">ncomp_t</span> <span class="n">m_offset</span><span class="p">;</span>             <span class="c1">//!&lt; Offset SDE operates from</span>
<a name="line-202"></a>    <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">RNG</span><span class="o">&amp;</span> <span class="n">m_rng</span><span class="p">;</span>               <span class="c1">//!&lt; Random number generator</span>
<a name="line-203"></a>    <span class="k">const</span> <span class="n">ctr</span><span class="o">::</span><span class="n">NormalizationType</span> <span class="n">m_norm</span><span class="p">;</span><span class="c1">//!&lt; Normalization type</span>
<a name="line-204"></a>
<a name="line-205"></a>    <span class="c1">//! Coefficients</span>
<a name="line-206"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">kw</span><span class="o">::</span><span class="n">sde_b</span><span class="o">::</span><span class="n">info</span><span class="o">::</span><span class="n">expect</span><span class="o">::</span><span class="n">type</span> <span class="o">&gt;</span> <span class="n">m_b</span><span class="p">;</span>
<a name="line-207"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">kw</span><span class="o">::</span><span class="n">sde_S</span><span class="o">::</span><span class="n">info</span><span class="o">::</span><span class="n">expect</span><span class="o">::</span><span class="n">type</span> <span class="o">&gt;</span> <span class="n">m_S</span><span class="p">;</span>
<a name="line-208"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">kw</span><span class="o">::</span><span class="n">sde_kappa</span><span class="o">::</span><span class="n">info</span><span class="o">::</span><span class="n">expect</span><span class="o">::</span><span class="n">type</span> <span class="o">&gt;</span> <span class="n">m_kprime</span><span class="p">;</span>
<a name="line-209"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">kw</span><span class="o">::</span><span class="n">sde_kappa</span><span class="o">::</span><span class="n">info</span><span class="o">::</span><span class="n">expect</span><span class="o">::</span><span class="n">type</span> <span class="o">&gt;</span> <span class="n">m_k</span><span class="p">;</span>
<a name="line-210"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">kw</span><span class="o">::</span><span class="n">sde_rho</span><span class="o">::</span><span class="n">info</span><span class="o">::</span><span class="n">expect</span><span class="o">::</span><span class="n">type</span> <span class="o">&gt;</span> <span class="n">m_rho</span><span class="p">;</span>
<a name="line-211"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">kw</span><span class="o">::</span><span class="n">sde_r</span><span class="o">::</span><span class="n">info</span><span class="o">::</span><span class="n">expect</span><span class="o">::</span><span class="n">type</span> <span class="o">&gt;</span> <span class="n">m_r</span><span class="p">;</span>
<a name="line-212"></a>
<a name="line-213"></a>    <span class="c1">//! Coefficients policy</span>
<a name="line-214"></a>    <span class="n">Coefficients</span> <span class="n">coeff</span><span class="p">;</span>
<a name="line-215"></a>
<a name="line-216"></a>    <span class="c1">//! \brief Return density for mass fractions</span>
<a name="line-217"></a>    <span class="c1">//! \details This function returns the instantaneous density, rho,</span>
<a name="line-218"></a>    <span class="c1">//!   based on the multiple mass fractions, Y_c.</span>
<a name="line-219"></a>    <span class="c1">//! \param[in] particles Array of particle properties</span>
<a name="line-220"></a>    <span class="c1">//! \param[in] p Particle index</span>
<a name="line-221"></a>    <span class="c1">//! \return Instantaneous value of the density, rho</span>
<a name="line-222"></a>    <span class="c1">//! \details This is computed based 1/rho = sum_{i=1}^N Y_i/R_i, where R_i</span>
<a name="line-223"></a>    <span class="c1">//!   are the constant pure-fluid densities and the Y_i are the mass</span>
<a name="line-224"></a>    <span class="c1">//!   fractions, of the N materials.</span>
<a name="line-225"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">rho</span><span class="p">(</span> <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">Particles</span><span class="o">&amp;</span> <span class="n">particles</span><span class="p">,</span> <span class="n">ncomp_t</span> <span class="n">p</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
<a name="line-226"></a>      <span class="c1">// start computing density</span>
<a name="line-227"></a>      <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<a name="line-228"></a>      <span class="k">for</span> <span class="p">(</span><span class="n">ncomp_t</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">m_ncomp</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
<a name="line-229"></a>        <span class="n">d</span> <span class="o">+=</span> <span class="n">particles</span><span class="p">(</span> <span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m_offset</span> <span class="p">)</span> <span class="o">/</span> <span class="n">m_rho</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a name="line-230"></a>      <span class="c1">// return particle density</span>
<a name="line-231"></a>      <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">d</span><span class="p">;</span>
<a name="line-232"></a>    <span class="p">}</span>
<a name="line-233"></a>
<a name="line-234"></a>    <span class="c1">//! Compute instantaneous values derived from particle mass fractions</span>
<a name="line-235"></a>    <span class="c1">//! \param[in,out] particles Particle properties array</span>
<a name="line-236"></a>    <span class="c1">//! \param[in] p Particle index</span>
<a name="line-237"></a><span class="hll">    <span class="kt">void</span> <span class="n">derived</span><span class="p">(</span> <span class="n">tk</span><span class="o">::</span><span class="n">Particles</span><span class="o">&amp;</span> <span class="n">particles</span><span class="p">,</span> <span class="n">ncomp_t</span> <span class="n">p</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span><span class="error2">&lt;--- Parameter 'particles' can be declared with const</span>
</span><a name="line-238"></a>      <span class="c1">// compute instantaneous fluid-density based on particle mass fractions</span>
<a name="line-239"></a>      <span class="k">auto</span> <span class="n">density</span> <span class="o">=</span> <span class="n">rho</span><span class="p">(</span> <span class="n">particles</span><span class="p">,</span> <span class="n">p</span> <span class="p">);</span>
<a name="line-240"></a>      <span class="c1">//// Compute and store instantaneous density</span>
<a name="line-241"></a>      <span class="n">particles</span><span class="p">(</span> <span class="n">p</span><span class="p">,</span> <span class="n">m_ncomp</span><span class="o">+</span><span class="n">DENSITY_OFFSET</span><span class="p">,</span> <span class="n">m_offset</span> <span class="p">)</span> <span class="o">=</span> <span class="n">density</span><span class="p">;</span>
<a name="line-242"></a>      <span class="c1">// Store instantaneous specific volume</span>
<a name="line-243"></a>      <span class="n">particles</span><span class="p">(</span> <span class="n">p</span><span class="p">,</span> <span class="n">m_ncomp</span><span class="o">+</span><span class="n">VOLUME_OFFSET</span><span class="p">,</span> <span class="n">m_offset</span> <span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">density</span><span class="p">;</span>
<a name="line-244"></a>    <span class="p">}</span>
<a name="line-245"></a>
<a name="line-246"></a><span class="p">};</span>
<a name="line-247"></a>
<a name="line-248"></a><span class="p">}</span> <span class="c1">// walker::</span>
<a name="line-249"></a>
<a name="line-250"></a><span class="cp">#endif </span><span class="c1">// MixDirichlet_h</span>
</pre></div>
</td></tr></table>
      </div> <!-- /.wrapper -->
    </div>
    <div id="footer" class="footer">
      <p>
        Cppcheck 2.3 - a tool for static C/C++ code analysis<br>
        <br>
        Internet: <a href="http://cppcheck.net">http://cppcheck.net</a><br>
        IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a><br>
      </p>
    </div>
  </body>
</html>
