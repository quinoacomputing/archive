<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quinoa: inciter::Refiner Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quinoa.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceinciter.html">inciter</a></li><li class="navelem"><a class="el" href="classinciter_1_1_refiner.html">Refiner</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classinciter_1_1_refiner-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">inciter::Refiner Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Mesh refiner for interfacing the mesh refinement library.  
 <a href="classinciter_1_1_refiner.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_refiner_8h_source.html">Refiner.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for inciter::Refiner:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner__inherit__graph.svg" width="123" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:add6558703bbfc6d8f8e58ce73ef778b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#add6558703bbfc6d8f8e58ce73ef778b0">Refiner</a> (const CProxy_Transporter &amp;transporter, const CProxy_Sorter &amp;sorter, const tk::CProxy_Solver &amp;solver, const <a class="el" href="classinciter_1_1_scheme.html">Scheme</a> &amp;scheme, const <a class="el" href="namespacetk.html#a14349512cb39672c145c692e522ff28f">tk::RefinerCallback</a> &amp;cbr, const <a class="el" href="namespacetk.html#aee5e81a51fe8734df54d70ab33b1b8d0">tk::SorterCallback</a> &amp;cbs, const std::vector&lt; std::size_t &gt; &amp;ginpoel, const <a class="el" href="classtk_1_1_uns_mesh.html#a4b2d1f8043c0354b11461c118a4379c5">tk::UnsMesh::CoordMap</a> &amp;coordmap, const std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; &amp;bface, const std::vector&lt; std::size_t &gt; &amp;triinpoel, const std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; &amp;bnode, int nchare)</td></tr>
<tr class="memdesc:add6558703bbfc6d8f8e58ce73ef778b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#add6558703bbfc6d8f8e58ce73ef778b0">More...</a><br /></td></tr>
<tr class="separator:add6558703bbfc6d8f8e58ce73ef778b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8593cea0b7ea13ff8761d7a63f7f5bc9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a8593cea0b7ea13ff8761d7a63f7f5bc9">addBndEdges</a> (CkReductionMsg *msg)</td></tr>
<tr class="memdesc:a8593cea0b7ea13ff8761d7a63f7f5bc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive boundary edges from all PEs (including this one)  <a href="#a8593cea0b7ea13ff8761d7a63f7f5bc9">More...</a><br /></td></tr>
<tr class="separator:a8593cea0b7ea13ff8761d7a63f7f5bc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a145a49215d520a7a06b7469d289d4402"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a145a49215d520a7a06b7469d289d4402">addRefBndEdges</a> (int fromch, const <a class="el" href="classtk_1_1_uns_mesh.html#a4c8d0c917a9349f675ca2d3259b69193">tk::UnsMesh::EdgeNodeCoord</a> &amp;ed)</td></tr>
<tr class="memdesc:a145a49215d520a7a06b7469d289d4402"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive newly added mesh node IDs on our chare boundary.  <a href="#a145a49215d520a7a06b7469d289d4402">More...</a><br /></td></tr>
<tr class="separator:a145a49215d520a7a06b7469d289d4402"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abac6e293394b68bc9109bd2fce7ecff1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#abac6e293394b68bc9109bd2fce7ecff1">recvRefBndEdges</a> ()</td></tr>
<tr class="memdesc:abac6e293394b68bc9109bd2fce7ecff1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acknowledge received newly added nodes shared with other chares.  <a href="#abac6e293394b68bc9109bd2fce7ecff1">More...</a><br /></td></tr>
<tr class="separator:abac6e293394b68bc9109bd2fce7ecff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfae691fb62d1e756bd28d41df057d02"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#acfae691fb62d1e756bd28d41df057d02">correctref</a> ()</td></tr>
<tr class="memdesc:acfae691fb62d1e756bd28d41df057d02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Correct refinement to arrive at conforming mesh across chare boundaries.  <a href="#acfae691fb62d1e756bd28d41df057d02">More...</a><br /></td></tr>
<tr class="separator:acfae691fb62d1e756bd28d41df057d02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a408b67afd67926d139c8a9be1e90f54b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a408b67afd67926d139c8a9be1e90f54b">nextref</a> ()</td></tr>
<tr class="memdesc:a408b67afd67926d139c8a9be1e90f54b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decide wether to continue with another step of mesh refinement.  <a href="#a408b67afd67926d139c8a9be1e90f54b">More...</a><br /></td></tr>
<tr class="separator:a408b67afd67926d139c8a9be1e90f54b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:afba8afbc60c7db3b9cf5b596de2ae33f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#afba8afbc60c7db3b9cf5b596de2ae33f">registerReducers</a> ()</td></tr>
<tr class="memdesc:afba8afbc60c7db3b9cf5b596de2ae33f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure Charm++ reduction types.  <a href="#afba8afbc60c7db3b9cf5b596de2ae33f">More...</a><br /></td></tr>
<tr class="separator:afba8afbc60c7db3b9cf5b596de2ae33f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a3a8ba2c58baf8faa11dfb175967e7b2b"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a3a8ba2c58baf8faa11dfb175967e7b2b">BndFaces</a> = std::unordered_map&lt; <a class="el" href="classtk_1_1_uns_mesh.html#ae8262763c870433021affc6bb5a0f804">tk::UnsMesh::Face</a>, std::pair&lt; int, std::size_t &gt;, <a class="el" href="structtk_1_1_uns_mesh_1_1_hash.html">tk::UnsMesh::Hash</a>&lt; 3 &gt;, <a class="el" href="structtk_1_1_uns_mesh_1_1_eq.html">tk::UnsMesh::Eq</a>&lt; 3 &gt; &gt;</td></tr>
<tr class="memdesc:a3a8ba2c58baf8faa11dfb175967e7b2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to associate a pair of side set id and adjacent tet id to a boundary triangle face.  <a href="#a3a8ba2c58baf8faa11dfb175967e7b2b">More...</a><br /></td></tr>
<tr class="separator:a3a8ba2c58baf8faa11dfb175967e7b2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc6b81c6f3ad0831d0f64739528fb212"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#acc6b81c6f3ad0831d0f64739528fb212">EdgeSet</a> = std::unordered_set&lt; <a class="el" href="classtk_1_1_uns_mesh.html#a622c34bab099c772650f046b848346d7">tk::UnsMesh::Edge</a>, <a class="el" href="structtk_1_1_uns_mesh_1_1_hash.html">tk::UnsMesh::Hash</a>&lt; 2 &gt;, <a class="el" href="structtk_1_1_uns_mesh_1_1_eq.html">tk::UnsMesh::Eq</a>&lt; 2 &gt; &gt;</td></tr>
<tr class="memdesc:acc6b81c6f3ad0831d0f64739528fb212"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unique set of edges.  <a href="#acc6b81c6f3ad0831d0f64739528fb212">More...</a><br /></td></tr>
<tr class="separator:acc6b81c6f3ad0831d0f64739528fb212"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a612f34f5b2817de0bf118e85c89c116e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtk_1_1_uns_mesh.html#a2ed8d512b099636a98ba6b35b1118d6f">tk::UnsMesh::Coords</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a612f34f5b2817de0bf118e85c89c116e">flatcoord</a> (const <a class="el" href="classtk_1_1_uns_mesh.html#a4b2d1f8043c0354b11461c118a4379c5">tk::UnsMesh::CoordMap</a> &amp;coordmap)</td></tr>
<tr class="memdesc:a612f34f5b2817de0bf118e85c89c116e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate flat coordinate data from coordinate map.  <a href="#a612f34f5b2817de0bf118e85c89c116e">More...</a><br /></td></tr>
<tr class="separator:a612f34f5b2817de0bf118e85c89c116e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0cc6c7182e9d82f08fbb48183e98e56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#ac0cc6c7182e9d82f08fbb48183e98e56">start</a> ()</td></tr>
<tr class="memdesc:ac0cc6c7182e9d82f08fbb48183e98e56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare for next step of mesh refinement.  <a href="#ac0cc6c7182e9d82f08fbb48183e98e56">More...</a><br /></td></tr>
<tr class="separator:ac0cc6c7182e9d82f08fbb48183e98e56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a250585f82bb30cda86c6717be44ae0c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a250585f82bb30cda86c6717be44ae0c9">bndEdges</a> ()</td></tr>
<tr class="memdesc:a250585f82bb30cda86c6717be44ae0c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate boundary edges and send them to all chares.  <a href="#a250585f82bb30cda86c6717be44ae0c9">More...</a><br /></td></tr>
<tr class="separator:a250585f82bb30cda86c6717be44ae0c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87db375021a5846871b6e2db7a485a4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a87db375021a5846871b6e2db7a485a4b">refine</a> ()</td></tr>
<tr class="memdesc:a87db375021a5846871b6e2db7a485a4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refine mesh.  <a href="#a87db375021a5846871b6e2db7a485a4b">More...</a><br /></td></tr>
<tr class="separator:a87db375021a5846871b6e2db7a485a4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d7830e14265ab1005c50f0ca54780d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a3d7830e14265ab1005c50f0ca54780d6">comExtra</a> ()</td></tr>
<tr class="memdesc:a3d7830e14265ab1005c50f0ca54780d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Communicate refined edges after a refinement step.  <a href="#a3d7830e14265ab1005c50f0ca54780d6">More...</a><br /></td></tr>
<tr class="separator:a3d7830e14265ab1005c50f0ca54780d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a8dfd310ca8fa2e9eee5f8e2d130b78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a3a8dfd310ca8fa2e9eee5f8e2d130b78">finish</a> ()</td></tr>
<tr class="memdesc:a3a8dfd310ca8fa2e9eee5f8e2d130b78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish initiel mesh refinement.  <a href="#a3a8dfd310ca8fa2e9eee5f8e2d130b78">More...</a><br /></td></tr>
<tr class="separator:a3a8dfd310ca8fa2e9eee5f8e2d130b78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3976418525f7877b1f0a43016983c4bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a3976418525f7877b1f0a43016983c4bf">uniformRefine</a> ()</td></tr>
<tr class="memdesc:a3976418525f7877b1f0a43016983c4bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do uniform mesh refinement.  <a href="#a3976418525f7877b1f0a43016983c4bf">More...</a><br /></td></tr>
<tr class="separator:a3976418525f7877b1f0a43016983c4bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1d8849088a3862e2ccc7e34d65abe8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#ac1d8849088a3862e2ccc7e34d65abe8f">errorRefine</a> ()</td></tr>
<tr class="memdesc:ac1d8849088a3862e2ccc7e34d65abe8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do error-based mesh refinement.  <a href="#ac1d8849088a3862e2ccc7e34d65abe8f">More...</a><br /></td></tr>
<tr class="separator:ac1d8849088a3862e2ccc7e34d65abe8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06a9b9f3a4fe8c6f3da9a1ff6d580cb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a06a9b9f3a4fe8c6f3da9a1ff6d580cb3">userRefine</a> ()</td></tr>
<tr class="memdesc:a06a9b9f3a4fe8c6f3da9a1ff6d580cb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do mesh refinement based on user explicitly tagging edges.  <a href="#a06a9b9f3a4fe8c6f3da9a1ff6d580cb3">More...</a><br /></td></tr>
<tr class="separator:a06a9b9f3a4fe8c6f3da9a1ff6d580cb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01dea6b9aece262ef9bbe7016e64fdb5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a01dea6b9aece262ef9bbe7016e64fdb5">correctRefine</a> (const <a class="el" href="classinciter_1_1_refiner.html#acc6b81c6f3ad0831d0f64739528fb212">EdgeSet</a> &amp;extra)</td></tr>
<tr class="memdesc:a01dea6b9aece262ef9bbe7016e64fdb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do mesh refinement correcting PE-boundary edges.  <a href="#a01dea6b9aece262ef9bbe7016e64fdb5">More...</a><br /></td></tr>
<tr class="separator:a01dea6b9aece262ef9bbe7016e64fdb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aa26e2c8cf1618a0452b8803c53637f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a2aa26e2c8cf1618a0452b8803c53637f">updateMesh</a> ()</td></tr>
<tr class="memdesc:a2aa26e2c8cf1618a0452b8803c53637f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update mesh after refinement.  <a href="#a2aa26e2c8cf1618a0452b8803c53637f">More...</a><br /></td></tr>
<tr class="separator:a2aa26e2c8cf1618a0452b8803c53637f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a045d5cea6d191dcb04a9f3c2931cd0a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a045d5cea6d191dcb04a9f3c2931cd0a8">updateVolMesh</a> (const std::unordered_set&lt; std::size_t &gt; &amp;old, const std::unordered_set&lt; std::size_t &gt; &amp;ref)</td></tr>
<tr class="memdesc:a045d5cea6d191dcb04a9f3c2931cd0a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update volume mesh after mesh refinement.  <a href="#a045d5cea6d191dcb04a9f3c2931cd0a8">More...</a><br /></td></tr>
<tr class="separator:a045d5cea6d191dcb04a9f3c2931cd0a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc369f20f8b77201f47252ddb8b77c53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#adc369f20f8b77201f47252ddb8b77c53">updateBndMesh</a> (const std::unordered_set&lt; std::size_t &gt; &amp;old, const std::unordered_set&lt; std::size_t &gt; &amp;ref)</td></tr>
<tr class="memdesc:adc369f20f8b77201f47252ddb8b77c53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update boundary data structures after mesh refinement.  <a href="#adc369f20f8b77201f47252ddb8b77c53">More...</a><br /></td></tr>
<tr class="separator:adc369f20f8b77201f47252ddb8b77c53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8448c88661a15ab79792dc9a43c53c6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinciter_1_1_refiner.html#a3a8ba2c58baf8faa11dfb175967e7b2b">BndFaces</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#ac8448c88661a15ab79792dc9a43c53c6">boundary</a> ()</td></tr>
<tr class="memdesc:ac8448c88661a15ab79792dc9a43c53c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate boundary data structures after mesh refinement.  <a href="#ac8448c88661a15ab79792dc9a43c53c6">More...</a><br /></td></tr>
<tr class="separator:ac8448c88661a15ab79792dc9a43c53c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89c9de6672bef7eff8e0833a754582c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a89c9de6672bef7eff8e0833a754582c7">updateBndFaces</a> (const std::unordered_set&lt; std::size_t &gt; &amp;old, const std::unordered_set&lt; std::size_t &gt; &amp;ref, const <a class="el" href="classinciter_1_1_refiner.html#a3a8ba2c58baf8faa11dfb175967e7b2b">BndFaces</a> &amp;bnd)</td></tr>
<tr class="memdesc:a89c9de6672bef7eff8e0833a754582c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regenerate boundary faces after mesh refinement step.  <a href="#a89c9de6672bef7eff8e0833a754582c7">More...</a><br /></td></tr>
<tr class="separator:a89c9de6672bef7eff8e0833a754582c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9017cbb24f0a70a5f33d0174c1a7c2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#ab9017cbb24f0a70a5f33d0174c1a7c2a">updateBndNodes</a> (const std::unordered_set&lt; std::size_t &gt; &amp;old, const std::unordered_set&lt; std::size_t &gt; &amp;ref, const <a class="el" href="classinciter_1_1_refiner.html#a3a8ba2c58baf8faa11dfb175967e7b2b">BndFaces</a> &amp;bnd)</td></tr>
<tr class="memdesc:ab9017cbb24f0a70a5f33d0174c1a7c2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regenerate boundary nodes after mesh refinement step.  <a href="#ab9017cbb24f0a70a5f33d0174c1a7c2a">More...</a><br /></td></tr>
<tr class="separator:ab9017cbb24f0a70a5f33d0174c1a7c2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ab2e81a0ce5e194be775b10ef1191ec"><td class="memItemLeft" align="right" valign="top">tk::Fields&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a0ab2e81a0ce5e194be775b10ef1191ec">nodeinit</a> (std::size_t npoin, const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;esup)</td></tr>
<tr class="memdesc:a0ab2e81a0ce5e194be775b10ef1191ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate initial conditions (IC) at mesh nodes.  <a href="#a0ab2e81a0ce5e194be775b10ef1191ec">More...</a><br /></td></tr>
<tr class="separator:a0ab2e81a0ce5e194be775b10ef1191ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a6dcb67634aab36a227a6e0fec4011432"><td class="memItemLeft" align="right" valign="top">CProxy_Transporter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a6dcb67634aab36a227a6e0fec4011432">m_host</a></td></tr>
<tr class="memdesc:a6dcb67634aab36a227a6e0fec4011432"><td class="mdescLeft">&#160;</td><td class="mdescRight">Host proxy.  <a href="#a6dcb67634aab36a227a6e0fec4011432">More...</a><br /></td></tr>
<tr class="separator:a6dcb67634aab36a227a6e0fec4011432"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1985a5a79a3178b5c50a9d8112f1dd8a"><td class="memItemLeft" align="right" valign="top">CProxy_Sorter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a1985a5a79a3178b5c50a9d8112f1dd8a">m_sorter</a></td></tr>
<tr class="memdesc:a1985a5a79a3178b5c50a9d8112f1dd8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mesh sorter proxy.  <a href="#a1985a5a79a3178b5c50a9d8112f1dd8a">More...</a><br /></td></tr>
<tr class="separator:a1985a5a79a3178b5c50a9d8112f1dd8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afee3e21d01face5a1bde8edf7746f8d2"><td class="memItemLeft" align="right" valign="top">tk::CProxy_Solver&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#afee3e21d01face5a1bde8edf7746f8d2">m_solver</a></td></tr>
<tr class="memdesc:afee3e21d01face5a1bde8edf7746f8d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linear soilver proxy.  <a href="#afee3e21d01face5a1bde8edf7746f8d2">More...</a><br /></td></tr>
<tr class="separator:afee3e21d01face5a1bde8edf7746f8d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cb785ca204645311f8c26ac6a93d9a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classinciter_1_1_scheme.html">Scheme</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a0cb785ca204645311f8c26ac6a93d9a3">m_scheme</a></td></tr>
<tr class="memdesc:a0cb785ca204645311f8c26ac6a93d9a3"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classinciter_1_1_discretization.html" title="Discretization Charm++ chare array holding common functinoality to all discretization schemes...">Discretization</a> scheme.  <a href="#a0cb785ca204645311f8c26ac6a93d9a3">More...</a><br /></td></tr>
<tr class="separator:a0cb785ca204645311f8c26ac6a93d9a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e89a122b60e779413d13f4ed35a40c9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacetk.html#a14349512cb39672c145c692e522ff28f">tk::RefinerCallback</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a8e89a122b60e779413d13f4ed35a40c9">m_cbr</a></td></tr>
<tr class="memdesc:a8e89a122b60e779413d13f4ed35a40c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Charm++ callbacks associated to compile-time tags for refiner.  <a href="#a8e89a122b60e779413d13f4ed35a40c9">More...</a><br /></td></tr>
<tr class="separator:a8e89a122b60e779413d13f4ed35a40c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8750c25fab71f650dcfeae371fa87bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacetk.html#aee5e81a51fe8734df54d70ab33b1b8d0">tk::SorterCallback</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#ab8750c25fab71f650dcfeae371fa87bf">m_cbs</a></td></tr>
<tr class="memdesc:ab8750c25fab71f650dcfeae371fa87bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Charm++ callbacks associated to compile-time tags for sorter.  <a href="#ab8750c25fab71f650dcfeae371fa87bf">More...</a><br /></td></tr>
<tr class="separator:ab8750c25fab71f650dcfeae371fa87bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae736705da5f6217e06153112e2038b2e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a></td></tr>
<tr class="memdesc:ae736705da5f6217e06153112e2038b2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tetrtahedron element connectivity of our chunk of the mesh (global ids)  <a href="#ae736705da5f6217e06153112e2038b2e">More...</a><br /></td></tr>
<tr class="separator:ae736705da5f6217e06153112e2038b2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00514941af3f4b071d2bfabeccf03789"><td class="memItemLeft" align="right" valign="top">std::tuple&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt;, std::unordered_map&lt; std::size_t, std::size_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">m_el</a></td></tr>
<tr class="separator:a00514941af3f4b071d2bfabeccf03789"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bc91e28516a27aea998ae384715707f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a> = std::get&lt;0&gt;( <a class="el" href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">m_el</a> )</td></tr>
<tr class="memdesc:a6bc91e28516a27aea998ae384715707f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alias to element connectivity with local node IDs in m_el.  <a href="#a6bc91e28516a27aea998ae384715707f">More...</a><br /></td></tr>
<tr class="separator:a6bc91e28516a27aea998ae384715707f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5636a971bbf52996e933493fc6a5aa07"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a> = std::get&lt;1&gt;( <a class="el" href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">m_el</a> )</td></tr>
<tr class="memdesc:a5636a971bbf52996e933493fc6a5aa07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alias to global node IDs of owned elements in m_el.  <a href="#a5636a971bbf52996e933493fc6a5aa07">More...</a><br /></td></tr>
<tr class="separator:a5636a971bbf52996e933493fc6a5aa07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a972fbff38d8e36f96be02b7e0a092472"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; std::size_t, std::size_t &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a> = std::get&lt;2&gt;( <a class="el" href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">m_el</a> )</td></tr>
<tr class="memdesc:a972fbff38d8e36f96be02b7e0a092472"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alias to local node IDs associated to the global ones of owned elements in m_el.  <a href="#a972fbff38d8e36f96be02b7e0a092472">More...</a><br /></td></tr>
<tr class="separator:a972fbff38d8e36f96be02b7e0a092472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dbe0d53033cee33b057f32f8a65ba58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtk_1_1_uns_mesh.html#a4b2d1f8043c0354b11461c118a4379c5">tk::UnsMesh::CoordMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">m_coordmap</a></td></tr>
<tr class="memdesc:a0dbe0d53033cee33b057f32f8a65ba58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coordinates associated to global node IDs of our mesh chunk.  <a href="#a0dbe0d53033cee33b057f32f8a65ba58">More...</a><br /></td></tr>
<tr class="separator:a0dbe0d53033cee33b057f32f8a65ba58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec812331b2bc9bfc51ed8c48906204fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtk_1_1_uns_mesh.html#a2ed8d512b099636a98ba6b35b1118d6f">tk::UnsMesh::Coords</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a></td></tr>
<tr class="memdesc:aec812331b2bc9bfc51ed8c48906204fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coordinates of mesh nodes of our chunk of the mesh.  <a href="#aec812331b2bc9bfc51ed8c48906204fe">More...</a><br /></td></tr>
<tr class="separator:aec812331b2bc9bfc51ed8c48906204fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38dadaef73bf3db0af0fdaeadf87408c"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a38dadaef73bf3db0af0fdaeadf87408c">m_bface</a></td></tr>
<tr class="memdesc:a38dadaef73bf3db0af0fdaeadf87408c"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of boundary faces associated to side-set IDs.  <a href="#a38dadaef73bf3db0af0fdaeadf87408c">More...</a><br /></td></tr>
<tr class="separator:a38dadaef73bf3db0af0fdaeadf87408c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe95236aea1ef5fb585930650e829015"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">m_triinpoel</a></td></tr>
<tr class="memdesc:abe95236aea1ef5fb585930650e829015"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boundary face-node connectivity.  <a href="#abe95236aea1ef5fb585930650e829015">More...</a><br /></td></tr>
<tr class="separator:abe95236aea1ef5fb585930650e829015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f752bc3a870aea2138683b778a9c6ee"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a8f752bc3a870aea2138683b778a9c6ee">m_bnode</a></td></tr>
<tr class="memdesc:a8f752bc3a870aea2138683b778a9c6ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of boundary nodes associated to side-set IDs.  <a href="#a8f752bc3a870aea2138683b778a9c6ee">More...</a><br /></td></tr>
<tr class="separator:a8f752bc3a870aea2138683b778a9c6ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40aca114fe5c6c650c5a8ebbe1969421"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a40aca114fe5c6c650c5a8ebbe1969421">m_nchare</a></td></tr>
<tr class="memdesc:a40aca114fe5c6c650c5a8ebbe1969421"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of refiner chares.  <a href="#a40aca114fe5c6c650c5a8ebbe1969421">More...</a><br /></td></tr>
<tr class="separator:a40aca114fe5c6c650c5a8ebbe1969421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9db2d016c546a539f8213e9804ec65ff"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespaceinciter_1_1ctr.html#ab492311c84666c98ea0363b2991f81fa">ctr::AMRInitialType</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">m_initref</a></td></tr>
<tr class="memdesc:a9db2d016c546a539f8213e9804ec65ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial mesh refinement type list (in reverse order)  <a href="#a9db2d016c546a539f8213e9804ec65ff">More...</a><br /></td></tr>
<tr class="separator:a9db2d016c546a539f8213e9804ec65ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e85879e386e8df4dc9b3291bd64eb70"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_m_r_1_1mesh__adapter__t.html">AMR::mesh_adapter_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a></td></tr>
<tr class="memdesc:a7e85879e386e8df4dc9b3291bd64eb70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mesh refiner (library) object.  <a href="#a7e85879e386e8df4dc9b3291bd64eb70">More...</a><br /></td></tr>
<tr class="separator:a7e85879e386e8df4dc9b3291bd64eb70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcdd64821992ed351c4da0dcb5ef5989"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#abcdd64821992ed351c4da0dcb5ef5989">m_nref</a></td></tr>
<tr class="memdesc:abcdd64821992ed351c4da0dcb5ef5989"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counter during distribution of newly added nodes to chare-boundary edges.  <a href="#abcdd64821992ed351c4da0dcb5ef5989">More...</a><br /></td></tr>
<tr class="separator:abcdd64821992ed351c4da0dcb5ef5989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae71fe355232fbbe89ccb90cb63a0ee5"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">m_extra</a></td></tr>
<tr class="memdesc:aae71fe355232fbbe89ccb90cb63a0ee5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of chare-boundary newly added nodes that need correction.  <a href="#aae71fe355232fbbe89ccb90cb63a0ee5">More...</a><br /></td></tr>
<tr class="separator:aae71fe355232fbbe89ccb90cb63a0ee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b6f78d266458831a12a9e53a609ce72"><td class="memItemLeft" align="right" valign="top">std::unordered_set&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">m_ch</a></td></tr>
<tr class="memdesc:a8b6f78d266458831a12a9e53a609ce72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Chares we share at least a single edge with.  <a href="#a8b6f78d266458831a12a9e53a609ce72">More...</a><br /></td></tr>
<tr class="separator:a8b6f78d266458831a12a9e53a609ce72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5af0df1e55bc32f0cdfd29f72d427f43"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtk_1_1_uns_mesh.html#a4c8d0c917a9349f675ca2d3259b69193">tk::UnsMesh::EdgeNodeCoord</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">m_edgenode</a></td></tr>
<tr class="memdesc:a5af0df1e55bc32f0cdfd29f72d427f43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map associating global IDs and coordinates of a node added to an edge.  <a href="#a5af0df1e55bc32f0cdfd29f72d427f43">More...</a><br /></td></tr>
<tr class="separator:a5af0df1e55bc32f0cdfd29f72d427f43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a296faa4bf9d5353b93a3184d24d25e"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; int, <a class="el" href="classtk_1_1_uns_mesh.html#a4c8d0c917a9349f675ca2d3259b69193">tk::UnsMesh::EdgeNodeCoord</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a8a296faa4bf9d5353b93a3184d24d25e">m_edgenodeCh</a></td></tr>
<tr class="memdesc:a8a296faa4bf9d5353b93a3184d24d25e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map associating global IDs and coordinates of a node added to an edge associated to another chare the edge is shared with.  <a href="#a8a296faa4bf9d5353b93a3184d24d25e">More...</a><br /></td></tr>
<tr class="separator:a8a296faa4bf9d5353b93a3184d24d25e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d96d8d83e5525268168cbc84d79396"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; int, <a class="el" href="classinciter_1_1_refiner.html#acc6b81c6f3ad0831d0f64739528fb212">EdgeSet</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a></td></tr>
<tr class="memdesc:ad9d96d8d83e5525268168cbc84d79396"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boundary edges associated to chares we share these edges with.  <a href="#ad9d96d8d83e5525268168cbc84d79396">More...</a><br /></td></tr>
<tr class="separator:ad9d96d8d83e5525268168cbc84d79396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d5398f5bbfa783db201e6daa7370a5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a5d5398f5bbfa783db201e6daa7370a5f">pup</a> (PUP::er &amp;p)</td></tr>
<tr class="memdesc:a5d5398f5bbfa783db201e6daa7370a5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack/Unpack serialize member function.  <a href="#a5d5398f5bbfa783db201e6daa7370a5f">More...</a><br /></td></tr>
<tr class="separator:a5d5398f5bbfa783db201e6daa7370a5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f911c5716c9c6d10e401f6baab33af6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_refiner.html#a2f911c5716c9c6d10e401f6baab33af6">operator|</a> (PUP::er &amp;p, <a class="el" href="classinciter_1_1_refiner.html">Refiner</a> &amp;r)</td></tr>
<tr class="memdesc:a2f911c5716c9c6d10e401f6baab33af6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack/Unpack serialize operator|.  <a href="#a2f911c5716c9c6d10e401f6baab33af6">More...</a><br /></td></tr>
<tr class="separator:a2f911c5716c9c6d10e401f6baab33af6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Mesh refiner for interfacing the mesh refinement library. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00034">34</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a3a8ba2c58baf8faa11dfb175967e7b2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a8ba2c58baf8faa11dfb175967e7b2b">&#9670;&nbsp;</a></span>BndFaces</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classinciter_1_1_refiner.html#a3a8ba2c58baf8faa11dfb175967e7b2b">inciter::Refiner::BndFaces</a> =  std::unordered_map&lt; <a class="el" href="classtk_1_1_uns_mesh.html#ae8262763c870433021affc6bb5a0f804">tk::UnsMesh::Face</a>, std::pair&lt; int, std::size_t &gt;, <a class="el" href="structtk_1_1_uns_mesh_1_1_hash.html">tk::UnsMesh::Hash</a>&lt;3&gt;, <a class="el" href="structtk_1_1_uns_mesh_1_1_eq.html">tk::UnsMesh::Eq</a>&lt;3&gt; &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Used to associate a pair of side set id and adjacent tet id to a boundary triangle face. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00111">111</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

</div>
</div>
<a id="acc6b81c6f3ad0831d0f64739528fb212"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc6b81c6f3ad0831d0f64739528fb212">&#9670;&nbsp;</a></span>EdgeSet</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classinciter_1_1_refiner.html#acc6b81c6f3ad0831d0f64739528fb212">inciter::Refiner::EdgeSet</a> =  std::unordered_set&lt; <a class="el" href="classtk_1_1_uns_mesh.html#a622c34bab099c772650f046b848346d7">tk::UnsMesh::Edge</a>, <a class="el" href="structtk_1_1_uns_mesh_1_1_hash.html">tk::UnsMesh::Hash</a>&lt;2&gt;, <a class="el" href="structtk_1_1_uns_mesh_1_1_eq.html">tk::UnsMesh::Eq</a>&lt;2&gt; &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unique set of edges. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00116">116</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="add6558703bbfc6d8f8e58ce73ef778b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add6558703bbfc6d8f8e58ce73ef778b0">&#9670;&nbsp;</a></span>Refiner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Refiner::Refiner </td>
          <td>(</td>
          <td class="paramtype">const CProxy_Transporter &amp;&#160;</td>
          <td class="paramname"><em>transporter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CProxy_Sorter &amp;&#160;</td>
          <td class="paramname"><em>sorter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::CProxy_Solver &amp;&#160;</td>
          <td class="paramname"><em>solver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinciter_1_1_scheme.html">Scheme</a> &amp;&#160;</td>
          <td class="paramname"><em>scheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacetk.html#a14349512cb39672c145c692e522ff28f">tk::RefinerCallback</a> &amp;&#160;</td>
          <td class="paramname"><em>cbr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacetk.html#aee5e81a51fe8734df54d70ab33b1b8d0">tk::SorterCallback</a> &amp;&#160;</td>
          <td class="paramname"><em>cbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>ginpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_uns_mesh.html#a4b2d1f8043c0354b11461c118a4379c5">tk::UnsMesh::CoordMap</a> &amp;&#160;</td>
          <td class="paramname"><em>coordmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>bface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>triinpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>bnode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nchare</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bface</td><td>Face lists mapped to side set ids </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">triinpoel</td><td>Interconnectivity of points and boundary-face </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00038">38</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>, <a class="el" href="_d_g_8_c_source.html#l00028">inciter::g_inputdeck</a>, <a class="el" href="_control_8h_source.html#l00046">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_refiner_8h_source.html#l00131">m_ginpoel</a>, <a class="el" href="_refiner_8h_source.html#l00159">m_initref</a>, and <a class="el" href="_refiner_8_c_source.html#l00135">start()</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                               :</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a6dcb67634aab36a227a6e0fec4011432">m_host</a>( transporter ),</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a1985a5a79a3178b5c50a9d8112f1dd8a">m_sorter</a>( sorter ),</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#afee3e21d01face5a1bde8edf7746f8d2">m_solver</a>( solver ),</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a0cb785ca204645311f8c26ac6a93d9a3">m_scheme</a>( scheme ),</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a8e89a122b60e779413d13f4ed35a40c9">m_cbr</a>( cbr ),</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#ab8750c25fab71f650dcfeae371fa87bf">m_cbs</a>( cbs ),</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>( ginpoel ),</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">m_el</a>( <a class="code" href="namespacetk.html#a0ee7abd71123782d48e2ec04906fe982">tk::global2local</a>( ginpoel ) ),     <span class="comment">// fills m_inpoel, m_gid, m_lid</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">m_coordmap</a>( coordmap ),</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a>( <a class="code" href="classinciter_1_1_refiner.html#a612f34f5b2817de0bf118e85c89c116e">flatcoord</a>(coordmap) ),</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a38dadaef73bf3db0af0fdaeadf87408c">m_bface</a>( bface ),</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">m_triinpoel</a>( triinpoel ),</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a8f752bc3a870aea2138683b778a9c6ee">m_bnode</a>( bnode ),</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a40aca114fe5c6c650c5a8ebbe1969421">m_nchare</a>( nchare ),</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">m_initref</a>( <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1amr.html">tag::amr</a>, <a class="code" href="structtag_1_1init.html">tag::init</a> &gt;() ),</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a> ),</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#abcdd64821992ed351c4da0dcb5ef5989">m_nref</a>( 0 ),</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">m_extra</a>( 0 ),</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">m_ch</a>(),</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">m_edgenode</a>(),</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a8a296faa4bf9d5353b93a3184d24d25e">m_edgenodeCh</a>(),</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>()</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">// *****************************************************************************</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//  Constructor</span><span class="comment"></span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//! \param[in] bface Face lists mapped to side set ids</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">//! \param[in] triinpoel Interconnectivity of points and boundary-face</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span><span class="comment">// *****************************************************************************</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;{</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( !<a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>.empty(), <span class="stringliteral">&quot;No elements assigned to refiner chare&quot;</span> );</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">// Reverse initial mesh refinement type list (will pop from back)</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  std::reverse( begin(<a class="code" href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">m_initref</a>), end(<a class="code" href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">m_initref</a>) );</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// If initial mesh refinement is configured, start initial mesh refinement.</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// See also tk::grm::check_amr_errors in Control/Inciter/InputDeck/Ggrammar.h.</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1amr.html">tag::amr</a>, <a class="code" href="structtag_1_1initamr.html">tag::initamr</a> &gt;())</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="classinciter_1_1_refiner.html#ac0cc6c7182e9d82f08fbb48183e98e56">start</a>();</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="classinciter_1_1_refiner.html#a3a8dfd310ca8fa2e9eee5f8e2d130b78">finish</a>();</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_aae71fe355232fbbe89ccb90cb63a0ee5"><div class="ttname"><a href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">inciter::Refiner::m_extra</a></div><div class="ttdeci">std::size_t m_extra</div><div class="ttdoc">Number of chare-boundary newly added nodes that need correction. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00165">Refiner.h:165</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a38dadaef73bf3db0af0fdaeadf87408c"><div class="ttname"><a href="classinciter_1_1_refiner.html#a38dadaef73bf3db0af0fdaeadf87408c">inciter::Refiner::m_bface</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_bface</div><div class="ttdoc">List of boundary faces associated to side-set IDs. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00151">Refiner.h:151</a></div></div>
<div class="ttc" id="structtag_1_1amr_html"><div class="ttname"><a href="structtag_1_1amr.html">tag::amr</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00073">Tags.h:73</a></div></div>
<div class="ttc" id="namespacetk_html_a0ee7abd71123782d48e2ec04906fe982"><div class="ttname"><a href="namespacetk.html#a0ee7abd71123782d48e2ec04906fe982">tk::global2local</a></div><div class="ttdeci">std::tuple&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt;, std::unordered_map&lt; std::size_t, std::size_t &gt; &gt; global2local(const std::vector&lt; std::size_t &gt; &amp;ginpoel)</div><div class="ttdoc">Generate element connectivity of local node IDs from connectivity of global node IDs also returning t...</div><div class="ttdef"><b>Definition:</b> <a href="_reorder_8_c_source.html#l00164">Reorder.C:164</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a6bc91e28516a27aea998ae384715707f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">inciter::Refiner::m_inpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_inpoel</div><div class="ttdoc">Alias to element connectivity with local node IDs in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00140">Refiner.h:140</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a5af0df1e55bc32f0cdfd29f72d427f43"><div class="ttname"><a href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">inciter::Refiner::m_edgenode</a></div><div class="ttdeci">tk::UnsMesh::EdgeNodeCoord m_edgenode</div><div class="ttdoc">Map associating global IDs and coordinates of a node added to an edge. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00169">Refiner.h:169</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a9db2d016c546a539f8213e9804ec65ff"><div class="ttname"><a href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">inciter::Refiner::m_initref</a></div><div class="ttdeci">std::vector&lt; ctr::AMRInitialType &gt; m_initref</div><div class="ttdoc">Initial mesh refinement type list (in reverse order) </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00159">Refiner.h:159</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_abe95236aea1ef5fb585930650e829015"><div class="ttname"><a href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">inciter::Refiner::m_triinpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; m_triinpoel</div><div class="ttdoc">Boundary face-node connectivity. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00153">Refiner.h:153</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a00514941af3f4b071d2bfabeccf03789"><div class="ttname"><a href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">inciter::Refiner::m_el</a></div><div class="ttdeci">std::tuple&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt;, std::unordered_map&lt; std::size_t, std::size_t &gt; &gt; m_el</div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00138">Refiner.h:138</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a40aca114fe5c6c650c5a8ebbe1969421"><div class="ttname"><a href="classinciter_1_1_refiner.html#a40aca114fe5c6c650c5a8ebbe1969421">inciter::Refiner::m_nchare</a></div><div class="ttdeci">int m_nchare</div><div class="ttdoc">Total number of refiner chares. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00157">Refiner.h:157</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ae736705da5f6217e06153112e2038b2e"><div class="ttname"><a href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">inciter::Refiner::m_ginpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; m_ginpoel</div><div class="ttdoc">Tetrtahedron element connectivity of our chunk of the mesh (global ids) </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00131">Refiner.h:131</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_abcdd64821992ed351c4da0dcb5ef5989"><div class="ttname"><a href="classinciter_1_1_refiner.html#abcdd64821992ed351c4da0dcb5ef5989">inciter::Refiner::m_nref</a></div><div class="ttdeci">std::size_t m_nref</div><div class="ttdoc">Counter during distribution of newly added nodes to chare-boundary edges. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00163">Refiner.h:163</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a0cb785ca204645311f8c26ac6a93d9a3"><div class="ttname"><a href="classinciter_1_1_refiner.html#a0cb785ca204645311f8c26ac6a93d9a3">inciter::Refiner::m_scheme</a></div><div class="ttdeci">Scheme m_scheme</div><div class="ttdoc">Discretization scheme. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00125">Refiner.h:125</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ad9d96d8d83e5525268168cbc84d79396"><div class="ttname"><a href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">inciter::Refiner::m_bndEdges</a></div><div class="ttdeci">std::unordered_map&lt; int, EdgeSet &gt; m_bndEdges</div><div class="ttdoc">Boundary edges associated to chares we share these edges with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00174">Refiner.h:174</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8e89a122b60e779413d13f4ed35a40c9"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8e89a122b60e779413d13f4ed35a40c9">inciter::Refiner::m_cbr</a></div><div class="ttdeci">tk::RefinerCallback m_cbr</div><div class="ttdoc">Charm++ callbacks associated to compile-time tags for refiner. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00127">Refiner.h:127</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_afee3e21d01face5a1bde8edf7746f8d2"><div class="ttname"><a href="classinciter_1_1_refiner.html#afee3e21d01face5a1bde8edf7746f8d2">inciter::Refiner::m_solver</a></div><div class="ttdeci">tk::CProxy_Solver m_solver</div><div class="ttdoc">Linear soilver proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00123">Refiner.h:123</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a612f34f5b2817de0bf118e85c89c116e"><div class="ttname"><a href="classinciter_1_1_refiner.html#a612f34f5b2817de0bf118e85c89c116e">inciter::Refiner::flatcoord</a></div><div class="ttdeci">tk::UnsMesh::Coords flatcoord(const tk::UnsMesh::CoordMap &amp;coordmap)</div><div class="ttdoc">Generate flat coordinate data from coordinate map. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00108">Refiner.C:108</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ac0cc6c7182e9d82f08fbb48183e98e56"><div class="ttname"><a href="classinciter_1_1_refiner.html#ac0cc6c7182e9d82f08fbb48183e98e56">inciter::Refiner::start</a></div><div class="ttdeci">void start()</div><div class="ttdoc">Prepare for next step of mesh refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00135">Refiner.C:135</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8b6f78d266458831a12a9e53a609ce72"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">inciter::Refiner::m_ch</a></div><div class="ttdeci">std::unordered_set&lt; int &gt; m_ch</div><div class="ttdoc">Chares we share at least a single edge with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00167">Refiner.h:167</a></div></div>
<div class="ttc" id="structtag_1_1init_html"><div class="ttname"><a href="structtag_1_1init.html">tag::init</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00148">Tags.h:148</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a1985a5a79a3178b5c50a9d8112f1dd8a"><div class="ttname"><a href="classinciter_1_1_refiner.html#a1985a5a79a3178b5c50a9d8112f1dd8a">inciter::Refiner::m_sorter</a></div><div class="ttdeci">CProxy_Sorter m_sorter</div><div class="ttdoc">Mesh sorter proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00121">Refiner.h:121</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a0dbe0d53033cee33b057f32f8a65ba58"><div class="ttname"><a href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">inciter::Refiner::m_coordmap</a></div><div class="ttdeci">tk::UnsMesh::CoordMap m_coordmap</div><div class="ttdoc">Coordinates associated to global node IDs of our mesh chunk. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00147">Refiner.h:147</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a3a8dfd310ca8fa2e9eee5f8e2d130b78"><div class="ttname"><a href="classinciter_1_1_refiner.html#a3a8dfd310ca8fa2e9eee5f8e2d130b78">inciter::Refiner::finish</a></div><div class="ttdeci">void finish()</div><div class="ttdoc">Finish initiel mesh refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00429">Refiner.C:429</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a6dcb67634aab36a227a6e0fec4011432"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6dcb67634aab36a227a6e0fec4011432">inciter::Refiner::m_host</a></div><div class="ttdeci">CProxy_Transporter m_host</div><div class="ttdoc">Host proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00119">Refiner.h:119</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00046">Control.h:46</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a7e85879e386e8df4dc9b3291bd64eb70"><div class="ttname"><a href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">inciter::Refiner::m_refiner</a></div><div class="ttdeci">AMR::mesh_adapter_t m_refiner</div><div class="ttdoc">Mesh refiner (library) object. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00161">Refiner.h:161</a></div></div>
<div class="ttc" id="structtag_1_1initamr_html"><div class="ttname"><a href="structtag_1_1initamr.html">tag::initamr</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00074">Tags.h:74</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ab8750c25fab71f650dcfeae371fa87bf"><div class="ttname"><a href="classinciter_1_1_refiner.html#ab8750c25fab71f650dcfeae371fa87bf">inciter::Refiner::m_cbs</a></div><div class="ttdeci">tk::SorterCallback m_cbs</div><div class="ttdoc">Charm++ callbacks associated to compile-time tags for sorter. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00129">Refiner.h:129</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8f752bc3a870aea2138683b778a9c6ee"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8f752bc3a870aea2138683b778a9c6ee">inciter::Refiner::m_bnode</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_bnode</div><div class="ttdoc">List of boundary nodes associated to side-set IDs. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00155">Refiner.h:155</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_aec812331b2bc9bfc51ed8c48906204fe"><div class="ttname"><a href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">inciter::Refiner::m_coord</a></div><div class="ttdeci">tk::UnsMesh::Coords m_coord</div><div class="ttdoc">Coordinates of mesh nodes of our chunk of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00149">Refiner.h:149</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8a296faa4bf9d5353b93a3184d24d25e"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8a296faa4bf9d5353b93a3184d24d25e">inciter::Refiner::m_edgenodeCh</a></div><div class="ttdeci">std::unordered_map&lt; int, tk::UnsMesh::EdgeNodeCoord &gt; m_edgenodeCh</div><div class="ttdoc">Map associating global IDs and coordinates of a node added to an edge associated to another chare the...</div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00172">Refiner.h:172</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_d_g_8_c_source.html#l00028">DG.C:28</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_add6558703bbfc6d8f8e58ce73ef778b0_cgraph.svg" width="100%" height="439"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8593cea0b7ea13ff8761d7a63f7f5bc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8593cea0b7ea13ff8761d7a63f7f5bc9">&#9670;&nbsp;</a></span>addBndEdges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::addBndEdges </td>
          <td>(</td>
          <td class="paramtype">CkReductionMsg *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive boundary edges from all PEs (including this one) </p>
<p>Receive boundary edges from all refiner chares (including this one) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>Charm++ message containing the aggregated map of bnd edges </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00193">193</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_container_util_8h_source.html#l00051">tk::cref_find()</a>, <a class="el" href="_refiner_8h_source.html#l00174">m_bndEdges</a>, <a class="el" href="_refiner_8h_source.html#l00167">m_ch</a>, and <a class="el" href="_refiner_8_c_source.html#l00215">refine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;{</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   PUP::fromMem creator( msg-&gt;getData() );</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   creator | <a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <span class="keyword">delete</span> msg;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <span class="comment">// Compute unique set of chares that share at least a single edge with us</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; ownedges = <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>( <a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>, thisIndex );</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : <a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>)    <span class="comment">// for all chares</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;     <span class="keywordflow">if</span> (p.first != thisIndex)         <span class="comment">// for all chares other than this one</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;       <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e : p.second)  <span class="comment">// for all boundary edges</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;         <span class="keywordflow">if</span> (ownedges.find(e) != end(ownedges))</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;           <a class="code" href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">m_ch</a>.insert( p.first );     <span class="comment">// if edge is shared, store its chare id</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <a class="code" href="classinciter_1_1_refiner.html#a87db375021a5846871b6e2db7a485a4b">refine</a>();</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_a87db375021a5846871b6e2db7a485a4b"><div class="ttname"><a href="classinciter_1_1_refiner.html#a87db375021a5846871b6e2db7a485a4b">inciter::Refiner::refine</a></div><div class="ttdeci">void refine()</div><div class="ttdoc">Refine mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00215">Refiner.C:215</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ad9d96d8d83e5525268168cbc84d79396"><div class="ttname"><a href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">inciter::Refiner::m_bndEdges</a></div><div class="ttdeci">std::unordered_map&lt; int, EdgeSet &gt; m_bndEdges</div><div class="ttdoc">Boundary edges associated to chares we share these edges with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00174">Refiner.h:174</a></div></div>
<div class="ttc" id="namespacetk_html_a2e002561a68875b091a264eb2a1e5f6c"><div class="ttname"><a href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a></div><div class="ttdeci">auto cref_find(const Container &amp;map, const typename Container::key_type &amp;key) -&gt; const typename Container::mapped_type &amp;</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00051">ContainerUtil.h:51</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8b6f78d266458831a12a9e53a609ce72"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">inciter::Refiner::m_ch</a></div><div class="ttdeci">std::unordered_set&lt; int &gt; m_ch</div><div class="ttdoc">Chares we share at least a single edge with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00167">Refiner.h:167</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a8593cea0b7ea13ff8761d7a63f7f5bc9_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a145a49215d520a7a06b7469d289d4402"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a145a49215d520a7a06b7469d289d4402">&#9670;&nbsp;</a></span>addRefBndEdges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::addRefBndEdges </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_uns_mesh.html#a4c8d0c917a9349f675ca2d3259b69193">tk::UnsMesh::EdgeNodeCoord</a> &amp;&#160;</td>
          <td class="paramname"><em>ed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive newly added mesh node IDs on our chare boundary. </p>
<p>Receive newly added mesh node IDs on our chare boundary </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Chare call coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ed</td><td>Newly added node IDs associated to parent nodes on chare boundary</td></tr>
  </table>
  </dd>
</dl>
<p>Receive newly added global node IDs and coordinates associated to global parent IDs of edges on our mesh chunk boundary. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00293">293</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_refiner_8h_source.html#l00172">m_edgenodeCh</a>.</p>
<div class="fragment"><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;{</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">// Save/augment buffer of edge-node (IDs and coords) for each sender chare</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a8a296faa4bf9d5353b93a3184d24d25e">m_edgenodeCh</a>[ fromch ].insert( begin(ed), end(ed) );</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// Acknowledge receipt of chare-boundary edges to sender</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  thisProxy[ fromch ].recvRefBndEdges();</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_a8a296faa4bf9d5353b93a3184d24d25e"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8a296faa4bf9d5353b93a3184d24d25e">inciter::Refiner::m_edgenodeCh</a></div><div class="ttdeci">std::unordered_map&lt; int, tk::UnsMesh::EdgeNodeCoord &gt; m_edgenodeCh</div><div class="ttdoc">Map associating global IDs and coordinates of a node added to an edge associated to another chare the...</div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00172">Refiner.h:172</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a250585f82bb30cda86c6717be44ae0c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a250585f82bb30cda86c6717be44ae0c9">&#9670;&nbsp;</a></span>bndEdges()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::bndEdges </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate boundary edges and send them to all chares. </p>
<p>Extract edges on the boundary only. The boundary edges (shared by multiple chares) will be agreed on a refinement that yields a conforming mesh across chares boundaries. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00156">156</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_refiner_8_c_source.html#l00032">inciter::BndEdgeMerger</a>, <a class="el" href="_derived_data_8_c_source.html#l00934">tk::genEsuelTet()</a>, <a class="el" href="_derived_data_8_c_source.html#l00042">tk::genEsup()</a>, <a class="el" href="_derived_data_8h_source.html#l00033">tk::lpofa</a>, <a class="el" href="_refiner_8h_source.html#l00174">m_bndEdges</a>, <a class="el" href="_refiner_8h_source.html#l00131">m_ginpoel</a>, <a class="el" href="_refiner_8h_source.html#l00140">m_inpoel</a>, <a class="el" href="_refiner_8h_source.html#l00145">m_lid</a>, and <a class="el" href="_hash_map_reducer_8h_source.html#l00034">tk::serialize()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00135">start()</a>.</p>
<div class="fragment"><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;{</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">// Generate boundary edges of our mesh chunk</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="classtk_1_1_uns_mesh.html#a564c87d50c1611fff1c6d045bc07a3b4">tk::UnsMesh::EdgeSet</a> bnded;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keyword">auto</span> esup = <a class="code" href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, 4 );         <span class="comment">// elements surrounding points</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keyword">auto</span> esuel = <a class="code" href="namespacetk.html#a5b61b3cb6492e71ff9853404440fddcc">tk::genEsuelTet</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, esup ); <span class="comment">// elems surrounding elements</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;esuel.size()/4; ++e) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keyword">auto</span> mark = e*4;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">for</span> (std::size_t f=0; f&lt;4; ++f) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">if</span> (esuel[mark+f] == -1) {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keyword">auto</span> A = <a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>[ mark+<a class="code" href="namespacetk.html#a30ac7c57927d6134e6563817f5d005a0">tk::lpofa</a>[f][0] ];</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keyword">auto</span> B = <a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>[ mark+tk::lpofa[f][1] ];</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keyword">auto</span> C = <a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>[ mark+tk::lpofa[f][2] ];</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        bnded.insert( {{{A,B}}} );</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        bnded.insert( {{{B,C}}} );</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        bnded.insert( {{{C,A}}} );</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>.find( A ) != end(<a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>), <span class="stringliteral">&quot;Local node ID not found&quot;</span> );</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>.find( B ) != end(<a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>), <span class="stringliteral">&quot;Local node ID not found&quot;</span> );</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>.find( C ) != end(<a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>), <span class="stringliteral">&quot;Local node ID not found&quot;</span> );</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">// Aggregate boundary edges across all refiner chares</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  decltype(<a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>) bnd{{ thisIndex, std::move(bnded) }};</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keyword">auto</span> stream = <a class="code" href="namespacetk.html#ae89ad400e8727632059aab318889c52c">tk::serialize</a>( bnd );</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  contribute( stream.first, stream.second.get(), <a class="code" href="namespaceinciter.html#af16fb066bd82d65db4ad0dcc5f6efc99">BndEdgeMerger</a>,</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    CkCallback(CkIndex_Refiner::addBndEdges(<span class="keyword">nullptr</span>),thisProxy) );</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_a6bc91e28516a27aea998ae384715707f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">inciter::Refiner::m_inpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_inpoel</div><div class="ttdoc">Alias to element connectivity with local node IDs in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00140">Refiner.h:140</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a972fbff38d8e36f96be02b7e0a092472"><div class="ttname"><a href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">inciter::Refiner::m_lid</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::size_t &gt; &amp; m_lid</div><div class="ttdoc">Alias to local node IDs associated to the global ones of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00145">Refiner.h:145</a></div></div>
<div class="ttc" id="namespacetk_html_a30ac7c57927d6134e6563817f5d005a0"><div class="ttname"><a href="namespacetk.html#a30ac7c57927d6134e6563817f5d005a0">tk::lpofa</a></div><div class="ttdeci">const std::array&lt; std::array&lt; std::size_t, 3 &gt;, 4 &gt; lpofa</div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8h_source.html#l00033">DerivedData.h:33</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ae736705da5f6217e06153112e2038b2e"><div class="ttname"><a href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">inciter::Refiner::m_ginpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; m_ginpoel</div><div class="ttdoc">Tetrtahedron element connectivity of our chunk of the mesh (global ids) </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00131">Refiner.h:131</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ad9d96d8d83e5525268168cbc84d79396"><div class="ttname"><a href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">inciter::Refiner::m_bndEdges</a></div><div class="ttdeci">std::unordered_map&lt; int, EdgeSet &gt; m_bndEdges</div><div class="ttdoc">Boundary edges associated to chares we share these edges with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00174">Refiner.h:174</a></div></div>
<div class="ttc" id="namespacetk_html_ae89ad400e8727632059aab318889c52c"><div class="ttname"><a href="namespacetk.html#ae89ad400e8727632059aab318889c52c">tk::serialize</a></div><div class="ttdeci">std::pair&lt; int, std::unique_ptr&lt; char[]&gt; &gt; serialize(const std::unordered_map&lt; Key, T, Hash, Eq &gt; &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="_hash_map_reducer_8h_source.html#l00034">HashMapReducer.h:34</a></div></div>
<div class="ttc" id="namespacetk_html_a5b61b3cb6492e71ff9853404440fddcc"><div class="ttname"><a href="namespacetk.html#a5b61b3cb6492e71ff9853404440fddcc">tk::genEsuelTet</a></div><div class="ttdeci">std::vector&lt; int &gt; genEsuelTet(const std::vector&lt; std::size_t &gt; &amp;inpoel, const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;esup)</div><div class="ttdoc">Generate derived data structure, elements surrounding elements as a fixed length data structure as a ...</div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00934">DerivedData.C:934</a></div></div>
<div class="ttc" id="namespacetk_html_a66a2889d5d8aeb4a836842c6a1010463"><div class="ttname"><a href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; genEsup(const std::vector&lt; std::size_t &gt; &amp;inpoel, std::size_t nnpe)</div><div class="ttdoc">Generate derived data structure, elements surrounding points. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00042">DerivedData.C:42</a></div></div>
<div class="ttc" id="namespaceinciter_html_af16fb066bd82d65db4ad0dcc5f6efc99"><div class="ttname"><a href="namespaceinciter.html#af16fb066bd82d65db4ad0dcc5f6efc99">inciter::BndEdgeMerger</a></div><div class="ttdeci">static CkReduction::reducerType BndEdgeMerger</div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00032">Refiner.C:32</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classtk_1_1_uns_mesh_html_a564c87d50c1611fff1c6d045bc07a3b4"><div class="ttname"><a href="classtk_1_1_uns_mesh.html#a564c87d50c1611fff1c6d045bc07a3b4">tk::UnsMesh::EdgeSet</a></div><div class="ttdeci">std::unordered_set&lt; Edge, Hash&lt; 2 &gt;, Eq&lt; 2 &gt; &gt; EdgeSet</div><div class="ttdoc">Unique set of edges. </div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00109">UnsMesh.h:109</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a250585f82bb30cda86c6717be44ae0c9_cgraph.svg" width="488" height="134"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ac8448c88661a15ab79792dc9a43c53c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8448c88661a15ab79792dc9a43c53c6">&#9670;&nbsp;</a></span>boundary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinciter_1_1_refiner.html#a3a8ba2c58baf8faa11dfb175967e7b2b">Refiner::BndFaces</a> Refiner::boundary </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate boundary data structures after mesh refinement. </p>
<dl class="section return"><dt>Returns</dt><dd>Map associating a pair of side set id and adjacent tet id (value) to a partition-boundary triangle face (key) given by three global node IDs</dd></dl>
<p>This is used to regenerate physical boundary face and node data structures after refinement, see updateBoundaryMesh(). </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00733">733</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_derived_data_8_c_source.html#l00934">tk::genEsuelTet()</a>, <a class="el" href="_derived_data_8_c_source.html#l00042">tk::genEsup()</a>, <a class="el" href="_derived_data_8h_source.html#l00033">tk::lpofa</a>, <a class="el" href="_refiner_8h_source.html#l00151">m_bface</a>, <a class="el" href="_refiner_8h_source.html#l00131">m_ginpoel</a>, <a class="el" href="_refiner_8h_source.html#l00140">m_inpoel</a>, <a class="el" href="_refiner_8h_source.html#l00161">m_refiner</a>, <a class="el" href="_refiner_8h_source.html#l00153">m_triinpoel</a>, <a class="el" href="mesh__adapter_8h_source.html#l00039">AMR::mesh_adapter_t::tet_store</a>, and <a class="el" href="tet__store_8h_source.html#l00041">AMR::tet_store_t::tets</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00802">updateBndMesh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;{</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keyword">using</span> Face = <a class="code" href="classtk_1_1_uns_mesh.html#ae8262763c870433021affc6bb5a0f804">tk::UnsMesh::Face</a>;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="keyword">using</span> Tet = <a class="code" href="classtk_1_1_uns_mesh.html#abc1a507e27f21d7c588e3ea8bcd76602">tk::UnsMesh::Tet</a>;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="comment">// Generate the inverse of AMR&#39;s tets map</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  std::unordered_map&lt; Tet,</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                      std::size_t,</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                      <a class="code" href="structtk_1_1_uns_mesh_1_1_hash.html">tk::UnsMesh::Hash&lt;4&gt;</a>,</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                      <a class="code" href="structtk_1_1_uns_mesh_1_1_eq.html">tk::UnsMesh::Eq&lt;4&gt;</a> &gt; invtets;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; t : <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#a42b0c354d6edd7b772c1844beb1c2f9a">tet_store</a>.<a class="code" href="class_a_m_r_1_1tet__store__t.html#a1908d4c25a05f43fbf5902df9649b913">tets</a>) invtets[ t.second ] = t.first;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="comment">// Generate data structure that associates the pair of side set id and</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="comment">// adjacent tet id to a boundary triangle face for all boundary faces. After</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">// this loop we will have all tets adjacent to boundary faces, where the</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="comment">// boundary includes all physical boundaries (where the user may assign</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="comment">// boundary conditions via side sets from the mesh file) as well as</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="comment">// chare-boundaries due to domain decomposition.</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a3a8ba2c58baf8faa11dfb175967e7b2b">BndFaces</a> bnd;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keyword">auto</span> oldesuel = <a class="code" href="namespacetk.html#a5b61b3cb6492e71ff9853404440fddcc">tk::genEsuelTet</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, <a class="code" href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a>(<a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>,4) );</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;oldesuel.size()/4; ++e) {    <span class="comment">// for tets on this chare</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keyword">auto</span> mark = e*4;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">for</span> (std::size_t f=0; f&lt;4; ++f) {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <span class="keywordflow">if</span> (oldesuel[mark+f] == -1) {  <span class="comment">// if a face does not have an adjacent tet</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        Face b{{ <a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>[ mark+<a class="code" href="namespacetk.html#a30ac7c57927d6134e6563817f5d005a0">tk::lpofa</a>[f][0] ],</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                 <a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>[ mark+tk::lpofa[f][1] ],</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                 <a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>[ mark+tk::lpofa[f][2] ] }};</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        Tet t{{ <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>[mark+0], <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>[mark+1],</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                m_inpoel[mark+2], m_inpoel[mark+3] }};</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="comment">// associate tet id adjacent to boundary face to boundary face, at this</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="comment">// point we fill in -1 for the side set id, since we don&#39;t know it yet</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keyword">auto</span> i = invtets.find( t );</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( i != end(invtets), <span class="stringliteral">&quot;Tet not found in AMR object&quot;</span> );</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        bnd[ b ] = { -1, i-&gt;second };</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      }</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    }</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  }</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="comment">// Assign side set ids to faces on the physical boundary only. Note that</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="comment">// m_bface may be empty and that is okay, in that case bnd will contain data</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="comment">// on both chare as well as physical boundaries and the side set id in the map</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="comment">// value will stay at -1.</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; ss : <a class="code" href="classinciter_1_1_refiner.html#a38dadaef73bf3db0af0fdaeadf87408c">m_bface</a>)  <span class="comment">// for all phsyical boundaries (sidesets)</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : ss.second) {    <span class="comment">// for all faces on this physical boundary</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      Face t{{ <a class="code" href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">m_triinpoel</a>[f*3+0], <a class="code" href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">m_triinpoel</a>[f*3+1], m_triinpoel[f*3+2] }};</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keyword">auto</span> cf = bnd.find( t );</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="keywordflow">if</span> (cf != end(bnd)) cf-&gt;second.first = ss.first;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="comment">// Remove chare-boundary faces (to which the above loop did not assign set</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="comment">// id), but only if the above loop was run, i.e., if m_bface was not empty.</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="comment">// This results in removing the chare-boundary faces keeping only the physical</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">// boundary faces (and their associated side set id and tet id).</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">if</span> (!m_bface.empty()) {</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keyword">auto</span> bndcopy = bnd;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; f : bndcopy) <span class="keywordflow">if</span> (f.second.first == -1) bnd.erase( f.first );</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  }</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordflow">return</span> bnd;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;}</div><div class="ttc" id="classtk_1_1_uns_mesh_html_ae8262763c870433021affc6bb5a0f804"><div class="ttname"><a href="classtk_1_1_uns_mesh.html#ae8262763c870433021affc6bb5a0f804">tk::UnsMesh::Face</a></div><div class="ttdeci">std::array&lt; std::size_t, 3 &gt; Face</div><div class="ttdoc">Face: node IDs of a triangle (tetrahedron face) </div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00056">UnsMesh.h:56</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a38dadaef73bf3db0af0fdaeadf87408c"><div class="ttname"><a href="classinciter_1_1_refiner.html#a38dadaef73bf3db0af0fdaeadf87408c">inciter::Refiner::m_bface</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_bface</div><div class="ttdoc">List of boundary faces associated to side-set IDs. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00151">Refiner.h:151</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a6bc91e28516a27aea998ae384715707f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">inciter::Refiner::m_inpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_inpoel</div><div class="ttdoc">Alias to element connectivity with local node IDs in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00140">Refiner.h:140</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_abe95236aea1ef5fb585930650e829015"><div class="ttname"><a href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">inciter::Refiner::m_triinpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; m_triinpoel</div><div class="ttdoc">Boundary face-node connectivity. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00153">Refiner.h:153</a></div></div>
<div class="ttc" id="namespacetk_html_a30ac7c57927d6134e6563817f5d005a0"><div class="ttname"><a href="namespacetk.html#a30ac7c57927d6134e6563817f5d005a0">tk::lpofa</a></div><div class="ttdeci">const std::array&lt; std::array&lt; std::size_t, 3 &gt;, 4 &gt; lpofa</div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8h_source.html#l00033">DerivedData.h:33</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ae736705da5f6217e06153112e2038b2e"><div class="ttname"><a href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">inciter::Refiner::m_ginpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; m_ginpoel</div><div class="ttdoc">Tetrtahedron element connectivity of our chunk of the mesh (global ids) </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00131">Refiner.h:131</a></div></div>
<div class="ttc" id="structtk_1_1_uns_mesh_1_1_eq_html"><div class="ttname"><a href="structtk_1_1_uns_mesh_1_1_eq.html">tk::UnsMesh::Eq</a></div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00084">UnsMesh.h:84</a></div></div>
<div class="ttc" id="class_a_m_r_1_1tet__store__t_html_a1908d4c25a05f43fbf5902df9649b913"><div class="ttname"><a href="class_a_m_r_1_1tet__store__t.html#a1908d4c25a05f43fbf5902df9649b913">AMR::tet_store_t::tets</a></div><div class="ttdeci">tet_list_t tets</div><div class="ttdef"><b>Definition:</b> <a href="tet__store_8h_source.html#l00041">tet_store.h:41</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a3a8ba2c58baf8faa11dfb175967e7b2b"><div class="ttname"><a href="classinciter_1_1_refiner.html#a3a8ba2c58baf8faa11dfb175967e7b2b">inciter::Refiner::BndFaces</a></div><div class="ttdeci">std::unordered_map&lt; tk::UnsMesh::Face, std::pair&lt; int, std::size_t &gt;, tk::UnsMesh::Hash&lt; 3 &gt;, tk::UnsMesh::Eq&lt; 3 &gt; &gt; BndFaces</div><div class="ttdoc">Used to associate a pair of side set id and adjacent tet id to a boundary triangle face...</div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00111">Refiner.h:111</a></div></div>
<div class="ttc" id="namespacetk_html_a5b61b3cb6492e71ff9853404440fddcc"><div class="ttname"><a href="namespacetk.html#a5b61b3cb6492e71ff9853404440fddcc">tk::genEsuelTet</a></div><div class="ttdeci">std::vector&lt; int &gt; genEsuelTet(const std::vector&lt; std::size_t &gt; &amp;inpoel, const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;esup)</div><div class="ttdoc">Generate derived data structure, elements surrounding elements as a fixed length data structure as a ...</div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00934">DerivedData.C:934</a></div></div>
<div class="ttc" id="classtk_1_1_uns_mesh_html_abc1a507e27f21d7c588e3ea8bcd76602"><div class="ttname"><a href="classtk_1_1_uns_mesh.html#abc1a507e27f21d7c588e3ea8bcd76602">tk::UnsMesh::Tet</a></div><div class="ttdeci">std::array&lt; std::size_t, 4 &gt; Tet</div><div class="ttdoc">Tet: node IDs of a tetrahedron. </div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00058">UnsMesh.h:58</a></div></div>
<div class="ttc" id="namespacetk_html_a66a2889d5d8aeb4a836842c6a1010463"><div class="ttname"><a href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; genEsup(const std::vector&lt; std::size_t &gt; &amp;inpoel, std::size_t nnpe)</div><div class="ttdoc">Generate derived data structure, elements surrounding points. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00042">DerivedData.C:42</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a7e85879e386e8df4dc9b3291bd64eb70"><div class="ttname"><a href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">inciter::Refiner::m_refiner</a></div><div class="ttdeci">AMR::mesh_adapter_t m_refiner</div><div class="ttdoc">Mesh refiner (library) object. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00161">Refiner.h:161</a></div></div>
<div class="ttc" id="structtk_1_1_uns_mesh_1_1_hash_html"><div class="ttname"><a href="structtk_1_1_uns_mesh_1_1_hash.html">tk::UnsMesh::Hash</a></div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00065">UnsMesh.h:65</a></div></div>
<div class="ttc" id="class_a_m_r_1_1mesh__adapter__t_html_a42b0c354d6edd7b772c1844beb1c2f9a"><div class="ttname"><a href="class_a_m_r_1_1mesh__adapter__t.html#a42b0c354d6edd7b772c1844beb1c2f9a">AMR::mesh_adapter_t::tet_store</a></div><div class="ttdeci">AMR::tet_store_t tet_store</div><div class="ttdef"><b>Definition:</b> <a href="mesh__adapter_8h_source.html#l00039">mesh_adapter.h:39</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_ac8448c88661a15ab79792dc9a43c53c6_cgraph.svg" width="483" height="84"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a3d7830e14265ab1005c50f0ca54780d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d7830e14265ab1005c50f0ca54780d6">&#9670;&nbsp;</a></span>comExtra()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::comExtra </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Communicate refined edges after a refinement step. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00268">268</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_container_util_8h_source.html#l00051">tk::cref_find()</a>, <a class="el" href="_refiner_8h_source.html#l00174">m_bndEdges</a>, <a class="el" href="_refiner_8h_source.html#l00127">m_cbr</a>, <a class="el" href="_refiner_8h_source.html#l00167">m_ch</a>, <a class="el" href="_refiner_8h_source.html#l00169">m_edgenode</a>, <a class="el" href="_refiner_8h_source.html#l00165">m_extra</a>, and <a class="el" href="_refiner_8h_source.html#l00163">m_nref</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00331">correctref()</a>, and <a class="el" href="_refiner_8_c_source.html#l00215">refine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;{</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// Export added nodes on our mesh chunk boundary to other chares (in serial)</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">m_ch</a>.empty())</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    contribute( <span class="keyword">sizeof</span>(std::size_t), &amp;<a class="code" href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">m_extra</a>, CkReduction::max_ulong,</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <a class="code" href="classinciter_1_1_refiner.html#a8e89a122b60e779413d13f4ed35a40c9">m_cbr</a>.get&lt; <a class="code" href="structtag_1_1matched.html">tag::matched</a> &gt;() );</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="classinciter_1_1_refiner.html#abcdd64821992ed351c4da0dcb5ef5989">m_nref</a> = 0;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : <a class="code" href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">m_ch</a>) {       <span class="comment">// for all chars we share at least an edge with</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="comment">// For all boundary edges of chare c, find out if we have added a new</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="comment">// node to it, and if so, export parents-&gt;(newid,coords) to c.</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <a class="code" href="classtk_1_1_uns_mesh.html#a4c8d0c917a9349f675ca2d3259b69193">tk::UnsMesh::EdgeNodeCoord</a> exp;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e : <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>(<a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>,c)) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keyword">auto</span> i = <a class="code" href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">m_edgenode</a>.find(e);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">if</span> (i != end(<a class="code" href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">m_edgenode</a>)) exp[ e ] = i-&gt;second;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      thisProxy[ c ].addRefBndEdges( thisIndex, exp );</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_aae71fe355232fbbe89ccb90cb63a0ee5"><div class="ttname"><a href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">inciter::Refiner::m_extra</a></div><div class="ttdeci">std::size_t m_extra</div><div class="ttdoc">Number of chare-boundary newly added nodes that need correction. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00165">Refiner.h:165</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a5af0df1e55bc32f0cdfd29f72d427f43"><div class="ttname"><a href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">inciter::Refiner::m_edgenode</a></div><div class="ttdeci">tk::UnsMesh::EdgeNodeCoord m_edgenode</div><div class="ttdoc">Map associating global IDs and coordinates of a node added to an edge. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00169">Refiner.h:169</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_abcdd64821992ed351c4da0dcb5ef5989"><div class="ttname"><a href="classinciter_1_1_refiner.html#abcdd64821992ed351c4da0dcb5ef5989">inciter::Refiner::m_nref</a></div><div class="ttdeci">std::size_t m_nref</div><div class="ttdoc">Counter during distribution of newly added nodes to chare-boundary edges. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00163">Refiner.h:163</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ad9d96d8d83e5525268168cbc84d79396"><div class="ttname"><a href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">inciter::Refiner::m_bndEdges</a></div><div class="ttdeci">std::unordered_map&lt; int, EdgeSet &gt; m_bndEdges</div><div class="ttdoc">Boundary edges associated to chares we share these edges with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00174">Refiner.h:174</a></div></div>
<div class="ttc" id="namespacetk_html_a2e002561a68875b091a264eb2a1e5f6c"><div class="ttname"><a href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a></div><div class="ttdeci">auto cref_find(const Container &amp;map, const typename Container::key_type &amp;key) -&gt; const typename Container::mapped_type &amp;</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00051">ContainerUtil.h:51</a></div></div>
<div class="ttc" id="classtk_1_1_uns_mesh_html_a4c8d0c917a9349f675ca2d3259b69193"><div class="ttname"><a href="classtk_1_1_uns_mesh.html#a4c8d0c917a9349f675ca2d3259b69193">tk::UnsMesh::EdgeNodeCoord</a></div><div class="ttdeci">std::unordered_map&lt; Edge, std::tuple&lt; std::size_t, real, real, real &gt;, Hash&lt; 2 &gt;, Eq&lt; 2 &gt; &gt; EdgeNodeCoord</div><div class="ttdoc">Map associating the ID and the coordinates of a node to an edge. </div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00106">UnsMesh.h:106</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8e89a122b60e779413d13f4ed35a40c9"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8e89a122b60e779413d13f4ed35a40c9">inciter::Refiner::m_cbr</a></div><div class="ttdeci">tk::RefinerCallback m_cbr</div><div class="ttdoc">Charm++ callbacks associated to compile-time tags for refiner. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00127">Refiner.h:127</a></div></div>
<div class="ttc" id="structtag_1_1matched_html"><div class="ttname"><a href="structtag_1_1matched.html">tag::matched</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00089">Tags.h:89</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8b6f78d266458831a12a9e53a609ce72"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">inciter::Refiner::m_ch</a></div><div class="ttdeci">std::unordered_set&lt; int &gt; m_ch</div><div class="ttdoc">Chares we share at least a single edge with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00167">Refiner.h:167</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a3d7830e14265ab1005c50f0ca54780d6_cgraph.svg" width="334" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="acfae691fb62d1e756bd28d41df057d02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfae691fb62d1e756bd28d41df057d02">&#9670;&nbsp;</a></span>correctref()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::correctref </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Correct refinement to arrive at conforming mesh across chare boundaries. </p>
<p>This function is called repeatedly until there is not a a single edge that needs correction for the whole distributed problem to arrive at a conforming mesh across chare boundaries during this initial mesh refinement step. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00331">331</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_refiner_8_c_source.html#l00268">comExtra()</a>, <a class="el" href="_refiner_8_c_source.html#l00614">correctRefine()</a>, <a class="el" href="_container_util_8h_source.html#l00051">tk::cref_find()</a>, <a class="el" href="_refiner_8h_source.html#l00174">m_bndEdges</a>, <a class="el" href="_refiner_8h_source.html#l00169">m_edgenode</a>, <a class="el" href="_refiner_8h_source.html#l00172">m_edgenodeCh</a>, <a class="el" href="_refiner_8h_source.html#l00165">m_extra</a>, and <a class="el" href="_refiner_8h_source.html#l00145">m_lid</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;{</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">// Storage for edges that still need a new node to yield a conforming mesh</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="classtk_1_1_uns_mesh.html#a564c87d50c1611fff1c6d045bc07a3b4">tk::UnsMesh::EdgeSet</a> extra;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">// Ensure that the same global node ID has been assigned by all chares and</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment">// that the new nodes have the same coordinates generated by potentially</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">// multiple chares sharing the refined edge. This is done by searching for all</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">// edges that we share with and refined by other chares: (1) If the incoming</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">// edge is found among our refined ones, we ensure the newly assigned global</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="comment">// IDs equal (independently assigned by multiple chares, this is also a test</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">// on the quality of the hash algorithm) and also verify that the new node</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">// coordinates equal to machine precision. (2) If the incoming edge is not</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">// found among our refined ones, we need to correct the mesh to make it</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// conforming since the edge has been refined by the remote chare. We collect</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// these extra edges, and run a correction refinement, whose result then needs</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// to be communicated again as the new refinement step may introduce new edges</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="comment">// that other chares did not yet refine but are shared.</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; c : <a class="code" href="classinciter_1_1_refiner.html#a8a296faa4bf9d5353b93a3184d24d25e">m_edgenodeCh</a>)       <span class="comment">// for all chares we share edges with</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e : c.second) {       <span class="comment">// for all refined edges on c.first</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keyword">auto</span> i = <a class="code" href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">m_edgenode</a>.find( e.first ); <span class="comment">// find refined edge given parents</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">if</span> (i != end(<a class="code" href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">m_edgenode</a>)) {          <span class="comment">// found same added node on edge</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="comment">// locally assigned added node ID and coordinates: i-&gt;second</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">// remotely assigned added node ID and coordinates: e.second</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">// Ensure global IDs of newly added nodes are the same</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( std::get&lt; 0 &gt;( i-&gt;second ) == std::get&lt; 0 &gt;( e.second ),</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="stringliteral">&quot;Remotely and locally assigned global ids mismatch&quot;</span> );</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="comment">// Ensure coordinates are the same</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( std::abs( std::get&lt;1&gt;(i-&gt;second) - std::get&lt;1&gt;(e.second) ) &lt;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                  std::numeric_limits&lt;tk::real&gt;::epsilon() &amp;&amp;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                std::abs( std::get&lt;2&gt;(i-&gt;second) - std::get&lt;2&gt;(e.second) ) &lt;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                  std::numeric_limits&lt;tk::real&gt;::epsilon() &amp;&amp;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                std::abs( std::get&lt;3&gt;(i-&gt;second) - std::get&lt;3&gt;(e.second) ) &lt;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                  std::numeric_limits&lt;tk::real&gt;::epsilon(),</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                <span class="stringliteral">&quot;Remote and local added node coordinates mismatch&quot;</span> );</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      } <span class="keywordflow">else</span> {  <span class="comment">// remote chare added node on edge but we did not</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="comment">// Make sure we know about this chare-boundary edge (we did not refine)</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>.find( thisIndex )-&gt;second.find( e.first ) !=</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                <a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>.find( thisIndex )-&gt;second.end(),</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                <span class="stringliteral">&quot;Local node IDs of boundary edge not found&quot;</span> );</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="comment">// Save edge (given by parent global node IDs) to which the remote chare</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">// has added a new node but we did not. Will need to correct the mesh so</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="comment">// it conforms across chare boundaries.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        extra.insert( {{ { <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>, e.first[0] ),</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                           <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>, e.first[1] ) } }} );</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// Store number of extra edges on this chare which this chare did not add but</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// was refined by another chare, so now we need to tag and refine them and</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// propagate reconnection of neighbor cells to arrive at conforming mesh</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">// across chare boundaries.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">m_extra</a> = extra.size();</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// Refine mesh triggered by nodes added on chare-boundary by other chares</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a01dea6b9aece262ef9bbe7016e64fdb5">correctRefine</a>( extra );</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">// Communicate extra edges. Since refining edges that we did not but other</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// chares did may result in refining new edges that may also be shared along</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">// chare boundaries, we now need to communicate these edges and potentially</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// repeat the correction step. This must happen until all chares that share</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// edges can agree that there are no more edges to correct (in which case the</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// above loop finds no extra edges). Only then can this refinement step be</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// considered complete.</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a3d7830e14265ab1005c50f0ca54780d6">comExtra</a>();</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_aae71fe355232fbbe89ccb90cb63a0ee5"><div class="ttname"><a href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">inciter::Refiner::m_extra</a></div><div class="ttdeci">std::size_t m_extra</div><div class="ttdoc">Number of chare-boundary newly added nodes that need correction. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00165">Refiner.h:165</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a5af0df1e55bc32f0cdfd29f72d427f43"><div class="ttname"><a href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">inciter::Refiner::m_edgenode</a></div><div class="ttdeci">tk::UnsMesh::EdgeNodeCoord m_edgenode</div><div class="ttdoc">Map associating global IDs and coordinates of a node added to an edge. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00169">Refiner.h:169</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a972fbff38d8e36f96be02b7e0a092472"><div class="ttname"><a href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">inciter::Refiner::m_lid</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::size_t &gt; &amp; m_lid</div><div class="ttdoc">Alias to local node IDs associated to the global ones of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00145">Refiner.h:145</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ad9d96d8d83e5525268168cbc84d79396"><div class="ttname"><a href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">inciter::Refiner::m_bndEdges</a></div><div class="ttdeci">std::unordered_map&lt; int, EdgeSet &gt; m_bndEdges</div><div class="ttdoc">Boundary edges associated to chares we share these edges with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00174">Refiner.h:174</a></div></div>
<div class="ttc" id="namespacetk_html_a2e002561a68875b091a264eb2a1e5f6c"><div class="ttname"><a href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a></div><div class="ttdeci">auto cref_find(const Container &amp;map, const typename Container::key_type &amp;key) -&gt; const typename Container::mapped_type &amp;</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00051">ContainerUtil.h:51</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a3d7830e14265ab1005c50f0ca54780d6"><div class="ttname"><a href="classinciter_1_1_refiner.html#a3d7830e14265ab1005c50f0ca54780d6">inciter::Refiner::comExtra</a></div><div class="ttdeci">void comExtra()</div><div class="ttdoc">Communicate refined edges after a refinement step. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00268">Refiner.C:268</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a01dea6b9aece262ef9bbe7016e64fdb5"><div class="ttname"><a href="classinciter_1_1_refiner.html#a01dea6b9aece262ef9bbe7016e64fdb5">inciter::Refiner::correctRefine</a></div><div class="ttdeci">void correctRefine(const EdgeSet &amp;extra)</div><div class="ttdoc">Do mesh refinement correcting PE-boundary edges. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00614">Refiner.C:614</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8a296faa4bf9d5353b93a3184d24d25e"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8a296faa4bf9d5353b93a3184d24d25e">inciter::Refiner::m_edgenodeCh</a></div><div class="ttdeci">std::unordered_map&lt; int, tk::UnsMesh::EdgeNodeCoord &gt; m_edgenodeCh</div><div class="ttdoc">Map associating global IDs and coordinates of a node added to an edge associated to another chare the...</div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00172">Refiner.h:172</a></div></div>
<div class="ttc" id="classtk_1_1_uns_mesh_html_a564c87d50c1611fff1c6d045bc07a3b4"><div class="ttname"><a href="classtk_1_1_uns_mesh.html#a564c87d50c1611fff1c6d045bc07a3b4">tk::UnsMesh::EdgeSet</a></div><div class="ttdeci">std::unordered_set&lt; Edge, Hash&lt; 2 &gt;, Eq&lt; 2 &gt; &gt; EdgeSet</div><div class="ttdoc">Unique set of edges. </div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00109">UnsMesh.h:109</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_acfae691fb62d1e756bd28d41df057d02_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a01dea6b9aece262ef9bbe7016e64fdb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01dea6b9aece262ef9bbe7016e64fdb5">&#9670;&nbsp;</a></span>correctRefine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::correctRefine </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classinciter_1_1_refiner.html#acc6b81c6f3ad0831d0f64739528fb212">EdgeSet</a> &amp;&#160;</td>
          <td class="paramname"><em>extra</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Do mesh refinement correcting PE-boundary edges. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">extra</td><td>Unique edges that need a new node on chare boundaries </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00614">614</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__adapter_8_c_source.html#l00060">AMR::mesh_adapter_t::error_refinement()</a>, <a class="el" href="_refiner_8h_source.html#l00161">m_refiner</a>, and <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00331">correctref()</a>.</p>
<div class="fragment"><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;{</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordflow">if</span> (!extra.empty()) {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">// Generate list of edges that need to be corrected</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    std::vector&lt; edge_t &gt; edge;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e : extra) edge.push_back( <a class="code" href="classedge__t.html">edge_t</a>(e[0],e[1]) );</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    std::vector&lt; real_t &gt; crit( edge.size(), 1.0 );</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">// Do refinement including edges that need to be corrected</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#aabf36773aecfd2a3de859e1ca1e9ecb0">error_refinement</a>( edge, crit );</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">// Update mesh coordinates and connectivity</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="classinciter_1_1_refiner.html#a2aa26e2c8cf1618a0452b8803c53637f">updateMesh</a>();</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;}</div><div class="ttc" id="classedge__t_html"><div class="ttname"><a href="classedge__t.html">edge_t</a></div><div class="ttdef"><b>Definition:</b> <a href="edge_8h_source.html#l00008">edge.h:8</a></div></div>
<div class="ttc" id="class_a_m_r_1_1mesh__adapter__t_html_aabf36773aecfd2a3de859e1ca1e9ecb0"><div class="ttname"><a href="class_a_m_r_1_1mesh__adapter__t.html#aabf36773aecfd2a3de859e1ca1e9ecb0">AMR::mesh_adapter_t::error_refinement</a></div><div class="ttdeci">void error_refinement(const std::vector&lt; edge_t &gt; &amp;edge, const std::vector&lt; real_t &gt; &amp;criteria)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__adapter_8_c_source.html#l00060">mesh_adapter.C:60</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a2aa26e2c8cf1618a0452b8803c53637f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a2aa26e2c8cf1618a0452b8803c53637f">inciter::Refiner::updateMesh</a></div><div class="ttdeci">void updateMesh()</div><div class="ttdoc">Update mesh after refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00635">Refiner.C:635</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a7e85879e386e8df4dc9b3291bd64eb70"><div class="ttname"><a href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">inciter::Refiner::m_refiner</a></div><div class="ttdeci">AMR::mesh_adapter_t m_refiner</div><div class="ttdoc">Mesh refiner (library) object. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00161">Refiner.h:161</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a01dea6b9aece262ef9bbe7016e64fdb5_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ac1d8849088a3862e2ccc7e34d65abe8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1d8849088a3862e2ccc7e34d65abe8f">&#9670;&nbsp;</a></span>errorRefine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::errorRefine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Do error-based mesh refinement. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00465">465</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="mesh__adapter_8_c_source.html#l00060">AMR::mesh_adapter_t::error_refinement()</a>, <a class="el" href="_d_g_8_c_source.html#l00028">inciter::g_inputdeck</a>, <a class="el" href="_derived_data_8_c_source.html#l00042">tk::genEsup()</a>, <a class="el" href="_derived_data_8_c_source.html#l00125">tk::genPsup()</a>, <a class="el" href="_control_8h_source.html#l00046">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_refiner_8h_source.html#l00149">m_coord</a>, <a class="el" href="_refiner_8h_source.html#l00165">m_extra</a>, <a class="el" href="_refiner_8h_source.html#l00140">m_inpoel</a>, <a class="el" href="_refiner_8h_source.html#l00161">m_refiner</a>, <a class="el" href="_refiner_8_c_source.html#l00560">nodeinit()</a>, <a class="el" href="_derived_data_8_c_source.html#l00029">tk::npoin()</a>, <a class="el" href="_error_8_c_source.html#l00022">AMR::Error::scalar()</a>, and <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00215">refine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;{</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// Find number of nodes in old mesh</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a> = <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">tk::npoin</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a> );</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// Generate edges surrounding points in old mesh</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keyword">auto</span> esup = <a class="code" href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, 4 );</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keyword">auto</span> psup = <a class="code" href="namespacetk.html#ad2a88a65102c17149b44660db15d445b">tk::genPsup</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, 4, esup );</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">// Evaluate initial conditions at mesh nodes</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keyword">auto</span> u = <a class="code" href="classinciter_1_1_refiner.html#a0ab2e81a0ce5e194be775b10ef1191ec">nodeinit</a>( <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a>, esup );</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="comment">// Get the indices (in the system of systems) of refinement variables and the</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">// error indicator configured</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; refidx = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="namespaceinciter_1_1ctr.html#ad8d2ef07f96dd9f967f9ad580ad28051">tag::amr</a>, <a class="code" href="structtag_1_1id.html">tag::id</a> &gt;();</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keyword">auto</span> errtype = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="namespaceinciter_1_1ctr.html#ad8d2ef07f96dd9f967f9ad580ad28051">tag::amr</a>, <a class="code" href="structtag_1_1error.html">tag::error</a> &gt;();</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// Compute errors in ICs and define refinement criteria for edges</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  std::vector&lt; edge_t &gt; edge;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  std::vector&lt; real_t &gt; crit;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <a class="code" href="class_a_m_r_1_1_error.html">AMR::Error</a> error;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">for</span> (std::size_t p=0; p&lt;<a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a>; ++p)   <span class="comment">// for all mesh nodes on this chare</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> q : <a class="code" href="classtk_1_1_around.html">tk::Around</a>(psup,p)) { <span class="comment">// for all nodes surrounding p</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;       <a class="code" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> cmax = 0.0;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;       <a class="code" href="classedge__t.html">edge_t</a> e(p,q);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;       <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : refidx) {          <span class="comment">// for all refinement variables</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;         <span class="keyword">auto</span> c = error.<a class="code" href="class_a_m_r_1_1_error.html#a7049cc5aaf2363427d8d428bad9d5216">scalar</a>( u, e, i, <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a>, <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, esup, errtype );</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;         <span class="keywordflow">if</span> (c &gt; cmax) cmax = c;        <span class="comment">// find max error at edge</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;       }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;       <span class="keywordflow">if</span> (cmax &gt; 0.0) {         <span class="comment">// if nonzero error, will pass edge to refiner</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;         edge.push_back( e );</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;         crit.push_back( cmax );</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;       }</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;     }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( edge.size() == crit.size(), <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// Do error-based refinement</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#aabf36773aecfd2a3de859e1ca1e9ecb0">error_refinement</a>( edge, crit );</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">// Update mesh coordinates and connectivity</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a2aa26e2c8cf1618a0452b8803c53637f">updateMesh</a>();</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="comment">// Set number of extra edges to a nonzero number, triggering correction</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">m_extra</a> = 1;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div><div class="ttc" id="class_a_m_r_1_1_error_html"><div class="ttname"><a href="class_a_m_r_1_1_error.html">AMR::Error</a></div><div class="ttdoc">Class for computing error estimates for mesh refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_inciter_2_a_m_r_2_error_8h_source.html#l00020">Error.h:20</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_aae71fe355232fbbe89ccb90cb63a0ee5"><div class="ttname"><a href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">inciter::Refiner::m_extra</a></div><div class="ttdeci">std::size_t m_extra</div><div class="ttdoc">Number of chare-boundary newly added nodes that need correction. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00165">Refiner.h:165</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a6bc91e28516a27aea998ae384715707f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">inciter::Refiner::m_inpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_inpoel</div><div class="ttdoc">Alias to element connectivity with local node IDs in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00140">Refiner.h:140</a></div></div>
<div class="ttc" id="classedge__t_html"><div class="ttname"><a href="classedge__t.html">edge_t</a></div><div class="ttdef"><b>Definition:</b> <a href="edge_8h_source.html#l00008">edge.h:8</a></div></div>
<div class="ttc" id="structtag_1_1error_html"><div class="ttname"><a href="structtag_1_1error.html">tag::error</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00035">Tags.h:35</a></div></div>
<div class="ttc" id="classtk_1_1_around_html"><div class="ttname"><a href="classtk_1_1_around.html">tk::Around</a></div><div class="ttdoc">Helper class simplifying client code for iterating on entries surrounding entries via linked lists de...</div><div class="ttdef"><b>Definition:</b> <a href="_around_8h_source.html#l00027">Around.h:27</a></div></div>
<div class="ttc" id="namespacetk_html_ad2a88a65102c17149b44660db15d445b"><div class="ttname"><a href="namespacetk.html#ad2a88a65102c17149b44660db15d445b">tk::genPsup</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; genPsup(const std::vector&lt; std::size_t &gt; &amp;inpoel, std::size_t nnpe, const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;esup)</div><div class="ttdoc">Generate derived data structure, points surrounding points. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00125">DerivedData.C:125</a></div></div>
<div class="ttc" id="class_a_m_r_1_1_error_html_a7049cc5aaf2363427d8d428bad9d5216"><div class="ttname"><a href="class_a_m_r_1_1_error.html#a7049cc5aaf2363427d8d428bad9d5216">AMR::Error::scalar</a></div><div class="ttdeci">tk::real scalar(const tk::Fields &amp;u, const edge_t &amp;edge, ncomp_t c, const std::array&lt; std::vector&lt; tk::real &gt;, 3 &gt; &amp;coord, const std::vector&lt; std::size_t &gt; &amp;inpoel, const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;esup, inciter::ctr::AMRErrorType err) const</div><div class="ttdoc">Compute error estimate for a scalar quantity. </div><div class="ttdef"><b>Definition:</b> <a href="_error_8_c_source.html#l00022">Error.C:22</a></div></div>
<div class="ttc" id="class_a_m_r_1_1mesh__adapter__t_html_aabf36773aecfd2a3de859e1ca1e9ecb0"><div class="ttname"><a href="class_a_m_r_1_1mesh__adapter__t.html#aabf36773aecfd2a3de859e1ca1e9ecb0">AMR::mesh_adapter_t::error_refinement</a></div><div class="ttdeci">void error_refinement(const std::vector&lt; edge_t &gt; &amp;edge, const std::vector&lt; real_t &gt; &amp;criteria)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__adapter_8_c_source.html#l00060">mesh_adapter.C:60</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a2aa26e2c8cf1618a0452b8803c53637f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a2aa26e2c8cf1618a0452b8803c53637f">inciter::Refiner::updateMesh</a></div><div class="ttdeci">void updateMesh()</div><div class="ttdoc">Update mesh after refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00635">Refiner.C:635</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a0ab2e81a0ce5e194be775b10ef1191ec"><div class="ttname"><a href="classinciter_1_1_refiner.html#a0ab2e81a0ce5e194be775b10ef1191ec">inciter::Refiner::nodeinit</a></div><div class="ttdeci">tk::Fields nodeinit(std::size_t npoin, const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;esup)</div><div class="ttdoc">Evaluate initial conditions (IC) at mesh nodes. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00560">Refiner.C:560</a></div></div>
<div class="ttc" id="structtag_1_1id_html"><div class="ttname"><a href="structtag_1_1id.html">tag::id</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00175">Tags.h:175</a></div></div>
<div class="ttc" id="namespacetk_html_abdd71f3e10edf6e1a8d047478abd488c"><div class="ttname"><a href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">tk::npoin</a></div><div class="ttdeci">std::size_t npoin(const std::vector&lt; std::size_t &gt; &amp;inpoel)</div><div class="ttdoc">Compute number of points (nodes) in mesh from connectivity. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00029">DerivedData.C:29</a></div></div>
<div class="ttc" id="namespacetk_html_a66a2889d5d8aeb4a836842c6a1010463"><div class="ttname"><a href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; genEsup(const std::vector&lt; std::size_t &gt; &amp;inpoel, std::size_t nnpe)</div><div class="ttdoc">Generate derived data structure, elements surrounding points. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00042">DerivedData.C:42</a></div></div>
<div class="ttc" id="namespaceinciter_1_1ctr_html_ad8d2ef07f96dd9f967f9ad580ad28051"><div class="ttname"><a href="namespaceinciter_1_1ctr.html#ad8d2ef07f96dd9f967f9ad580ad28051">inciter::ctr::amr</a></div><div class="ttdeci">tk::tuple::tagged_tuple&lt; tag::amr, bool, tag::initamr, bool, tag::init, std::vector&lt; AMRInitialType &gt;, tag::refvar, std::vector&lt; std::string &gt;, tag::id, std::vector&lt; std::size_t &gt;, tag::error, AMRErrorType, tag::edge, std::vector&lt; kw::amr_initref::info::expect::type &gt; &gt; amr</div><div class="ttdoc">Adaptive-mesh refinement options. </div><div class="ttdef"><b>Definition:</b> <a href="_control_2_inciter_2_types_8h_source.html#l00052">Types.h:52</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00046">Control.h:46</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a7e85879e386e8df4dc9b3291bd64eb70"><div class="ttname"><a href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">inciter::Refiner::m_refiner</a></div><div class="ttdeci">AMR::mesh_adapter_t m_refiner</div><div class="ttdoc">Mesh refiner (library) object. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00161">Refiner.h:161</a></div></div>
<div class="ttc" id="namespacetk_html_a1a96ada94b7e2911ecca0a360f305575"><div class="ttname"><a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a></div><div class="ttdeci">double real</div><div class="ttdoc">Real number type used throughout the whole code. </div><div class="ttdef"><b>Definition:</b> <a href="_base_2_types_8h_source.html#l00016">Types.h:16</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_aec812331b2bc9bfc51ed8c48906204fe"><div class="ttname"><a href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">inciter::Refiner::m_coord</a></div><div class="ttdeci">tk::UnsMesh::Coords m_coord</div><div class="ttdoc">Coordinates of mesh nodes of our chunk of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00149">Refiner.h:149</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_d_g_8_c_source.html#l00028">DG.C:28</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_ac1d8849088a3862e2ccc7e34d65abe8f_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a3a8dfd310ca8fa2e9eee5f8e2d130b78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a8dfd310ca8fa2e9eee5f8e2d130b78">&#9670;&nbsp;</a></span>finish()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::finish </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finish initiel mesh refinement. </p>
<p>This function is called as after initial mesh refinement has finished. If initial mesh reifnement was not configured by the user, this is the point where we continue after the constructor, by computing the total number of elements across the whole problem. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00429">429</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_refiner_8h_source.html#l00151">m_bface</a>, <a class="el" href="_refiner_8h_source.html#l00155">m_bnode</a>, <a class="el" href="_refiner_8h_source.html#l00127">m_cbr</a>, <a class="el" href="_refiner_8h_source.html#l00129">m_cbs</a>, <a class="el" href="_refiner_8h_source.html#l00149">m_coord</a>, <a class="el" href="_refiner_8h_source.html#l00147">m_coordmap</a>, <a class="el" href="_refiner_8h_source.html#l00131">m_ginpoel</a>, <a class="el" href="_refiner_8h_source.html#l00119">m_host</a>, <a class="el" href="_refiner_8h_source.html#l00157">m_nchare</a>, <a class="el" href="_refiner_8h_source.html#l00125">m_scheme</a>, <a class="el" href="_refiner_8h_source.html#l00123">m_solver</a>, <a class="el" href="_refiner_8h_source.html#l00121">m_sorter</a>, and <a class="el" href="_refiner_8h_source.html#l00153">m_triinpoel</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00406">nextref()</a>, and <a class="el" href="_refiner_8_c_source.html#l00038">Refiner()</a>.</p>
<div class="fragment"><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;{</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// create sorter Charm++ chare array elements using dynamic insertion</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a1985a5a79a3178b5c50a9d8112f1dd8a">m_sorter</a>[ thisIndex ].insert( <a class="code" href="classinciter_1_1_refiner.html#a6dcb67634aab36a227a6e0fec4011432">m_host</a>, <a class="code" href="classinciter_1_1_refiner.html#afee3e21d01face5a1bde8edf7746f8d2">m_solver</a>, <a class="code" href="classinciter_1_1_refiner.html#ab8750c25fab71f650dcfeae371fa87bf">m_cbs</a>, <a class="code" href="classinciter_1_1_refiner.html#a0cb785ca204645311f8c26ac6a93d9a3">m_scheme</a>, <a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">m_coordmap</a>, <a class="code" href="classinciter_1_1_refiner.html#a38dadaef73bf3db0af0fdaeadf87408c">m_bface</a>, <a class="code" href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">m_triinpoel</a>, <a class="code" href="classinciter_1_1_refiner.html#a8f752bc3a870aea2138683b778a9c6ee">m_bnode</a>, <a class="code" href="classinciter_1_1_refiner.html#a40aca114fe5c6c650c5a8ebbe1969421">m_nchare</a>, CkMyPe() );</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">// Compute final number of cells across whole problem</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  std::vector&lt; std::uint64_t &gt; mesh{ <a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>.size()/4, <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a>[0].size() };</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  contribute( mesh, CkReduction::sum_ulong, <a class="code" href="classinciter_1_1_refiner.html#a8e89a122b60e779413d13f4ed35a40c9">m_cbr</a>.get&lt; <a class="code" href="structtag_1_1refined.html">tag::refined</a> &gt;() );</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_a38dadaef73bf3db0af0fdaeadf87408c"><div class="ttname"><a href="classinciter_1_1_refiner.html#a38dadaef73bf3db0af0fdaeadf87408c">inciter::Refiner::m_bface</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_bface</div><div class="ttdoc">List of boundary faces associated to side-set IDs. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00151">Refiner.h:151</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_abe95236aea1ef5fb585930650e829015"><div class="ttname"><a href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">inciter::Refiner::m_triinpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; m_triinpoel</div><div class="ttdoc">Boundary face-node connectivity. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00153">Refiner.h:153</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a40aca114fe5c6c650c5a8ebbe1969421"><div class="ttname"><a href="classinciter_1_1_refiner.html#a40aca114fe5c6c650c5a8ebbe1969421">inciter::Refiner::m_nchare</a></div><div class="ttdeci">int m_nchare</div><div class="ttdoc">Total number of refiner chares. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00157">Refiner.h:157</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ae736705da5f6217e06153112e2038b2e"><div class="ttname"><a href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">inciter::Refiner::m_ginpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; m_ginpoel</div><div class="ttdoc">Tetrtahedron element connectivity of our chunk of the mesh (global ids) </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00131">Refiner.h:131</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a0cb785ca204645311f8c26ac6a93d9a3"><div class="ttname"><a href="classinciter_1_1_refiner.html#a0cb785ca204645311f8c26ac6a93d9a3">inciter::Refiner::m_scheme</a></div><div class="ttdeci">Scheme m_scheme</div><div class="ttdoc">Discretization scheme. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00125">Refiner.h:125</a></div></div>
<div class="ttc" id="structtag_1_1refined_html"><div class="ttname"><a href="structtag_1_1refined.html">tag::refined</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00088">Tags.h:88</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8e89a122b60e779413d13f4ed35a40c9"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8e89a122b60e779413d13f4ed35a40c9">inciter::Refiner::m_cbr</a></div><div class="ttdeci">tk::RefinerCallback m_cbr</div><div class="ttdoc">Charm++ callbacks associated to compile-time tags for refiner. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00127">Refiner.h:127</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_afee3e21d01face5a1bde8edf7746f8d2"><div class="ttname"><a href="classinciter_1_1_refiner.html#afee3e21d01face5a1bde8edf7746f8d2">inciter::Refiner::m_solver</a></div><div class="ttdeci">tk::CProxy_Solver m_solver</div><div class="ttdoc">Linear soilver proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00123">Refiner.h:123</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a1985a5a79a3178b5c50a9d8112f1dd8a"><div class="ttname"><a href="classinciter_1_1_refiner.html#a1985a5a79a3178b5c50a9d8112f1dd8a">inciter::Refiner::m_sorter</a></div><div class="ttdeci">CProxy_Sorter m_sorter</div><div class="ttdoc">Mesh sorter proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00121">Refiner.h:121</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a0dbe0d53033cee33b057f32f8a65ba58"><div class="ttname"><a href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">inciter::Refiner::m_coordmap</a></div><div class="ttdeci">tk::UnsMesh::CoordMap m_coordmap</div><div class="ttdoc">Coordinates associated to global node IDs of our mesh chunk. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00147">Refiner.h:147</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a6dcb67634aab36a227a6e0fec4011432"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6dcb67634aab36a227a6e0fec4011432">inciter::Refiner::m_host</a></div><div class="ttdeci">CProxy_Transporter m_host</div><div class="ttdoc">Host proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00119">Refiner.h:119</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ab8750c25fab71f650dcfeae371fa87bf"><div class="ttname"><a href="classinciter_1_1_refiner.html#ab8750c25fab71f650dcfeae371fa87bf">inciter::Refiner::m_cbs</a></div><div class="ttdeci">tk::SorterCallback m_cbs</div><div class="ttdoc">Charm++ callbacks associated to compile-time tags for sorter. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00129">Refiner.h:129</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8f752bc3a870aea2138683b778a9c6ee"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8f752bc3a870aea2138683b778a9c6ee">inciter::Refiner::m_bnode</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_bnode</div><div class="ttdoc">List of boundary nodes associated to side-set IDs. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00155">Refiner.h:155</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_aec812331b2bc9bfc51ed8c48906204fe"><div class="ttname"><a href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">inciter::Refiner::m_coord</a></div><div class="ttdeci">tk::UnsMesh::Coords m_coord</div><div class="ttdoc">Coordinates of mesh nodes of our chunk of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00149">Refiner.h:149</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a612f34f5b2817de0bf118e85c89c116e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a612f34f5b2817de0bf118e85c89c116e">&#9670;&nbsp;</a></span>flatcoord()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtk_1_1_uns_mesh.html#a2ed8d512b099636a98ba6b35b1118d6f">tk::UnsMesh::Coords</a> Refiner::flatcoord </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtk_1_1_uns_mesh.html#a4b2d1f8043c0354b11461c118a4379c5">tk::UnsMesh::CoordMap</a> &amp;&#160;</td>
          <td class="paramname"><em>coordmap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate flat coordinate data from coordinate map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coordmap</td><td>Coordinates associated to global node IDs of mesh chunk </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Flat coordinate data </dd></dl>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00108">108</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_container_util_8h_source.html#l00051">tk::cref_find()</a>, <a class="el" href="_refiner_8h_source.html#l00142">m_gid</a>, <a class="el" href="_refiner_8h_source.html#l00145">m_lid</a>, and <a class="el" href="_derived_data_8_c_source.html#l00029">tk::npoin()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;{</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="classtk_1_1_uns_mesh.html#a2ed8d512b099636a98ba6b35b1118d6f">tk::UnsMesh::Coords</a> coord;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">// Convert node coordinates associated to global node IDs to a flat vector</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a> = coordmap.size();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a>.size() == <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a>, <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  coord[0].resize( <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a> );</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  coord[1].resize( <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a> );</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  coord[2].resize( <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a> );</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; c : coordmap) {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">auto</span> i = <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>, c.first );</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( i &lt; <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a>, <span class="stringliteral">&quot;Indexing out of coordinate map&quot;</span> );</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    coord[0][i] = c.second[0];</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    coord[1][i] = c.second[1];</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    coord[2][i] = c.second[2];</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">return</span> coord;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div><div class="ttc" id="classtk_1_1_uns_mesh_html_a2ed8d512b099636a98ba6b35b1118d6f"><div class="ttname"><a href="classtk_1_1_uns_mesh.html#a2ed8d512b099636a98ba6b35b1118d6f">tk::UnsMesh::Coords</a></div><div class="ttdeci">std::array&lt; std::vector&lt; real &gt;, 3 &gt; Coords</div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00047">UnsMesh.h:47</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a972fbff38d8e36f96be02b7e0a092472"><div class="ttname"><a href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">inciter::Refiner::m_lid</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::size_t &gt; &amp; m_lid</div><div class="ttdoc">Alias to local node IDs associated to the global ones of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00145">Refiner.h:145</a></div></div>
<div class="ttc" id="namespacetk_html_a2e002561a68875b091a264eb2a1e5f6c"><div class="ttname"><a href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a></div><div class="ttdeci">auto cref_find(const Container &amp;map, const typename Container::key_type &amp;key) -&gt; const typename Container::mapped_type &amp;</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00051">ContainerUtil.h:51</a></div></div>
<div class="ttc" id="namespacetk_html_abdd71f3e10edf6e1a8d047478abd488c"><div class="ttname"><a href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">tk::npoin</a></div><div class="ttdeci">std::size_t npoin(const std::vector&lt; std::size_t &gt; &amp;inpoel)</div><div class="ttdoc">Compute number of points (nodes) in mesh from connectivity. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00029">DerivedData.C:29</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a5636a971bbf52996e933493fc6a5aa07"><div class="ttname"><a href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">inciter::Refiner::m_gid</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_gid</div><div class="ttdoc">Alias to global node IDs of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00142">Refiner.h:142</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a612f34f5b2817de0bf118e85c89c116e_cgraph.svg" width="331" height="84"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a408b67afd67926d139c8a9be1e90f54b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a408b67afd67926d139c8a9be1e90f54b">&#9670;&nbsp;</a></span>nextref()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::nextref </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decide wether to continue with another step of mesh refinement. </p>
<p>This concludes this mesh refinement step, and we continue if there are more steps configured by the user. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00406">406</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="namespacetk.html#aea4fb4c5b5f9f99675ec2f39d25a3482a294ce20cdefa29be3be0735cb62e715d">tk::CREATE</a>, <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>, <a class="el" href="_refiner_8h_source.html#l00149">m_coord</a>, <a class="el" href="_refiner_8h_source.html#l00159">m_initref</a>, <a class="el" href="_refiner_8h_source.html#l00140">m_inpoel</a>, <a class="el" href="_refiner_8_c_source.html#l00135">start()</a>, and <a class="el" href="_exodus_i_i_mesh_writer_8_c_source.html#l00075">tk::ExodusIIMeshWriter::writeMesh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;{</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">// Remove initial mesh refinement step from list</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">m_initref</a>.empty()) <a class="code" href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">m_initref</a>.pop_back();</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">m_initref</a>.empty())       <span class="comment">// Continue to next initial refinement step</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="classinciter_1_1_refiner.html#ac0cc6c7182e9d82f08fbb48183e98e56">start</a>();</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">else</span> {                        <span class="comment">// Finish mesh refinement</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// Output final mesh after initial mesh refinement</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="classtk_1_1_uns_mesh.html">tk::UnsMesh</a> refmesh( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a> );</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="classtk_1_1_exodus_i_i_mesh_writer.html">tk::ExodusIIMeshWriter</a> mw( <span class="stringliteral">&quot;initref.final.&quot;</span> + std::to_string(thisIndex),</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                               <a class="code" href="namespacetk.html#aea4fb4c5b5f9f99675ec2f39d25a3482a294ce20cdefa29be3be0735cb62e715d">tk::ExoWriter::CREATE</a> );</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    mw.writeMesh( refmesh );</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="classinciter_1_1_refiner.html#a3a8dfd310ca8fa2e9eee5f8e2d130b78">finish</a>();</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_a6bc91e28516a27aea998ae384715707f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">inciter::Refiner::m_inpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_inpoel</div><div class="ttdoc">Alias to element connectivity with local node IDs in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00140">Refiner.h:140</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a9db2d016c546a539f8213e9804ec65ff"><div class="ttname"><a href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">inciter::Refiner::m_initref</a></div><div class="ttdeci">std::vector&lt; ctr::AMRInitialType &gt; m_initref</div><div class="ttdoc">Initial mesh refinement type list (in reverse order) </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00159">Refiner.h:159</a></div></div>
<div class="ttc" id="classtk_1_1_uns_mesh_html"><div class="ttname"><a href="classtk_1_1_uns_mesh.html">tk::UnsMesh</a></div><div class="ttdoc">3D unstructured mesh class </div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00034">UnsMesh.h:34</a></div></div>
<div class="ttc" id="classtk_1_1_exodus_i_i_mesh_writer_html"><div class="ttname"><a href="classtk_1_1_exodus_i_i_mesh_writer.html">tk::ExodusIIMeshWriter</a></div><div class="ttdef"><b>Definition:</b> <a href="_exodus_i_i_mesh_writer_8h_source.html#l00029">ExodusIIMeshWriter.h:29</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ac0cc6c7182e9d82f08fbb48183e98e56"><div class="ttname"><a href="classinciter_1_1_refiner.html#ac0cc6c7182e9d82f08fbb48183e98e56">inciter::Refiner::start</a></div><div class="ttdeci">void start()</div><div class="ttdoc">Prepare for next step of mesh refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00135">Refiner.C:135</a></div></div>
<div class="ttc" id="namespacetk_html_aea4fb4c5b5f9f99675ec2f39d25a3482a294ce20cdefa29be3be0735cb62e715d"><div class="ttname"><a href="namespacetk.html#aea4fb4c5b5f9f99675ec2f39d25a3482a294ce20cdefa29be3be0735cb62e715d">tk::ExoWriter::CREATE</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a3a8dfd310ca8fa2e9eee5f8e2d130b78"><div class="ttname"><a href="classinciter_1_1_refiner.html#a3a8dfd310ca8fa2e9eee5f8e2d130b78">inciter::Refiner::finish</a></div><div class="ttdeci">void finish()</div><div class="ttdoc">Finish initiel mesh refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00429">Refiner.C:429</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_aec812331b2bc9bfc51ed8c48906204fe"><div class="ttname"><a href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">inciter::Refiner::m_coord</a></div><div class="ttdeci">tk::UnsMesh::Coords m_coord</div><div class="ttdoc">Coordinates of mesh nodes of our chunk of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00149">Refiner.h:149</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a408b67afd67926d139c8a9be1e90f54b_cgraph.svg" width="100%" height="551"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a0ab2e81a0ce5e194be775b10ef1191ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ab2e81a0ce5e194be775b10ef1191ec">&#9670;&nbsp;</a></span>nodeinit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tk::Fields Refiner::nodeinit </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>npoin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>esup</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate initial conditions (IC) at mesh nodes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">npoin</td><td>Number points in mesh (on this chare) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">esup</td><td>Elements surrounding points as linked lists, see <a class="el" href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463" title="Generate derived data structure, elements surrounding points. ">tk::genEsup</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Initial conditions (evaluated at t0) at nodes </dd></dl>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00560">560</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="namespaceinciter_1_1ctr.html#aba4e861eef4516f2b2b8f78e99b5af5ead7fb95a565d5b96f24fd2a30a7231729">inciter::ctr::DG</a>, <a class="el" href="namespaceinciter_1_1ctr.html#aba4e861eef4516f2b2b8f78e99b5af5ea0d82657f3a15a4f1307015b28b7bf82b">inciter::ctr::DiagCG</a>, <a class="el" href="_discretization_8_c_source.html#l00030">inciter::g_cgpde</a>, <a class="el" href="_discretization_8_c_source.html#l00031">inciter::g_dgpde</a>, <a class="el" href="_d_g_8_c_source.html#l00028">inciter::g_inputdeck</a>, <a class="el" href="_derived_data_8_c_source.html#l01439">tk::genGeoElemTet()</a>, <a class="el" href="_control_8h_source.html#l00046">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_refiner_8h_source.html#l00149">m_coord</a>, <a class="el" href="_refiner_8h_source.html#l00140">m_inpoel</a>, <a class="el" href="namespaceinciter_1_1ctr.html#aba4e861eef4516f2b2b8f78e99b5af5ea353e47fe83cde0cbcddf72ac555dd1e4">inciter::ctr::MatCG</a>, <a class="el" href="_derived_data_8_c_source.html#l00029">tk::npoin()</a>, and <a class="el" href="_exception_8h_source.html#l00031">Throw</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00465">errorRefine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;{</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keyword">auto</span> t0 = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1discr.html">tag::discr</a>, <a class="code" href="structtag_1_1t0.html">tag::t0</a> &gt;();</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keyword">auto</span> nprop = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment">// Will store nodal ICs</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  tk::Fields u( <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a>[0].size(), nprop );</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="comment">// Evaluate ICs differently depending on nodal or cell-centered discretization</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> scheme = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1discr.html">tag::discr</a>, <a class="code" href="structtag_1_1scheme.html">tag::scheme</a> &gt;();</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceinciter_1_1ctr.html#aba4e861eef4516f2b2b8f78e99b5af5ea353e47fe83cde0cbcddf72ac555dd1e4">ctr::SchemeType::MatCG</a> || scheme == <a class="code" href="namespaceinciter_1_1ctr.html#aba4e861eef4516f2b2b8f78e99b5af5ea0d82657f3a15a4f1307015b28b7bf82b">ctr::SchemeType::DiagCG</a>) {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// Node-centered: evaluate ICs for all scalar components integrated</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; eq : <a class="code" href="namespaceinciter.html#a13d1fc7121850561556871530b310016">g_cgpde</a>) eq.initialize( <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a>, u, t0 );</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceinciter_1_1ctr.html#aba4e861eef4516f2b2b8f78e99b5af5ead7fb95a565d5b96f24fd2a30a7231729">ctr::SchemeType::DG</a>) {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">// Initialize cell-centered unknowns</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    tk::Fields ue( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>.size()/4, nprop );</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keyword">auto</span> geoElem = <a class="code" href="namespacetk.html#af33c6a2dc1649b840ab82bfcd3d1617a">tk::genGeoElemTet</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a> );</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; eq : <a class="code" href="namespaceinciter.html#a9f44cfbd2d66fc825ad2848240dea587">g_dgpde</a>) eq.initialize( geoElem, ue, t0 );</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">// Transfer initial conditions from cells to nodes</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">for</span> (std::size_t p=0; p&lt;<a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a>; ++p) {    <span class="comment">// for all mesh nodes on this chare</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      std::vector&lt; tk::real &gt; up( nprop, 0.0 );</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <a class="code" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> vol = 0.0;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : <a class="code" href="classtk_1_1_around.html">tk::Around</a>(esup,p)) {       <span class="comment">// for all cells around node p</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="comment">// compute nodal volume: every element contributes their volume / 4</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        vol += geoElem(e,0,0) / 4.0;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="comment">// sum cell value to node weighed by cell volume / 4</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">for</span> (std::size_t c=0; c&lt;nprop; ++c)</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          up[c] += ue[e][c] * geoElem(e,0,0) / 4.0;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="comment">// store nodal value</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keywordflow">for</span> (std::size_t c=0; c&lt;nprop; ++c) u(p,c,0) = up[c] / vol;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  } <span class="keywordflow">else</span> <a class="code" href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a>( <span class="stringliteral">&quot;Nodal initialization not handled for discretization scheme&quot;</span> );</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( u.nunk() == <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a>[0].size(), <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( u.nprop() == nprop, <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="keywordflow">return</span> u;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_a6bc91e28516a27aea998ae384715707f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">inciter::Refiner::m_inpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_inpoel</div><div class="ttdoc">Alias to element connectivity with local node IDs in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00140">Refiner.h:140</a></div></div>
<div class="ttc" id="namespaceinciter_1_1ctr_html_aba4e861eef4516f2b2b8f78e99b5af5ea0d82657f3a15a4f1307015b28b7bf82b"><div class="ttname"><a href="namespaceinciter_1_1ctr.html#aba4e861eef4516f2b2b8f78e99b5af5ea0d82657f3a15a4f1307015b28b7bf82b">inciter::ctr::SchemeType::DiagCG</a></div></div>
<div class="ttc" id="namespaceinciter_html_a9f44cfbd2d66fc825ad2848240dea587"><div class="ttname"><a href="namespaceinciter.html#a9f44cfbd2d66fc825ad2848240dea587">inciter::g_dgpde</a></div><div class="ttdeci">std::vector&lt; DGPDE &gt; g_dgpde</div><div class="ttdef"><b>Definition:</b> <a href="_discretization_8_c_source.html#l00031">Discretization.C:31</a></div></div>
<div class="ttc" id="namespaceinciter_1_1ctr_html_aba4e861eef4516f2b2b8f78e99b5af5ea353e47fe83cde0cbcddf72ac555dd1e4"><div class="ttname"><a href="namespaceinciter_1_1ctr.html#aba4e861eef4516f2b2b8f78e99b5af5ea353e47fe83cde0cbcddf72ac555dd1e4">inciter::ctr::SchemeType::MatCG</a></div></div>
<div class="ttc" id="classtk_1_1_around_html"><div class="ttname"><a href="classtk_1_1_around.html">tk::Around</a></div><div class="ttdoc">Helper class simplifying client code for iterating on entries surrounding entries via linked lists de...</div><div class="ttdef"><b>Definition:</b> <a href="_around_8h_source.html#l00027">Around.h:27</a></div></div>
<div class="ttc" id="structtag_1_1discr_html"><div class="ttname"><a href="structtag_1_1discr.html">tag::discr</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00143">Tags.h:143</a></div></div>
<div class="ttc" id="namespaceinciter_html_a13d1fc7121850561556871530b310016"><div class="ttname"><a href="namespaceinciter.html#a13d1fc7121850561556871530b310016">inciter::g_cgpde</a></div><div class="ttdeci">std::vector&lt; CGPDE &gt; g_cgpde</div><div class="ttdef"><b>Definition:</b> <a href="_discretization_8_c_source.html#l00030">Discretization.C:30</a></div></div>
<div class="ttc" id="_exception_8h_html_a0412f798470c18f503a2c2f63c970ba8"><div class="ttname"><a href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a></div><div class="ttdeci">#define Throw(...)</div><div class="ttdoc">Throw macro that always throws an exception. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00031">Exception.h:31</a></div></div>
<div class="ttc" id="namespaceinciter_1_1ctr_html_aba4e861eef4516f2b2b8f78e99b5af5ead7fb95a565d5b96f24fd2a30a7231729"><div class="ttname"><a href="namespaceinciter_1_1ctr.html#aba4e861eef4516f2b2b8f78e99b5af5ead7fb95a565d5b96f24fd2a30a7231729">inciter::ctr::SchemeType::DG</a></div></div>
<div class="ttc" id="structtag_1_1t0_html"><div class="ttname"><a href="structtag_1_1t0.html">tag::t0</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00082">Tags.h:82</a></div></div>
<div class="ttc" id="namespacetk_html_abdd71f3e10edf6e1a8d047478abd488c"><div class="ttname"><a href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">tk::npoin</a></div><div class="ttdeci">std::size_t npoin(const std::vector&lt; std::size_t &gt; &amp;inpoel)</div><div class="ttdoc">Compute number of points (nodes) in mesh from connectivity. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00029">DerivedData.C:29</a></div></div>
<div class="ttc" id="namespacetk_html_af33c6a2dc1649b840ab82bfcd3d1617a"><div class="ttname"><a href="namespacetk.html#af33c6a2dc1649b840ab82bfcd3d1617a">tk::genGeoElemTet</a></div><div class="ttdeci">tk::Fields genGeoElemTet(const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::UnsMesh::Coords &amp;coord)</div><div class="ttdoc">Generate derived data structure, element geometry. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l01439">DerivedData.C:1439</a></div></div>
<div class="ttc" id="structtag_1_1scheme_html"><div class="ttname"><a href="structtag_1_1scheme.html">tag::scheme</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00076">Tags.h:76</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00046">Control.h:46</a></div></div>
<div class="ttc" id="namespacetk_html_a1a96ada94b7e2911ecca0a360f305575"><div class="ttname"><a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a></div><div class="ttdeci">double real</div><div class="ttdoc">Real number type used throughout the whole code. </div><div class="ttdef"><b>Definition:</b> <a href="_base_2_types_8h_source.html#l00016">Types.h:16</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00144">Tags.h:144</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_aec812331b2bc9bfc51ed8c48906204fe"><div class="ttname"><a href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">inciter::Refiner::m_coord</a></div><div class="ttdeci">tk::UnsMesh::Coords m_coord</div><div class="ttdoc">Coordinates of mesh nodes of our chunk of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00149">Refiner.h:149</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_d_g_8_c_source.html#l00028">DG.C:28</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a0ab2e81a0ce5e194be775b10ef1191ec_cgraph.svg" width="616" height="160"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a5d5398f5bbfa783db201e6daa7370a5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d5398f5bbfa783db201e6daa7370a5f">&#9670;&nbsp;</a></span>pup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inciter::Refiner::pup </td>
          <td>(</td>
          <td class="paramtype">PUP::er &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pack/Unpack serialize member function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>Charm++'s PUP::er serializer object reference </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00072">72</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">References <a class="el" href="_refiner_8h_source.html#l00151">m_bface</a>, <a class="el" href="_refiner_8h_source.html#l00174">m_bndEdges</a>, <a class="el" href="_refiner_8h_source.html#l00155">m_bnode</a>, <a class="el" href="_refiner_8h_source.html#l00127">m_cbr</a>, <a class="el" href="_refiner_8h_source.html#l00129">m_cbs</a>, <a class="el" href="_refiner_8h_source.html#l00167">m_ch</a>, <a class="el" href="_refiner_8h_source.html#l00149">m_coord</a>, <a class="el" href="_refiner_8h_source.html#l00147">m_coordmap</a>, <a class="el" href="_refiner_8h_source.html#l00169">m_edgenode</a>, <a class="el" href="_refiner_8h_source.html#l00172">m_edgenodeCh</a>, <a class="el" href="_refiner_8h_source.html#l00138">m_el</a>, <a class="el" href="_refiner_8h_source.html#l00165">m_extra</a>, <a class="el" href="_refiner_8h_source.html#l00142">m_gid</a>, <a class="el" href="_refiner_8h_source.html#l00131">m_ginpoel</a>, <a class="el" href="_refiner_8h_source.html#l00119">m_host</a>, <a class="el" href="_refiner_8h_source.html#l00159">m_initref</a>, <a class="el" href="_refiner_8h_source.html#l00140">m_inpoel</a>, <a class="el" href="_refiner_8h_source.html#l00145">m_lid</a>, <a class="el" href="_refiner_8h_source.html#l00157">m_nchare</a>, <a class="el" href="_refiner_8h_source.html#l00163">m_nref</a>, <a class="el" href="_refiner_8h_source.html#l00153">m_triinpoel</a>, and <a class="el" href="_p_u_p_util_8h_source.html#l00046">PUP::pup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                         {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="namespace_p_u_p.html#aa494dd0331773529acf90e7f40658c63">CBase_Refiner::pup</a>(p);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#a6dcb67634aab36a227a6e0fec4011432">m_host</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#a8e89a122b60e779413d13f4ed35a40c9">m_cbr</a>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#ab8750c25fab71f650dcfeae371fa87bf">m_cbs</a>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">m_el</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">if</span> (p.isUnpacking()) {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a> = std::get&lt; 0 &gt;( <a class="code" href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">m_el</a> );</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a> = std::get&lt; 1 &gt;( <a class="code" href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">m_el</a> );</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a> = std::get&lt; 2 &gt;( <a class="code" href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">m_el</a> );</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">m_coordmap</a>;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#a38dadaef73bf3db0af0fdaeadf87408c">m_bface</a>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">m_triinpoel</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#a8f752bc3a870aea2138683b778a9c6ee">m_bnode</a>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#a40aca114fe5c6c650c5a8ebbe1969421">m_nchare</a>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">m_initref</a>;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="comment">//p | m_refiner;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#abcdd64821992ed351c4da0dcb5ef5989">m_nref</a>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">m_extra</a>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">m_ch</a>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">m_edgenode</a>;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#a8a296faa4bf9d5353b93a3184d24d25e">m_edgenodeCh</a>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      p | <a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div><div class="ttc" id="classinciter_1_1_refiner_html_aae71fe355232fbbe89ccb90cb63a0ee5"><div class="ttname"><a href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">inciter::Refiner::m_extra</a></div><div class="ttdeci">std::size_t m_extra</div><div class="ttdoc">Number of chare-boundary newly added nodes that need correction. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00165">Refiner.h:165</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a38dadaef73bf3db0af0fdaeadf87408c"><div class="ttname"><a href="classinciter_1_1_refiner.html#a38dadaef73bf3db0af0fdaeadf87408c">inciter::Refiner::m_bface</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_bface</div><div class="ttdoc">List of boundary faces associated to side-set IDs. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00151">Refiner.h:151</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a6bc91e28516a27aea998ae384715707f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">inciter::Refiner::m_inpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_inpoel</div><div class="ttdoc">Alias to element connectivity with local node IDs in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00140">Refiner.h:140</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a5af0df1e55bc32f0cdfd29f72d427f43"><div class="ttname"><a href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">inciter::Refiner::m_edgenode</a></div><div class="ttdeci">tk::UnsMesh::EdgeNodeCoord m_edgenode</div><div class="ttdoc">Map associating global IDs and coordinates of a node added to an edge. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00169">Refiner.h:169</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a9db2d016c546a539f8213e9804ec65ff"><div class="ttname"><a href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">inciter::Refiner::m_initref</a></div><div class="ttdeci">std::vector&lt; ctr::AMRInitialType &gt; m_initref</div><div class="ttdoc">Initial mesh refinement type list (in reverse order) </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00159">Refiner.h:159</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_abe95236aea1ef5fb585930650e829015"><div class="ttname"><a href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">inciter::Refiner::m_triinpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; m_triinpoel</div><div class="ttdoc">Boundary face-node connectivity. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00153">Refiner.h:153</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a00514941af3f4b071d2bfabeccf03789"><div class="ttname"><a href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">inciter::Refiner::m_el</a></div><div class="ttdeci">std::tuple&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt;, std::unordered_map&lt; std::size_t, std::size_t &gt; &gt; m_el</div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00138">Refiner.h:138</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a972fbff38d8e36f96be02b7e0a092472"><div class="ttname"><a href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">inciter::Refiner::m_lid</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::size_t &gt; &amp; m_lid</div><div class="ttdoc">Alias to local node IDs associated to the global ones of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00145">Refiner.h:145</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a40aca114fe5c6c650c5a8ebbe1969421"><div class="ttname"><a href="classinciter_1_1_refiner.html#a40aca114fe5c6c650c5a8ebbe1969421">inciter::Refiner::m_nchare</a></div><div class="ttdeci">int m_nchare</div><div class="ttdoc">Total number of refiner chares. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00157">Refiner.h:157</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ae736705da5f6217e06153112e2038b2e"><div class="ttname"><a href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">inciter::Refiner::m_ginpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; m_ginpoel</div><div class="ttdoc">Tetrtahedron element connectivity of our chunk of the mesh (global ids) </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00131">Refiner.h:131</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_abcdd64821992ed351c4da0dcb5ef5989"><div class="ttname"><a href="classinciter_1_1_refiner.html#abcdd64821992ed351c4da0dcb5ef5989">inciter::Refiner::m_nref</a></div><div class="ttdeci">std::size_t m_nref</div><div class="ttdoc">Counter during distribution of newly added nodes to chare-boundary edges. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00163">Refiner.h:163</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ad9d96d8d83e5525268168cbc84d79396"><div class="ttname"><a href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">inciter::Refiner::m_bndEdges</a></div><div class="ttdeci">std::unordered_map&lt; int, EdgeSet &gt; m_bndEdges</div><div class="ttdoc">Boundary edges associated to chares we share these edges with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00174">Refiner.h:174</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8e89a122b60e779413d13f4ed35a40c9"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8e89a122b60e779413d13f4ed35a40c9">inciter::Refiner::m_cbr</a></div><div class="ttdeci">tk::RefinerCallback m_cbr</div><div class="ttdoc">Charm++ callbacks associated to compile-time tags for refiner. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00127">Refiner.h:127</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8b6f78d266458831a12a9e53a609ce72"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">inciter::Refiner::m_ch</a></div><div class="ttdeci">std::unordered_set&lt; int &gt; m_ch</div><div class="ttdoc">Chares we share at least a single edge with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00167">Refiner.h:167</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a0dbe0d53033cee33b057f32f8a65ba58"><div class="ttname"><a href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">inciter::Refiner::m_coordmap</a></div><div class="ttdeci">tk::UnsMesh::CoordMap m_coordmap</div><div class="ttdoc">Coordinates associated to global node IDs of our mesh chunk. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00147">Refiner.h:147</a></div></div>
<div class="ttc" id="namespace_p_u_p_html_aa494dd0331773529acf90e7f40658c63"><div class="ttname"><a href="namespace_p_u_p.html#aa494dd0331773529acf90e7f40658c63">PUP::pup</a></div><div class="ttdeci">void pup(PUP::er &amp;p, E &amp;e)</div><div class="ttdoc">Pack/Unpack enum class. </div><div class="ttdef"><b>Definition:</b> <a href="_p_u_p_util_8h_source.html#l00046">PUPUtil.h:46</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a5636a971bbf52996e933493fc6a5aa07"><div class="ttname"><a href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">inciter::Refiner::m_gid</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_gid</div><div class="ttdoc">Alias to global node IDs of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00142">Refiner.h:142</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a6dcb67634aab36a227a6e0fec4011432"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6dcb67634aab36a227a6e0fec4011432">inciter::Refiner::m_host</a></div><div class="ttdeci">CProxy_Transporter m_host</div><div class="ttdoc">Host proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00119">Refiner.h:119</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ab8750c25fab71f650dcfeae371fa87bf"><div class="ttname"><a href="classinciter_1_1_refiner.html#ab8750c25fab71f650dcfeae371fa87bf">inciter::Refiner::m_cbs</a></div><div class="ttdeci">tk::SorterCallback m_cbs</div><div class="ttdoc">Charm++ callbacks associated to compile-time tags for sorter. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00129">Refiner.h:129</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8f752bc3a870aea2138683b778a9c6ee"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8f752bc3a870aea2138683b778a9c6ee">inciter::Refiner::m_bnode</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_bnode</div><div class="ttdoc">List of boundary nodes associated to side-set IDs. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00155">Refiner.h:155</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_aec812331b2bc9bfc51ed8c48906204fe"><div class="ttname"><a href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">inciter::Refiner::m_coord</a></div><div class="ttdeci">tk::UnsMesh::Coords m_coord</div><div class="ttdoc">Coordinates of mesh nodes of our chunk of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00149">Refiner.h:149</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8a296faa4bf9d5353b93a3184d24d25e"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8a296faa4bf9d5353b93a3184d24d25e">inciter::Refiner::m_edgenodeCh</a></div><div class="ttdeci">std::unordered_map&lt; int, tk::UnsMesh::EdgeNodeCoord &gt; m_edgenodeCh</div><div class="ttdoc">Map associating global IDs and coordinates of a node added to an edge associated to another chare the...</div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00172">Refiner.h:172</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a5d5398f5bbfa783db201e6daa7370a5f_cgraph.svg" width="283" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="abac6e293394b68bc9109bd2fce7ecff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abac6e293394b68bc9109bd2fce7ecff1">&#9670;&nbsp;</a></span>recvRefBndEdges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::recvRefBndEdges </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Acknowledge received newly added nodes shared with other chares. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00310">310</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_refiner_8h_source.html#l00127">m_cbr</a>, <a class="el" href="_refiner_8h_source.html#l00167">m_ch</a>, <a class="el" href="_refiner_8h_source.html#l00165">m_extra</a>, and <a class="el" href="_refiner_8h_source.html#l00163">m_nref</a>.</p>
<div class="fragment"><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;{</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">// When we have heard from all chares we share at least a single edge with,</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// contribute the number of extra edges that this mesh refinement step has</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">// found that were not refined by this chare but were refined by other chares</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">// this chare shares the edge with. A global maximum is then be computed on</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">// the umber of extra edges appearing in Transporter::matched() which is then</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// used to decide if a new correction step is needed. If this is called for</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// the first time in a given initial mesh refinement step, i.e., not after a</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// correction step, m_extra=1 on all chares, so a correction step is assumed</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// to be required.</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span> (++<a class="code" href="classinciter_1_1_refiner.html#abcdd64821992ed351c4da0dcb5ef5989">m_nref</a> == <a class="code" href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">m_ch</a>.size()) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    contribute( <span class="keyword">sizeof</span>(std::size_t), &amp;<a class="code" href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">m_extra</a>, CkReduction::max_ulong,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <a class="code" href="classinciter_1_1_refiner.html#a8e89a122b60e779413d13f4ed35a40c9">m_cbr</a>.get&lt; <a class="code" href="structtag_1_1matched.html">tag::matched</a> &gt;() );</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_aae71fe355232fbbe89ccb90cb63a0ee5"><div class="ttname"><a href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">inciter::Refiner::m_extra</a></div><div class="ttdeci">std::size_t m_extra</div><div class="ttdoc">Number of chare-boundary newly added nodes that need correction. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00165">Refiner.h:165</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_abcdd64821992ed351c4da0dcb5ef5989"><div class="ttname"><a href="classinciter_1_1_refiner.html#abcdd64821992ed351c4da0dcb5ef5989">inciter::Refiner::m_nref</a></div><div class="ttdeci">std::size_t m_nref</div><div class="ttdoc">Counter during distribution of newly added nodes to chare-boundary edges. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00163">Refiner.h:163</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8e89a122b60e779413d13f4ed35a40c9"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8e89a122b60e779413d13f4ed35a40c9">inciter::Refiner::m_cbr</a></div><div class="ttdeci">tk::RefinerCallback m_cbr</div><div class="ttdoc">Charm++ callbacks associated to compile-time tags for refiner. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00127">Refiner.h:127</a></div></div>
<div class="ttc" id="structtag_1_1matched_html"><div class="ttname"><a href="structtag_1_1matched.html">tag::matched</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00089">Tags.h:89</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8b6f78d266458831a12a9e53a609ce72"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">inciter::Refiner::m_ch</a></div><div class="ttdeci">std::unordered_set&lt; int &gt; m_ch</div><div class="ttdoc">Chares we share at least a single edge with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00167">Refiner.h:167</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87db375021a5846871b6e2db7a485a4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87db375021a5846871b6e2db7a485a4b">&#9670;&nbsp;</a></span>refine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::refine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refine mesh. </p>
<p>This is a single step in a potentially multiple-entry list of initial adaptive mesh refinement steps. Distribution of the chare-boundary edges has preceded this step, so that boundary edges (shared by multiple chares) can agree on a refinement that yields a conforming mesh across chare boundaries. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00215">215</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_refiner_8_c_source.html#l00268">comExtra()</a>, <a class="el" href="_container_util_8h_source.html#l00051">tk::cref_find()</a>, <a class="el" href="_refiner_8_c_source.html#l00465">errorRefine()</a>, <a class="el" href="_derived_data_8_c_source.html#l00934">tk::genEsuelTet()</a>, <a class="el" href="_derived_data_8_c_source.html#l00042">tk::genEsup()</a>, <a class="el" href="_macro_8h_source.html#l00019">IGNORE</a>, <a class="el" href="namespaceinciter_1_1ctr.html#ab492311c84666c98ea0363b2991f81faa18c4ce216b667f1d25e30d69f0b15649">inciter::ctr::INITIAL_CONDITIONS</a>, <a class="el" href="_derived_data_8_c_source.html#l01496">tk::leakyPartition()</a>, <a class="el" href="_refiner_8h_source.html#l00174">m_bndEdges</a>, <a class="el" href="_refiner_8h_source.html#l00149">m_coord</a>, <a class="el" href="_refiner_8h_source.html#l00159">m_initref</a>, <a class="el" href="_refiner_8h_source.html#l00140">m_inpoel</a>, <a class="el" href="_refiner_8h_source.html#l00145">m_lid</a>, <a class="el" href="_reorder_8_c_source.html#l00194">tk::positiveJacobians()</a>, <a class="el" href="_exception_8h_source.html#l00031">Throw</a>, <a class="el" href="namespaceinciter_1_1ctr.html#ab492311c84666c98ea0363b2991f81faa891f35a29c3d51d02ffd42dd6dcc69b2">inciter::ctr::UNIFORM</a>, <a class="el" href="_refiner_8_c_source.html#l00448">uniformRefine()</a>, and <a class="el" href="_refiner_8_c_source.html#l00515">userRefine()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00193">addBndEdges()</a>.</p>
<div class="fragment"><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;{</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">// Perform leak test on old mesh</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( !<a class="code" href="namespacetk.html#a8b04469b1f0015a5322697e83617ca6d">tk::leakyPartition</a>(</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <a class="code" href="namespacetk.html#a5b61b3cb6492e71ff9853404440fddcc">tk::genEsuelTet</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, <a class="code" href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a>(<a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>,4) ),</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a> ),</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          <span class="stringliteral">&quot;Mesh partition before refinement leaky&quot;</span> );</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e : <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>(<a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>,thisIndex)) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="_macro_8h.html#a494f327b84ea26d04e3ad24251b4bbe0">IGNORE</a>(e);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>.find( e[0] ) != end( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a> ) &amp;&amp;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>.find( e[1] ) != end( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a> ),</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="stringliteral">&quot;Boundary edge not found before refinement&quot;</span> );</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// Refine mesh based on next initial refinement type</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">m_initref</a>.empty()) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">auto</span> r = <a class="code" href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">m_initref</a>.back();    <span class="comment">// consume (reversed) list from back</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (r == <a class="code" href="namespaceinciter_1_1ctr.html#ab492311c84666c98ea0363b2991f81faa891f35a29c3d51d02ffd42dd6dcc69b2">ctr::AMRInitialType::UNIFORM</a>)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <a class="code" href="classinciter_1_1_refiner.html#a3976418525f7877b1f0a43016983c4bf">uniformRefine</a>();</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r == <a class="code" href="namespaceinciter_1_1ctr.html#ab492311c84666c98ea0363b2991f81faa18c4ce216b667f1d25e30d69f0b15649">ctr::AMRInitialType::INITIAL_CONDITIONS</a>)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <a class="code" href="classinciter_1_1_refiner.html#ac1d8849088a3862e2ccc7e34d65abe8f">errorRefine</a>();</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a>( <span class="stringliteral">&quot;Initial AMR type not implemented&quot;</span> );</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">// Additionally refine mesh based on user explicitly tagging edges</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a06a9b9f3a4fe8c6f3da9a1ff6d580cb3">userRefine</a>();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e : <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>(<a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>,thisIndex)) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="_macro_8h.html#a494f327b84ea26d04e3ad24251b4bbe0">IGNORE</a>(e);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>.find( e[0] ) != end( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a> ) &amp;&amp;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>.find( e[1] ) != end( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a> ),</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="stringliteral">&quot;Boundary edge not found after refinement&quot;</span> );</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">// Ensure valid mesh after refinement</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="namespacetk.html#a6c5589db5d1caeac294a0b1569b65ebd">tk::positiveJacobians</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a> ),</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          <span class="stringliteral">&quot;Refined mesh cell Jacobian non-positive&quot;</span> );</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">// Communicate extra edges</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a3d7830e14265ab1005c50f0ca54780d6">comExtra</a>();</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_a6bc91e28516a27aea998ae384715707f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">inciter::Refiner::m_inpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_inpoel</div><div class="ttdoc">Alias to element connectivity with local node IDs in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00140">Refiner.h:140</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a9db2d016c546a539f8213e9804ec65ff"><div class="ttname"><a href="classinciter_1_1_refiner.html#a9db2d016c546a539f8213e9804ec65ff">inciter::Refiner::m_initref</a></div><div class="ttdeci">std::vector&lt; ctr::AMRInitialType &gt; m_initref</div><div class="ttdoc">Initial mesh refinement type list (in reverse order) </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00159">Refiner.h:159</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a972fbff38d8e36f96be02b7e0a092472"><div class="ttname"><a href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">inciter::Refiner::m_lid</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::size_t &gt; &amp; m_lid</div><div class="ttdoc">Alias to local node IDs associated to the global ones of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00145">Refiner.h:145</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ad9d96d8d83e5525268168cbc84d79396"><div class="ttname"><a href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">inciter::Refiner::m_bndEdges</a></div><div class="ttdeci">std::unordered_map&lt; int, EdgeSet &gt; m_bndEdges</div><div class="ttdoc">Boundary edges associated to chares we share these edges with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00174">Refiner.h:174</a></div></div>
<div class="ttc" id="namespacetk_html_a2e002561a68875b091a264eb2a1e5f6c"><div class="ttname"><a href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a></div><div class="ttdeci">auto cref_find(const Container &amp;map, const typename Container::key_type &amp;key) -&gt; const typename Container::mapped_type &amp;</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00051">ContainerUtil.h:51</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a3d7830e14265ab1005c50f0ca54780d6"><div class="ttname"><a href="classinciter_1_1_refiner.html#a3d7830e14265ab1005c50f0ca54780d6">inciter::Refiner::comExtra</a></div><div class="ttdeci">void comExtra()</div><div class="ttdoc">Communicate refined edges after a refinement step. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00268">Refiner.C:268</a></div></div>
<div class="ttc" id="namespaceinciter_1_1ctr_html_ab492311c84666c98ea0363b2991f81faa18c4ce216b667f1d25e30d69f0b15649"><div class="ttname"><a href="namespaceinciter_1_1ctr.html#ab492311c84666c98ea0363b2991f81faa18c4ce216b667f1d25e30d69f0b15649">inciter::ctr::AMRInitialType::INITIAL_CONDITIONS</a></div></div>
<div class="ttc" id="namespaceinciter_1_1ctr_html_ab492311c84666c98ea0363b2991f81faa891f35a29c3d51d02ffd42dd6dcc69b2"><div class="ttname"><a href="namespaceinciter_1_1ctr.html#ab492311c84666c98ea0363b2991f81faa891f35a29c3d51d02ffd42dd6dcc69b2">inciter::ctr::AMRInitialType::UNIFORM</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a3976418525f7877b1f0a43016983c4bf"><div class="ttname"><a href="classinciter_1_1_refiner.html#a3976418525f7877b1f0a43016983c4bf">inciter::Refiner::uniformRefine</a></div><div class="ttdeci">void uniformRefine()</div><div class="ttdoc">Do uniform mesh refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00448">Refiner.C:448</a></div></div>
<div class="ttc" id="_macro_8h_html_a494f327b84ea26d04e3ad24251b4bbe0"><div class="ttname"><a href="_macro_8h.html#a494f327b84ea26d04e3ad24251b4bbe0">IGNORE</a></div><div class="ttdeci">#define IGNORE(expr)</div><div class="ttdoc">This macro can be used to suppress compiler warning on unused variable. </div><div class="ttdef"><b>Definition:</b> <a href="_macro_8h_source.html#l00019">Macro.h:19</a></div></div>
<div class="ttc" id="_exception_8h_html_a0412f798470c18f503a2c2f63c970ba8"><div class="ttname"><a href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a></div><div class="ttdeci">#define Throw(...)</div><div class="ttdoc">Throw macro that always throws an exception. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00031">Exception.h:31</a></div></div>
<div class="ttc" id="namespacetk_html_a8b04469b1f0015a5322697e83617ca6d"><div class="ttname"><a href="namespacetk.html#a8b04469b1f0015a5322697e83617ca6d">tk::leakyPartition</a></div><div class="ttdeci">bool leakyPartition(const std::vector&lt; int &gt; &amp;esueltet, const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::UnsMesh::Coords &amp;coord)</div><div class="ttdoc">Perform leak-test on mesh (partition) </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l01496">DerivedData.C:1496</a></div></div>
<div class="ttc" id="namespacetk_html_a5b61b3cb6492e71ff9853404440fddcc"><div class="ttname"><a href="namespacetk.html#a5b61b3cb6492e71ff9853404440fddcc">tk::genEsuelTet</a></div><div class="ttdeci">std::vector&lt; int &gt; genEsuelTet(const std::vector&lt; std::size_t &gt; &amp;inpoel, const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;esup)</div><div class="ttdoc">Generate derived data structure, elements surrounding elements as a fixed length data structure as a ...</div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00934">DerivedData.C:934</a></div></div>
<div class="ttc" id="namespacetk_html_a6c5589db5d1caeac294a0b1569b65ebd"><div class="ttname"><a href="namespacetk.html#a6c5589db5d1caeac294a0b1569b65ebd">tk::positiveJacobians</a></div><div class="ttdeci">bool positiveJacobians(const std::vector&lt; std::size_t &gt; &amp;inpoel, const std::array&lt; std::vector&lt; real &gt;, 3 &gt; &amp;coord)</div><div class="ttdoc">Test positivity of the Jacobian for all cells in a mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_reorder_8_c_source.html#l00194">Reorder.C:194</a></div></div>
<div class="ttc" id="namespacetk_html_a66a2889d5d8aeb4a836842c6a1010463"><div class="ttname"><a href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; genEsup(const std::vector&lt; std::size_t &gt; &amp;inpoel, std::size_t nnpe)</div><div class="ttdoc">Generate derived data structure, elements surrounding points. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00042">DerivedData.C:42</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ac1d8849088a3862e2ccc7e34d65abe8f"><div class="ttname"><a href="classinciter_1_1_refiner.html#ac1d8849088a3862e2ccc7e34d65abe8f">inciter::Refiner::errorRefine</a></div><div class="ttdeci">void errorRefine()</div><div class="ttdoc">Do error-based mesh refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00465">Refiner.C:465</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a06a9b9f3a4fe8c6f3da9a1ff6d580cb3"><div class="ttname"><a href="classinciter_1_1_refiner.html#a06a9b9f3a4fe8c6f3da9a1ff6d580cb3">inciter::Refiner::userRefine</a></div><div class="ttdeci">void userRefine()</div><div class="ttdoc">Do mesh refinement based on user explicitly tagging edges. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00515">Refiner.C:515</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_aec812331b2bc9bfc51ed8c48906204fe"><div class="ttname"><a href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">inciter::Refiner::m_coord</a></div><div class="ttdeci">tk::UnsMesh::Coords m_coord</div><div class="ttdoc">Coordinates of mesh nodes of our chunk of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00149">Refiner.h:149</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a87db375021a5846871b6e2db7a485a4b_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="afba8afbc60c7db3b9cf5b596de2ae33f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afba8afbc60c7db3b9cf5b596de2ae33f">&#9670;&nbsp;</a></span>registerReducers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::registerReducers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configure Charm++ reduction types. </p>
<p>Since this is a [nodeinit] routine, the runtime system executes the routine exactly once on every logical node early on in the Charm++ init sequence. Must be static as it is called without an object. See also: Section "Initializations at Program Startup" at in the Charm++ manual <a href="http://charm.cs.illinois.edu/manuals/html/charm++/manual.html">http://charm.cs.illinois.edu/manuals/html/charm++/manual.html</a>. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00092">92</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_refiner_8_c_source.html#l00032">inciter::BndEdgeMerger</a>, <a class="el" href="_refiner_8h_source.html#l00174">m_bndEdges</a>, and <a class="el" href="_hash_map_reducer_8h_source.html#l00094">tk::mergeHashMap()</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="namespaceinciter.html#af16fb066bd82d65db4ad0dcc5f6efc99">BndEdgeMerger</a> = CkReduction::addReducer(</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                    <a class="code" href="namespacetk.html#ac371117af5d2009dca83a8cb5539a43f">tk::mergeHashMap</a>&lt; decltype(<a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>)::key_type,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                      decltype(<a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>)::mapped_type &gt; );</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div><div class="ttc" id="namespacetk_html_ac371117af5d2009dca83a8cb5539a43f"><div class="ttname"><a href="namespacetk.html#ac371117af5d2009dca83a8cb5539a43f">tk::mergeHashMap</a></div><div class="ttdeci">CkReductionMsg * mergeHashMap(int nmsg, CkReductionMsg **msgs)</div><div class="ttdoc">Charm++ custom reducer for merging std::unordered_maps during reduction across PEs. </div><div class="ttdef"><b>Definition:</b> <a href="_hash_map_reducer_8h_source.html#l00094">HashMapReducer.h:94</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ad9d96d8d83e5525268168cbc84d79396"><div class="ttname"><a href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">inciter::Refiner::m_bndEdges</a></div><div class="ttdeci">std::unordered_map&lt; int, EdgeSet &gt; m_bndEdges</div><div class="ttdoc">Boundary edges associated to chares we share these edges with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00174">Refiner.h:174</a></div></div>
<div class="ttc" id="namespaceinciter_html_af16fb066bd82d65db4ad0dcc5f6efc99"><div class="ttname"><a href="namespaceinciter.html#af16fb066bd82d65db4ad0dcc5f6efc99">inciter::BndEdgeMerger</a></div><div class="ttdeci">static CkReduction::reducerType BndEdgeMerger</div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00032">Refiner.C:32</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_afba8afbc60c7db3b9cf5b596de2ae33f_cgraph.svg" width="512" height="84"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ac0cc6c7182e9d82f08fbb48183e98e56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0cc6c7182e9d82f08fbb48183e98e56">&#9670;&nbsp;</a></span>start()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare for next step of mesh refinement. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00135">135</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_refiner_8_c_source.html#l00156">bndEdges()</a>, <a class="el" href="_d_g_8_c_source.html#l00028">inciter::g_inputdeck</a>, <a class="el" href="_control_8h_source.html#l00046">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_refiner_8h_source.html#l00174">m_bndEdges</a>, <a class="el" href="_refiner_8h_source.html#l00167">m_ch</a>, <a class="el" href="_refiner_8h_source.html#l00169">m_edgenode</a>, <a class="el" href="_refiner_8h_source.html#l00172">m_edgenodeCh</a>, and <a class="el" href="_refiner_8h_source.html#l00165">m_extra</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00406">nextref()</a>, and <a class="el" href="_refiner_8_c_source.html#l00038">Refiner()</a>.</p>
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( (!<a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1amr.html">tag::amr</a>, <a class="code" href="structtag_1_1init.html">tag::init</a> &gt;().empty()) ||</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          (!<a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1amr.html">tag::amr</a>, <a class="code" href="structtag_1_1init.html">tag::init</a> &gt;().empty()),</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <span class="stringliteral">&quot;Neither initial mesh refinement type list nor user-defined &quot;</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          <span class="stringliteral">&quot;edge list given&quot;</span> );</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">m_extra</a> = 0;  <span class="comment">// assume at least a single step of correction is needed</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">m_bndEdges</a>.clear();</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">m_ch</a>.clear();</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a8a296faa4bf9d5353b93a3184d24d25e">m_edgenodeCh</a>.clear();</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">m_edgenode</a>.clear();</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// Generate boundary edges</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a250585f82bb30cda86c6717be44ae0c9">bndEdges</a>();</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_aae71fe355232fbbe89ccb90cb63a0ee5"><div class="ttname"><a href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">inciter::Refiner::m_extra</a></div><div class="ttdeci">std::size_t m_extra</div><div class="ttdoc">Number of chare-boundary newly added nodes that need correction. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00165">Refiner.h:165</a></div></div>
<div class="ttc" id="structtag_1_1amr_html"><div class="ttname"><a href="structtag_1_1amr.html">tag::amr</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00073">Tags.h:73</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a5af0df1e55bc32f0cdfd29f72d427f43"><div class="ttname"><a href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">inciter::Refiner::m_edgenode</a></div><div class="ttdeci">tk::UnsMesh::EdgeNodeCoord m_edgenode</div><div class="ttdoc">Map associating global IDs and coordinates of a node added to an edge. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00169">Refiner.h:169</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ad9d96d8d83e5525268168cbc84d79396"><div class="ttname"><a href="classinciter_1_1_refiner.html#ad9d96d8d83e5525268168cbc84d79396">inciter::Refiner::m_bndEdges</a></div><div class="ttdeci">std::unordered_map&lt; int, EdgeSet &gt; m_bndEdges</div><div class="ttdoc">Boundary edges associated to chares we share these edges with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00174">Refiner.h:174</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a250585f82bb30cda86c6717be44ae0c9"><div class="ttname"><a href="classinciter_1_1_refiner.html#a250585f82bb30cda86c6717be44ae0c9">inciter::Refiner::bndEdges</a></div><div class="ttdeci">void bndEdges()</div><div class="ttdoc">Generate boundary edges and send them to all chares. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00156">Refiner.C:156</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8b6f78d266458831a12a9e53a609ce72"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8b6f78d266458831a12a9e53a609ce72">inciter::Refiner::m_ch</a></div><div class="ttdeci">std::unordered_set&lt; int &gt; m_ch</div><div class="ttdoc">Chares we share at least a single edge with. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00167">Refiner.h:167</a></div></div>
<div class="ttc" id="structtag_1_1init_html"><div class="ttname"><a href="structtag_1_1init.html">tag::init</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00148">Tags.h:148</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00046">Control.h:46</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8a296faa4bf9d5353b93a3184d24d25e"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8a296faa4bf9d5353b93a3184d24d25e">inciter::Refiner::m_edgenodeCh</a></div><div class="ttdeci">std::unordered_map&lt; int, tk::UnsMesh::EdgeNodeCoord &gt; m_edgenodeCh</div><div class="ttdoc">Map associating global IDs and coordinates of a node added to an edge associated to another chare the...</div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00172">Refiner.h:172</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_d_g_8_c_source.html#l00028">DG.C:28</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_ac0cc6c7182e9d82f08fbb48183e98e56_cgraph.svg" width="100%" height="400"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a3976418525f7877b1f0a43016983c4bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3976418525f7877b1f0a43016983c4bf">&#9670;&nbsp;</a></span>uniformRefine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::uniformRefine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Do uniform mesh refinement. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00448">448</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_refiner_8h_source.html#l00165">m_extra</a>, <a class="el" href="_refiner_8h_source.html#l00161">m_refiner</a>, <a class="el" href="mesh__adapter_8_c_source.html#l00050">AMR::mesh_adapter_t::uniform_refinement()</a>, and <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00215">refine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;{</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">// Do uniform refinement</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#a88f9567e3632ef1e1bcb64e750bb817d">uniform_refinement</a>();</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">// Update mesh coordinates and connectivity</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a2aa26e2c8cf1618a0452b8803c53637f">updateMesh</a>();</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="comment">// Set number of extra edges to be zero, skipping correction (if this is the</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">// only step in this refinement step)</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">m_extra</a> = 0;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_aae71fe355232fbbe89ccb90cb63a0ee5"><div class="ttname"><a href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">inciter::Refiner::m_extra</a></div><div class="ttdeci">std::size_t m_extra</div><div class="ttdoc">Number of chare-boundary newly added nodes that need correction. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00165">Refiner.h:165</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a2aa26e2c8cf1618a0452b8803c53637f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a2aa26e2c8cf1618a0452b8803c53637f">inciter::Refiner::updateMesh</a></div><div class="ttdeci">void updateMesh()</div><div class="ttdoc">Update mesh after refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00635">Refiner.C:635</a></div></div>
<div class="ttc" id="class_a_m_r_1_1mesh__adapter__t_html_a88f9567e3632ef1e1bcb64e750bb817d"><div class="ttname"><a href="class_a_m_r_1_1mesh__adapter__t.html#a88f9567e3632ef1e1bcb64e750bb817d">AMR::mesh_adapter_t::uniform_refinement</a></div><div class="ttdeci">void uniform_refinement()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__adapter_8_c_source.html#l00050">mesh_adapter.C:50</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a7e85879e386e8df4dc9b3291bd64eb70"><div class="ttname"><a href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">inciter::Refiner::m_refiner</a></div><div class="ttdeci">AMR::mesh_adapter_t m_refiner</div><div class="ttdoc">Mesh refiner (library) object. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00161">Refiner.h:161</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a3976418525f7877b1f0a43016983c4bf_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a89c9de6672bef7eff8e0833a754582c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89c9de6672bef7eff8e0833a754582c7">&#9670;&nbsp;</a></span>updateBndFaces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::updateBndFaces </td>
          <td>(</td>
          <td class="paramtype">const std::unordered_set&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unordered_set&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinciter_1_1_refiner.html#a3a8ba2c58baf8faa11dfb175967e7b2b">BndFaces</a> &amp;&#160;</td>
          <td class="paramname"><em>bnd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Regenerate boundary faces after mesh refinement step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">old</td><td>Unique nodes of the old (unrefined) mesh using local ids </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>Unique nodes of the refined mesh using local ids </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bnd</td><td>Boundary face map, associating a pair of side set id and adjacent tet id to a boundary triangle face </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00819">819</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_container_util_8h_source.html#l00051">tk::cref_find()</a>, <a class="el" href="tet__store_8h_source.html#l00069">AMR::tet_store_t::data()</a>, <a class="el" href="node__connectivity_8h_source.html#l00055">AMR::node_connectivity_t::get()</a>, <a class="el" href="tet__store_8h_source.html#l00677">AMR::tet_store_t::get_child_id()</a>, <a class="el" href="_macro_8h_source.html#l00019">IGNORE</a>, <a class="el" href="_refiner_8h_source.html#l00151">m_bface</a>, <a class="el" href="_refiner_8h_source.html#l00142">m_gid</a>, <a class="el" href="_refiner_8h_source.html#l00145">m_lid</a>, <a class="el" href="_refiner_8h_source.html#l00161">m_refiner</a>, <a class="el" href="_refiner_8h_source.html#l00153">m_triinpoel</a>, <a class="el" href="mesh__adapter_8h_source.html#l00040">AMR::mesh_adapter_t::node_connectivity</a>, <a class="el" href="_refinement___state_8h_source.html#l00079">AMR::Refinement_State::num_children</a>, <a class="el" href="mesh__adapter_8h_source.html#l00039">AMR::mesh_adapter_t::tet_store</a>, and <a class="el" href="tet__store_8h_source.html#l00041">AMR::tet_store_t::tets</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00802">updateBndMesh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;{</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <a class="code" href="_macro_8h.html#a494f327b84ea26d04e3ad24251b4bbe0">IGNORE</a>(ref);  <span class="comment">// to avoid compiler warning when asserts are optimized away</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="keyword">using</span> Face = <a class="code" href="classtk_1_1_uns_mesh.html#ae8262763c870433021affc6bb5a0f804">tk::UnsMesh::Face</a>;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="comment">// storage for boundary faces associated to side-set IDs of the refined mesh</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  decltype(<a class="code" href="classinciter_1_1_refiner.html#a38dadaef73bf3db0af0fdaeadf87408c">m_bface</a>) bface;              <span class="comment">// will become m_bface</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// storage for boundary faces-node connectivity of the refined mesh</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  decltype(<a class="code" href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">m_triinpoel</a>) triinpoel;      <span class="comment">// will become m_triinpoel</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="comment">// face id counter</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  std::size_t facecnt = 0;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="comment">// Lambda to associate a boundary face and connectivity to a side set.</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="comment">// Parameter &#39;s&#39; is the list of faces (ids) to add new face to. Parameter &#39;f&#39;</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="comment">// is the triangle face connecttivity to add.</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keyword">auto</span> addBndFace = [ &amp;facecnt, &amp;triinpoel ]</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                    ( std::vector&lt; std::size_t &gt;&amp; s, <span class="keyword">const</span> Face&amp; f )</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  {</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    s.push_back( facecnt++ );</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    triinpoel.insert( end(triinpoel), begin(f), end(f) );</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  };</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="comment">// Lambda to find the nodes of the parent face of a child face. Argument</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">// &#39;face&#39; denotes the node ids of the child face whose parent face we are</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// looking for. This search may find 3 or 4 parent nodes, depending on whether</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">// the child shares or does not share a face with the parent tet,</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">// respectively.</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="keyword">auto</span> parentFace = [ &amp;old, this ]( <span class="keyword">const</span> Face&amp; face ){</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    std::unordered_set&lt; std::size_t &gt; s;<span class="comment">// will store nodes of parent face</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : face) {               <span class="comment">// for all 3 nodes of the face</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">if</span> (old.find(n) != end(old))      <span class="comment">// if child node found in old mesh,</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        s.insert( n );                  <span class="comment">// that node is also in the parent face</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordflow">else</span> {                            <span class="comment">// if child node is a newly added one</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="comment">// find its parent nodes and store both uniquely</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keyword">auto</span> p = this-&gt;<a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#a39da1e19190151486bf54ddf71a00fa1">node_connectivity</a>.<a class="code" href="class_a_m_r_1_1node__connectivity__t.html#a5be4453543c8ec6a6c3f8ad03df62876">get</a>( n );</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        s.insert( begin(p), end(p) );</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      }</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    }</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">// Ensure the number of parent nodes are correct</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( s.size() == 3 || s.size() == 4,</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <span class="stringliteral">&quot;Parent node list length must be 3 or 4&quot;</span> );</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// Ensure all parent nodes are part of the old (unrefined) mesh</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( std::all_of( begin(s), end(s), [ &amp;old ]( std::size_t j ){</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                           <span class="keywordflow">return</span> old.find(j) != end(old); } ),</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="stringliteral">&quot;Old face nodes not in old mesh&quot;</span> );</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">// Return unique set of nodes of the parent face of child face</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">return</span> s;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  };</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="comment">// Regenerate boundary faces after refinement step</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; f : bnd)     <span class="comment">// for all boundary faces</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">if</span> (f.second.first != -1) { <span class="comment">// for all physical boundary faces</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="comment">// construct face of old mesh boundary face using local ids</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      Face oldface{{ <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>, f.first[0] ),</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                     <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>, f.first[1] ),</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                     <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>, f.first[2] ) }};</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="comment">// will associate to side set id of old (unrefined) mesh boundary face</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="keyword">auto</span>&amp; sideface = bface[ f.second.first ];</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="comment">// query number of children of boundary tet adjacent to boundary face</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="keyword">auto</span> nc = <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#a42b0c354d6edd7b772c1844beb1c2f9a">tet_store</a>.<a class="code" href="class_a_m_r_1_1tet__store__t.html#ac7eaca5a0a6042c2c64553ba86afc6b7">data</a>( f.second.second ).<a class="code" href="class_a_m_r_1_1_refinement___state.html#a75696f5620781df9c0a2ffa689129131">num_children</a>;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="keywordflow">if</span> (nc == 0) {    <span class="comment">// if boundary tet is not refined, add its boundary face</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        addBndFace( sideface, f.first );</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      } <span class="keywordflow">else</span> {          <span class="comment">// if boundary tet is refined</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tets = <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#a42b0c354d6edd7b772c1844beb1c2f9a">tet_store</a>.<a class="code" href="class_a_m_r_1_1tet__store__t.html#a1908d4c25a05f43fbf5902df9649b913">tets</a>;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keywordflow">for</span> (decltype(nc) i=0; i&lt;nc; ++i ) {      <span class="comment">// for all child tets</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;          <span class="comment">// get child tet id</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;          <span class="keyword">auto</span> childtet = <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#a42b0c354d6edd7b772c1844beb1c2f9a">tet_store</a>.<a class="code" href="class_a_m_r_1_1tet__store__t.html#a52a7fb919a963dd10e21e56be3d18ff0">get_child_id</a>( f.second.second, i );</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;          <span class="keyword">auto</span> ct = tets.find( childtet );</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;          <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( ct != end(tets), <span class="stringliteral">&quot;Child tet not found&quot;</span> );</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          <span class="comment">// ensure all nodes of child tet are in refined mesh</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( ref.find(ct-&gt;second[0]) != end(ref) &amp;&amp;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                  ref.find(ct-&gt;second[1]) != end(ref) &amp;&amp;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                  ref.find(ct-&gt;second[2]) != end(ref) &amp;&amp;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                  ref.find(ct-&gt;second[3]) != end(ref),</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                  <span class="stringliteral">&quot;Boundary child tet node id not found in refined mesh&quot;</span> );</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;          <span class="comment">// get nodes of child tet</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;          <span class="keyword">auto</span> A = ct-&gt;second[0];</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;          <span class="keyword">auto</span> B = ct-&gt;second[1];</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;          <span class="keyword">auto</span> C = ct-&gt;second[2];</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          <span class="keyword">auto</span> D = ct-&gt;second[3];</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;          <span class="comment">// form all 4 faces of child tet</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;          std::array&lt;Face,4&gt; face{{{{A,C,B}}, {{A,B,D}}, {{A,D,C}}, {{B,C,D}}}};</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; rf : face) {   <span class="comment">// for all faces of child tet</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <span class="comment">// find nodes of the parent face of child face</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <span class="keyword">auto</span> parfac = parentFace( rf );</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <span class="comment">// if the child shares a face with its parent and all 3 nodes of the</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <span class="comment">// parent face of the child&#39;s face are the same, the child face is</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            <span class="comment">// on the same boundary as the parent face</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <span class="keywordflow">if</span> ( parfac.size() == 3 &amp;&amp;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                 parfac.find(oldface[0]) != end(parfac) &amp;&amp;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                 parfac.find(oldface[1]) != end(parfac) &amp;&amp;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                 parfac.find(oldface[2]) != end(parfac) )</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            {</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;              addBndFace(sideface, {{<a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a>[rf[2]],<a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a>[rf[1]],<a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a>[rf[0]]}});</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            }</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;          }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      }</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">// Update boundary face data structures</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a38dadaef73bf3db0af0fdaeadf87408c">m_bface</a> = std::move(bface);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">m_triinpoel</a> = std::move(triinpoel);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;}</div><div class="ttc" id="classtk_1_1_uns_mesh_html_ae8262763c870433021affc6bb5a0f804"><div class="ttname"><a href="classtk_1_1_uns_mesh.html#ae8262763c870433021affc6bb5a0f804">tk::UnsMesh::Face</a></div><div class="ttdeci">std::array&lt; std::size_t, 3 &gt; Face</div><div class="ttdoc">Face: node IDs of a triangle (tetrahedron face) </div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00056">UnsMesh.h:56</a></div></div>
<div class="ttc" id="class_a_m_r_1_1node__connectivity__t_html_a5be4453543c8ec6a6c3f8ad03df62876"><div class="ttname"><a href="class_a_m_r_1_1node__connectivity__t.html#a5be4453543c8ec6a6c3f8ad03df62876">AMR::node_connectivity_t::get</a></div><div class="ttdeci">node_pair_t get(size_t id)</div><div class="ttdoc">Getter into node storage. </div><div class="ttdef"><b>Definition:</b> <a href="node__connectivity_8h_source.html#l00055">node_connectivity.h:55</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a38dadaef73bf3db0af0fdaeadf87408c"><div class="ttname"><a href="classinciter_1_1_refiner.html#a38dadaef73bf3db0af0fdaeadf87408c">inciter::Refiner::m_bface</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_bface</div><div class="ttdoc">List of boundary faces associated to side-set IDs. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00151">Refiner.h:151</a></div></div>
<div class="ttc" id="class_a_m_r_1_1tet__store__t_html_ac7eaca5a0a6042c2c64553ba86afc6b7"><div class="ttname"><a href="class_a_m_r_1_1tet__store__t.html#ac7eaca5a0a6042c2c64553ba86afc6b7">AMR::tet_store_t::data</a></div><div class="ttdeci">Refinement_State &amp; data(size_t id)</div><div class="ttdef"><b>Definition:</b> <a href="tet__store_8h_source.html#l00069">tet_store.h:69</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_abe95236aea1ef5fb585930650e829015"><div class="ttname"><a href="classinciter_1_1_refiner.html#abe95236aea1ef5fb585930650e829015">inciter::Refiner::m_triinpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; m_triinpoel</div><div class="ttdoc">Boundary face-node connectivity. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00153">Refiner.h:153</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a972fbff38d8e36f96be02b7e0a092472"><div class="ttname"><a href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">inciter::Refiner::m_lid</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::size_t &gt; &amp; m_lid</div><div class="ttdoc">Alias to local node IDs associated to the global ones of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00145">Refiner.h:145</a></div></div>
<div class="ttc" id="class_a_m_r_1_1_refinement___state_html_a75696f5620781df9c0a2ffa689129131"><div class="ttname"><a href="class_a_m_r_1_1_refinement___state.html#a75696f5620781df9c0a2ffa689129131">AMR::Refinement_State::num_children</a></div><div class="ttdeci">size_t num_children</div><div class="ttdef"><b>Definition:</b> <a href="_refinement___state_8h_source.html#l00079">Refinement_State.h:79</a></div></div>
<div class="ttc" id="class_a_m_r_1_1tet__store__t_html_a1908d4c25a05f43fbf5902df9649b913"><div class="ttname"><a href="class_a_m_r_1_1tet__store__t.html#a1908d4c25a05f43fbf5902df9649b913">AMR::tet_store_t::tets</a></div><div class="ttdeci">tet_list_t tets</div><div class="ttdef"><b>Definition:</b> <a href="tet__store_8h_source.html#l00041">tet_store.h:41</a></div></div>
<div class="ttc" id="namespacetk_html_a2e002561a68875b091a264eb2a1e5f6c"><div class="ttname"><a href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a></div><div class="ttdeci">auto cref_find(const Container &amp;map, const typename Container::key_type &amp;key) -&gt; const typename Container::mapped_type &amp;</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00051">ContainerUtil.h:51</a></div></div>
<div class="ttc" id="class_a_m_r_1_1tet__store__t_html_a52a7fb919a963dd10e21e56be3d18ff0"><div class="ttname"><a href="class_a_m_r_1_1tet__store__t.html#a52a7fb919a963dd10e21e56be3d18ff0">AMR::tet_store_t::get_child_id</a></div><div class="ttdeci">size_t get_child_id(size_t parent_id, size_t offset)</div><div class="ttdef"><b>Definition:</b> <a href="tet__store_8h_source.html#l00677">tet_store.h:677</a></div></div>
<div class="ttc" id="_macro_8h_html_a494f327b84ea26d04e3ad24251b4bbe0"><div class="ttname"><a href="_macro_8h.html#a494f327b84ea26d04e3ad24251b4bbe0">IGNORE</a></div><div class="ttdeci">#define IGNORE(expr)</div><div class="ttdoc">This macro can be used to suppress compiler warning on unused variable. </div><div class="ttdef"><b>Definition:</b> <a href="_macro_8h_source.html#l00019">Macro.h:19</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a5636a971bbf52996e933493fc6a5aa07"><div class="ttname"><a href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">inciter::Refiner::m_gid</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_gid</div><div class="ttdoc">Alias to global node IDs of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00142">Refiner.h:142</a></div></div>
<div class="ttc" id="class_a_m_r_1_1mesh__adapter__t_html_a39da1e19190151486bf54ddf71a00fa1"><div class="ttname"><a href="class_a_m_r_1_1mesh__adapter__t.html#a39da1e19190151486bf54ddf71a00fa1">AMR::mesh_adapter_t::node_connectivity</a></div><div class="ttdeci">AMR::node_connectivity_t node_connectivity</div><div class="ttdef"><b>Definition:</b> <a href="mesh__adapter_8h_source.html#l00040">mesh_adapter.h:40</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a7e85879e386e8df4dc9b3291bd64eb70"><div class="ttname"><a href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">inciter::Refiner::m_refiner</a></div><div class="ttdeci">AMR::mesh_adapter_t m_refiner</div><div class="ttdoc">Mesh refiner (library) object. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00161">Refiner.h:161</a></div></div>
<div class="ttc" id="class_a_m_r_1_1mesh__adapter__t_html_a42b0c354d6edd7b772c1844beb1c2f9a"><div class="ttname"><a href="class_a_m_r_1_1mesh__adapter__t.html#a42b0c354d6edd7b772c1844beb1c2f9a">AMR::mesh_adapter_t::tet_store</a></div><div class="ttdeci">AMR::tet_store_t tet_store</div><div class="ttdef"><b>Definition:</b> <a href="mesh__adapter_8h_source.html#l00039">mesh_adapter.h:39</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a89c9de6672bef7eff8e0833a754582c7_cgraph.svg" width="100%" height="457"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="adc369f20f8b77201f47252ddb8b77c53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc369f20f8b77201f47252ddb8b77c53">&#9670;&nbsp;</a></span>updateBndMesh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::updateBndMesh </td>
          <td>(</td>
          <td class="paramtype">const std::unordered_set&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unordered_set&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>ref</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update boundary data structures after mesh refinement. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">old</td><td>Unique nodes of the old (unrefined) mesh using local ids </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>Unique nodes of the refined mesh using local ids </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00802">802</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_refiner_8_c_source.html#l00733">boundary()</a>, <a class="el" href="_refiner_8_c_source.html#l00819">updateBndFaces()</a>, and <a class="el" href="_refiner_8_c_source.html#l00935">updateBndNodes()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;{</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="comment">// generate boundary data structure after mesh refinement</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keyword">auto</span> bnd = <a class="code" href="classinciter_1_1_refiner.html#ac8448c88661a15ab79792dc9a43c53c6">boundary</a>();</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="comment">// regerate boundary faces and nodes after mesh refinement</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a89c9de6672bef7eff8e0833a754582c7">updateBndFaces</a>( old, ref, bnd );</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#ab9017cbb24f0a70a5f33d0174c1a7c2a">updateBndNodes</a>( old, ref, bnd );</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_ac8448c88661a15ab79792dc9a43c53c6"><div class="ttname"><a href="classinciter_1_1_refiner.html#ac8448c88661a15ab79792dc9a43c53c6">inciter::Refiner::boundary</a></div><div class="ttdeci">BndFaces boundary()</div><div class="ttdoc">Generate boundary data structures after mesh refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00733">Refiner.C:733</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ab9017cbb24f0a70a5f33d0174c1a7c2a"><div class="ttname"><a href="classinciter_1_1_refiner.html#ab9017cbb24f0a70a5f33d0174c1a7c2a">inciter::Refiner::updateBndNodes</a></div><div class="ttdeci">void updateBndNodes(const std::unordered_set&lt; std::size_t &gt; &amp;old, const std::unordered_set&lt; std::size_t &gt; &amp;ref, const BndFaces &amp;bnd)</div><div class="ttdoc">Regenerate boundary nodes after mesh refinement step. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00935">Refiner.C:935</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a89c9de6672bef7eff8e0833a754582c7"><div class="ttname"><a href="classinciter_1_1_refiner.html#a89c9de6672bef7eff8e0833a754582c7">inciter::Refiner::updateBndFaces</a></div><div class="ttdeci">void updateBndFaces(const std::unordered_set&lt; std::size_t &gt; &amp;old, const std::unordered_set&lt; std::size_t &gt; &amp;ref, const BndFaces &amp;bnd)</div><div class="ttdoc">Regenerate boundary faces after mesh refinement step. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00819">Refiner.C:819</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_adc369f20f8b77201f47252ddb8b77c53_cgraph.svg" width="100%" height="568"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ab9017cbb24f0a70a5f33d0174c1a7c2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9017cbb24f0a70a5f33d0174c1a7c2a">&#9670;&nbsp;</a></span>updateBndNodes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::updateBndNodes </td>
          <td>(</td>
          <td class="paramtype">const std::unordered_set&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unordered_set&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classinciter_1_1_refiner.html#a3a8ba2c58baf8faa11dfb175967e7b2b">BndFaces</a> &amp;&#160;</td>
          <td class="paramname"><em>bnd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Regenerate boundary nodes after mesh refinement step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">old</td><td>Unique nodes of the old (unrefined) mesh using local ids </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>Unique nodes of the refined mesh using local ids </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bnd</td><td>Boundary face map, associating a pair of side set id and adjacent tet id to a boundary triangle face </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00935">935</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="tet__store_8h_source.html#l00069">AMR::tet_store_t::data()</a>, <a class="el" href="node__connectivity_8h_source.html#l00055">AMR::node_connectivity_t::get()</a>, <a class="el" href="tet__store_8h_source.html#l00677">AMR::tet_store_t::get_child_id()</a>, <a class="el" href="_macro_8h_source.html#l00019">IGNORE</a>, <a class="el" href="_refiner_8h_source.html#l00155">m_bnode</a>, <a class="el" href="_refiner_8h_source.html#l00142">m_gid</a>, <a class="el" href="_refiner_8h_source.html#l00161">m_refiner</a>, <a class="el" href="mesh__adapter_8h_source.html#l00040">AMR::mesh_adapter_t::node_connectivity</a>, <a class="el" href="_refinement___state_8h_source.html#l00079">AMR::Refinement_State::num_children</a>, <a class="el" href="mesh__adapter_8h_source.html#l00039">AMR::mesh_adapter_t::tet_store</a>, <a class="el" href="tet__store_8h_source.html#l00041">AMR::tet_store_t::tets</a>, and <a class="el" href="_container_util_8h_source.html#l00023">tk::unique()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00802">updateBndMesh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;{</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <a class="code" href="_macro_8h.html#a494f327b84ea26d04e3ad24251b4bbe0">IGNORE</a>(ref);  <span class="comment">// to avoid compiler warning when asserts are optimized away</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keyword">using</span> Edge = <a class="code" href="classtk_1_1_uns_mesh.html#a622c34bab099c772650f046b848346d7">tk::UnsMesh::Edge</a>;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">// storage for boundary nodes associated to side-set IDs of the refined mesh</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  decltype(<a class="code" href="classinciter_1_1_refiner.html#a8f752bc3a870aea2138683b778a9c6ee">m_bnode</a>) bnode;              <span class="comment">// will become m_node</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="comment">// Generate unique set of nodes for each side set</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  std::unordered_map&lt; int, std::unordered_set&lt; std::size_t &gt; &gt; bnodeset;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; ss : <a class="code" href="classinciter_1_1_refiner.html#a8f752bc3a870aea2138683b778a9c6ee">m_bnode</a>)  <span class="comment">// for all phsyical boundaries (sidesets)</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    bnodeset[ ss.first ].insert( begin(ss.second), end(ss.second) );</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="comment">// Lambda to find the nodes of the parent edge of a node</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keyword">auto</span> parentEdge = [ &amp;old, this ]( std::size_t c ) -&gt; Edge {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">if</span> (old.find(c) != end(old)) <span class="comment">// if node is in old mesh, return doubled input</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <span class="keywordflow">return</span> {{ c, c }};</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keywordflow">return</span> this-&gt;<a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#a39da1e19190151486bf54ddf71a00fa1">node_connectivity</a>.<a class="code" href="class_a_m_r_1_1node__connectivity__t.html#a5be4453543c8ec6a6c3f8ad03df62876">get</a>( c );</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  };</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="comment">// Lambda to find a global node ID among the nodelists of side sets. Return -1</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="comment">// if not found, or all the side set ids in which the node is found.</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keyword">auto</span> bndNode = [ &amp;bnodeset ]( std::size_t p ){</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    std::vector&lt; int &gt; ss;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; s : bnodeset)  <span class="comment">// for all phsyical boundaries (sidesets)</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keywordflow">if</span> (s.second.find(p) != end(s.second))</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        ss.push_back( s.first );</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">return</span> ss;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  };</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="comment">// Regenerate boundary node lists after refinement step</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; f : bnd) {</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="comment">// query number of children of boundary tet adjacent to boundary face</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keyword">auto</span> nc = <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#a42b0c354d6edd7b772c1844beb1c2f9a">tet_store</a>.<a class="code" href="class_a_m_r_1_1tet__store__t.html#ac7eaca5a0a6042c2c64553ba86afc6b7">data</a>( f.second.second ).<a class="code" href="class_a_m_r_1_1_refinement___state.html#a75696f5620781df9c0a2ffa689129131">num_children</a>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">if</span> (nc == 0) {      <span class="comment">// if boundary tet is not refined, add its boundary face</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : f.first) {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keyword">auto</span> ss = bndNode( n );</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : ss) <span class="keywordflow">if</span> (s != -1) bnode[ s ].push_back( n );</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    } <span class="keywordflow">else</span> {            <span class="comment">// if boundary tet is refined</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tets = <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#a42b0c354d6edd7b772c1844beb1c2f9a">tet_store</a>.<a class="code" href="class_a_m_r_1_1tet__store__t.html#a1908d4c25a05f43fbf5902df9649b913">tets</a>;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="keywordflow">for</span> (decltype(nc) i=0; i&lt;nc; ++i ) {      <span class="comment">// for all child tets</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="comment">// get child tet id</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keyword">auto</span> childtet = <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#a42b0c354d6edd7b772c1844beb1c2f9a">tet_store</a>.<a class="code" href="class_a_m_r_1_1tet__store__t.html#a52a7fb919a963dd10e21e56be3d18ff0">get_child_id</a>( f.second.second, i );</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keyword">auto</span> ct = tets.find( childtet );</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( ct != end(tets), <span class="stringliteral">&quot;Child tet not found&quot;</span> );</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="comment">// ensure all nodes of child tet are in refined mesh</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( ref.find(ct-&gt;second[0]) != end(ref) &amp;&amp;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                ref.find(ct-&gt;second[1]) != end(ref) &amp;&amp;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                ref.find(ct-&gt;second[2]) != end(ref) &amp;&amp;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                ref.find(ct-&gt;second[3]) != end(ref),</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                <span class="stringliteral">&quot;Boundary child tet node id not found in refined mesh&quot;</span> );</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="comment">// get nodes of child tet</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="keyword">auto</span> A = ct-&gt;second[0];</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="keyword">auto</span> B = ct-&gt;second[1];</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keyword">auto</span> C = ct-&gt;second[2];</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keyword">auto</span> D = ct-&gt;second[3];</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="comment">// form all 6 edges of child tet</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        std::array&lt;Edge,6&gt; edge{{ {{A,B}}, {{B,C}}, {{A,C}},</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                  {{A,D}}, {{B,D}}, {{C,D}} }};</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; re : edge)</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : re) {</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            <span class="keyword">auto</span> p = parentEdge( c );</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            <span class="keyword">auto</span> ss1 = bndNode( <a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a>[p[0]] );</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            <span class="keyword">auto</span> ss2 = bndNode( <a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a>[p[1]] );</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> s1 : ss1)</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">auto</span> s2 : ss2)</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                <span class="keywordflow">if</span> (s1 != -1 &amp;&amp; s2 != -1 &amp;&amp; s1 == s2)</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                  bnode[ s1 ].push_back( <a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a>[c] );</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          }</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      }</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    }</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  }</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="comment">// Make boundary node IDs unique for each physical boundary (side set)</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; s : bnode) <a class="code" href="namespacetk.html#a87af1b002bc711716bd170a714bda211">tk::unique</a>( s.second );</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="comment">// Update boundary node lists</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  m_bnode = std::move(bnode);</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;}</div><div class="ttc" id="class_a_m_r_1_1node__connectivity__t_html_a5be4453543c8ec6a6c3f8ad03df62876"><div class="ttname"><a href="class_a_m_r_1_1node__connectivity__t.html#a5be4453543c8ec6a6c3f8ad03df62876">AMR::node_connectivity_t::get</a></div><div class="ttdeci">node_pair_t get(size_t id)</div><div class="ttdoc">Getter into node storage. </div><div class="ttdef"><b>Definition:</b> <a href="node__connectivity_8h_source.html#l00055">node_connectivity.h:55</a></div></div>
<div class="ttc" id="class_a_m_r_1_1tet__store__t_html_ac7eaca5a0a6042c2c64553ba86afc6b7"><div class="ttname"><a href="class_a_m_r_1_1tet__store__t.html#ac7eaca5a0a6042c2c64553ba86afc6b7">AMR::tet_store_t::data</a></div><div class="ttdeci">Refinement_State &amp; data(size_t id)</div><div class="ttdef"><b>Definition:</b> <a href="tet__store_8h_source.html#l00069">tet_store.h:69</a></div></div>
<div class="ttc" id="class_a_m_r_1_1_refinement___state_html_a75696f5620781df9c0a2ffa689129131"><div class="ttname"><a href="class_a_m_r_1_1_refinement___state.html#a75696f5620781df9c0a2ffa689129131">AMR::Refinement_State::num_children</a></div><div class="ttdeci">size_t num_children</div><div class="ttdef"><b>Definition:</b> <a href="_refinement___state_8h_source.html#l00079">Refinement_State.h:79</a></div></div>
<div class="ttc" id="class_a_m_r_1_1tet__store__t_html_a1908d4c25a05f43fbf5902df9649b913"><div class="ttname"><a href="class_a_m_r_1_1tet__store__t.html#a1908d4c25a05f43fbf5902df9649b913">AMR::tet_store_t::tets</a></div><div class="ttdeci">tet_list_t tets</div><div class="ttdef"><b>Definition:</b> <a href="tet__store_8h_source.html#l00041">tet_store.h:41</a></div></div>
<div class="ttc" id="namespacetk_html_a87af1b002bc711716bd170a714bda211"><div class="ttname"><a href="namespacetk.html#a87af1b002bc711716bd170a714bda211">tk::unique</a></div><div class="ttdeci">void unique(Container &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00023">ContainerUtil.h:23</a></div></div>
<div class="ttc" id="classtk_1_1_uns_mesh_html_a622c34bab099c772650f046b848346d7"><div class="ttname"><a href="classtk_1_1_uns_mesh.html#a622c34bab099c772650f046b848346d7">tk::UnsMesh::Edge</a></div><div class="ttdeci">std::array&lt; std::size_t, 2 &gt; Edge</div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00054">UnsMesh.h:54</a></div></div>
<div class="ttc" id="class_a_m_r_1_1tet__store__t_html_a52a7fb919a963dd10e21e56be3d18ff0"><div class="ttname"><a href="class_a_m_r_1_1tet__store__t.html#a52a7fb919a963dd10e21e56be3d18ff0">AMR::tet_store_t::get_child_id</a></div><div class="ttdeci">size_t get_child_id(size_t parent_id, size_t offset)</div><div class="ttdef"><b>Definition:</b> <a href="tet__store_8h_source.html#l00677">tet_store.h:677</a></div></div>
<div class="ttc" id="_macro_8h_html_a494f327b84ea26d04e3ad24251b4bbe0"><div class="ttname"><a href="_macro_8h.html#a494f327b84ea26d04e3ad24251b4bbe0">IGNORE</a></div><div class="ttdeci">#define IGNORE(expr)</div><div class="ttdoc">This macro can be used to suppress compiler warning on unused variable. </div><div class="ttdef"><b>Definition:</b> <a href="_macro_8h_source.html#l00019">Macro.h:19</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a5636a971bbf52996e933493fc6a5aa07"><div class="ttname"><a href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">inciter::Refiner::m_gid</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_gid</div><div class="ttdoc">Alias to global node IDs of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00142">Refiner.h:142</a></div></div>
<div class="ttc" id="class_a_m_r_1_1mesh__adapter__t_html_a39da1e19190151486bf54ddf71a00fa1"><div class="ttname"><a href="class_a_m_r_1_1mesh__adapter__t.html#a39da1e19190151486bf54ddf71a00fa1">AMR::mesh_adapter_t::node_connectivity</a></div><div class="ttdeci">AMR::node_connectivity_t node_connectivity</div><div class="ttdef"><b>Definition:</b> <a href="mesh__adapter_8h_source.html#l00040">mesh_adapter.h:40</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a7e85879e386e8df4dc9b3291bd64eb70"><div class="ttname"><a href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">inciter::Refiner::m_refiner</a></div><div class="ttdeci">AMR::mesh_adapter_t m_refiner</div><div class="ttdoc">Mesh refiner (library) object. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00161">Refiner.h:161</a></div></div>
<div class="ttc" id="class_a_m_r_1_1mesh__adapter__t_html_a42b0c354d6edd7b772c1844beb1c2f9a"><div class="ttname"><a href="class_a_m_r_1_1mesh__adapter__t.html#a42b0c354d6edd7b772c1844beb1c2f9a">AMR::mesh_adapter_t::tet_store</a></div><div class="ttdeci">AMR::tet_store_t tet_store</div><div class="ttdef"><b>Definition:</b> <a href="mesh__adapter_8h_source.html#l00039">mesh_adapter.h:39</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a8f752bc3a870aea2138683b778a9c6ee"><div class="ttname"><a href="classinciter_1_1_refiner.html#a8f752bc3a870aea2138683b778a9c6ee">inciter::Refiner::m_bnode</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_bnode</div><div class="ttdoc">List of boundary nodes associated to side-set IDs. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00155">Refiner.h:155</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_ab9017cbb24f0a70a5f33d0174c1a7c2a_cgraph.svg" width="100%" height="462"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a2aa26e2c8cf1618a0452b8803c53637f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2aa26e2c8cf1618a0452b8803c53637f">&#9670;&nbsp;</a></span>updateMesh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::updateMesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update mesh after refinement. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00635">635</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_refiner_8_c_source.html#l00108">flatcoord()</a>, <a class="el" href="_derived_data_8_c_source.html#l00934">tk::genEsuelTet()</a>, <a class="el" href="_derived_data_8_c_source.html#l00042">tk::genEsup()</a>, <a class="el" href="tet__store_8h_source.html#l00390">AMR::tet_store_t::get_active_inpoel()</a>, <a class="el" href="_derived_data_8_c_source.html#l01496">tk::leakyPartition()</a>, <a class="el" href="_refiner_8h_source.html#l00149">m_coord</a>, <a class="el" href="_refiner_8h_source.html#l00147">m_coordmap</a>, <a class="el" href="_refiner_8h_source.html#l00142">m_gid</a>, <a class="el" href="_refiner_8h_source.html#l00131">m_ginpoel</a>, <a class="el" href="_refiner_8h_source.html#l00140">m_inpoel</a>, <a class="el" href="_refiner_8h_source.html#l00161">m_refiner</a>, <a class="el" href="mesh__adapter_8h_source.html#l00039">AMR::mesh_adapter_t::tet_store</a>, <a class="el" href="_container_util_8h_source.html#l00038">tk::uniquecopy()</a>, <a class="el" href="_refiner_8_c_source.html#l00802">updateBndMesh()</a>, and <a class="el" href="_refiner_8_c_source.html#l00673">updateVolMesh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00614">correctRefine()</a>, <a class="el" href="_refiner_8_c_source.html#l00465">errorRefine()</a>, <a class="el" href="_refiner_8_c_source.html#l00448">uniformRefine()</a>, and <a class="el" href="_refiner_8_c_source.html#l00515">userRefine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;{</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">// Get refined mesh connectivity</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; refinpoel = <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#a42b0c354d6edd7b772c1844beb1c2f9a">tet_store</a>.<a class="code" href="class_a_m_r_1_1tet__store__t.html#a7830d3dfc073a529263217de9f23ada4">get_active_inpoel</a>();</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( refinpoel.size()%4 == 0, <span class="stringliteral">&quot;Inconsistent refined mesh connectivity&quot;</span> );</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="comment">// Generate unique node lists of old and refined mesh using local ids</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  std::unordered_set&lt; std::size_t &gt; old( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>.cbegin(), <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>.cend() );</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  std::unordered_set&lt; std::size_t &gt; ref( refinpoel.cbegin(), refinpoel.cend() );</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a045d5cea6d191dcb04a9f3c2931cd0a8">updateVolMesh</a>( old, ref );</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#adc369f20f8b77201f47252ddb8b77c53">updateBndMesh</a>( old, ref );</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="comment">// Update mesh connectivity with local node IDs</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a> = refinpoel;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="comment">// Update mesh connectivity with new global node ids</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a> = <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="namespacetk.html#a33be2bf221a519d736333a9f18c8ffdc">tk::uniquecopy</a>(<a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>).size() == <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a>[0].size(),</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; i : <a class="code" href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">m_ginpoel</a>) i = <a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a>[i];</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="comment">// Update flat coordinates storage</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a> = <a class="code" href="classinciter_1_1_refiner.html#a612f34f5b2817de0bf118e85c89c116e">flatcoord</a>( <a class="code" href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">m_coordmap</a> );</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">// Perform leak test on new mesh</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( !<a class="code" href="namespacetk.html#a8b04469b1f0015a5322697e83617ca6d">tk::leakyPartition</a>(</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <a class="code" href="namespacetk.html#a5b61b3cb6492e71ff9853404440fddcc">tk::genEsuelTet</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, <a class="code" href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a>(<a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>,4) ),</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a> ),</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;          <span class="stringliteral">&quot;Refined mesh partition leaky&quot;</span> );</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">//std::cout &lt;&lt; &quot;----------------\n&quot;;</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_a6bc91e28516a27aea998ae384715707f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">inciter::Refiner::m_inpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_inpoel</div><div class="ttdoc">Alias to element connectivity with local node IDs in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00140">Refiner.h:140</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_ae736705da5f6217e06153112e2038b2e"><div class="ttname"><a href="classinciter_1_1_refiner.html#ae736705da5f6217e06153112e2038b2e">inciter::Refiner::m_ginpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; m_ginpoel</div><div class="ttdoc">Tetrtahedron element connectivity of our chunk of the mesh (global ids) </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00131">Refiner.h:131</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_adc369f20f8b77201f47252ddb8b77c53"><div class="ttname"><a href="classinciter_1_1_refiner.html#adc369f20f8b77201f47252ddb8b77c53">inciter::Refiner::updateBndMesh</a></div><div class="ttdeci">void updateBndMesh(const std::unordered_set&lt; std::size_t &gt; &amp;old, const std::unordered_set&lt; std::size_t &gt; &amp;ref)</div><div class="ttdoc">Update boundary data structures after mesh refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00802">Refiner.C:802</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a612f34f5b2817de0bf118e85c89c116e"><div class="ttname"><a href="classinciter_1_1_refiner.html#a612f34f5b2817de0bf118e85c89c116e">inciter::Refiner::flatcoord</a></div><div class="ttdeci">tk::UnsMesh::Coords flatcoord(const tk::UnsMesh::CoordMap &amp;coordmap)</div><div class="ttdoc">Generate flat coordinate data from coordinate map. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00108">Refiner.C:108</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a0dbe0d53033cee33b057f32f8a65ba58"><div class="ttname"><a href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">inciter::Refiner::m_coordmap</a></div><div class="ttdeci">tk::UnsMesh::CoordMap m_coordmap</div><div class="ttdoc">Coordinates associated to global node IDs of our mesh chunk. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00147">Refiner.h:147</a></div></div>
<div class="ttc" id="namespacetk_html_a8b04469b1f0015a5322697e83617ca6d"><div class="ttname"><a href="namespacetk.html#a8b04469b1f0015a5322697e83617ca6d">tk::leakyPartition</a></div><div class="ttdeci">bool leakyPartition(const std::vector&lt; int &gt; &amp;esueltet, const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::UnsMesh::Coords &amp;coord)</div><div class="ttdoc">Perform leak-test on mesh (partition) </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l01496">DerivedData.C:1496</a></div></div>
<div class="ttc" id="namespacetk_html_a5b61b3cb6492e71ff9853404440fddcc"><div class="ttname"><a href="namespacetk.html#a5b61b3cb6492e71ff9853404440fddcc">tk::genEsuelTet</a></div><div class="ttdeci">std::vector&lt; int &gt; genEsuelTet(const std::vector&lt; std::size_t &gt; &amp;inpoel, const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;esup)</div><div class="ttdoc">Generate derived data structure, elements surrounding elements as a fixed length data structure as a ...</div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00934">DerivedData.C:934</a></div></div>
<div class="ttc" id="namespacetk_html_a33be2bf221a519d736333a9f18c8ffdc"><div class="ttname"><a href="namespacetk.html#a33be2bf221a519d736333a9f18c8ffdc">tk::uniquecopy</a></div><div class="ttdeci">Container uniquecopy(const Container &amp;src)</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00038">ContainerUtil.h:38</a></div></div>
<div class="ttc" id="namespacetk_html_a66a2889d5d8aeb4a836842c6a1010463"><div class="ttname"><a href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; genEsup(const std::vector&lt; std::size_t &gt; &amp;inpoel, std::size_t nnpe)</div><div class="ttdoc">Generate derived data structure, elements surrounding points. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00042">DerivedData.C:42</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a045d5cea6d191dcb04a9f3c2931cd0a8"><div class="ttname"><a href="classinciter_1_1_refiner.html#a045d5cea6d191dcb04a9f3c2931cd0a8">inciter::Refiner::updateVolMesh</a></div><div class="ttdeci">void updateVolMesh(const std::unordered_set&lt; std::size_t &gt; &amp;old, const std::unordered_set&lt; std::size_t &gt; &amp;ref)</div><div class="ttdoc">Update volume mesh after mesh refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00673">Refiner.C:673</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a5636a971bbf52996e933493fc6a5aa07"><div class="ttname"><a href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">inciter::Refiner::m_gid</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_gid</div><div class="ttdoc">Alias to global node IDs of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00142">Refiner.h:142</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a7e85879e386e8df4dc9b3291bd64eb70"><div class="ttname"><a href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">inciter::Refiner::m_refiner</a></div><div class="ttdeci">AMR::mesh_adapter_t m_refiner</div><div class="ttdoc">Mesh refiner (library) object. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00161">Refiner.h:161</a></div></div>
<div class="ttc" id="class_a_m_r_1_1tet__store__t_html_a7830d3dfc073a529263217de9f23ada4"><div class="ttname"><a href="class_a_m_r_1_1tet__store__t.html#a7830d3dfc073a529263217de9f23ada4">AMR::tet_store_t::get_active_inpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; get_active_inpoel()</div><div class="ttdoc">Function to extract only the active elements from tetinpeol. </div><div class="ttdef"><b>Definition:</b> <a href="tet__store_8h_source.html#l00390">tet_store.h:390</a></div></div>
<div class="ttc" id="class_a_m_r_1_1mesh__adapter__t_html_a42b0c354d6edd7b772c1844beb1c2f9a"><div class="ttname"><a href="class_a_m_r_1_1mesh__adapter__t.html#a42b0c354d6edd7b772c1844beb1c2f9a">AMR::mesh_adapter_t::tet_store</a></div><div class="ttdeci">AMR::tet_store_t tet_store</div><div class="ttdef"><b>Definition:</b> <a href="mesh__adapter_8h_source.html#l00039">mesh_adapter.h:39</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_aec812331b2bc9bfc51ed8c48906204fe"><div class="ttname"><a href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">inciter::Refiner::m_coord</a></div><div class="ttdeci">tk::UnsMesh::Coords m_coord</div><div class="ttdoc">Coordinates of mesh nodes of our chunk of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00149">Refiner.h:149</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a2aa26e2c8cf1618a0452b8803c53637f_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a045d5cea6d191dcb04a9f3c2931cd0a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a045d5cea6d191dcb04a9f3c2931cd0a8">&#9670;&nbsp;</a></span>updateVolMesh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::updateVolMesh </td>
          <td>(</td>
          <td class="paramtype">const std::unordered_set&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unordered_set&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>ref</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update volume mesh after mesh refinement. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">old</td><td>Unique nodes of the old (unrefined) mesh using local ids </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>Unique nodes of the refined mesh using local ids </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00673">673</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="node__connectivity_8h_source.html#l00055">AMR::node_connectivity_t::get()</a>, <a class="el" href="_refiner_8h_source.html#l00149">m_coord</a>, <a class="el" href="_refiner_8h_source.html#l00147">m_coordmap</a>, <a class="el" href="_refiner_8h_source.html#l00169">m_edgenode</a>, <a class="el" href="_refiner_8h_source.html#l00142">m_gid</a>, <a class="el" href="_refiner_8h_source.html#l00145">m_lid</a>, <a class="el" href="_refiner_8h_source.html#l00161">m_refiner</a>, <a class="el" href="_data_8h_source.html#l00603">tk::max()</a>, <a class="el" href="mesh__adapter_8h_source.html#l00040">AMR::mesh_adapter_t::node_connectivity</a>, and <a class="el" href="_derived_data_8_c_source.html#l00029">tk::npoin()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;{</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keyword">auto</span>&amp; x = <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a>[0];</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keyword">auto</span>&amp; y = <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a>[1];</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keyword">auto</span>&amp; z = <a class="code" href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">m_coord</a>[2];</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="comment">// Resize node coordinate storage to accommodate refined mesh nodes</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a> = ref.size();</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  x.resize( <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a> );</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  y.resize( <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a> );</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  z.resize( <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a> );</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a>.resize( <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a>, <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">std::numeric_limits&lt; std::size_t &gt;::max</a>() );</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="comment">// Generate coordinates and ids to newly added nodes after refinement step</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> r : ref) {               <span class="comment">// for all unique nodes of the refined mesh</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">if</span> (old.find(r) == end(old)) {   <span class="comment">// if node is newly added (in this step)</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="comment">// get (local) parent ids of newly added node</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keyword">auto</span> p = <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#a39da1e19190151486bf54ddf71a00fa1">node_connectivity</a>.<a class="code" href="class_a_m_r_1_1node__connectivity__t.html#a5be4453543c8ec6a6c3f8ad03df62876">get</a>( r );</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( old.find(p[0]) != end(old) &amp;&amp; old.find(p[1]) != end(old),</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;              <span class="stringliteral">&quot;Parent(s) not in old mesh&quot;</span> );</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( r &gt;= old.size(), <span class="stringliteral">&quot;Attempting to overwrite node with added one&quot;</span> );</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="comment">// generate coordinates for newly added node</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      x[r] = (x[p[0]] + x[p[1]])/2.0;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      y[r] = (y[p[0]] + y[p[1]])/2.0;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      z[r] = (z[p[0]] + z[p[1]])/2.0;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      decltype(p) gp{{ <a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a>[p[0]], <a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a>[p[1]] }}; <span class="comment">// global parent ids</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <span class="comment">// generate new global ID for newly added node</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keyword">auto</span> g = <a class="code" href="structtk_1_1_uns_mesh_1_1_hash.html">tk::UnsMesh::Hash&lt;2&gt;</a>()( gp );</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="comment">// ensure newly generated node id has not yet been used</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( g &gt;= old.size(), <span class="stringliteral">&quot;Hashed id overwriting old id&quot;</span> );</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">m_coordmap</a>.find(g) == end(<a class="code" href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">m_coordmap</a>),</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;              <span class="stringliteral">&quot;Hash collision: ID already exist&quot;</span> );</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="comment">// assign new global ids to local-&gt;global and to global-&gt;local maps</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <a class="code" href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">m_gid</a>[r] = g;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>.find(g) == end(<a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>),</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;              <span class="stringliteral">&quot;Overwriting entry global-&gt;local node ID map&quot;</span> );</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <a class="code" href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">m_lid</a>[g] = r;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="comment">// assign new coordinates to new global node id</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">m_coordmap</a>.find(g) == end(<a class="code" href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">m_coordmap</a>),</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;              <span class="stringliteral">&quot;Overwriting entry coordmap&quot;</span> );</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <a class="code" href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">m_coordmap</a>.insert( {g, {{x[r], y[r], z[r]}}} );</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="comment">// assign new coordinates and new global node id to global parent id pair</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <a class="code" href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">m_edgenode</a>[ gp ] = std::make_tuple( g, x[r], y[r], z[r] );</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( m_gid.size() == m_lid.size(), <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( std::none_of( begin(m_gid), end(m_gid), [](std::size_t i){</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="keywordflow">return</span> i == <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">std::numeric_limits&lt; std::size_t &gt;::max</a>(); } ),</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;          <span class="stringliteral">&quot;Not all local-&gt;global node IDs have been assigned&quot;</span> );</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;}</div><div class="ttc" id="class_a_m_r_1_1node__connectivity__t_html_a5be4453543c8ec6a6c3f8ad03df62876"><div class="ttname"><a href="class_a_m_r_1_1node__connectivity__t.html#a5be4453543c8ec6a6c3f8ad03df62876">AMR::node_connectivity_t::get</a></div><div class="ttdeci">node_pair_t get(size_t id)</div><div class="ttdoc">Getter into node storage. </div><div class="ttdef"><b>Definition:</b> <a href="node__connectivity_8h_source.html#l00055">node_connectivity.h:55</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a5af0df1e55bc32f0cdfd29f72d427f43"><div class="ttname"><a href="classinciter_1_1_refiner.html#a5af0df1e55bc32f0cdfd29f72d427f43">inciter::Refiner::m_edgenode</a></div><div class="ttdeci">tk::UnsMesh::EdgeNodeCoord m_edgenode</div><div class="ttdoc">Map associating global IDs and coordinates of a node added to an edge. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00169">Refiner.h:169</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a972fbff38d8e36f96be02b7e0a092472"><div class="ttname"><a href="classinciter_1_1_refiner.html#a972fbff38d8e36f96be02b7e0a092472">inciter::Refiner::m_lid</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::size_t &gt; &amp; m_lid</div><div class="ttdoc">Alias to local node IDs associated to the global ones of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00145">Refiner.h:145</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a0dbe0d53033cee33b057f32f8a65ba58"><div class="ttname"><a href="classinciter_1_1_refiner.html#a0dbe0d53033cee33b057f32f8a65ba58">inciter::Refiner::m_coordmap</a></div><div class="ttdeci">tk::UnsMesh::CoordMap m_coordmap</div><div class="ttdoc">Coordinates associated to global node IDs of our mesh chunk. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00147">Refiner.h:147</a></div></div>
<div class="ttc" id="namespacetk_html_abdd71f3e10edf6e1a8d047478abd488c"><div class="ttname"><a href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">tk::npoin</a></div><div class="ttdeci">std::size_t npoin(const std::vector&lt; std::size_t &gt; &amp;inpoel)</div><div class="ttdoc">Compute number of points (nodes) in mesh from connectivity. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00029">DerivedData.C:29</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a5636a971bbf52996e933493fc6a5aa07"><div class="ttname"><a href="classinciter_1_1_refiner.html#a5636a971bbf52996e933493fc6a5aa07">inciter::Refiner::m_gid</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_gid</div><div class="ttdoc">Alias to global node IDs of owned elements in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00142">Refiner.h:142</a></div></div>
<div class="ttc" id="namespacetk_html_ac9a26e30d19b940a12990a866a514cb5"><div class="ttname"><a href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">tk::max</a></div><div class="ttdeci">Data&lt; Layout &gt; max(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00603">Data.h:603</a></div></div>
<div class="ttc" id="class_a_m_r_1_1mesh__adapter__t_html_a39da1e19190151486bf54ddf71a00fa1"><div class="ttname"><a href="class_a_m_r_1_1mesh__adapter__t.html#a39da1e19190151486bf54ddf71a00fa1">AMR::mesh_adapter_t::node_connectivity</a></div><div class="ttdeci">AMR::node_connectivity_t node_connectivity</div><div class="ttdef"><b>Definition:</b> <a href="mesh__adapter_8h_source.html#l00040">mesh_adapter.h:40</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a7e85879e386e8df4dc9b3291bd64eb70"><div class="ttname"><a href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">inciter::Refiner::m_refiner</a></div><div class="ttdeci">AMR::mesh_adapter_t m_refiner</div><div class="ttdoc">Mesh refiner (library) object. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00161">Refiner.h:161</a></div></div>
<div class="ttc" id="structtk_1_1_uns_mesh_1_1_hash_html"><div class="ttname"><a href="structtk_1_1_uns_mesh_1_1_hash.html">tk::UnsMesh::Hash</a></div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00065">UnsMesh.h:65</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_aec812331b2bc9bfc51ed8c48906204fe"><div class="ttname"><a href="classinciter_1_1_refiner.html#aec812331b2bc9bfc51ed8c48906204fe">inciter::Refiner::m_coord</a></div><div class="ttdeci">tk::UnsMesh::Coords m_coord</div><div class="ttdoc">Coordinates of mesh nodes of our chunk of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00149">Refiner.h:149</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a045d5cea6d191dcb04a9f3c2931cd0a8_cgraph.svg" width="558" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a06a9b9f3a4fe8c6f3da9a1ff6d580cb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06a9b9f3a4fe8c6f3da9a1ff6d580cb3">&#9670;&nbsp;</a></span>userRefine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Refiner::userRefine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Do mesh refinement based on user explicitly tagging edges. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8_c_source.html#l00515">515</a> of file <a class="el" href="_refiner_8_c_source.html">Refiner.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="mesh__adapter_8_c_source.html#l00060">AMR::mesh_adapter_t::error_refinement()</a>, <a class="el" href="_d_g_8_c_source.html#l00028">inciter::g_inputdeck</a>, <a class="el" href="_derived_data_8_c_source.html#l00042">tk::genEsup()</a>, <a class="el" href="_derived_data_8_c_source.html#l00125">tk::genPsup()</a>, <a class="el" href="_control_8h_source.html#l00046">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_refiner_8h_source.html#l00165">m_extra</a>, <a class="el" href="_refiner_8h_source.html#l00140">m_inpoel</a>, <a class="el" href="_refiner_8h_source.html#l00161">m_refiner</a>, <a class="el" href="_derived_data_8_c_source.html#l00029">tk::npoin()</a>, and <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00215">refine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;{</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment">// Get user-defined node-pairs (edges) to tag for refinement</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; edgenodelist = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="namespaceinciter_1_1ctr.html#ad8d2ef07f96dd9f967f9ad580ad28051">tag::amr</a>, <a class="code" href="structtag_1_1edge.html">tag::edge</a> &gt;();</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">if</span> (!edgenodelist.empty()) {  <span class="comment">// if user explicitly tagged edges</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">// Find number of nodes in old mesh</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a> = <a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">tk::npoin</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a> );</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// Generate edges surrounding points in old mesh</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keyword">auto</span> esup = <a class="code" href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, 4 );</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keyword">auto</span> psup = <a class="code" href="namespacetk.html#ad2a88a65102c17149b44660db15d445b">tk::genPsup</a>( <a class="code" href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">m_inpoel</a>, 4, esup );</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="classtk_1_1_uns_mesh.html#a564c87d50c1611fff1c6d045bc07a3b4">tk::UnsMesh::EdgeSet</a> edgeset;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">for</span> (std::size_t i=0; i&lt;edgenodelist.size()/2; ++i)</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      edgeset.insert( {{ {edgenodelist[i*2+0], edgenodelist[i*2+1]} }} );</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">// Compute errors in ICs and define refinement criteria for edges</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    std::vector&lt; edge_t &gt; edge;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    std::vector&lt; real_t &gt; crit;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">for</span> (std::size_t p=0; p&lt;<a class="code" href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">npoin</a>; ++p)        <span class="comment">// for all mesh nodes on this chare</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> q : <a class="code" href="classtk_1_1_around.html">tk::Around</a>(psup,p)) {      <span class="comment">// for all nodes surrounding p</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <a class="code" href="classtk_1_1_uns_mesh.html#a622c34bab099c772650f046b848346d7">tk::UnsMesh::Edge</a> e{{p,q}};</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">if</span> (edgeset.find(e) != end(edgeset)) { <span class="comment">// tag edge if on user&#39;s list</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;          edge.push_back( <a class="code" href="classedge__t.html">edge_t</a>(e[0],e[1]) );</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;          crit.push_back( 1.0 );</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( edge.size() == crit.size(), <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// Do error-based refinement</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">m_refiner</a>.<a class="code" href="class_a_m_r_1_1mesh__adapter__t.html#aabf36773aecfd2a3de859e1ca1e9ecb0">error_refinement</a>( edge, crit );</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">// Update mesh coordinates and connectivity</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <a class="code" href="classinciter_1_1_refiner.html#a2aa26e2c8cf1618a0452b8803c53637f">updateMesh</a>();</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">// Set number of extra edges to a nonzero number, triggering correction</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">m_extra</a> = 1;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;}</div><div class="ttc" id="classinciter_1_1_refiner_html_aae71fe355232fbbe89ccb90cb63a0ee5"><div class="ttname"><a href="classinciter_1_1_refiner.html#aae71fe355232fbbe89ccb90cb63a0ee5">inciter::Refiner::m_extra</a></div><div class="ttdeci">std::size_t m_extra</div><div class="ttdoc">Number of chare-boundary newly added nodes that need correction. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00165">Refiner.h:165</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a6bc91e28516a27aea998ae384715707f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a6bc91e28516a27aea998ae384715707f">inciter::Refiner::m_inpoel</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; &amp; m_inpoel</div><div class="ttdoc">Alias to element connectivity with local node IDs in m_el. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00140">Refiner.h:140</a></div></div>
<div class="ttc" id="classedge__t_html"><div class="ttname"><a href="classedge__t.html">edge_t</a></div><div class="ttdef"><b>Definition:</b> <a href="edge_8h_source.html#l00008">edge.h:8</a></div></div>
<div class="ttc" id="structtag_1_1edge_html"><div class="ttname"><a href="structtag_1_1edge.html">tag::edge</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00179">Tags.h:179</a></div></div>
<div class="ttc" id="classtk_1_1_around_html"><div class="ttname"><a href="classtk_1_1_around.html">tk::Around</a></div><div class="ttdoc">Helper class simplifying client code for iterating on entries surrounding entries via linked lists de...</div><div class="ttdef"><b>Definition:</b> <a href="_around_8h_source.html#l00027">Around.h:27</a></div></div>
<div class="ttc" id="namespacetk_html_ad2a88a65102c17149b44660db15d445b"><div class="ttname"><a href="namespacetk.html#ad2a88a65102c17149b44660db15d445b">tk::genPsup</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; genPsup(const std::vector&lt; std::size_t &gt; &amp;inpoel, std::size_t nnpe, const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;esup)</div><div class="ttdoc">Generate derived data structure, points surrounding points. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00125">DerivedData.C:125</a></div></div>
<div class="ttc" id="class_a_m_r_1_1mesh__adapter__t_html_aabf36773aecfd2a3de859e1ca1e9ecb0"><div class="ttname"><a href="class_a_m_r_1_1mesh__adapter__t.html#aabf36773aecfd2a3de859e1ca1e9ecb0">AMR::mesh_adapter_t::error_refinement</a></div><div class="ttdeci">void error_refinement(const std::vector&lt; edge_t &gt; &amp;edge, const std::vector&lt; real_t &gt; &amp;criteria)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__adapter_8_c_source.html#l00060">mesh_adapter.C:60</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a2aa26e2c8cf1618a0452b8803c53637f"><div class="ttname"><a href="classinciter_1_1_refiner.html#a2aa26e2c8cf1618a0452b8803c53637f">inciter::Refiner::updateMesh</a></div><div class="ttdeci">void updateMesh()</div><div class="ttdoc">Update mesh after refinement. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8_c_source.html#l00635">Refiner.C:635</a></div></div>
<div class="ttc" id="classtk_1_1_uns_mesh_html_a622c34bab099c772650f046b848346d7"><div class="ttname"><a href="classtk_1_1_uns_mesh.html#a622c34bab099c772650f046b848346d7">tk::UnsMesh::Edge</a></div><div class="ttdeci">std::array&lt; std::size_t, 2 &gt; Edge</div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00054">UnsMesh.h:54</a></div></div>
<div class="ttc" id="namespacetk_html_abdd71f3e10edf6e1a8d047478abd488c"><div class="ttname"><a href="namespacetk.html#abdd71f3e10edf6e1a8d047478abd488c">tk::npoin</a></div><div class="ttdeci">std::size_t npoin(const std::vector&lt; std::size_t &gt; &amp;inpoel)</div><div class="ttdoc">Compute number of points (nodes) in mesh from connectivity. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00029">DerivedData.C:29</a></div></div>
<div class="ttc" id="namespacetk_html_a66a2889d5d8aeb4a836842c6a1010463"><div class="ttname"><a href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; genEsup(const std::vector&lt; std::size_t &gt; &amp;inpoel, std::size_t nnpe)</div><div class="ttdoc">Generate derived data structure, elements surrounding points. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00042">DerivedData.C:42</a></div></div>
<div class="ttc" id="namespaceinciter_1_1ctr_html_ad8d2ef07f96dd9f967f9ad580ad28051"><div class="ttname"><a href="namespaceinciter_1_1ctr.html#ad8d2ef07f96dd9f967f9ad580ad28051">inciter::ctr::amr</a></div><div class="ttdeci">tk::tuple::tagged_tuple&lt; tag::amr, bool, tag::initamr, bool, tag::init, std::vector&lt; AMRInitialType &gt;, tag::refvar, std::vector&lt; std::string &gt;, tag::id, std::vector&lt; std::size_t &gt;, tag::error, AMRErrorType, tag::edge, std::vector&lt; kw::amr_initref::info::expect::type &gt; &gt; amr</div><div class="ttdoc">Adaptive-mesh refinement options. </div><div class="ttdef"><b>Definition:</b> <a href="_control_2_inciter_2_types_8h_source.html#l00052">Types.h:52</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00046">Control.h:46</a></div></div>
<div class="ttc" id="classinciter_1_1_refiner_html_a7e85879e386e8df4dc9b3291bd64eb70"><div class="ttname"><a href="classinciter_1_1_refiner.html#a7e85879e386e8df4dc9b3291bd64eb70">inciter::Refiner::m_refiner</a></div><div class="ttdeci">AMR::mesh_adapter_t m_refiner</div><div class="ttdoc">Mesh refiner (library) object. </div><div class="ttdef"><b>Definition:</b> <a href="_refiner_8h_source.html#l00161">Refiner.h:161</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_d_g_8_c_source.html#l00028">DG.C:28</a></div></div>
<div class="ttc" id="classtk_1_1_uns_mesh_html_a564c87d50c1611fff1c6d045bc07a3b4"><div class="ttname"><a href="classtk_1_1_uns_mesh.html#a564c87d50c1611fff1c6d045bc07a3b4">tk::UnsMesh::EdgeSet</a></div><div class="ttdeci">std::unordered_set&lt; Edge, Hash&lt; 2 &gt;, Eq&lt; 2 &gt; &gt; EdgeSet</div><div class="ttdoc">Unique set of edges. </div><div class="ttdef"><b>Definition:</b> <a href="_uns_mesh_8h_source.html#l00109">UnsMesh.h:109</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_refiner_a06a9b9f3a4fe8c6f3da9a1ff6d580cb3_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a2f911c5716c9c6d10e401f6baab33af6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f911c5716c9c6d10e401f6baab33af6">&#9670;&nbsp;</a></span>operator|</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void operator| </td>
          <td>(</td>
          <td class="paramtype">PUP::er &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinciter_1_1_refiner.html">Refiner</a> &amp;&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pack/Unpack serialize operator|. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>Charm++'s PUP::er serializer object reference </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r</td><td><a class="el" href="classinciter_1_1_refiner.html" title="Mesh refiner for interfacing the mesh refinement library. ">Refiner</a> object reference </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00102">102</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{ r.pup(p); }</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a38dadaef73bf3db0af0fdaeadf87408c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38dadaef73bf3db0af0fdaeadf87408c">&#9670;&nbsp;</a></span>m_bface</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; inciter::Refiner::m_bface</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>List of boundary faces associated to side-set IDs. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00151">151</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00733">boundary()</a>, <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, and <a class="el" href="_refiner_8_c_source.html#l00819">updateBndFaces()</a>.</p>

</div>
</div>
<a id="ad9d96d8d83e5525268168cbc84d79396"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9d96d8d83e5525268168cbc84d79396">&#9670;&nbsp;</a></span>m_bndEdges</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt; int, <a class="el" href="classinciter_1_1_refiner.html#acc6b81c6f3ad0831d0f64739528fb212">EdgeSet</a> &gt; inciter::Refiner::m_bndEdges</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boundary edges associated to chares we share these edges with. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00174">174</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00193">addBndEdges()</a>, <a class="el" href="_refiner_8_c_source.html#l00156">bndEdges()</a>, <a class="el" href="_refiner_8_c_source.html#l00268">comExtra()</a>, <a class="el" href="_refiner_8_c_source.html#l00331">correctref()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, <a class="el" href="_refiner_8_c_source.html#l00215">refine()</a>, <a class="el" href="_refiner_8_c_source.html#l00092">registerReducers()</a>, and <a class="el" href="_refiner_8_c_source.html#l00135">start()</a>.</p>

</div>
</div>
<a id="a8f752bc3a870aea2138683b778a9c6ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f752bc3a870aea2138683b778a9c6ee">&#9670;&nbsp;</a></span>m_bnode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; inciter::Refiner::m_bnode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>List of boundary nodes associated to side-set IDs. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00155">155</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, and <a class="el" href="_refiner_8_c_source.html#l00935">updateBndNodes()</a>.</p>

</div>
</div>
<a id="a8e89a122b60e779413d13f4ed35a40c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e89a122b60e779413d13f4ed35a40c9">&#9670;&nbsp;</a></span>m_cbr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetk.html#a14349512cb39672c145c692e522ff28f">tk::RefinerCallback</a> inciter::Refiner::m_cbr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Charm++ callbacks associated to compile-time tags for refiner. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00127">127</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00268">comExtra()</a>, <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, and <a class="el" href="_refiner_8_c_source.html#l00310">recvRefBndEdges()</a>.</p>

</div>
</div>
<a id="ab8750c25fab71f650dcfeae371fa87bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8750c25fab71f650dcfeae371fa87bf">&#9670;&nbsp;</a></span>m_cbs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetk.html#aee5e81a51fe8734df54d70ab33b1b8d0">tk::SorterCallback</a> inciter::Refiner::m_cbs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Charm++ callbacks associated to compile-time tags for sorter. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00129">129</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>, and <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>.</p>

</div>
</div>
<a id="a8b6f78d266458831a12a9e53a609ce72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b6f78d266458831a12a9e53a609ce72">&#9670;&nbsp;</a></span>m_ch</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt; int &gt; inciter::Refiner::m_ch</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Chares we share at least a single edge with. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00167">167</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00193">addBndEdges()</a>, <a class="el" href="_refiner_8_c_source.html#l00268">comExtra()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, <a class="el" href="_refiner_8_c_source.html#l00310">recvRefBndEdges()</a>, and <a class="el" href="_refiner_8_c_source.html#l00135">start()</a>.</p>

</div>
</div>
<a id="aec812331b2bc9bfc51ed8c48906204fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec812331b2bc9bfc51ed8c48906204fe">&#9670;&nbsp;</a></span>m_coord</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtk_1_1_uns_mesh.html#a2ed8d512b099636a98ba6b35b1118d6f">tk::UnsMesh::Coords</a> inciter::Refiner::m_coord</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Coordinates of mesh nodes of our chunk of the mesh. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00149">149</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00465">errorRefine()</a>, <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>, <a class="el" href="_refiner_8_c_source.html#l00406">nextref()</a>, <a class="el" href="_refiner_8_c_source.html#l00560">nodeinit()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, <a class="el" href="_refiner_8_c_source.html#l00215">refine()</a>, <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>, and <a class="el" href="_refiner_8_c_source.html#l00673">updateVolMesh()</a>.</p>

</div>
</div>
<a id="a0dbe0d53033cee33b057f32f8a65ba58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dbe0d53033cee33b057f32f8a65ba58">&#9670;&nbsp;</a></span>m_coordmap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtk_1_1_uns_mesh.html#a4b2d1f8043c0354b11461c118a4379c5">tk::UnsMesh::CoordMap</a> inciter::Refiner::m_coordmap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Coordinates associated to global node IDs of our mesh chunk. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00147">147</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>, and <a class="el" href="_refiner_8_c_source.html#l00673">updateVolMesh()</a>.</p>

</div>
</div>
<a id="a5af0df1e55bc32f0cdfd29f72d427f43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5af0df1e55bc32f0cdfd29f72d427f43">&#9670;&nbsp;</a></span>m_edgenode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtk_1_1_uns_mesh.html#a4c8d0c917a9349f675ca2d3259b69193">tk::UnsMesh::EdgeNodeCoord</a> inciter::Refiner::m_edgenode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Map associating global IDs and coordinates of a node added to an edge. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00169">169</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00268">comExtra()</a>, <a class="el" href="_refiner_8_c_source.html#l00331">correctref()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, <a class="el" href="_refiner_8_c_source.html#l00135">start()</a>, and <a class="el" href="_refiner_8_c_source.html#l00673">updateVolMesh()</a>.</p>

</div>
</div>
<a id="a8a296faa4bf9d5353b93a3184d24d25e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a296faa4bf9d5353b93a3184d24d25e">&#9670;&nbsp;</a></span>m_edgenodeCh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt; int, <a class="el" href="classtk_1_1_uns_mesh.html#a4c8d0c917a9349f675ca2d3259b69193">tk::UnsMesh::EdgeNodeCoord</a> &gt; inciter::Refiner::m_edgenodeCh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Map associating global IDs and coordinates of a node added to an edge associated to another chare the edge is shared with. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00172">172</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00293">addRefBndEdges()</a>, <a class="el" href="_refiner_8_c_source.html#l00331">correctref()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, and <a class="el" href="_refiner_8_c_source.html#l00135">start()</a>.</p>

</div>
</div>
<a id="a00514941af3f4b071d2bfabeccf03789"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00514941af3f4b071d2bfabeccf03789">&#9670;&nbsp;</a></span>m_el</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::tuple&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt;, std::unordered_map&lt; std::size_t, std::size_t &gt; &gt; inciter::Refiner::m_el</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Elements of the mesh chunk we operate on</p>
<p>The first vector is the element connectivity (local IDs), the second vector is the global node IDs of owned elements, while the third one is a map of global-&gt;local node IDs. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00138">138</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>.</p>

</div>
</div>
<a id="aae71fe355232fbbe89ccb90cb63a0ee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae71fe355232fbbe89ccb90cb63a0ee5">&#9670;&nbsp;</a></span>m_extra</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t inciter::Refiner::m_extra</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of chare-boundary newly added nodes that need correction. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00165">165</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00268">comExtra()</a>, <a class="el" href="_refiner_8_c_source.html#l00331">correctref()</a>, <a class="el" href="_refiner_8_c_source.html#l00465">errorRefine()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, <a class="el" href="_refiner_8_c_source.html#l00310">recvRefBndEdges()</a>, <a class="el" href="_refiner_8_c_source.html#l00135">start()</a>, <a class="el" href="_refiner_8_c_source.html#l00448">uniformRefine()</a>, and <a class="el" href="_refiner_8_c_source.html#l00515">userRefine()</a>.</p>

</div>
</div>
<a id="a5636a971bbf52996e933493fc6a5aa07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5636a971bbf52996e933493fc6a5aa07">&#9670;&nbsp;</a></span>m_gid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::size_t &gt;&amp; inciter::Refiner::m_gid = std::get&lt;1&gt;( <a class="el" href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">m_el</a> )</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Alias to global node IDs of owned elements in m_el. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00142">142</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00108">flatcoord()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, <a class="el" href="_refiner_8_c_source.html#l00819">updateBndFaces()</a>, <a class="el" href="_refiner_8_c_source.html#l00935">updateBndNodes()</a>, <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>, and <a class="el" href="_refiner_8_c_source.html#l00673">updateVolMesh()</a>.</p>

</div>
</div>
<a id="ae736705da5f6217e06153112e2038b2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae736705da5f6217e06153112e2038b2e">&#9670;&nbsp;</a></span>m_ginpoel</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::size_t &gt; inciter::Refiner::m_ginpoel</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tetrtahedron element connectivity of our chunk of the mesh (global ids) </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00131">131</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00156">bndEdges()</a>, <a class="el" href="_refiner_8_c_source.html#l00733">boundary()</a>, <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, <a class="el" href="_refiner_8_c_source.html#l00038">Refiner()</a>, and <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>.</p>

</div>
</div>
<a id="a6dcb67634aab36a227a6e0fec4011432"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dcb67634aab36a227a6e0fec4011432">&#9670;&nbsp;</a></span>m_host</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CProxy_Transporter inciter::Refiner::m_host</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Host proxy. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00119">119</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>, and <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>.</p>

</div>
</div>
<a id="a9db2d016c546a539f8213e9804ec65ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9db2d016c546a539f8213e9804ec65ff">&#9670;&nbsp;</a></span>m_initref</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="namespaceinciter_1_1ctr.html#ab492311c84666c98ea0363b2991f81fa">ctr::AMRInitialType</a> &gt; inciter::Refiner::m_initref</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initial mesh refinement type list (in reverse order) </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00159">159</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00406">nextref()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, <a class="el" href="_refiner_8_c_source.html#l00215">refine()</a>, and <a class="el" href="_refiner_8_c_source.html#l00038">Refiner()</a>.</p>

</div>
</div>
<a id="a6bc91e28516a27aea998ae384715707f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bc91e28516a27aea998ae384715707f">&#9670;&nbsp;</a></span>m_inpoel</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::size_t &gt;&amp; inciter::Refiner::m_inpoel = std::get&lt;0&gt;( <a class="el" href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">m_el</a> )</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Alias to element connectivity with local node IDs in m_el. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00140">140</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00156">bndEdges()</a>, <a class="el" href="_refiner_8_c_source.html#l00733">boundary()</a>, <a class="el" href="_refiner_8_c_source.html#l00465">errorRefine()</a>, <a class="el" href="_refiner_8_c_source.html#l00406">nextref()</a>, <a class="el" href="_refiner_8_c_source.html#l00560">nodeinit()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, <a class="el" href="_refiner_8_c_source.html#l00215">refine()</a>, <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>, and <a class="el" href="_refiner_8_c_source.html#l00515">userRefine()</a>.</p>

</div>
</div>
<a id="a972fbff38d8e36f96be02b7e0a092472"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a972fbff38d8e36f96be02b7e0a092472">&#9670;&nbsp;</a></span>m_lid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt; std::size_t, std::size_t &gt;&amp; inciter::Refiner::m_lid = std::get&lt;2&gt;( <a class="el" href="classinciter_1_1_refiner.html#a00514941af3f4b071d2bfabeccf03789">m_el</a> )</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Alias to local node IDs associated to the global ones of owned elements in m_el. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00145">145</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00156">bndEdges()</a>, <a class="el" href="_refiner_8_c_source.html#l00331">correctref()</a>, <a class="el" href="_refiner_8_c_source.html#l00108">flatcoord()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, <a class="el" href="_refiner_8_c_source.html#l00215">refine()</a>, <a class="el" href="_refiner_8_c_source.html#l00819">updateBndFaces()</a>, and <a class="el" href="_refiner_8_c_source.html#l00673">updateVolMesh()</a>.</p>

</div>
</div>
<a id="a40aca114fe5c6c650c5a8ebbe1969421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40aca114fe5c6c650c5a8ebbe1969421">&#9670;&nbsp;</a></span>m_nchare</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int inciter::Refiner::m_nchare</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of refiner chares. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00157">157</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>, and <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>.</p>

</div>
</div>
<a id="abcdd64821992ed351c4da0dcb5ef5989"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcdd64821992ed351c4da0dcb5ef5989">&#9670;&nbsp;</a></span>m_nref</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t inciter::Refiner::m_nref</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Counter during distribution of newly added nodes to chare-boundary edges. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00163">163</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00268">comExtra()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, and <a class="el" href="_refiner_8_c_source.html#l00310">recvRefBndEdges()</a>.</p>

</div>
</div>
<a id="a7e85879e386e8df4dc9b3291bd64eb70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e85879e386e8df4dc9b3291bd64eb70">&#9670;&nbsp;</a></span>m_refiner</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_m_r_1_1mesh__adapter__t.html">AMR::mesh_adapter_t</a> inciter::Refiner::m_refiner</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mesh refiner (library) object. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00161">161</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00733">boundary()</a>, <a class="el" href="_refiner_8_c_source.html#l00614">correctRefine()</a>, <a class="el" href="_refiner_8_c_source.html#l00465">errorRefine()</a>, <a class="el" href="_refiner_8_c_source.html#l00448">uniformRefine()</a>, <a class="el" href="_refiner_8_c_source.html#l00819">updateBndFaces()</a>, <a class="el" href="_refiner_8_c_source.html#l00935">updateBndNodes()</a>, <a class="el" href="_refiner_8_c_source.html#l00635">updateMesh()</a>, <a class="el" href="_refiner_8_c_source.html#l00673">updateVolMesh()</a>, and <a class="el" href="_refiner_8_c_source.html#l00515">userRefine()</a>.</p>

</div>
</div>
<a id="a0cb785ca204645311f8c26ac6a93d9a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cb785ca204645311f8c26ac6a93d9a3">&#9670;&nbsp;</a></span>m_scheme</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinciter_1_1_scheme.html">Scheme</a> inciter::Refiner::m_scheme</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classinciter_1_1_discretization.html" title="Discretization Charm++ chare array holding common functinoality to all discretization schemes...">Discretization</a> scheme. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00125">125</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>.</p>

</div>
</div>
<a id="afee3e21d01face5a1bde8edf7746f8d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afee3e21d01face5a1bde8edf7746f8d2">&#9670;&nbsp;</a></span>m_solver</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tk::CProxy_Solver inciter::Refiner::m_solver</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Linear soilver proxy. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00123">123</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>.</p>

</div>
</div>
<a id="a1985a5a79a3178b5c50a9d8112f1dd8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1985a5a79a3178b5c50a9d8112f1dd8a">&#9670;&nbsp;</a></span>m_sorter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CProxy_Sorter inciter::Refiner::m_sorter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mesh sorter proxy. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00121">121</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>.</p>

</div>
</div>
<a id="abe95236aea1ef5fb585930650e829015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe95236aea1ef5fb585930650e829015">&#9670;&nbsp;</a></span>m_triinpoel</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::size_t &gt; inciter::Refiner::m_triinpoel</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boundary face-node connectivity. </p>

<p class="definition">Definition at line <a class="el" href="_refiner_8h_source.html#l00153">153</a> of file <a class="el" href="_refiner_8h_source.html">Refiner.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_refiner_8_c_source.html#l00733">boundary()</a>, <a class="el" href="_refiner_8_c_source.html#l00429">finish()</a>, <a class="el" href="_refiner_8h_source.html#l00072">pup()</a>, and <a class="el" href="_refiner_8_c_source.html#l00819">updateBndFaces()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/tmp/TeamCity-12/work/821a9fd6f64749d9/src/Inciter/<a class="el" href="_refiner_8h_source.html">Refiner.h</a></li>
<li>/tmp/TeamCity-12/work/821a9fd6f64749d9/src/Inciter/<a class="el" href="_refiner_8_c_source.html">Refiner.C</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jul 9 2018 22:28:36 for Quinoa by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
