<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quinoa: /tmp/TeamCity-14/work/821a9fd6f64749d9/src/LinSys/Solver.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quinoa.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_3ca9c9eb36ab3ecb75ba69910724f6da.html">LinSys</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Solver.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_solver_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// *****************************************************************************</span><span class="comment"></span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">  \file      src/LinSys/Solver.h</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">  \copyright 2012-2015, J. Bakosi, 2016-2017, Los Alamos National Security, LLC.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">  \brief     Charm++ chare linear system merger group to solve a linear system</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">  \details   Charm++ chare linear system merger group used to collect and</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">    assemble the left hand side matrix (lhs), the right hand side (rhs) vector,</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">    and the solution (unknown) vector from individual worker</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">    chares. Beside collection and assembly, the system is also solved. The</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">    solution is outsourced to hypre, an MPI-only library. Once the solution is</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">    available, the individual worker chares are updated with the new solution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">    This class assembles and solves two linear systems, whose rhs vectors may</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">    change during time stepping. One of the two linear systems is called a</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">    high-order and the other one is the low-order linear system.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">    Characteristics of the low-order linear system: (1) the left hand side</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">    matrix is diagonal, (2) the right hand side vector is a combination of the</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">    high-order right hand side vector and another vector, assembled separately</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">    (and overlapped with that of the high-order system). This dual system</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">    solution is done here as required by the flux-corrected transport algorithm</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">    used for transport equations in inciter.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">    The implementation uses the Charm++ runtime system and is fully</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">    asynchronous, overlapping computation and communication. The algorithm</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">    utilizes the structured dagger (SDAG) Charm++ functionality. The high-level</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">    overview of the algorithm structure and how it interfaces with Charm++ is</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">    discussed in the Charm++ interface file src/LinSys/solver.ci.</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">    #### Call graph ####</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">    The following is a directed acyclic graph (DAG) that outlines the</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">    asynchronous algorithm implemented in this class The detailed discussion of</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">    the algorithm is given in the Charm++ interface file solver.ci. On the</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">    DAG orange fills denote global synchronization points that contain or</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">    eventually lead to global reductions. Dashed lines are potential shortcuts</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">    that allow jumping over some of the task-graph under some circumstances or</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">    optional code paths (taken, e.g., only in DEBUG mode). See the detailed</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">    discussion in linsysmrger.ci.</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">    \dot</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">    digraph &quot;Solver SDAG&quot; {</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">      rankdir=&quot;LR&quot;;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">      node [shape=record, fontname=Helvetica, fontsize=10];</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">      ChRow [ label=&quot;ChRow&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">              tooltip=&quot;chares contribute their global row IDs&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::charerow&quot;];</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">      ChBC [ label=&quot;ChBC&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">             tooltip=&quot;chares contribute their global node IDs at which</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">                      they can set boundary conditions&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">             URL=&quot;\ref tk::Solver::charebc&quot;];</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">      RowComplete   [ label=&quot;RowComplete&quot; color=&quot;#e6851c&quot; style=&quot;filled&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">              tooltip=&quot;all linear system solver branches have done heir part of</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">              storing and exporting global row ids&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">              URL=&quot;\ref inciter::Transporter::rowcomplete&quot;];</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">      Init [ label=&quot;Init&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">              tooltip=&quot;Workers start setting and outputing ICs, computing</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">                       initial dt, computing LHS&quot;];</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">      dt [ label=&quot;dt&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">           tooltip=&quot;Worker chares compute their minimum time step size&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">           color=&quot;#e6851c&quot; style=&quot;filled&quot;];</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">      Ver  [ label=&quot;Ver&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">              tooltip=&quot;start optional verifications, query BCs, and converting</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">                       row IDs to hypre format&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::rowsreceived&quot;];</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">      LhsBC [ label=&quot;LhsBC&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">              tooltip=&quot;set boundary conditions on the left-hand side matrix&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::lhsbc&quot;];</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">      RhsBC [ label=&quot;RhsBC&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">              tooltip=&quot;set boundary conditions on the right-hand side vector&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::rhsbc&quot;];</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">      ChSol [ label=&quot;ChSol&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">              tooltip=&quot;chares contribute their solution vector nonzeros&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::charesol&quot;];</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">      ChLhs [ label=&quot;ChLhs&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">              tooltip=&quot;chares contribute their left hand side matrix nonzeros&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::charelhs&quot;];</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">      ChLoLhs [ label=&quot;ChLowLhs&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">              tooltip=&quot;chares contribute their low-order left hand side matrix&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::charelow&quot;];</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">      ChRhs [ label=&quot;ChRhs&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">              tooltip=&quot;chares contribute their right hand side vector nonzeros&quot;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::charesol&quot;];</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">      ChLoRhs [ label=&quot;ChLowRhs&quot;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">              tooltip=&quot;chares contribute their contribution to the low-order</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">                       right hand side vector&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::charelowrhs&quot;];</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">      HypreRow [ label=&quot;HypreRow&quot;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">              tooltip=&quot;convert global row ID vector to hypre format&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::hyprerow&quot;];</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">      HypreSol [ label=&quot;HypreSol&quot;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">              tooltip=&quot;convert solution vector to hypre format&quot;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::hypresol&quot;];</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">      HypreLhs [ label=&quot;HypreLhs&quot;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">              tooltip=&quot;convert left hand side matrix to hypre format&quot;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::hyprelhs&quot;];</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">      HypreRhs [ label=&quot;HypreRhs&quot;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">              tooltip=&quot;convert right hand side vector to hypre format&quot;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::hyprerhs&quot;];</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">      FillSol [ label=&quot;FillSol&quot;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">              tooltip=&quot;fill/set solution vector&quot;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::sol&quot;];</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">      FillLhs [ label=&quot;FillLhs&quot;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">              tooltip=&quot;fill/set left hand side matrix&quot;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::lhs&quot;];</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">      FillRhs [ label=&quot;FillRhs&quot;</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">              tooltip=&quot;fill/set right hand side vector&quot;</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::rhs&quot;];</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">      AsmSol [ label=&quot;AsmSol&quot;</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">              tooltip=&quot;assemble solution vector&quot;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::assemblesol&quot;];</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">      AsmLhs [ label=&quot;AsmLhs&quot;</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">              tooltip=&quot;assemble left hand side matrix&quot;</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::assemblelhs&quot;];</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">      AsmRhs [ label=&quot;AsmRhs&quot;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">              tooltip=&quot;assemble right hand side vector&quot;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::assemblerhs&quot;];</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">      Solve [ label=&quot;Solve&quot; tooltip=&quot;solve linear system&quot;</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::solve&quot;];</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">      LoSolve [ label=&quot;LoSolve&quot; tooltip=&quot;solve low-order linear system&quot;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">              URL=&quot;\ref tk::Solver::lowsolve&quot;];</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">      Upd [ label=&quot;Upd&quot; tooltip=&quot;update solution&quot;</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">                color=&quot;#e6851c&quot; style=&quot;filled&quot;</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">                URL=&quot;\ref tk::Solver::updateSol&quot;];</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">      LowUpd [ label=&quot;LowUpd&quot; tooltip=&quot;update low-order solution&quot;</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">               color=&quot;#e6851c&quot;style=&quot;filled&quot;</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">               URL=&quot;\ref tk::Solver::updateLowol&quot;];</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">      ChRow -&gt; RowComplete [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">      RowComplete -&gt; Init [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">      RowComplete -&gt; Ver [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">      Ver -&gt; HypreRow [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">      ChLhs -&gt; LhsBC [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">      ChRhs -&gt; RhsBC [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">      LhsBC -&gt; HypreLhs [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">      RhsBC -&gt; HypreRhs [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">      RhsBC -&gt; LowSolve [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">      ChLowRhs -&gt; LowSolve [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">      ChLowLhs -&gt; LowSolve [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">      Init -&gt; ChSol [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">      Init -&gt; ChLhs [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">      Init -&gt; ChLowLhs [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">      Init -&gt; dt [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">      dt -&gt; ChRhs [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">      dt -&gt; ChLowRhs [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">      dt -&gt; ChBC [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">      ChBC -&gt; LhsBC [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">      ChBC -&gt; RhsBC [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">      HypreRow -&gt; FillSol [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">      HypreRow -&gt; FillLhs [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">      HypreRow -&gt; FillRhs [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">      ChSol -&gt; HypreSol -&gt; FillSol -&gt; AsmSol -&gt; Solve [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">      HypreLhs -&gt; FillLhs -&gt; AsmLhs -&gt; Solve [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">      HypreRhs -&gt; FillRhs -&gt; AsmRhs -&gt; Solve [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">      Solve -&gt; Upd [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">      LowSolve -&gt; LowUpd [ style=&quot;solid&quot; ];</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">    \enddot</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">    \include LinSys/solver.ci</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">// *****************************************************************************</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#ifndef Solver_h</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#define Solver_h</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">#include &lt;unordered_map&gt;</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">#include &quot;Types.h&quot;</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_tags_8h.html">Tags.h</a>&quot;</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_fields_8h.html">Fields.h</a>&quot;</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_tagged_tuple_8h.html">TaggedTuple.h</a>&quot;</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_hypre_matrix_8h.html">HypreMatrix.h</a>&quot;</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_hypre_vector_8h.html">HypreVector.h</a>&quot;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_hypre_solver_8h.html">HypreSolver.h</a>&quot;</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="solver_8decl_8h.html">NoWarning/solver.decl.h</a>&quot;</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cg_8decl_8h.html">NoWarning/cg.decl.h</a>&quot;</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacetk.html">tk</a> {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">//! Linear system merger and solver Charm++ chare group class</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">//! \details Instantiations of Solver comprise a processor aware Charm++</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">//!   chare group. When instantiated, a new object is created on each PE and not</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">//!   more (as opposed to individual chares or chare array object elements). The</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">//!   group&#39;s elements are used to collect information from all chare objects</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">//!   that happen to be on a given PE. See also the Charm++ interface file</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">//!   solver.ci.</span></div><div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html">  186</a></span>&#160;<span class="comment"></span><span class="keyword">class </span><a class="code" href="classtk_1_1_solver.html">Solver</a> : <span class="keyword">public</span> CBase_Solver {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="preprocessor">  #if defined(__clang__)</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">    #pragma clang diagnostic push</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">    #pragma clang diagnostic ignored &quot;-Wunused-parameter&quot;</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">    #pragma clang diagnostic ignored &quot;-Wdeprecated-declarations&quot;</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">  #elif defined(STRICT_GNUC)</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic push</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic ignored &quot;-Wdeprecated-declarations&quot;</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic ignored &quot;-Wunused-parameter&quot;</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">  #elif defined(__INTEL_COMPILER)</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">    #pragma warning( push )</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">    #pragma warning( disable: 1478 )</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">// Include Charm++ SDAG code. See http://charm.cs.illinois.edu/manuals/html/</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// charm++/manual.html, Sec. &quot;Structured Control Flow: Structured Dagger&quot;.</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  Solver_SDAG_CODE</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">  #if defined(__clang__)</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">    #pragma clang diagnostic pop</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">  #elif defined(STRICT_GNUC)</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic pop</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">  #elif defined(__INTEL_COMPILER)</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">    #pragma warning( pop )</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor">  #endif</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">    //! Constructor</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"></span>    <a class="code" href="classtk_1_1_solver.html#a1fb120745008c33ab1831f790db4a364">Solver</a>( <span class="keyword">const</span> std::vector&lt; CkCallback &gt;&amp; cb,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="keyword">const</span> std::map&lt; <span class="keywordtype">int</span>, std::vector&lt; std::size_t &gt; &gt;&amp; s,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            std::size_t n,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keywordtype">bool</span> <span class="comment">/*feedback*/</span> );</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">    //! Configure Charm++ reduction types for concatenating BC nodelists</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span>    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#aff0985fc91d7845dc68843b21b885497">registerBCMerger</a>();</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">    //! Receive lower and upper global node IDs all PEs will operate on</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#ae64639059051bc44536ed5e7452632f4">bounds</a>( <span class="keywordtype">int</span> p, std::size_t lower, std::size_t upper );</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">    //! Re-enable SDAG waits for rebuilding the right-hand side vector only</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a220e350690f38fd69631ca7c6211fd6f">enable_wait4rhs</a>();</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">    //! Set number of worker chares expected to contribute on my PE</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a0297a6c08589267f294efba205c4527e">nchare</a>( <span class="keywordtype">int</span> n );</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">    //! Chares contribute their global row ids</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a7e279112bc8c77fd556eb88f059566b9">charerow</a>( <span class="keywordtype">int</span> fromch, <span class="keyword">const</span> std::vector&lt; std::size_t &gt;&amp; row );</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">    //! Receive global row ids from fellow group branches</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#ae890e5746f0ed9790380e6acd2b6a358">addrow</a>( <span class="keywordtype">int</span> fromch, <span class="keywordtype">int</span> frompe, <span class="keyword">const</span> std::set&lt; std::size_t &gt;&amp; row );</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">    //! Acknowledge received row ids</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#ab3c996911cb985352859098c77521c52">recrow</a>();</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">    //! Chares contribute their solution nonzero values</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#ab8f9ed3f6abc92f43b34c70a7d832a1d">charesol</a>( <span class="keywordtype">int</span> fromch,</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                   <span class="keyword">const</span> std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                   <span class="keyword">const</span> Fields&amp; solution );</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">    //! Receive solution vector nonzeros from fellow group branches</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a905fd2cbb41ec8daeaec028f694b8e24">addsol</a>( <span class="keywordtype">int</span> fromch,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                 <span class="keyword">const</span> std::map&lt; std::size_t,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                 std::vector&lt; tk::real &gt; &gt;&amp; solution );</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">    //! Chares contribute their matrix nonzero values</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a2eb7392a5115a24b78e527ba1e7790ac">charelhs</a>( <span class="keywordtype">int</span> fromch,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                   <span class="keyword">const</span> std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                   <span class="keyword">const</span> std::pair&lt; std::vector&lt; std::size_t &gt;,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                    std::vector&lt; std::size_t &gt; &gt;&amp; psup,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                   <span class="keyword">const</span> tk::Fields&amp; lhsd,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                   <span class="keyword">const</span> tk::Fields&amp; lhso );</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">    //! Receive matrix nonzeros from fellow group branches</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a4d1489fadc01b7698a464c1dd04d10aa">addlhs</a>( <span class="keywordtype">int</span> fromch,</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                 <span class="keyword">const</span> std::map&lt; std::size_t,</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                 std::map&lt; std::size_t,</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                           std::vector&lt; tk::real &gt; &gt; &gt;&amp; l );</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">    //! Chares contribute their rhs nonzero values</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a55a06e41d7050066fd36210310b89d40">charerhs</a>( <span class="keyword">const</span> inciter::CProxy_CG&amp; worker,</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                   <span class="keywordtype">int</span> fromch,</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                   <span class="keyword">const</span> std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                   <span class="keyword">const</span> Fields&amp; r );</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">    //! Receive+add right-hand side vector nonzeros from fellow group branches</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a4c58ba59af290c75d153a475b278dd50">addrhs</a>( <span class="keywordtype">int</span> fromch,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                 <span class="keyword">const</span> std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt;&amp; r );</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">    //! Chares contribute to the rhs of the low-order linear system</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a654486524ba64903c8241c8ba988d066">charelowrhs</a>( <span class="keywordtype">int</span> fromch,</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                      <span class="keyword">const</span> std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                      <span class="keyword">const</span> Fields&amp; lowrhs );</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">    //! Receive+add low-order rhs vector nonzeros from fellow group branches</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a2750a5f1756091efb4fefef2e3c54e94">addlowrhs</a>( <span class="keywordtype">int</span> fromch,</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    <span class="keyword">const</span> std::map&lt; std::size_t,</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                    std::vector&lt; tk::real &gt; &gt;&amp; lowrhs );</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">    //! Chares contribute to the lhs of the low-order linear system</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a2e383a035e8831c2602783f03d1beb0f">charelowlhs</a>( <span class="keywordtype">int</span> fromch,</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                      <span class="keyword">const</span> std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                      <span class="keyword">const</span> Fields&amp; lowlhs );</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">    //! \brief Receive and add lhs vector to the low-order system from fellow</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">    //!   group branches</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#ad4db9887c8edf07d0e4bcb54c0dcdb93">addlowlhs</a>( <span class="keywordtype">int</span> fromch,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    <span class="keyword">const</span> std::map&lt; std::size_t,</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                    std::vector&lt; tk::real &gt; &gt;&amp; lowlhs );</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">    //! Assert that all global row indices have been received on my PE</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#aced72f90840bce3c1725dfb0d77c09be">rowsreceived</a>();</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">    //! Chares query side set info</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">    //! \note This function does not have to be declared as a Charm++ entry</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">    //!   method since it is always called by chares on the same PE.</span></div><div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a6b3b523d096850165aa3853913b19640">  300</a></span>&#160;<span class="comment"></span>    <span class="keyword">const</span> std::map&lt; int, std::vector&lt; std::size_t &gt; &gt;&amp; <a class="code" href="classtk_1_1_solver.html#a6b3b523d096850165aa3853913b19640">side</a>() { <span class="keywordflow">return</span> <a class="code" href="classtk_1_1_solver.html#a8c65ab8493c82ad5359d11e9e07b35c4">m_side</a>; }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">    //! Chares query Dirichlet boundary conditions</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">    //! \note This function does not have to be declared as a Charm++ entry</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">    //!   method since it is always called by chares on the same PE.</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span>    <span class="keyword">const</span> std::unordered_map&lt; std::size_t,</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt;&amp;</div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a4761ce81512f1be3e7256b58d42f281e">  307</a></span>&#160;      <a class="code" href="classtk_1_1_solver.html#a4761ce81512f1be3e7256b58d42f281e">dirbc</a>() { <span class="keywordflow">return</span> <a class="code" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">m_bc</a>; }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">    //! \brief Chares contribute their global row ids and associated Dirichlet</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">    //!   boundary condition values at which they set BCs</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a3850261483923550e6bedb0a66a0175a">charebc</a>( <span class="keyword">const</span> std::unordered_map&lt; std::size_t,</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                          std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt;&amp; bc );</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">    //! Reduction target collecting the final aggregated BC node list map</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a2d617950c03716f48d61da94069e9e66">addbc</a>( CkReductionMsg* msg );</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">    //! \brief Chares contribute their numerical and analytical solutions</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">    //!   nonzero values for computing diagnostics</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a79a081933d00a3e29ef1edae2b39858d">charediag</a>( <span class="keywordtype">int</span> fromch,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    <span class="keyword">const</span> std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    <span class="keyword">const</span> Fields&amp; u,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    <span class="keyword">const</span> Fields&amp; a,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    <span class="keyword">const</span> std::vector&lt; tk::real &gt;&amp; v );</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">    //! \brief Receive numerical and analytical solution vector nonzeros from</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">    //!   fellow group branches for computing diagnostics</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a9b7772900d005ff050b53d9d367c1ba6">adddiag</a>( <span class="keywordtype">int</span> fromch,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                  std::map&lt; std::size_t,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    std::vector&lt; std::vector&lt; tk::real &gt; &gt; &gt;&amp; solution );</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">    //! Return processing element for global mesh row id</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> <a class="code" href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">pe</a>( std::size_t gid );</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">    //! Charm++ reduction callbacks associated to compile-time tags</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span>    <a class="code" href="structtk_1_1tuple_1_1tagged__tuple.html">tk::tuple::tagged_tuple</a>&lt;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="structtag_1_1row.html">tag::row</a>,   CkCallback</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      , <a class="code" href="structtag_1_1dt.html">tag::dt</a>,    CkCallback</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      , <a class="code" href="structtag_1_1coord.html">tag::coord</a>, CkCallback</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      , <a class="code" href="structtag_1_1diag.html">tag::diag</a>,  CkCallback</div><div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#aff2d766ddb2b7f7130d371f9d0b76880">  341</a></span>&#160;    &gt; <a class="code" href="classtk_1_1_solver.html#aff2d766ddb2b7f7130d371f9d0b76880">m_cb</a>;<span class="comment"></span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">    //! Global (as in file) mesh node IDs mapped to side set ids of the mesh</span></div><div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a8c65ab8493c82ad5359d11e9e07b35c4">  343</a></span>&#160;<span class="comment"></span>    std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; <a class="code" href="classtk_1_1_solver.html#a8c65ab8493c82ad5359d11e9e07b35c4">m_side</a>;</div><div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">  344</a></span>&#160;    std::size_t <a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>;        <span class="comment">//!&lt; Number of scalar components per unknown</span></div><div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">  345</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">m_nchare</a>;       <span class="comment">//!&lt; Number of chares contributing to my PE</span></div><div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">  346</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">m_nperow</a>;       <span class="comment">//!&lt; Number of fellow PEs to send row ids to</span></div><div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#acd9d7306f5a5e0a30709c61c9e6f4bcb">  347</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_solver.html#acd9d7306f5a5e0a30709c61c9e6f4bcb">m_nchbc</a>;        <span class="comment">//!&lt; Number of chares we received bcs from</span></div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">  348</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a>;        <span class="comment">//!&lt; Lower index of the global rows on my PE</span></div><div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">  349</a></span>&#160;<span class="comment"></span>    std::size_t <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>;        <span class="comment">//!&lt; Upper index of the global rows on my PE</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"></span>    <span class="comment">//bool m_feedback;            //!&lt; Whether to send sub-task feedback to host</span><span class="comment"></span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">    //! Ids of workers on my PE</span></div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">  352</a></span>&#160;<span class="comment"></span>    std::vector&lt; int &gt; <a class="code" href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">m_myworker</a>;<span class="comment"></span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">    //! \brief Import map associating a list of global row ids to a worker chare</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">    //!   id during the communication of the global row ids</span></div><div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">  355</a></span>&#160;<span class="comment"></span>    std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; <a class="code" href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">m_rowimport</a>;<span class="comment"></span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">    //! \brief Import map associating a list of global row ids to a worker chare</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">    //!   id during the communication of the solution/unknown vector</span></div><div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">  358</a></span>&#160;<span class="comment"></span>    std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; <a class="code" href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">m_solimport</a>;<span class="comment"></span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">    //! \brief Import map associating a list of global row ids to a worker chare</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">    //!   id during the communication of the left-hand side matrix</span></div><div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a7fb039115d7990655180a208b2db100e">  361</a></span>&#160;<span class="comment"></span>    std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; <a class="code" href="classtk_1_1_solver.html#a7fb039115d7990655180a208b2db100e">m_lhsimport</a>;<span class="comment"></span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">    //! \brief Import map associating a list of global row ids to a worker chare</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">    //!   id during the communication of the righ-hand side vector</span></div><div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">  364</a></span>&#160;<span class="comment"></span>    std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; <a class="code" href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">m_rhsimport</a>;<span class="comment"></span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">    //! \brief Import map associating a list of global row ids to a worker chare</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">    //!   id during the communication of the low-order rhs vector</span></div><div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">  367</a></span>&#160;<span class="comment"></span>    std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; <a class="code" href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">m_lowrhsimport</a>;<span class="comment"></span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">    //! \brief Import map associating a list of global row ids to a worker chare</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">    //!   id during the communication of the low-order lhs vector</span></div><div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a0e65b31fc4d20bebd4f8fa9d12f4f11e">  370</a></span>&#160;<span class="comment"></span>    std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; <a class="code" href="classtk_1_1_solver.html#a0e65b31fc4d20bebd4f8fa9d12f4f11e">m_lowlhsimport</a>;<span class="comment"></span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">    //! \brief Import map associating a list of global row ids to a worker chare</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">    //!   id during the communication of the solution/unknown vector for</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">    //!   computing diagnostics, e.g., residuals</span></div><div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">  374</a></span>&#160;<span class="comment"></span>    std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; <a class="code" href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">m_diagimport</a>;<span class="comment"></span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">    //! Part of global row indices owned by my PE</span></div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">  376</a></span>&#160;<span class="comment"></span>    std::set&lt; std::size_t &gt; <a class="code" href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">m_row</a>;<span class="comment"></span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">    //! \brief Part of unknown/solution vector owned by my PE</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">    //! \details Vector of values (for each scalar equation solved) associated</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">    //!   to global mesh point row IDs</span></div><div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">  380</a></span>&#160;<span class="comment"></span>    std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; <a class="code" href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">m_sol</a>;<span class="comment"></span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">    //! \brief Part of left-hand side matrix owned by my PE</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">    //! \details Nonzero values (for each scalar equation solved) associated to</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">    //!   global mesh point row and column IDs.</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span>    std::map&lt; std::size_t,</div><div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">  385</a></span>&#160;              std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; <a class="code" href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">m_lhs</a>;<span class="comment"></span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">    //! \brief Part of right-hand side vector owned by my PE</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">    //! \details Vector of values (for each scalar equation solved) associated</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">    //!   to global mesh point row ids</span></div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">  389</a></span>&#160;<span class="comment"></span>    std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; <a class="code" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">m_rhs</a>;<span class="comment"></span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">    //! \brief Part of low-order right-hand side vector owned by my PE</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">    //! \details Vector of values (for each scalar equation solved) associated</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">    //!   to global mesh point row ids. This vector collects the rhs</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">    //!   terms to be combined with the rhs to produce the low-order rhs.</span></div><div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">  394</a></span>&#160;<span class="comment"></span>    std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; <a class="code" href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">m_lowrhs</a>;<span class="comment"></span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">    //! \brief Part of the low-order system left-hand side vector owned by my PE</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">    //! \details Vector of values (for each scalar equation solved) associated</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">    //!   to global mesh point row ids. This vector collects the nonzero values</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">    //!   of the low-order system lhs &quot;matrix&quot; solution.</span></div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">  399</a></span>&#160;<span class="comment"></span>    std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; <a class="code" href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">m_lowlhs</a>;<span class="comment"></span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">    //! \brief Part of solution vector owned by my PE</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">    //! \details Vector of values (for each scalar equation solved) associated</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">    //!   to global mesh point row IDs. The map-value is a pair of vectors,</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">    //!   where the first one is the numerical and the second one is the</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">    //!   analytical solution. If the analytical solution for a PDE is not</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">    //!   defined, it is the initial condition.</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">    //! \see charediag(), adddiag(), e.g., inciter::CG::diagnostics()</span></div><div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#aeb7e186805440317cd4368ee3a15eef0">  407</a></span>&#160;<span class="comment"></span>    std::map&lt; std::size_t, std::vector&lt; std::vector&lt; tk::real &gt; &gt; &gt; <a class="code" href="classtk_1_1_solver.html#aeb7e186805440317cd4368ee3a15eef0">m_diag</a>;</div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">  408</a></span>&#160;    <a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html">tk::hypre::HypreVector</a> <a class="code" href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">m_x</a>; <span class="comment">//!&lt; Hypre vector to store the solution/unknowns</span></div><div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">  409</a></span>&#160;<span class="comment"></span>    <a class="code" href="classtk_1_1hypre_1_1_hypre_matrix.html">tk::hypre::HypreMatrix</a> <a class="code" href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">m_A</a>; <span class="comment">//!&lt; Hypre matrix to store the left-hand side</span></div><div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">  410</a></span>&#160;<span class="comment"></span>    <a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html">tk::hypre::HypreVector</a> <a class="code" href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">m_b</a>; <span class="comment">//!&lt; Hypre vector to store the right-hand side</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"></span><span class="comment">    //! Hypre solver</span></div><div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a8b9162f97c74ba4c2101da82cd00ae95">  412</a></span>&#160;<span class="comment"></span>    <a class="code" href="classtk_1_1hypre_1_1_hypre_solver.html">tk::hypre::HypreSolver</a> <a class="code" href="classtk_1_1_solver.html#a8b9162f97c74ba4c2101da82cd00ae95">m_solver</a>;<span class="comment"></span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">    //! Row indices for my PE</span></div><div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">  414</a></span>&#160;<span class="comment"></span>    std::vector&lt; int &gt; <a class="code" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">m_hypreRows</a>;<span class="comment"></span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">    //! Number of matrix columns/rows on my PE</span></div><div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#aeaa19ea4a831054772289e836be73208">  416</a></span>&#160;<span class="comment"></span>    std::vector&lt; int &gt; <a class="code" href="classtk_1_1_solver.html#aeaa19ea4a831054772289e836be73208">m_hypreNcols</a>;<span class="comment"></span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">    //! Matrix column indices for rows on my PE</span></div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a131b3e1a92fb6922fa01202d01f63da5">  418</a></span>&#160;<span class="comment"></span>    std::vector&lt; int &gt; <a class="code" href="classtk_1_1_solver.html#a131b3e1a92fb6922fa01202d01f63da5">m_hypreCols</a>;<span class="comment"></span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">    //! Matrix nonzero values for my PE</span></div><div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a463ecb7a4fe179cf728b681fd568d325">  420</a></span>&#160;<span class="comment"></span>    std::vector&lt; tk::real &gt; <a class="code" href="classtk_1_1_solver.html#a463ecb7a4fe179cf728b681fd568d325">m_hypreMat</a>;<span class="comment"></span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">    //! RHS vector nonzero values for my PE</span></div><div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">  422</a></span>&#160;<span class="comment"></span>    std::vector&lt; tk::real &gt; <a class="code" href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">m_hypreRhs</a>;<span class="comment"></span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">    //! Solution vector nonzero values for my PE</span></div><div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">  424</a></span>&#160;<span class="comment"></span>    std::vector&lt; tk::real &gt; <a class="code" href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">m_hypreSol</a>;<span class="comment"></span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">    //! Global-&gt;local row id map for sending back solution vector parts</span></div><div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#aeb5c5c77b2cddf8dd06a5d64477a2bd7">  426</a></span>&#160;<span class="comment"></span>    std::map&lt; std::size_t, std::size_t &gt; <a class="code" href="classtk_1_1_solver.html#aeb5c5c77b2cddf8dd06a5d64477a2bd7">m_lid</a>;<span class="comment"></span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">    //! \brief PEs associated to lower and upper global row indices</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">    //! \details These are the divisions at which the linear system is divided</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">    //!   along PE boundaries.</span></div><div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#ae05ada0e47dc55cf2f7597813a112bb8">  430</a></span>&#160;<span class="comment"></span>    std::map&lt; std::pair&lt; std::size_t, std::size_t &gt;, <span class="keywordtype">int</span> &gt; <a class="code" href="classtk_1_1_solver.html#ae05ada0e47dc55cf2f7597813a112bb8">m_div</a>;<span class="comment"></span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">    //! \brief PEs associated to global mesh point indices</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">    //! \details This is used to cache the PE associated to mesh nodes</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">    //!   communicated, so that a quicker-than-linear-cost search can be used to</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">    //!   find the PE for a communicated mesh node after the node is in the</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">    //!   cache.</span></div><div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#aa7c5cb2402a3aa4b4f411a9f516c5ceb">  436</a></span>&#160;<span class="comment"></span>    std::map&lt; std::size_t, int &gt; <a class="code" href="classtk_1_1_solver.html#aa7c5cb2402a3aa4b4f411a9f516c5ceb">m_pe</a>;<span class="comment"></span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">    //! \brief Values (for each scalar equation solved) of Dirichlet boundary</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">    //!   conditions assigned to global node IDs we set</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">    //! \details The map key is the global mesh node/row ID, the value is a</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">    //!   vector of pairs in which the bool (.first) indicates whether the</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">    //!   boundary condition value (.second) is set at the given node. The size</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">    //!   of the vectors is the number of PDEs integrated times the number of</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">    //!   scalar components in all PDEs. This BC map stores all row IDs at which</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">    //!   Dirichlet boundary conditions are prescribed, i.e., including boundary</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">    //!   conditions set across all PEs, not just the ones need to be set on</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">    //!   this PE.</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment"></span>    std::unordered_map&lt; std::size_t,</div><div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">  448</a></span>&#160;                        std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; <a class="code" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">m_bc</a>;<span class="comment"></span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">    //! Matrix non-zero coefficients for Dirichlet boundary conditions</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span>    std::unordered_map&lt; std::size_t,</div><div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#acee52a58249f1160f1c705d9b6e29ddf">  451</a></span>&#160;                        std::map&lt; std::size_t, std::vector&lt;tk::real&gt; &gt; &gt; <a class="code" href="classtk_1_1_solver.html#acee52a58249f1160f1c705d9b6e29ddf">m_bca</a>;<span class="comment"></span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">    //! Worker proxy</span></div><div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="classtk_1_1_solver.html#a123c1061f4552868a1e44a14e1e65f9f">  453</a></span>&#160;<span class="comment"></span>    inciter::CProxy_CG <a class="code" href="classtk_1_1_solver.html#a123c1061f4552868a1e44a14e1e65f9f">m_worker</a>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">    //! Check if we have done our part in storing and exporting global row ids</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classtk_1_1_solver.html#a9f818da983b16b063215c6abeb17eb85">rowcomplete</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">    //! Check if our portion of the solution vector values is complete</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classtk_1_1_solver.html#acfa0eb96404c975cb02639300ae739b5">solcomplete</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">    //! Check if our portion of the matrix values is complete</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classtk_1_1_solver.html#af61e84ad65a61447da298d8ac96bef23">lhscomplete</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">    //! \brief Check if our portion of the solution vector values (for</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">    //!   diagnostics) is complete</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classtk_1_1_solver.html#a415fb78532c6817ab12deb9fe5ab4982">diagcomplete</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">    //! Check if our portion of the right-hand side vector values is complete</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classtk_1_1_solver.html#aad32c27e97e90f3f302984db6bcfdaf6">rhscomplete</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">    //! Check if our portion of the low-order rhs vector values is complete</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classtk_1_1_solver.html#a0989c9167aab10e23096c1ee84d4be30">lowrhscomplete</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">    //! Check if our portion of the low-order lhs vector values is complete</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classtk_1_1_solver.html#a6191d0983a4fd8635ca90ea58df06d99">lowlhscomplete</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">    //! Check if contributions to global row IDs are complete</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a84fdd731ef49944110c21d7645883829">checkifrowcomplete</a>();</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">    //! Check if contributions to unknown/solution vector are complete</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a109fc9cd6c8a31503f4f9c31ddf90a24">checkifsolcomplete</a>();</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">    //! Build Hypre data for our portion of the global row ids</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a3ed80bcf668e291b5f571a73650027a2">hyprerow</a>();</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">    //! Set boundary conditions on the left-hand side matrix</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#af6deaa8e458f6df24e635265d0b51584">lhsbc</a>();</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">    //! Set Dirichlet boundary conditions on the right-hand side vector</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a07ff8b79a6fe088d62bef9347a50c4db">rhsbc</a>();</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">    //! Build Hypre data for our portion of the solution vector</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a3434a8203d2836c49abc55c324ed7a14">hypresol</a>();</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">    //! Build Hypre data for our portion of the matrix</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#af9cb98d033677aaf8e1f9cd56e443f42">hyprelhs</a>();</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">    //! Build Hypre data for our portion of the right-hand side vector</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a58ce170f76d94f412e0a5ac8a2e19ac7">hyprerhs</a>();</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">    //! Set our portion of values of the distributed solution vector</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a71d371296bc61c43fd36386df31fcbc4">sol</a>();</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">    //! Set our portion of values of the distributed matrix</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a6f9c5ff09968b7b87d9cb0c22f4cf2e2">lhs</a>();</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">    //! Set our portion of values of the distributed right-hand side vector</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#ab2038dcb1e9162ace96fc410fc67991d">rhs</a>();</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">    //! Assemble distributed solution vector</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#ac498f4a8a36dd945676a64f7aea5eb57">assemblesol</a>();</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">    //! Assemble distributed matrix</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#ad4d563eb6596a6921db5549aedc18439">assemblelhs</a>();</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">    //! Assemble distributed right-hand side vector</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#aa0edf5008623c35127cf930054c00a9e">assemblerhs</a>();</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">    //! Update solution vector in our PE&#39;s workers</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#ac4260f32744d54b5f8ea91fd492a456b">updateSol</a>();</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">    //! Solve hyigh-order linear system</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#ab651560a089c3beaf420deb61ea4bd87">solve</a>();</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">    //! Update low-order solution vector in our PE&#39;s workers</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#afd2cf6f3695d1007aedfd69bcd847d36">updateLowSol</a>();</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">    //! Solve low-order linear system</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a7bfe4d55939e03e51bb0e9b9547f2e7a">lowsolve</a>();</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">    //! Update diagnostics vector</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#a779d2ccb6a57583bde1c77bc3589504f">updateDiag</a>( std::size_t row,</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                     std::vector&lt; tk::real &gt;&amp;&amp; u,</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                     std::vector&lt; tk::real &gt;&amp;&amp; a,</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                     <a class="code" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> v );</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">    //! Compute diagnostics (residuals) and contribute them back to host</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classtk_1_1_solver.html#ab94d600572564911f7faa8e7d3168fb9">diagnostics</a>();</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;};</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;} <span class="comment">// tk::</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="preprocessor">#endif // Solver_h</span></div><div class="ttc" id="classtk_1_1_solver_html_ab651560a089c3beaf420deb61ea4bd87"><div class="ttname"><a href="classtk_1_1_solver.html#ab651560a089c3beaf420deb61ea4bd87">tk::Solver::solve</a></div><div class="ttdeci">void solve()</div><div class="ttdoc">Solve hyigh-order linear system. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01202">Solver.C:1202</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aee8a7b9bf4f8c3c4c85f6c246a5817cb"><div class="ttname"><a href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">tk::Solver::m_x</a></div><div class="ttdeci">tk::hypre::HypreVector m_x</div><div class="ttdoc">Hypre vector to store the solution/unknowns. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00408">Solver.h:408</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aaaa8b3117a8a96197d39b8a5e7eaae66"><div class="ttname"><a href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">tk::Solver::m_A</a></div><div class="ttdeci">tk::hypre::HypreMatrix m_A</div><div class="ttdoc">Hypre matrix to store the left-hand side. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00409">Solver.h:409</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a0d82dd86315e09ac53e73bb1a70fd405"><div class="ttname"><a href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">tk::Solver::pe</a></div><div class="ttdeci">int pe(std::size_t gid)</div><div class="ttdoc">Return processing element for global mesh row id. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00726">Solver.C:726</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aff0985fc91d7845dc68843b21b885497"><div class="ttname"><a href="classtk_1_1_solver.html#aff0985fc91d7845dc68843b21b885497">tk::Solver::registerBCMerger</a></div><div class="ttdeci">static void registerBCMerger()</div><div class="ttdoc">Configure Charm++ reduction types for concatenating BC nodelists. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00121">Solver.C:121</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a9b7772900d005ff050b53d9d367c1ba6"><div class="ttname"><a href="classtk_1_1_solver.html#a9b7772900d005ff050b53d9d367c1ba6">tk::Solver::adddiag</a></div><div class="ttdeci">void adddiag(int fromch, std::map&lt; std::size_t, std::vector&lt; std::vector&lt; tk::real &gt; &gt; &gt; &amp;solution)</div><div class="ttdoc">Receive numerical and analytical solution vector nonzeros from fellow group branches for computing di...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00704">Solver.C:704</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aad32c27e97e90f3f302984db6bcfdaf6"><div class="ttname"><a href="classtk_1_1_solver.html#aad32c27e97e90f3f302984db6bcfdaf6">tk::Solver::rhscomplete</a></div><div class="ttdeci">bool rhscomplete() const</div><div class="ttdoc">Check if our portion of the right-hand side vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00808">Solver.C:808</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a8b9162f97c74ba4c2101da82cd00ae95"><div class="ttname"><a href="classtk_1_1_solver.html#a8b9162f97c74ba4c2101da82cd00ae95">tk::Solver::m_solver</a></div><div class="ttdeci">tk::hypre::HypreSolver m_solver</div><div class="ttdoc">Hypre solver. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00412">Solver.h:412</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aa91c68e53e18f58cdc2ff5db1ea9477b"><div class="ttname"><a href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">tk::Solver::m_hypreRhs</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreRhs</div><div class="ttdoc">RHS vector nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00422">Solver.h:422</a></div></div>
<div class="ttc" id="structtk_1_1tuple_1_1tagged__tuple_html"><div class="ttname"><a href="structtk_1_1tuple_1_1tagged__tuple.html">tk::tuple::tagged_tuple</a></div><div class="ttdef"><b>Definition:</b> <a href="_tagged_tuple_8h_source.html#l00101">TaggedTuple.h:101</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a4d1489fadc01b7698a464c1dd04d10aa"><div class="ttname"><a href="classtk_1_1_solver.html#a4d1489fadc01b7698a464c1dd04d10aa">tk::Solver::addlhs</a></div><div class="ttdeci">void addlhs(int fromch, const std::map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; &amp;l)</div><div class="ttdoc">Receive matrix nonzeros from fellow group branches. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00397">Solver.C:397</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html">tk::hypre::HypreVector</a></div><div class="ttdoc">Hypre vector class. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00021">HypreVector.h:21</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a2eb7392a5115a24b78e527ba1e7790ac"><div class="ttname"><a href="classtk_1_1_solver.html#a2eb7392a5115a24b78e527ba1e7790ac">tk::Solver::charelhs</a></div><div class="ttdeci">void charelhs(int fromch, const std::vector&lt; std::size_t &gt; &amp;gid, const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;psup, const tk::Fields &amp;lhsd, const tk::Fields &amp;lhso)</div><div class="ttdoc">Chares contribute their matrix nonzero values. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00339">Solver.C:339</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a7f94d0cea62cb5114ad313d79a1664f0"><div class="ttname"><a href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">tk::Solver::m_sol</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_sol</div><div class="ttdoc">Part of unknown/solution vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00380">Solver.h:380</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a3ed80bcf668e291b5f571a73650027a2"><div class="ttname"><a href="classtk_1_1_solver.html#a3ed80bcf668e291b5f571a73650027a2">tk::Solver::hyprerow</a></div><div class="ttdeci">void hyprerow()</div><div class="ttdoc">Build Hypre data for our portion of the global row ids. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00866">Solver.C:866</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a123c1061f4552868a1e44a14e1e65f9f"><div class="ttname"><a href="classtk_1_1_solver.html#a123c1061f4552868a1e44a14e1e65f9f">tk::Solver::m_worker</a></div><div class="ttdeci">inciter::CProxy_CG m_worker</div><div class="ttdoc">Worker proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00453">Solver.h:453</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a131b3e1a92fb6922fa01202d01f63da5"><div class="ttname"><a href="classtk_1_1_solver.html#a131b3e1a92fb6922fa01202d01f63da5">tk::Solver::m_hypreCols</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreCols</div><div class="ttdoc">Matrix column indices for rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00418">Solver.h:418</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a0e65b31fc4d20bebd4f8fa9d12f4f11e"><div class="ttname"><a href="classtk_1_1_solver.html#a0e65b31fc4d20bebd4f8fa9d12f4f11e">tk::Solver::m_lowlhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lowlhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00370">Solver.h:370</a></div></div>
<div class="ttc" id="structtag_1_1coord_html"><div class="ttname"><a href="structtag_1_1coord.html">tag::coord</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00159">Tags.h:159</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ac4260f32744d54b5f8ea91fd492a456b"><div class="ttname"><a href="classtk_1_1_solver.html#ac4260f32744d54b5f8ea91fd492a456b">tk::Solver::updateSol</a></div><div class="ttdeci">void updateSol()</div><div class="ttdoc">Update solution vector in our PE&amp;#39;s workers. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01165">Solver.C:1165</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00344">Solver.h:344</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ad4db9887c8edf07d0e4bcb54c0dcdb93"><div class="ttname"><a href="classtk_1_1_solver.html#ad4db9887c8edf07d0e4bcb54c0dcdb93">tk::Solver::addlowlhs</a></div><div class="ttdeci">void addlowlhs(int fromch, const std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &amp;lowlhs)</div><div class="ttdoc">Receive and add lhs vector to the low-order system from fellow group branches. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00572">Solver.C:572</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a15cb29c1ed768f5e288c4c1cc1dbfe3c"><div class="ttname"><a href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">tk::Solver::m_bc</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; m_bc</div><div class="ttdoc">Values (for each scalar equation solved) of Dirichlet boundary conditions assigned to global node IDs...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00448">Solver.h:448</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aa0edf5008623c35127cf930054c00a9e"><div class="ttname"><a href="classtk_1_1_solver.html#aa0edf5008623c35127cf930054c00a9e">tk::Solver::assemblerhs</a></div><div class="ttdeci">void assemblerhs()</div><div class="ttdoc">Assemble distributed right-hand side vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01155">Solver.C:1155</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a7e279112bc8c77fd556eb88f059566b9"><div class="ttname"><a href="classtk_1_1_solver.html#a7e279112bc8c77fd556eb88f059566b9">tk::Solver::charerow</a></div><div class="ttdeci">void charerow(int fromch, const std::vector&lt; std::size_t &gt; &amp;row)</div><div class="ttdoc">Chares contribute their global row ids. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00224">Solver.C:224</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab2038dcb1e9162ace96fc410fc67991d"><div class="ttname"><a href="classtk_1_1_solver.html#ab2038dcb1e9162ace96fc410fc67991d">tk::Solver::rhs</a></div><div class="ttdeci">void rhs()</div><div class="ttdoc">Set our portion of values of the distributed right-hand side vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01118">Solver.C:1118</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a0989c9167aab10e23096c1ee84d4be30"><div class="ttname"><a href="classtk_1_1_solver.html#a0989c9167aab10e23096c1ee84d4be30">tk::Solver::lowrhscomplete</a></div><div class="ttdeci">bool lowrhscomplete() const</div><div class="ttdoc">Check if our portion of the low-order rhs vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00818">Solver.C:818</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00348">Solver.h:348</a></div></div>
<div class="ttc" id="_tags_8h_html"><div class="ttname"><a href="_tags_8h.html">Tags.h</a></div><div class="ttdoc">Tags. </div></div>
<div class="ttc" id="solver_8decl_8h_html"><div class="ttname"><a href="solver_8decl_8h.html">solver.decl.h</a></div><div class="ttdoc">Include solver.decl.h with turning off specific compiler warnings. </div></div>
<div class="ttc" id="classtk_1_1_solver_html_a2e383a035e8831c2602783f03d1beb0f"><div class="ttname"><a href="classtk_1_1_solver.html#a2e383a035e8831c2602783f03d1beb0f">tk::Solver::charelowlhs</a></div><div class="ttdeci">void charelowlhs(int fromch, const std::vector&lt; std::size_t &gt; &amp;gid, const Fields &amp;lowlhs)</div><div class="ttdoc">Chares contribute to the lhs of the low-order linear system. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00535">Solver.C:535</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab94d600572564911f7faa8e7d3168fb9"><div class="ttname"><a href="classtk_1_1_solver.html#ab94d600572564911f7faa8e7d3168fb9">tk::Solver::diagnostics</a></div><div class="ttdeci">void diagnostics()</div><div class="ttdoc">Compute diagnostics (residuals) and contribute them back to host. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01332">Solver.C:1332</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a798bf7f5ab59aa65cfc00dfe0631ed7e"><div class="ttname"><a href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">tk::Solver::m_lowrhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_lowrhs</div><div class="ttdoc">Part of low-order right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00394">Solver.h:394</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a3850261483923550e6bedb0a66a0175a"><div class="ttname"><a href="classtk_1_1_solver.html#a3850261483923550e6bedb0a66a0175a">tk::Solver::charebc</a></div><div class="ttdeci">void charebc(const std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; &amp;bc)</div><div class="ttdoc">Chares contribute their global row ids and associated Dirichlet boundary condition values at which th...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00615">Solver.C:615</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae64639059051bc44536ed5e7452632f4"><div class="ttname"><a href="classtk_1_1_solver.html#ae64639059051bc44536ed5e7452632f4">tk::Solver::bounds</a></div><div class="ttdeci">void bounds(int p, std::size_t lower, std::size_t upper)</div><div class="ttdoc">Receive lower and upper global node IDs all PEs will operate on. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00139">Solver.C:139</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a55a06e41d7050066fd36210310b89d40"><div class="ttname"><a href="classtk_1_1_solver.html#a55a06e41d7050066fd36210310b89d40">tk::Solver::charerhs</a></div><div class="ttdeci">void charerhs(const inciter::CProxy_CG &amp;worker, int fromch, const std::vector&lt; std::size_t &gt; &amp;gid, const Fields &amp;r)</div><div class="ttdoc">Chares contribute their rhs nonzero values. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00418">Solver.C:418</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a2750a5f1756091efb4fefef2e3c54e94"><div class="ttname"><a href="classtk_1_1_solver.html#a2750a5f1756091efb4fefef2e3c54e94">tk::Solver::addlowrhs</a></div><div class="ttdeci">void addlowrhs(int fromch, const std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &amp;lowrhs)</div><div class="ttdoc">Receive+add low-order rhs vector nonzeros from fellow group branches. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00514">Solver.C:514</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a1fb120745008c33ab1831f790db4a364"><div class="ttname"><a href="classtk_1_1_solver.html#a1fb120745008c33ab1831f790db4a364">tk::Solver::Solver</a></div><div class="ttdeci">Solver(const std::vector&lt; CkCallback &gt; &amp;cb, const std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; &amp;s, std::size_t n, bool)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00050">Solver.C:50</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a8c65ab8493c82ad5359d11e9e07b35c4"><div class="ttname"><a href="classtk_1_1_solver.html#a8c65ab8493c82ad5359d11e9e07b35c4">tk::Solver::m_side</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_side</div><div class="ttdoc">Global (as in file) mesh node IDs mapped to side set ids of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00343">Solver.h:343</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_af0c77bd852425a6506ffee14ffbddba2"><div class="ttname"><a href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">tk::Solver::m_lowlhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_lowlhs</div><div class="ttdoc">Part of the low-order system left-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00399">Solver.h:399</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a415fb78532c6817ab12deb9fe5ab4982"><div class="ttname"><a href="classtk_1_1_solver.html#a415fb78532c6817ab12deb9fe5ab4982">tk::Solver::diagcomplete</a></div><div class="ttdeci">bool diagcomplete() const</div><div class="ttdoc">Check if our portion of the solution vector values (for diagnostics) is complete. ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00797">Solver.C:797</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_af61e84ad65a61447da298d8ac96bef23"><div class="ttname"><a href="classtk_1_1_solver.html#af61e84ad65a61447da298d8ac96bef23">tk::Solver::lhscomplete</a></div><div class="ttdeci">bool lhscomplete() const</div><div class="ttdoc">Check if our portion of the matrix values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00787">Solver.C:787</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a989650135b8066b1d562bef134e6c74e"><div class="ttname"><a href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">tk::Solver::m_rhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00364">Solver.h:364</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ac498f4a8a36dd945676a64f7aea5eb57"><div class="ttname"><a href="classtk_1_1_solver.html#ac498f4a8a36dd945676a64f7aea5eb57">tk::Solver::assemblesol</a></div><div class="ttdeci">void assemblesol()</div><div class="ttdoc">Assemble distributed solution vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01135">Solver.C:1135</a></div></div>
<div class="ttc" id="_tagged_tuple_8h_html"><div class="ttname"><a href="_tagged_tuple_8h.html">TaggedTuple.h</a></div><div class="ttdoc">Tagged tuple allowing tag-based access. </div></div>
<div class="ttc" id="classtk_1_1_solver_html_a654486524ba64903c8241c8ba988d066"><div class="ttname"><a href="classtk_1_1_solver.html#a654486524ba64903c8241c8ba988d066">tk::Solver::charelowrhs</a></div><div class="ttdeci">void charelowrhs(int fromch, const std::vector&lt; std::size_t &gt; &amp;gid, const Fields &amp;lowrhs)</div><div class="ttdoc">Chares contribute to the rhs of the low-order linear system. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00477">Solver.C:477</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae890e5746f0ed9790380e6acd2b6a358"><div class="ttname"><a href="classtk_1_1_solver.html#ae890e5746f0ed9790380e6acd2b6a358">tk::Solver::addrow</a></div><div class="ttdeci">void addrow(int fromch, int frompe, const std::set&lt; std::size_t &gt; &amp;row)</div><div class="ttdoc">Receive global row ids from fellow group branches. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00257">Solver.C:257</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a79a081933d00a3e29ef1edae2b39858d"><div class="ttname"><a href="classtk_1_1_solver.html#a79a081933d00a3e29ef1edae2b39858d">tk::Solver::charediag</a></div><div class="ttdeci">void charediag(int fromch, const std::vector&lt; std::size_t &gt; &amp;gid, const Fields &amp;u, const Fields &amp;a, const std::vector&lt; tk::real &gt; &amp;v)</div><div class="ttdoc">Chares contribute their numerical and analytical solutions nonzero values for computing diagnostics...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00660">Solver.C:660</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ababfdb48bb065b69d1222582c61db6e1"><div class="ttname"><a href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">tk::Solver::m_row</a></div><div class="ttdeci">std::set&lt; std::size_t &gt; m_row</div><div class="ttdoc">Part of global row indices owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00376">Solver.h:376</a></div></div>
<div class="ttc" id="_hypre_vector_8h_html"><div class="ttname"><a href="_hypre_vector_8h.html">HypreVector.h</a></div><div class="ttdoc">Hypre IJ vector class. </div></div>
<div class="ttc" id="classtk_1_1_solver_html_a6f9c5ff09968b7b87d9cb0c22f4cf2e2"><div class="ttname"><a href="classtk_1_1_solver.html#a6f9c5ff09968b7b87d9cb0c22f4cf2e2">tk::Solver::lhs</a></div><div class="ttdeci">void lhs()</div><div class="ttdoc">Set our portion of values of the distributed matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01099">Solver.C:1099</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_acfa0eb96404c975cb02639300ae739b5"><div class="ttname"><a href="classtk_1_1_solver.html#acfa0eb96404c975cb02639300ae739b5">tk::Solver::solcomplete</a></div><div class="ttdeci">bool solcomplete() const</div><div class="ttdoc">Check if our portion of the solution vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00776">Solver.C:776</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a3434a8203d2836c49abc55c324ed7a14"><div class="ttname"><a href="classtk_1_1_solver.html#a3434a8203d2836c49abc55c324ed7a14">tk::Solver::hypresol</a></div><div class="ttdeci">void hypresol()</div><div class="ttdoc">Build Hypre data for our portion of the solution vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01022">Solver.C:1022</a></div></div>
<div class="ttc" id="structtag_1_1row_html"><div class="ttname"><a href="structtag_1_1row.html">tag::row</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00158">Tags.h:158</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a4e3671da52361509cca6781a7aab834c"><div class="ttname"><a href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">tk::Solver::m_nperow</a></div><div class="ttdeci">std::size_t m_nperow</div><div class="ttdoc">Number of fellow PEs to send row ids to. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00346">Solver.h:346</a></div></div>
<div class="ttc" id="_hypre_solver_8h_html"><div class="ttname"><a href="_hypre_solver_8h.html">HypreSolver.h</a></div><div class="ttdoc">Hypre solver class. </div></div>
<div class="ttc" id="classtk_1_1_solver_html_a7bfe4d55939e03e51bb0e9b9547f2e7a"><div class="ttname"><a href="classtk_1_1_solver.html#a7bfe4d55939e03e51bb0e9b9547f2e7a">tk::Solver::lowsolve</a></div><div class="ttdeci">void lowsolve()</div><div class="ttdoc">Solve low-order linear system. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01240">Solver.C:1240</a></div></div>
<div class="ttc" id="cg_8decl_8h_html"><div class="ttname"><a href="cg_8decl_8h.html">cg.decl.h</a></div><div class="ttdoc">Include cg.decl.h with turning off specific compiler warnings. </div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeb5c5c77b2cddf8dd06a5d64477a2bd7"><div class="ttname"><a href="classtk_1_1_solver.html#aeb5c5c77b2cddf8dd06a5d64477a2bd7">tk::Solver::m_lid</a></div><div class="ttdeci">std::map&lt; std::size_t, std::size_t &gt; m_lid</div><div class="ttdoc">Global-&gt;local row id map for sending back solution vector parts. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00426">Solver.h:426</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_acee52a58249f1160f1c705d9b6e29ddf"><div class="ttname"><a href="classtk_1_1_solver.html#acee52a58249f1160f1c705d9b6e29ddf">tk::Solver::m_bca</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; m_bca</div><div class="ttdoc">Matrix non-zero coefficients for Dirichlet boundary conditions. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00451">Solver.h:451</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a4c58ba59af290c75d153a475b278dd50"><div class="ttname"><a href="classtk_1_1_solver.html#a4c58ba59af290c75d153a475b278dd50">tk::Solver::addrhs</a></div><div class="ttdeci">void addrhs(int fromch, const std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &amp;r)</div><div class="ttdoc">Receive+add right-hand side vector nonzeros from fellow group branches. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00458">Solver.C:458</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a2ec72eba8056ffe153131495383e8946"><div class="ttname"><a href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">tk::Solver::m_hypreRows</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreRows</div><div class="ttdoc">Row indices for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00414">Solver.h:414</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5e9b584b84dbca204b2c55322a487d85"><div class="ttname"><a href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">tk::Solver::m_rhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_rhs</div><div class="ttdoc">Part of right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00389">Solver.h:389</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a84fdd731ef49944110c21d7645883829"><div class="ttname"><a href="classtk_1_1_solver.html#a84fdd731ef49944110c21d7645883829">tk::Solver::checkifrowcomplete</a></div><div class="ttdeci">void checkifrowcomplete()</div><div class="ttdoc">Check if contributions to global row IDs are complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00838">Solver.C:838</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a779d2ccb6a57583bde1c77bc3589504f"><div class="ttname"><a href="classtk_1_1_solver.html#a779d2ccb6a57583bde1c77bc3589504f">tk::Solver::updateDiag</a></div><div class="ttdeci">void updateDiag(std::size_t row, std::vector&lt; tk::real &gt; &amp;&amp;u, std::vector&lt; tk::real &gt; &amp;&amp;a, tk::real v)</div><div class="ttdoc">Update diagnostics vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01299">Solver.C:1299</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_acd9d7306f5a5e0a30709c61c9e6f4bcb"><div class="ttname"><a href="classtk_1_1_solver.html#acd9d7306f5a5e0a30709c61c9e6f4bcb">tk::Solver::m_nchbc</a></div><div class="ttdeci">std::size_t m_nchbc</div><div class="ttdoc">Number of chares we received bcs from. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00347">Solver.h:347</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a4761ce81512f1be3e7256b58d42f281e"><div class="ttname"><a href="classtk_1_1_solver.html#a4761ce81512f1be3e7256b58d42f281e">tk::Solver::dirbc</a></div><div class="ttdeci">const std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; &amp; dirbc()</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00307">Solver.h:307</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a785b937d0f47b18b3f5a7dd41fb2a5b4"><div class="ttname"><a href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">tk::Solver::m_lowrhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lowrhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00367">Solver.h:367</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aff2d766ddb2b7f7130d371f9d0b76880"><div class="ttname"><a href="classtk_1_1_solver.html#aff2d766ddb2b7f7130d371f9d0b76880">tk::Solver::m_cb</a></div><div class="ttdeci">tk::tuple::tagged_tuple&lt; tag::row, CkCallback, tag::dt, CkCallback, tag::coord, CkCallback, tag::diag, CkCallback &gt; m_cb</div><div class="ttdoc">Charm++ reduction callbacks associated to compile-time tags. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00341">Solver.h:341</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aa7c5cb2402a3aa4b4f411a9f516c5ceb"><div class="ttname"><a href="classtk_1_1_solver.html#aa7c5cb2402a3aa4b4f411a9f516c5ceb">tk::Solver::m_pe</a></div><div class="ttdeci">std::map&lt; std::size_t, int &gt; m_pe</div><div class="ttdoc">PEs associated to global mesh point indices. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00436">Solver.h:436</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a6191d0983a4fd8635ca90ea58df06d99"><div class="ttname"><a href="classtk_1_1_solver.html#a6191d0983a4fd8635ca90ea58df06d99">tk::Solver::lowlhscomplete</a></div><div class="ttdeci">bool lowlhscomplete() const</div><div class="ttdoc">Check if our portion of the low-order lhs vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00828">Solver.C:828</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ad4d563eb6596a6921db5549aedc18439"><div class="ttname"><a href="classtk_1_1_solver.html#ad4d563eb6596a6921db5549aedc18439">tk::Solver::assemblelhs</a></div><div class="ttdeci">void assemblelhs()</div><div class="ttdoc">Assemble distributed matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01145">Solver.C:1145</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afd2cf6f3695d1007aedfd69bcd847d36"><div class="ttname"><a href="classtk_1_1_solver.html#afd2cf6f3695d1007aedfd69bcd847d36">tk::Solver::updateLowSol</a></div><div class="ttdeci">void updateLowSol()</div><div class="ttdoc">Update low-order solution vector in our PE&amp;#39;s workers. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01216">Solver.C:1216</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae08497a429ae63351cebcbb73e8cdaa7"><div class="ttname"><a href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">tk::Solver::m_solimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_solimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00358">Solver.h:358</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a07ff8b79a6fe088d62bef9347a50c4db"><div class="ttname"><a href="classtk_1_1_solver.html#a07ff8b79a6fe088d62bef9347a50c4db">tk::Solver::rhsbc</a></div><div class="ttdeci">void rhsbc()</div><div class="ttdoc">Set Dirichlet boundary conditions on the right-hand side vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00985">Solver.C:985</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_solver_html"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_solver.html">tk::hypre::HypreSolver</a></div><div class="ttdoc">Hypre matrix class. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_solver_8h_source.html#l00023">HypreSolver.h:23</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ac698c274af8e024cd88cdd3243a6140e"><div class="ttname"><a href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">tk::Solver::m_b</a></div><div class="ttdeci">tk::hypre::HypreVector m_b</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00410">Solver.h:410</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab3c996911cb985352859098c77521c52"><div class="ttname"><a href="classtk_1_1_solver.html#ab3c996911cb985352859098c77521c52">tk::Solver::recrow</a></div><div class="ttdeci">void recrow()</div><div class="ttdoc">Acknowledge received row ids. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00273">Solver.C:273</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_af9cb98d033677aaf8e1f9cd56e443f42"><div class="ttname"><a href="classtk_1_1_solver.html#af9cb98d033677aaf8e1f9cd56e443f42">tk::Solver::hyprelhs</a></div><div class="ttdeci">void hyprelhs()</div><div class="ttdoc">Build Hypre data for our portion of the matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01041">Solver.C:1041</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a71d371296bc61c43fd36386df31fcbc4"><div class="ttname"><a href="classtk_1_1_solver.html#a71d371296bc61c43fd36386df31fcbc4">tk::Solver::sol</a></div><div class="ttdeci">void sol()</div><div class="ttdoc">Set our portion of values of the distributed solution vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01081">Solver.C:1081</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeaa19ea4a831054772289e836be73208"><div class="ttname"><a href="classtk_1_1_solver.html#aeaa19ea4a831054772289e836be73208">tk::Solver::m_hypreNcols</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreNcols</div><div class="ttdoc">Number of matrix columns/rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00416">Solver.h:416</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a7fb039115d7990655180a208b2db100e"><div class="ttname"><a href="classtk_1_1_solver.html#a7fb039115d7990655180a208b2db100e">tk::Solver::m_lhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00361">Solver.h:361</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00349">Solver.h:349</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5075ce717bdb9d6dfd18d1b124f542d0"><div class="ttname"><a href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">tk::Solver::m_diagimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_diagimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00374">Solver.h:374</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a58ce170f76d94f412e0a5ac8a2e19ac7"><div class="ttname"><a href="classtk_1_1_solver.html#a58ce170f76d94f412e0a5ac8a2e19ac7">tk::Solver::hyprerhs</a></div><div class="ttdeci">void hyprerhs()</div><div class="ttdoc">Build Hypre data for our portion of the right-hand side vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01065">Solver.C:1065</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a311ab085fcb1950dcdbfdac6c978a1ad"><div class="ttname"><a href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">tk::Solver::m_myworker</a></div><div class="ttdeci">std::vector&lt; int &gt; m_myworker</div><div class="ttdoc">Ids of workers on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00352">Solver.h:352</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_af6deaa8e458f6df24e635265d0b51584"><div class="ttname"><a href="classtk_1_1_solver.html#af6deaa8e458f6df24e635265d0b51584">tk::Solver::lhsbc</a></div><div class="ttdeci">void lhsbc()</div><div class="ttdoc">Set boundary conditions on the left-hand side matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00883">Solver.C:883</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a0297a6c08589267f294efba205c4527e"><div class="ttname"><a href="classtk_1_1_solver.html#a0297a6c08589267f294efba205c4527e">tk::Solver::nchare</a></div><div class="ttdeci">void nchare(int n)</div><div class="ttdoc">Set number of worker chares expected to contribute on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00209">Solver.C:209</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aced72f90840bce3c1725dfb0d77c09be"><div class="ttname"><a href="classtk_1_1_solver.html#aced72f90840bce3c1725dfb0d77c09be">tk::Solver::rowsreceived</a></div><div class="ttdeci">void rowsreceived()</div><div class="ttdoc">Assert that all global row indices have been received on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00593">Solver.C:593</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a905fd2cbb41ec8daeaec028f694b8e24"><div class="ttname"><a href="classtk_1_1_solver.html#a905fd2cbb41ec8daeaec028f694b8e24">tk::Solver::addsol</a></div><div class="ttdeci">void addsol(int fromch, const std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &amp;solution)</div><div class="ttdoc">Receive solution vector nonzeros from fellow group branches. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00320">Solver.C:320</a></div></div>
<div class="ttc" id="namespacetk_html_a1a96ada94b7e2911ecca0a360f305575"><div class="ttname"><a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a></div><div class="ttdeci">double real</div><div class="ttdoc">Real number type used throughout the whole code. </div><div class="ttdef"><b>Definition:</b> <a href="_base_2_types_8h_source.html#l00016">Types.h:16</a></div></div>
<div class="ttc" id="namespacetk_html"><div class="ttname"><a href="namespacetk.html">tk</a></div><div class="ttdoc">Toolkit declarations and definitions for general purpose utilities. </div><div class="ttdef"><b>Definition:</b> <a href="_charm_util_8h_source.html#l00014">CharmUtil.h:14</a></div></div>
<div class="ttc" id="_hypre_matrix_8h_html"><div class="ttname"><a href="_hypre_matrix_8h.html">HypreMatrix.h</a></div><div class="ttdoc">Hypre IJ matrix class. </div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeb7e186805440317cd4368ee3a15eef0"><div class="ttname"><a href="classtk_1_1_solver.html#aeb7e186805440317cd4368ee3a15eef0">tk::Solver::m_diag</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; std::vector&lt; tk::real &gt; &gt; &gt; m_diag</div><div class="ttdoc">Part of solution vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00407">Solver.h:407</a></div></div>
<div class="ttc" id="structtag_1_1diag_html"><div class="ttname"><a href="structtag_1_1diag.html">tag::diag</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00018">Tags.h:18</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html"><div class="ttname"><a href="classtk_1_1_solver.html">tk::Solver</a></div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00186">Solver.h:186</a></div></div>
<div class="ttc" id="structtag_1_1dt_html"><div class="ttname"><a href="structtag_1_1dt.html">tag::dt</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00077">Tags.h:77</a></div></div>
<div class="ttc" id="_fields_8h_html"><div class="ttname"><a href="_fields_8h.html">Fields.h</a></div><div class="ttdoc">Fields used to store data associated to mesh entities. </div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae05ada0e47dc55cf2f7597813a112bb8"><div class="ttname"><a href="classtk_1_1_solver.html#ae05ada0e47dc55cf2f7597813a112bb8">tk::Solver::m_div</a></div><div class="ttdeci">std::map&lt; std::pair&lt; std::size_t, std::size_t &gt;, int &gt; m_div</div><div class="ttdoc">PEs associated to lower and upper global row indices. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00430">Solver.h:430</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afff71961577fa755ed96de7b3ed938cb"><div class="ttname"><a href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">tk::Solver::m_rowimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rowimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab8f9ed3f6abc92f43b34c70a7d832a1d"><div class="ttname"><a href="classtk_1_1_solver.html#ab8f9ed3f6abc92f43b34c70a7d832a1d">tk::Solver::charesol</a></div><div class="ttdeci">void charesol(int fromch, const std::vector&lt; std::size_t &gt; &amp;gid, const Fields &amp;solution)</div><div class="ttdoc">Chares contribute their solution nonzero values. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00283">Solver.C:283</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a220e350690f38fd69631ca7c6211fd6f"><div class="ttname"><a href="classtk_1_1_solver.html#a220e350690f38fd69631ca7c6211fd6f">tk::Solver::enable_wait4rhs</a></div><div class="ttdeci">void enable_wait4rhs()</div><div class="ttdoc">Re-enable SDAG waits for rebuilding the right-hand side vector only. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00177">Solver.C:177</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a2d617950c03716f48d61da94069e9e66"><div class="ttname"><a href="classtk_1_1_solver.html#a2d617950c03716f48d61da94069e9e66">tk::Solver::addbc</a></div><div class="ttdeci">void addbc(CkReductionMsg *msg)</div><div class="ttdoc">Reduction target collecting the final aggregated BC node list map. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00646">Solver.C:646</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a6b3b523d096850165aa3853913b19640"><div class="ttname"><a href="classtk_1_1_solver.html#a6b3b523d096850165aa3853913b19640">tk::Solver::side</a></div><div class="ttdeci">const std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; &amp; side()</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00300">Solver.h:300</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aa0917fe1c723d52a9729c321a18c76e4"><div class="ttname"><a href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">tk::Solver::m_nchare</a></div><div class="ttdeci">std::size_t m_nchare</div><div class="ttdoc">Number of chares contributing to my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00345">Solver.h:345</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a109fc9cd6c8a31503f4f9c31ddf90a24"><div class="ttname"><a href="classtk_1_1_solver.html#a109fc9cd6c8a31503f4f9c31ddf90a24">tk::Solver::checkifsolcomplete</a></div><div class="ttdeci">void checkifsolcomplete()</div><div class="ttdoc">Check if contributions to unknown/solution vector are complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00852">Solver.C:852</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a463ecb7a4fe179cf728b681fd568d325"><div class="ttname"><a href="classtk_1_1_solver.html#a463ecb7a4fe179cf728b681fd568d325">tk::Solver::m_hypreMat</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreMat</div><div class="ttdoc">Matrix nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00420">Solver.h:420</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a89057b993f4b676ce381d22f580b1122"><div class="ttname"><a href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">tk::Solver::m_lhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; m_lhs</div><div class="ttdoc">Part of left-hand side matrix owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00385">Solver.h:385</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a9f818da983b16b063215c6abeb17eb85"><div class="ttname"><a href="classtk_1_1_solver.html#a9f818da983b16b063215c6abeb17eb85">tk::Solver::rowcomplete</a></div><div class="ttdeci">bool rowcomplete() const</div><div class="ttdoc">Check if we have done our part in storing and exporting global row ids. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00753">Solver.C:753</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ad006a029a5dec2e2fbb234ec39ac0e79"><div class="ttname"><a href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">tk::Solver::m_hypreSol</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreSol</div><div class="ttdoc">Solution vector nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00424">Solver.h:424</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_matrix_html"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_matrix.html">tk::hypre::HypreMatrix</a></div><div class="ttdoc">Hypre matrix class. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_matrix_8h_source.html#l00021">HypreMatrix.h:21</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 19 2017 03:03:26 for Quinoa by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
