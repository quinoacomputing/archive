<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quinoa: tk::Solver Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quinoa.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacetk.html">tk</a></li><li class="navelem"><a class="el" href="classtk_1_1_solver.html">Solver</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classtk_1_1_solver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">tk::Solver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_solver_8h_source.html">Solver.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for tk::Solver:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver__inherit__graph.svg" width="115" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aea0902e664644ffd993db0d04057c987"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#aea0902e664644ffd993db0d04057c987">Solver</a> (CProxy_SolverShadow sh, const std::vector&lt; CkCallback &gt; &amp;cb, const std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; &amp;s, std::size_t n, bool)</td></tr>
<tr class="memdesc:aea0902e664644ffd993db0d04057c987"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#aea0902e664644ffd993db0d04057c987">More...</a><br /></td></tr>
<tr class="separator:aea0902e664644ffd993db0d04057c987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae64639059051bc44536ed5e7452632f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ae64639059051bc44536ed5e7452632f4">bounds</a> (int p, std::size_t lower, std::size_t upper)</td></tr>
<tr class="memdesc:ae64639059051bc44536ed5e7452632f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive lower and upper global node IDs all PEs will operate on.  <a href="#ae64639059051bc44536ed5e7452632f4">More...</a><br /></td></tr>
<tr class="separator:ae64639059051bc44536ed5e7452632f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59605a73c9c94190e2dec90277165e2e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a59605a73c9c94190e2dec90277165e2e">next</a> ()</td></tr>
<tr class="memdesc:a59605a73c9c94190e2dec90277165e2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare for next step.  <a href="#a59605a73c9c94190e2dec90277165e2e">More...</a><br /></td></tr>
<tr class="separator:a59605a73c9c94190e2dec90277165e2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0297a6c08589267f294efba205c4527e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a0297a6c08589267f294efba205c4527e">nchare</a> (int n)</td></tr>
<tr class="memdesc:a0297a6c08589267f294efba205c4527e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set number of worker chares expected to contribute on my PE.  <a href="#a0297a6c08589267f294efba205c4527e">More...</a><br /></td></tr>
<tr class="separator:a0297a6c08589267f294efba205c4527e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d4f34d3bc936f09c05ca3e10b443e83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a2d4f34d3bc936f09c05ca3e10b443e83">charecom</a> (const inciter::CProxy_CG &amp;worker, int fromch, const std::vector&lt; std::size_t &gt; &amp;row)</td></tr>
<tr class="memdesc:a2d4f34d3bc936f09c05ca3e10b443e83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Chares contribute their global row ids for establishing communications.  <a href="#a2d4f34d3bc936f09c05ca3e10b443e83">More...</a><br /></td></tr>
<tr class="separator:a2d4f34d3bc936f09c05ca3e10b443e83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a191685814cc6626319d0b17515d6c934"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a191685814cc6626319d0b17515d6c934">created</a> ()</td></tr>
<tr class="memdesc:a191685814cc6626319d0b17515d6c934"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signal the runtime system that the workers have been created.  <a href="#a191685814cc6626319d0b17515d6c934">More...</a><br /></td></tr>
<tr class="separator:a191685814cc6626319d0b17515d6c934"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae890e5746f0ed9790380e6acd2b6a358"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ae890e5746f0ed9790380e6acd2b6a358">addrow</a> (int fromch, int frompe, const std::set&lt; std::size_t &gt; &amp;row)</td></tr>
<tr class="memdesc:ae890e5746f0ed9790380e6acd2b6a358"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive global row ids from fellow group branches.  <a href="#ae890e5746f0ed9790380e6acd2b6a358">More...</a><br /></td></tr>
<tr class="separator:ae890e5746f0ed9790380e6acd2b6a358"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3c996911cb985352859098c77521c52"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ab3c996911cb985352859098c77521c52">recrow</a> ()</td></tr>
<tr class="memdesc:ab3c996911cb985352859098c77521c52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acknowledge received row ids.  <a href="#ab3c996911cb985352859098c77521c52">More...</a><br /></td></tr>
<tr class="separator:ab3c996911cb985352859098c77521c52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8f9ed3f6abc92f43b34c70a7d832a1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ab8f9ed3f6abc92f43b34c70a7d832a1d">charesol</a> (int fromch, const std::vector&lt; std::size_t &gt; &amp;gid, const Fields &amp;solution)</td></tr>
<tr class="memdesc:ab8f9ed3f6abc92f43b34c70a7d832a1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Chares contribute their solution nonzero values.  <a href="#ab8f9ed3f6abc92f43b34c70a7d832a1d">More...</a><br /></td></tr>
<tr class="separator:ab8f9ed3f6abc92f43b34c70a7d832a1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a905fd2cbb41ec8daeaec028f694b8e24"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a905fd2cbb41ec8daeaec028f694b8e24">addsol</a> (int fromch, const std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &amp;solution)</td></tr>
<tr class="memdesc:a905fd2cbb41ec8daeaec028f694b8e24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive solution vector nonzeros from fellow group branches.  <a href="#a905fd2cbb41ec8daeaec028f694b8e24">More...</a><br /></td></tr>
<tr class="separator:a905fd2cbb41ec8daeaec028f694b8e24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eb7392a5115a24b78e527ba1e7790ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a2eb7392a5115a24b78e527ba1e7790ac">charelhs</a> (int fromch, const std::vector&lt; std::size_t &gt; &amp;gid, const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;psup, const tk::Fields &amp;lhsd, const tk::Fields &amp;lhso)</td></tr>
<tr class="memdesc:a2eb7392a5115a24b78e527ba1e7790ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Chares contribute their matrix nonzero values.  <a href="#a2eb7392a5115a24b78e527ba1e7790ac">More...</a><br /></td></tr>
<tr class="separator:a2eb7392a5115a24b78e527ba1e7790ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d1489fadc01b7698a464c1dd04d10aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a4d1489fadc01b7698a464c1dd04d10aa">addlhs</a> (int fromch, const std::map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; &amp;l)</td></tr>
<tr class="memdesc:a4d1489fadc01b7698a464c1dd04d10aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive matrix nonzeros from fellow group branches.  <a href="#a4d1489fadc01b7698a464c1dd04d10aa">More...</a><br /></td></tr>
<tr class="separator:a4d1489fadc01b7698a464c1dd04d10aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd01ce572c21d346cbe8340bf65ab842"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#abd01ce572c21d346cbe8340bf65ab842">charerhs</a> (int fromch, const std::vector&lt; std::size_t &gt; &amp;gid, const Fields &amp;r)</td></tr>
<tr class="memdesc:abd01ce572c21d346cbe8340bf65ab842"><td class="mdescLeft">&#160;</td><td class="mdescRight">Chares contribute their rhs nonzero values.  <a href="#abd01ce572c21d346cbe8340bf65ab842">More...</a><br /></td></tr>
<tr class="separator:abd01ce572c21d346cbe8340bf65ab842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c58ba59af290c75d153a475b278dd50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a4c58ba59af290c75d153a475b278dd50">addrhs</a> (int fromch, const std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &amp;r)</td></tr>
<tr class="memdesc:a4c58ba59af290c75d153a475b278dd50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive+add right-hand side vector nonzeros from fellow group branches.  <a href="#a4c58ba59af290c75d153a475b278dd50">More...</a><br /></td></tr>
<tr class="separator:a4c58ba59af290c75d153a475b278dd50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a654486524ba64903c8241c8ba988d066"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a654486524ba64903c8241c8ba988d066">charelowrhs</a> (int fromch, const std::vector&lt; std::size_t &gt; &amp;gid, const Fields &amp;lowrhs)</td></tr>
<tr class="memdesc:a654486524ba64903c8241c8ba988d066"><td class="mdescLeft">&#160;</td><td class="mdescRight">Chares contribute to the rhs of the low-order linear system.  <a href="#a654486524ba64903c8241c8ba988d066">More...</a><br /></td></tr>
<tr class="separator:a654486524ba64903c8241c8ba988d066"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2750a5f1756091efb4fefef2e3c54e94"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a2750a5f1756091efb4fefef2e3c54e94">addlowrhs</a> (int fromch, const std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &amp;lowrhs)</td></tr>
<tr class="memdesc:a2750a5f1756091efb4fefef2e3c54e94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive+add low-order rhs vector nonzeros from fellow group branches.  <a href="#a2750a5f1756091efb4fefef2e3c54e94">More...</a><br /></td></tr>
<tr class="separator:a2750a5f1756091efb4fefef2e3c54e94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e383a035e8831c2602783f03d1beb0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a2e383a035e8831c2602783f03d1beb0f">charelowlhs</a> (int fromch, const std::vector&lt; std::size_t &gt; &amp;gid, const Fields &amp;lowlhs)</td></tr>
<tr class="memdesc:a2e383a035e8831c2602783f03d1beb0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Chares contribute to the lhs of the low-order linear system.  <a href="#a2e383a035e8831c2602783f03d1beb0f">More...</a><br /></td></tr>
<tr class="separator:a2e383a035e8831c2602783f03d1beb0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4db9887c8edf07d0e4bcb54c0dcdb93"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ad4db9887c8edf07d0e4bcb54c0dcdb93">addlowlhs</a> (int fromch, const std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &amp;lowlhs)</td></tr>
<tr class="memdesc:ad4db9887c8edf07d0e4bcb54c0dcdb93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive and add lhs vector to the low-order system from fellow group branches.  <a href="#ad4db9887c8edf07d0e4bcb54c0dcdb93">More...</a><br /></td></tr>
<tr class="separator:ad4db9887c8edf07d0e4bcb54c0dcdb93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa39c0b56ceb812e85cbc9a4bbbd1b857"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#aa39c0b56ceb812e85cbc9a4bbbd1b857">comfinal</a> ()</td></tr>
<tr class="memdesc:aa39c0b56ceb812e85cbc9a4bbbd1b857"><td class="mdescLeft">&#160;</td><td class="mdescRight">All communications have been establised among PEs.  <a href="#aa39c0b56ceb812e85cbc9a4bbbd1b857">More...</a><br /></td></tr>
<tr class="separator:aa39c0b56ceb812e85cbc9a4bbbd1b857"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b3b523d096850165aa3853913b19640"><td class="memItemLeft" align="right" valign="top">const std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a6b3b523d096850165aa3853913b19640">side</a> ()</td></tr>
<tr class="separator:a6b3b523d096850165aa3853913b19640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4761ce81512f1be3e7256b58d42f281e"><td class="memItemLeft" align="right" valign="top">const std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a4761ce81512f1be3e7256b58d42f281e">dirbc</a> ()</td></tr>
<tr class="separator:a4761ce81512f1be3e7256b58d42f281e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3850261483923550e6bedb0a66a0175a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a3850261483923550e6bedb0a66a0175a">charebc</a> (const std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; &amp;bc)</td></tr>
<tr class="memdesc:a3850261483923550e6bedb0a66a0175a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Chares contribute their global row ids and associated Dirichlet boundary condition values at which they set BCs.  <a href="#a3850261483923550e6bedb0a66a0175a">More...</a><br /></td></tr>
<tr class="separator:a3850261483923550e6bedb0a66a0175a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d617950c03716f48d61da94069e9e66"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a2d617950c03716f48d61da94069e9e66">addbc</a> (CkReductionMsg *msg)</td></tr>
<tr class="memdesc:a2d617950c03716f48d61da94069e9e66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduction target collecting the final aggregated BC node list map.  <a href="#a2d617950c03716f48d61da94069e9e66">More...</a><br /></td></tr>
<tr class="separator:a2d617950c03716f48d61da94069e9e66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79a081933d00a3e29ef1edae2b39858d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a79a081933d00a3e29ef1edae2b39858d">charediag</a> (int fromch, const std::vector&lt; std::size_t &gt; &amp;gid, const Fields &amp;u, const Fields &amp;a, const std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &amp;v)</td></tr>
<tr class="memdesc:a79a081933d00a3e29ef1edae2b39858d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Chares contribute their numerical and analytical solutions nonzero values for computing diagnostics.  <a href="#a79a081933d00a3e29ef1edae2b39858d">More...</a><br /></td></tr>
<tr class="separator:a79a081933d00a3e29ef1edae2b39858d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b7772900d005ff050b53d9d367c1ba6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a9b7772900d005ff050b53d9d367c1ba6">adddiag</a> (int fromch, std::map&lt; std::size_t, std::vector&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; &amp;solution)</td></tr>
<tr class="memdesc:a9b7772900d005ff050b53d9d367c1ba6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive numerical and analytical solution vector nonzeros from fellow group branches for computing diagnostics.  <a href="#a9b7772900d005ff050b53d9d367c1ba6">More...</a><br /></td></tr>
<tr class="separator:a9b7772900d005ff050b53d9d367c1ba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d82dd86315e09ac53e73bb1a70fd405"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">pe</a> (std::size_t gid)</td></tr>
<tr class="memdesc:a0d82dd86315e09ac53e73bb1a70fd405"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return processing element for global mesh row id.  <a href="#a0d82dd86315e09ac53e73bb1a70fd405">More...</a><br /></td></tr>
<tr class="separator:a0d82dd86315e09ac53e73bb1a70fd405"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a5cf2b15c9104825539d97a8af94407dd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a5cf2b15c9104825539d97a8af94407dd">registerReducers</a> ()</td></tr>
<tr class="memdesc:a5cf2b15c9104825539d97a8af94407dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure Charm++ reduction types for concatenating BC nodelists.  <a href="#a5cf2b15c9104825539d97a8af94407dd">More...</a><br /></td></tr>
<tr class="separator:a5cf2b15c9104825539d97a8af94407dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a2f598b4321c7e287133afdc86df24b22"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a2f598b4321c7e287133afdc86df24b22">comcomplete</a> () const</td></tr>
<tr class="memdesc:a2f598b4321c7e287133afdc86df24b22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if we have done our part in storing and exporting global row ids.  <a href="#a2f598b4321c7e287133afdc86df24b22">More...</a><br /></td></tr>
<tr class="separator:a2f598b4321c7e287133afdc86df24b22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70b0188cdae61d2b07ce14df43f51fde"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a70b0188cdae61d2b07ce14df43f51fde">solcomplete</a> () const</td></tr>
<tr class="memdesc:a70b0188cdae61d2b07ce14df43f51fde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if our portion of the solution vector values is complete.  <a href="#a70b0188cdae61d2b07ce14df43f51fde">More...</a><br /></td></tr>
<tr class="separator:a70b0188cdae61d2b07ce14df43f51fde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adff512ead1e7f2b5d24801531019aced"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#adff512ead1e7f2b5d24801531019aced">lhscomplete</a> () const</td></tr>
<tr class="memdesc:adff512ead1e7f2b5d24801531019aced"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if our portion of the matrix values is complete.  <a href="#adff512ead1e7f2b5d24801531019aced">More...</a><br /></td></tr>
<tr class="separator:adff512ead1e7f2b5d24801531019aced"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82facd8e5dc1f7c3715e176e747bd268"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a82facd8e5dc1f7c3715e176e747bd268">diagcomplete</a> () const</td></tr>
<tr class="memdesc:a82facd8e5dc1f7c3715e176e747bd268"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if our portion of the solution vector values (for diagnostics) is complete.  <a href="#a82facd8e5dc1f7c3715e176e747bd268">More...</a><br /></td></tr>
<tr class="separator:a82facd8e5dc1f7c3715e176e747bd268"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08e43845db3aeb56e84388241d9138f6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a08e43845db3aeb56e84388241d9138f6">rhscomplete</a> () const</td></tr>
<tr class="memdesc:a08e43845db3aeb56e84388241d9138f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if our portion of the right-hand side vector values is complete.  <a href="#a08e43845db3aeb56e84388241d9138f6">More...</a><br /></td></tr>
<tr class="separator:a08e43845db3aeb56e84388241d9138f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e3434316f4316977063b72bed398b10"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a4e3434316f4316977063b72bed398b10">lowrhscomplete</a> () const</td></tr>
<tr class="memdesc:a4e3434316f4316977063b72bed398b10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if our portion of the low-order rhs vector values is complete.  <a href="#a4e3434316f4316977063b72bed398b10">More...</a><br /></td></tr>
<tr class="separator:a4e3434316f4316977063b72bed398b10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ac9815d3617f4bae94ba9eb9309f44"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ac9ac9815d3617f4bae94ba9eb9309f44">lowlhscomplete</a> () const</td></tr>
<tr class="memdesc:ac9ac9815d3617f4bae94ba9eb9309f44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if our portion of the low-order lhs vector values is complete.  <a href="#ac9ac9815d3617f4bae94ba9eb9309f44">More...</a><br /></td></tr>
<tr class="separator:ac9ac9815d3617f4bae94ba9eb9309f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ed80bcf668e291b5f571a73650027a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a3ed80bcf668e291b5f571a73650027a2">hyprerow</a> ()</td></tr>
<tr class="memdesc:a3ed80bcf668e291b5f571a73650027a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build Hypre data for our portion of the global row ids.  <a href="#a3ed80bcf668e291b5f571a73650027a2">More...</a><br /></td></tr>
<tr class="separator:a3ed80bcf668e291b5f571a73650027a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6deaa8e458f6df24e635265d0b51584"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#af6deaa8e458f6df24e635265d0b51584">lhsbc</a> ()</td></tr>
<tr class="memdesc:af6deaa8e458f6df24e635265d0b51584"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set boundary conditions on the left-hand side matrix.  <a href="#af6deaa8e458f6df24e635265d0b51584">More...</a><br /></td></tr>
<tr class="separator:af6deaa8e458f6df24e635265d0b51584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07ff8b79a6fe088d62bef9347a50c4db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a07ff8b79a6fe088d62bef9347a50c4db">rhsbc</a> ()</td></tr>
<tr class="memdesc:a07ff8b79a6fe088d62bef9347a50c4db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Dirichlet boundary conditions on the right-hand side vector.  <a href="#a07ff8b79a6fe088d62bef9347a50c4db">More...</a><br /></td></tr>
<tr class="separator:a07ff8b79a6fe088d62bef9347a50c4db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3434a8203d2836c49abc55c324ed7a14"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a3434a8203d2836c49abc55c324ed7a14">hypresol</a> ()</td></tr>
<tr class="memdesc:a3434a8203d2836c49abc55c324ed7a14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build Hypre data for our portion of the solution vector.  <a href="#a3434a8203d2836c49abc55c324ed7a14">More...</a><br /></td></tr>
<tr class="separator:a3434a8203d2836c49abc55c324ed7a14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9cb98d033677aaf8e1f9cd56e443f42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#af9cb98d033677aaf8e1f9cd56e443f42">hyprelhs</a> ()</td></tr>
<tr class="memdesc:af9cb98d033677aaf8e1f9cd56e443f42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build Hypre data for our portion of the matrix.  <a href="#af9cb98d033677aaf8e1f9cd56e443f42">More...</a><br /></td></tr>
<tr class="separator:af9cb98d033677aaf8e1f9cd56e443f42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58ce170f76d94f412e0a5ac8a2e19ac7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a58ce170f76d94f412e0a5ac8a2e19ac7">hyprerhs</a> ()</td></tr>
<tr class="memdesc:a58ce170f76d94f412e0a5ac8a2e19ac7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build Hypre data for our portion of the right-hand side vector.  <a href="#a58ce170f76d94f412e0a5ac8a2e19ac7">More...</a><br /></td></tr>
<tr class="separator:a58ce170f76d94f412e0a5ac8a2e19ac7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71d371296bc61c43fd36386df31fcbc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a71d371296bc61c43fd36386df31fcbc4">sol</a> ()</td></tr>
<tr class="memdesc:a71d371296bc61c43fd36386df31fcbc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set our portion of values of the distributed solution vector.  <a href="#a71d371296bc61c43fd36386df31fcbc4">More...</a><br /></td></tr>
<tr class="separator:a71d371296bc61c43fd36386df31fcbc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f9c5ff09968b7b87d9cb0c22f4cf2e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a6f9c5ff09968b7b87d9cb0c22f4cf2e2">lhs</a> ()</td></tr>
<tr class="memdesc:a6f9c5ff09968b7b87d9cb0c22f4cf2e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set our portion of values of the distributed matrix.  <a href="#a6f9c5ff09968b7b87d9cb0c22f4cf2e2">More...</a><br /></td></tr>
<tr class="separator:a6f9c5ff09968b7b87d9cb0c22f4cf2e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2038dcb1e9162ace96fc410fc67991d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ab2038dcb1e9162ace96fc410fc67991d">rhs</a> ()</td></tr>
<tr class="memdesc:ab2038dcb1e9162ace96fc410fc67991d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set our portion of values of the distributed right-hand side vector.  <a href="#ab2038dcb1e9162ace96fc410fc67991d">More...</a><br /></td></tr>
<tr class="separator:ab2038dcb1e9162ace96fc410fc67991d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af612bfba25ce27cc095927841bf0a7c8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#af612bfba25ce27cc095927841bf0a7c8">assemblesol</a> ()</td></tr>
<tr class="memdesc:af612bfba25ce27cc095927841bf0a7c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assemble distributed solution vector.  <a href="#af612bfba25ce27cc095927841bf0a7c8">More...</a><br /></td></tr>
<tr class="separator:af612bfba25ce27cc095927841bf0a7c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a773b1d4a6f183fef32bb7fb68574b2fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a773b1d4a6f183fef32bb7fb68574b2fd">assemblelhs</a> ()</td></tr>
<tr class="memdesc:a773b1d4a6f183fef32bb7fb68574b2fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assemble distributed matrix.  <a href="#a773b1d4a6f183fef32bb7fb68574b2fd">More...</a><br /></td></tr>
<tr class="separator:a773b1d4a6f183fef32bb7fb68574b2fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae24a7a63d3a7487defc31dc823fd727d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ae24a7a63d3a7487defc31dc823fd727d">assemblerhs</a> ()</td></tr>
<tr class="memdesc:ae24a7a63d3a7487defc31dc823fd727d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assemble distributed right-hand side vector.  <a href="#ae24a7a63d3a7487defc31dc823fd727d">More...</a><br /></td></tr>
<tr class="separator:ae24a7a63d3a7487defc31dc823fd727d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4260f32744d54b5f8ea91fd492a456b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ac4260f32744d54b5f8ea91fd492a456b">updateSol</a> ()</td></tr>
<tr class="memdesc:ac4260f32744d54b5f8ea91fd492a456b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update solution vector in our PE's workers.  <a href="#ac4260f32744d54b5f8ea91fd492a456b">More...</a><br /></td></tr>
<tr class="separator:ac4260f32744d54b5f8ea91fd492a456b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab651560a089c3beaf420deb61ea4bd87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ab651560a089c3beaf420deb61ea4bd87">solve</a> ()</td></tr>
<tr class="memdesc:ab651560a089c3beaf420deb61ea4bd87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve hyigh-order linear system.  <a href="#ab651560a089c3beaf420deb61ea4bd87">More...</a><br /></td></tr>
<tr class="separator:ab651560a089c3beaf420deb61ea4bd87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd2cf6f3695d1007aedfd69bcd847d36"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#afd2cf6f3695d1007aedfd69bcd847d36">updateLowSol</a> ()</td></tr>
<tr class="memdesc:afd2cf6f3695d1007aedfd69bcd847d36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update low-order solution vector in our PE's workers.  <a href="#afd2cf6f3695d1007aedfd69bcd847d36">More...</a><br /></td></tr>
<tr class="separator:afd2cf6f3695d1007aedfd69bcd847d36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bfe4d55939e03e51bb0e9b9547f2e7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a7bfe4d55939e03e51bb0e9b9547f2e7a">lowsolve</a> ()</td></tr>
<tr class="memdesc:a7bfe4d55939e03e51bb0e9b9547f2e7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve low-order linear system.  <a href="#a7bfe4d55939e03e51bb0e9b9547f2e7a">More...</a><br /></td></tr>
<tr class="separator:a7bfe4d55939e03e51bb0e9b9547f2e7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a779d2ccb6a57583bde1c77bc3589504f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a779d2ccb6a57583bde1c77bc3589504f">updateDiag</a> (std::size_t row, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &amp;&amp;u, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &amp;&amp;a, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> v)</td></tr>
<tr class="memdesc:a779d2ccb6a57583bde1c77bc3589504f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update diagnostics vector.  <a href="#a779d2ccb6a57583bde1c77bc3589504f">More...</a><br /></td></tr>
<tr class="separator:a779d2ccb6a57583bde1c77bc3589504f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab94d600572564911f7faa8e7d3168fb9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ab94d600572564911f7faa8e7d3168fb9">diagnostics</a> ()</td></tr>
<tr class="memdesc:ab94d600572564911f7faa8e7d3168fb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute diagnostics (residuals) and contribute them back to host.  <a href="#ab94d600572564911f7faa8e7d3168fb9">More...</a><br /></td></tr>
<tr class="separator:ab94d600572564911f7faa8e7d3168fb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ae670c687250b64158b4adec9e1b9cb0f"><td class="memItemLeft" align="right" valign="top">CProxy_SolverShadow&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ae670c687250b64158b4adec9e1b9cb0f">m_shadow</a></td></tr>
<tr class="separator:ae670c687250b64158b4adec9e1b9cb0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a093deef03f663d258ae53716c60eb77b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtk_1_1tuple_1_1tagged__tuple.html">tk::tuple::tagged_tuple</a>&lt; <a class="el" href="structtag_1_1com.html">tag::com</a>, CkCallback, <a class="el" href="structtag_1_1coord.html">tag::coord</a>, CkCallback, <a class="el" href="structtag_1_1diag.html">tag::diag</a>, CkCallback &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a093deef03f663d258ae53716c60eb77b">m_cb</a></td></tr>
<tr class="memdesc:a093deef03f663d258ae53716c60eb77b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Charm++ reduction callbacks associated to compile-time tags.  <a href="#a093deef03f663d258ae53716c60eb77b">More...</a><br /></td></tr>
<tr class="separator:a093deef03f663d258ae53716c60eb77b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c65ab8493c82ad5359d11e9e07b35c4"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a8c65ab8493c82ad5359d11e9e07b35c4">m_side</a></td></tr>
<tr class="memdesc:a8c65ab8493c82ad5359d11e9e07b35c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global (as in file) mesh node IDs mapped to side set ids of the mesh.  <a href="#a8c65ab8493c82ad5359d11e9e07b35c4">More...</a><br /></td></tr>
<tr class="separator:a8c65ab8493c82ad5359d11e9e07b35c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a694b6eabfbceee8fd165a614b9992da4"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a></td></tr>
<tr class="memdesc:a694b6eabfbceee8fd165a614b9992da4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of scalar components per unknown.  <a href="#a694b6eabfbceee8fd165a614b9992da4">More...</a><br /></td></tr>
<tr class="separator:a694b6eabfbceee8fd165a614b9992da4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0917fe1c723d52a9729c321a18c76e4"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">m_nchare</a></td></tr>
<tr class="memdesc:aa0917fe1c723d52a9729c321a18c76e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of chares contributing to my PE.  <a href="#aa0917fe1c723d52a9729c321a18c76e4">More...</a><br /></td></tr>
<tr class="separator:aa0917fe1c723d52a9729c321a18c76e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e3671da52361509cca6781a7aab834c"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">m_nperow</a></td></tr>
<tr class="memdesc:a4e3671da52361509cca6781a7aab834c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of fellow PEs to send row ids to.  <a href="#a4e3671da52361509cca6781a7aab834c">More...</a><br /></td></tr>
<tr class="separator:a4e3671da52361509cca6781a7aab834c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd9d7306f5a5e0a30709c61c9e6f4bcb"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#acd9d7306f5a5e0a30709c61c9e6f4bcb">m_nchbc</a></td></tr>
<tr class="memdesc:acd9d7306f5a5e0a30709c61c9e6f4bcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of chares we received bcs from.  <a href="#acd9d7306f5a5e0a30709c61c9e6f4bcb">More...</a><br /></td></tr>
<tr class="separator:acd9d7306f5a5e0a30709c61c9e6f4bcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9b1ac27e7fc5d0c36b30bad6d4aef06"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a></td></tr>
<tr class="memdesc:ab9b1ac27e7fc5d0c36b30bad6d4aef06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lower index of the global rows on my PE.  <a href="#ab9b1ac27e7fc5d0c36b30bad6d4aef06">More...</a><br /></td></tr>
<tr class="separator:ab9b1ac27e7fc5d0c36b30bad6d4aef06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb3da11c759216fb57e0dcf7b1803455"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a></td></tr>
<tr class="memdesc:afb3da11c759216fb57e0dcf7b1803455"><td class="mdescLeft">&#160;</td><td class="mdescRight">Upper index of the global rows on my PE.  <a href="#afb3da11c759216fb57e0dcf7b1803455">More...</a><br /></td></tr>
<tr class="separator:afb3da11c759216fb57e0dcf7b1803455"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a311ab085fcb1950dcdbfdac6c978a1ad"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">m_myworker</a></td></tr>
<tr class="memdesc:a311ab085fcb1950dcdbfdac6c978a1ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ids of workers on my PE.  <a href="#a311ab085fcb1950dcdbfdac6c978a1ad">More...</a><br /></td></tr>
<tr class="separator:a311ab085fcb1950dcdbfdac6c978a1ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afff71961577fa755ed96de7b3ed938cb"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">m_rowimport</a></td></tr>
<tr class="memdesc:afff71961577fa755ed96de7b3ed938cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Import map associating a list of global row ids to a worker chare id during the communication of the global row ids.  <a href="#afff71961577fa755ed96de7b3ed938cb">More...</a><br /></td></tr>
<tr class="separator:afff71961577fa755ed96de7b3ed938cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae08497a429ae63351cebcbb73e8cdaa7"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">m_solimport</a></td></tr>
<tr class="memdesc:ae08497a429ae63351cebcbb73e8cdaa7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Import map associating a list of global row ids to a worker chare id during the communication of the solution/unknown vector.  <a href="#ae08497a429ae63351cebcbb73e8cdaa7">More...</a><br /></td></tr>
<tr class="separator:ae08497a429ae63351cebcbb73e8cdaa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fb039115d7990655180a208b2db100e"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a7fb039115d7990655180a208b2db100e">m_lhsimport</a></td></tr>
<tr class="memdesc:a7fb039115d7990655180a208b2db100e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Import map associating a list of global row ids to a worker chare id during the communication of the left-hand side matrix.  <a href="#a7fb039115d7990655180a208b2db100e">More...</a><br /></td></tr>
<tr class="separator:a7fb039115d7990655180a208b2db100e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a989650135b8066b1d562bef134e6c74e"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">m_rhsimport</a></td></tr>
<tr class="memdesc:a989650135b8066b1d562bef134e6c74e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Import map associating a list of global row ids to a worker chare id during the communication of the righ-hand side vector.  <a href="#a989650135b8066b1d562bef134e6c74e">More...</a><br /></td></tr>
<tr class="separator:a989650135b8066b1d562bef134e6c74e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a785b937d0f47b18b3f5a7dd41fb2a5b4"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">m_lowrhsimport</a></td></tr>
<tr class="memdesc:a785b937d0f47b18b3f5a7dd41fb2a5b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Import map associating a list of global row ids to a worker chare id during the communication of the low-order rhs vector.  <a href="#a785b937d0f47b18b3f5a7dd41fb2a5b4">More...</a><br /></td></tr>
<tr class="separator:a785b937d0f47b18b3f5a7dd41fb2a5b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e65b31fc4d20bebd4f8fa9d12f4f11e"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a0e65b31fc4d20bebd4f8fa9d12f4f11e">m_lowlhsimport</a></td></tr>
<tr class="memdesc:a0e65b31fc4d20bebd4f8fa9d12f4f11e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Import map associating a list of global row ids to a worker chare id during the communication of the low-order lhs vector.  <a href="#a0e65b31fc4d20bebd4f8fa9d12f4f11e">More...</a><br /></td></tr>
<tr class="separator:a0e65b31fc4d20bebd4f8fa9d12f4f11e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5075ce717bdb9d6dfd18d1b124f542d0"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">m_diagimport</a></td></tr>
<tr class="memdesc:a5075ce717bdb9d6dfd18d1b124f542d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Import map associating a list of global row ids to a worker chare id during the communication of the solution/unknown vector for computing diagnostics, e.g., residuals.  <a href="#a5075ce717bdb9d6dfd18d1b124f542d0">More...</a><br /></td></tr>
<tr class="separator:a5075ce717bdb9d6dfd18d1b124f542d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ababfdb48bb065b69d1222582c61db6e1"><td class="memItemLeft" align="right" valign="top">std::set&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">m_row</a></td></tr>
<tr class="memdesc:ababfdb48bb065b69d1222582c61db6e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of global row indices owned by my PE.  <a href="#ababfdb48bb065b69d1222582c61db6e1">More...</a><br /></td></tr>
<tr class="separator:ababfdb48bb065b69d1222582c61db6e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f94d0cea62cb5114ad313d79a1664f0"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">m_sol</a></td></tr>
<tr class="memdesc:a7f94d0cea62cb5114ad313d79a1664f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of unknown/solution vector owned by my PE.  <a href="#a7f94d0cea62cb5114ad313d79a1664f0">More...</a><br /></td></tr>
<tr class="separator:a7f94d0cea62cb5114ad313d79a1664f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89057b993f4b676ce381d22f580b1122"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">m_lhs</a></td></tr>
<tr class="memdesc:a89057b993f4b676ce381d22f580b1122"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of left-hand side matrix owned by my PE.  <a href="#a89057b993f4b676ce381d22f580b1122">More...</a><br /></td></tr>
<tr class="separator:a89057b993f4b676ce381d22f580b1122"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e9b584b84dbca204b2c55322a487d85"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">m_rhs</a></td></tr>
<tr class="memdesc:a5e9b584b84dbca204b2c55322a487d85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of right-hand side vector owned by my PE.  <a href="#a5e9b584b84dbca204b2c55322a487d85">More...</a><br /></td></tr>
<tr class="separator:a5e9b584b84dbca204b2c55322a487d85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a798bf7f5ab59aa65cfc00dfe0631ed7e"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">m_lowrhs</a></td></tr>
<tr class="memdesc:a798bf7f5ab59aa65cfc00dfe0631ed7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of low-order right-hand side vector owned by my PE.  <a href="#a798bf7f5ab59aa65cfc00dfe0631ed7e">More...</a><br /></td></tr>
<tr class="separator:a798bf7f5ab59aa65cfc00dfe0631ed7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0c77bd852425a6506ffee14ffbddba2"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">m_lowlhs</a></td></tr>
<tr class="memdesc:af0c77bd852425a6506ffee14ffbddba2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of the low-order system left-hand side vector owned by my PE.  <a href="#af0c77bd852425a6506ffee14ffbddba2">More...</a><br /></td></tr>
<tr class="separator:af0c77bd852425a6506ffee14ffbddba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb7e186805440317cd4368ee3a15eef0"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::size_t, std::vector&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#aeb7e186805440317cd4368ee3a15eef0">m_diag</a></td></tr>
<tr class="memdesc:aeb7e186805440317cd4368ee3a15eef0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of solution vector owned by my PE.  <a href="#aeb7e186805440317cd4368ee3a15eef0">More...</a><br /></td></tr>
<tr class="separator:aeb7e186805440317cd4368ee3a15eef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee8a7b9bf4f8c3c4c85f6c246a5817cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtk_1_1hypre_1_1_hypre_vector.html">tk::hypre::HypreVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">m_x</a></td></tr>
<tr class="memdesc:aee8a7b9bf4f8c3c4c85f6c246a5817cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hypre vector to store the solution/unknowns.  <a href="#aee8a7b9bf4f8c3c4c85f6c246a5817cb">More...</a><br /></td></tr>
<tr class="separator:aee8a7b9bf4f8c3c4c85f6c246a5817cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaa8b3117a8a96197d39b8a5e7eaae66"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtk_1_1hypre_1_1_hypre_matrix.html">tk::hypre::HypreMatrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">m_A</a></td></tr>
<tr class="memdesc:aaaa8b3117a8a96197d39b8a5e7eaae66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hypre matrix to store the left-hand side.  <a href="#aaaa8b3117a8a96197d39b8a5e7eaae66">More...</a><br /></td></tr>
<tr class="separator:aaaa8b3117a8a96197d39b8a5e7eaae66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac698c274af8e024cd88cdd3243a6140e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtk_1_1hypre_1_1_hypre_vector.html">tk::hypre::HypreVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">m_b</a></td></tr>
<tr class="separator:ac698c274af8e024cd88cdd3243a6140e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b9162f97c74ba4c2101da82cd00ae95"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtk_1_1hypre_1_1_hypre_solver.html">tk::hypre::HypreSolver</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a8b9162f97c74ba4c2101da82cd00ae95">m_solver</a></td></tr>
<tr class="memdesc:a8b9162f97c74ba4c2101da82cd00ae95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hypre solver.  <a href="#a8b9162f97c74ba4c2101da82cd00ae95">More...</a><br /></td></tr>
<tr class="separator:a8b9162f97c74ba4c2101da82cd00ae95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ec72eba8056ffe153131495383e8946"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">m_hypreRows</a></td></tr>
<tr class="memdesc:a2ec72eba8056ffe153131495383e8946"><td class="mdescLeft">&#160;</td><td class="mdescRight">Row indices for my PE.  <a href="#a2ec72eba8056ffe153131495383e8946">More...</a><br /></td></tr>
<tr class="separator:a2ec72eba8056ffe153131495383e8946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaa19ea4a831054772289e836be73208"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#aeaa19ea4a831054772289e836be73208">m_hypreNcols</a></td></tr>
<tr class="memdesc:aeaa19ea4a831054772289e836be73208"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of matrix columns/rows on my PE.  <a href="#aeaa19ea4a831054772289e836be73208">More...</a><br /></td></tr>
<tr class="separator:aeaa19ea4a831054772289e836be73208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a131b3e1a92fb6922fa01202d01f63da5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a131b3e1a92fb6922fa01202d01f63da5">m_hypreCols</a></td></tr>
<tr class="memdesc:a131b3e1a92fb6922fa01202d01f63da5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix column indices for rows on my PE.  <a href="#a131b3e1a92fb6922fa01202d01f63da5">More...</a><br /></td></tr>
<tr class="separator:a131b3e1a92fb6922fa01202d01f63da5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a463ecb7a4fe179cf728b681fd568d325"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a463ecb7a4fe179cf728b681fd568d325">m_hypreMat</a></td></tr>
<tr class="memdesc:a463ecb7a4fe179cf728b681fd568d325"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix nonzero values for my PE.  <a href="#a463ecb7a4fe179cf728b681fd568d325">More...</a><br /></td></tr>
<tr class="separator:a463ecb7a4fe179cf728b681fd568d325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa91c68e53e18f58cdc2ff5db1ea9477b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">m_hypreRhs</a></td></tr>
<tr class="memdesc:aa91c68e53e18f58cdc2ff5db1ea9477b"><td class="mdescLeft">&#160;</td><td class="mdescRight">RHS vector nonzero values for my PE.  <a href="#aa91c68e53e18f58cdc2ff5db1ea9477b">More...</a><br /></td></tr>
<tr class="separator:aa91c68e53e18f58cdc2ff5db1ea9477b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad006a029a5dec2e2fbb234ec39ac0e79"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">m_hypreSol</a></td></tr>
<tr class="memdesc:ad006a029a5dec2e2fbb234ec39ac0e79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solution vector nonzero values for my PE.  <a href="#ad006a029a5dec2e2fbb234ec39ac0e79">More...</a><br /></td></tr>
<tr class="separator:ad006a029a5dec2e2fbb234ec39ac0e79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb5c5c77b2cddf8dd06a5d64477a2bd7"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::size_t, std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#aeb5c5c77b2cddf8dd06a5d64477a2bd7">m_lid</a></td></tr>
<tr class="memdesc:aeb5c5c77b2cddf8dd06a5d64477a2bd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global-&gt;local row id map for sending back solution vector parts.  <a href="#aeb5c5c77b2cddf8dd06a5d64477a2bd7">More...</a><br /></td></tr>
<tr class="separator:aeb5c5c77b2cddf8dd06a5d64477a2bd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae05ada0e47dc55cf2f7597813a112bb8"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::pair&lt; std::size_t, std::size_t &gt;, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#ae05ada0e47dc55cf2f7597813a112bb8">m_div</a></td></tr>
<tr class="memdesc:ae05ada0e47dc55cf2f7597813a112bb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">PEs associated to lower and upper global row indices.  <a href="#ae05ada0e47dc55cf2f7597813a112bb8">More...</a><br /></td></tr>
<tr class="separator:ae05ada0e47dc55cf2f7597813a112bb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7c5cb2402a3aa4b4f411a9f516c5ceb"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::size_t, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#aa7c5cb2402a3aa4b4f411a9f516c5ceb">m_pe</a></td></tr>
<tr class="memdesc:aa7c5cb2402a3aa4b4f411a9f516c5ceb"><td class="mdescLeft">&#160;</td><td class="mdescRight">PEs associated to global mesh point indices.  <a href="#aa7c5cb2402a3aa4b4f411a9f516c5ceb">More...</a><br /></td></tr>
<tr class="separator:aa7c5cb2402a3aa4b4f411a9f516c5ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15cb29c1ed768f5e288c4c1cc1dbfe3c"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">m_bc</a></td></tr>
<tr class="memdesc:a15cb29c1ed768f5e288c4c1cc1dbfe3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Values (for each scalar equation solved) of Dirichlet boundary conditions assigned to global node IDs we set.  <a href="#a15cb29c1ed768f5e288c4c1cc1dbfe3c">More...</a><br /></td></tr>
<tr class="separator:a15cb29c1ed768f5e288c4c1cc1dbfe3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acee52a58249f1160f1c705d9b6e29ddf"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#acee52a58249f1160f1c705d9b6e29ddf">m_bca</a></td></tr>
<tr class="memdesc:acee52a58249f1160f1c705d9b6e29ddf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix non-zero coefficients for Dirichlet boundary conditions.  <a href="#acee52a58249f1160f1c705d9b6e29ddf">More...</a><br /></td></tr>
<tr class="separator:acee52a58249f1160f1c705d9b6e29ddf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a123c1061f4552868a1e44a14e1e65f9f"><td class="memItemLeft" align="right" valign="top">inciter::CProxy_CG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html#a123c1061f4552868a1e44a14e1e65f9f">m_worker</a></td></tr>
<tr class="memdesc:a123c1061f4552868a1e44a14e1e65f9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Worker proxy.  <a href="#a123c1061f4552868a1e44a14e1e65f9f">More...</a><br /></td></tr>
<tr class="separator:a123c1061f4552868a1e44a14e1e65f9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Linear system merger and solver Charm++ chare group class</p>
<p>Instantiations of <a class="el" href="classtk_1_1_solver.html">Solver</a> comprise a processor aware Charm++ chare group. When instantiated, a new object is created on each PE and not more (as opposed to individual chares or chare array object elements). The group's elements are used to collect information from all chare objects that happen to be on a given PE. See also the Charm++ interface file <a class="el" href="solver_8ci.html">solver.ci</a>. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00187">187</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aea0902e664644ffd993db0d04057c987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea0902e664644ffd993db0d04057c987">&#9670;&nbsp;</a></span>Solver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Solver::Solver </td>
          <td>(</td>
          <td class="paramtype">CProxy_SolverShadow&#160;</td>
          <td class="paramname"><em>sh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; CkCallback &gt; &amp;&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cb</td><td>Charm++ callbacks </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Mesh node IDs mapped to side set ids </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Total number of scalar components in the linear system </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00055">55</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                         :</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="classtk_1_1_solver.html#ae670c687250b64158b4adec9e1b9cb0f">m_shadow</a>( sh ),</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a093deef03f663d258ae53716c60eb77b">m_cb</a>( cb[0], cb[1], cb[2] ),</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a8c65ab8493c82ad5359d11e9e07b35c4">m_side</a>( s ),</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>( n ),</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">m_nchare</a>( 0 ),</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">m_nperow</a>( 0 ),</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="classtk_1_1_solver.html#acd9d7306f5a5e0a30709c61c9e6f4bcb">m_nchbc</a>( 0 ),</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a>( 0 ),</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>( 0 ),</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">//m_feedback( feedback ),</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">m_myworker</a>(),</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">m_rowimport</a>(),</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">m_solimport</a>(),</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a7fb039115d7990655180a208b2db100e">m_lhsimport</a>(),</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">m_rhsimport</a>(),</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">m_lowrhsimport</a>(),</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a0e65b31fc4d20bebd4f8fa9d12f4f11e">m_lowlhsimport</a>(),</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">m_diagimport</a>(),</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">m_row</a>(),</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">m_sol</a>(),</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">m_lhs</a>(),</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">m_rhs</a>(),</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">m_lowrhs</a>(),</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">m_lowlhs</a>(),</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aeb7e186805440317cd4368ee3a15eef0">m_diag</a>(),</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">m_x</a>(),</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">m_A</a>(),</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">m_b</a>(),</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a8b9162f97c74ba4c2101da82cd00ae95">m_solver</a>(),</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">m_hypreRows</a>(),</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aeaa19ea4a831054772289e836be73208">m_hypreNcols</a>(),</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a131b3e1a92fb6922fa01202d01f63da5">m_hypreCols</a>(),</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a463ecb7a4fe179cf728b681fd568d325">m_hypreMat</a>(),</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">m_hypreRhs</a>(),</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">m_hypreSol</a>(),</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aeb5c5c77b2cddf8dd06a5d64477a2bd7">m_lid</a>(),</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="classtk_1_1_solver.html#ae05ada0e47dc55cf2f7597813a112bb8">m_div</a>(),</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aa7c5cb2402a3aa4b4f411a9f516c5ceb">m_pe</a>(),</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">m_bc</a>(),</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="classtk_1_1_solver.html#acee52a58249f1160f1c705d9b6e29ddf">m_bca</a>()</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">// *****************************************************************************</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">//  Constructor</span><span class="comment"></span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//! \param[in] cb Charm++ callbacks</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">//! \param[in] s Mesh node IDs mapped to side set ids</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//! \param[in] n Total number of scalar components in the linear system</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span><span class="comment">// *****************************************************************************</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;{</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// Activate SDAG waits</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  wait4nchare();</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  wait4lhsbc();</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  wait4rhsbc();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  wait4hypresol();</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  wait4hyprelhs();</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  wait4hyprerhs();</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  wait4asm();</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  wait4low();</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_aee8a7b9bf4f8c3c4c85f6c246a5817cb"><div class="ttname"><a href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">tk::Solver::m_x</a></div><div class="ttdeci">tk::hypre::HypreVector m_x</div><div class="ttdoc">Hypre vector to store the solution/unknowns. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00414">Solver.h:414</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aaaa8b3117a8a96197d39b8a5e7eaae66"><div class="ttname"><a href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">tk::Solver::m_A</a></div><div class="ttdeci">tk::hypre::HypreMatrix m_A</div><div class="ttdoc">Hypre matrix to store the left-hand side. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00415">Solver.h:415</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a8b9162f97c74ba4c2101da82cd00ae95"><div class="ttname"><a href="classtk_1_1_solver.html#a8b9162f97c74ba4c2101da82cd00ae95">tk::Solver::m_solver</a></div><div class="ttdeci">tk::hypre::HypreSolver m_solver</div><div class="ttdoc">Hypre solver. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00418">Solver.h:418</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aa91c68e53e18f58cdc2ff5db1ea9477b"><div class="ttname"><a href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">tk::Solver::m_hypreRhs</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreRhs</div><div class="ttdoc">RHS vector nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00428">Solver.h:428</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a7f94d0cea62cb5114ad313d79a1664f0"><div class="ttname"><a href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">tk::Solver::m_sol</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_sol</div><div class="ttdoc">Part of unknown/solution vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00386">Solver.h:386</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a131b3e1a92fb6922fa01202d01f63da5"><div class="ttname"><a href="classtk_1_1_solver.html#a131b3e1a92fb6922fa01202d01f63da5">tk::Solver::m_hypreCols</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreCols</div><div class="ttdoc">Matrix column indices for rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00424">Solver.h:424</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a0e65b31fc4d20bebd4f8fa9d12f4f11e"><div class="ttname"><a href="classtk_1_1_solver.html#a0e65b31fc4d20bebd4f8fa9d12f4f11e">tk::Solver::m_lowlhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lowlhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00376">Solver.h:376</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a15cb29c1ed768f5e288c4c1cc1dbfe3c"><div class="ttname"><a href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">tk::Solver::m_bc</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; m_bc</div><div class="ttdoc">Values (for each scalar equation solved) of Dirichlet boundary conditions assigned to global node IDs...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00454">Solver.h:454</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a798bf7f5ab59aa65cfc00dfe0631ed7e"><div class="ttname"><a href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">tk::Solver::m_lowrhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_lowrhs</div><div class="ttdoc">Part of low-order right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00400">Solver.h:400</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae670c687250b64158b4adec9e1b9cb0f"><div class="ttname"><a href="classtk_1_1_solver.html#ae670c687250b64158b4adec9e1b9cb0f">tk::Solver::m_shadow</a></div><div class="ttdeci">CProxy_SolverShadow m_shadow</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00341">Solver.h:341</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a8c65ab8493c82ad5359d11e9e07b35c4"><div class="ttname"><a href="classtk_1_1_solver.html#a8c65ab8493c82ad5359d11e9e07b35c4">tk::Solver::m_side</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_side</div><div class="ttdoc">Global (as in file) mesh node IDs mapped to side set ids of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00349">Solver.h:349</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_af0c77bd852425a6506ffee14ffbddba2"><div class="ttname"><a href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">tk::Solver::m_lowlhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_lowlhs</div><div class="ttdoc">Part of the low-order system left-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00405">Solver.h:405</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a989650135b8066b1d562bef134e6c74e"><div class="ttname"><a href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">tk::Solver::m_rhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00370">Solver.h:370</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ababfdb48bb065b69d1222582c61db6e1"><div class="ttname"><a href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">tk::Solver::m_row</a></div><div class="ttdeci">std::set&lt; std::size_t &gt; m_row</div><div class="ttdoc">Part of global row indices owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00382">Solver.h:382</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a4e3671da52361509cca6781a7aab834c"><div class="ttname"><a href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">tk::Solver::m_nperow</a></div><div class="ttdeci">std::size_t m_nperow</div><div class="ttdoc">Number of fellow PEs to send row ids to. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00352">Solver.h:352</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeb5c5c77b2cddf8dd06a5d64477a2bd7"><div class="ttname"><a href="classtk_1_1_solver.html#aeb5c5c77b2cddf8dd06a5d64477a2bd7">tk::Solver::m_lid</a></div><div class="ttdeci">std::map&lt; std::size_t, std::size_t &gt; m_lid</div><div class="ttdoc">Global-&gt;local row id map for sending back solution vector parts. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00432">Solver.h:432</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_acee52a58249f1160f1c705d9b6e29ddf"><div class="ttname"><a href="classtk_1_1_solver.html#acee52a58249f1160f1c705d9b6e29ddf">tk::Solver::m_bca</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; m_bca</div><div class="ttdoc">Matrix non-zero coefficients for Dirichlet boundary conditions. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00457">Solver.h:457</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a2ec72eba8056ffe153131495383e8946"><div class="ttname"><a href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">tk::Solver::m_hypreRows</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreRows</div><div class="ttdoc">Row indices for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00420">Solver.h:420</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5e9b584b84dbca204b2c55322a487d85"><div class="ttname"><a href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">tk::Solver::m_rhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_rhs</div><div class="ttdoc">Part of right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00395">Solver.h:395</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_acd9d7306f5a5e0a30709c61c9e6f4bcb"><div class="ttname"><a href="classtk_1_1_solver.html#acd9d7306f5a5e0a30709c61c9e6f4bcb">tk::Solver::m_nchbc</a></div><div class="ttdeci">std::size_t m_nchbc</div><div class="ttdoc">Number of chares we received bcs from. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00353">Solver.h:353</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a785b937d0f47b18b3f5a7dd41fb2a5b4"><div class="ttname"><a href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">tk::Solver::m_lowrhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lowrhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00373">Solver.h:373</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aa7c5cb2402a3aa4b4f411a9f516c5ceb"><div class="ttname"><a href="classtk_1_1_solver.html#aa7c5cb2402a3aa4b4f411a9f516c5ceb">tk::Solver::m_pe</a></div><div class="ttdeci">std::map&lt; std::size_t, int &gt; m_pe</div><div class="ttdoc">PEs associated to global mesh point indices. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00442">Solver.h:442</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae08497a429ae63351cebcbb73e8cdaa7"><div class="ttname"><a href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">tk::Solver::m_solimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_solimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00364">Solver.h:364</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ac698c274af8e024cd88cdd3243a6140e"><div class="ttname"><a href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">tk::Solver::m_b</a></div><div class="ttdeci">tk::hypre::HypreVector m_b</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00416">Solver.h:416</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeaa19ea4a831054772289e836be73208"><div class="ttname"><a href="classtk_1_1_solver.html#aeaa19ea4a831054772289e836be73208">tk::Solver::m_hypreNcols</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreNcols</div><div class="ttdoc">Number of matrix columns/rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00422">Solver.h:422</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a7fb039115d7990655180a208b2db100e"><div class="ttname"><a href="classtk_1_1_solver.html#a7fb039115d7990655180a208b2db100e">tk::Solver::m_lhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00367">Solver.h:367</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5075ce717bdb9d6dfd18d1b124f542d0"><div class="ttname"><a href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">tk::Solver::m_diagimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_diagimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00380">Solver.h:380</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a311ab085fcb1950dcdbfdac6c978a1ad"><div class="ttname"><a href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">tk::Solver::m_myworker</a></div><div class="ttdeci">std::vector&lt; int &gt; m_myworker</div><div class="ttdoc">Ids of workers on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00358">Solver.h:358</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeb7e186805440317cd4368ee3a15eef0"><div class="ttname"><a href="classtk_1_1_solver.html#aeb7e186805440317cd4368ee3a15eef0">tk::Solver::m_diag</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; std::vector&lt; tk::real &gt; &gt; &gt; m_diag</div><div class="ttdoc">Part of solution vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00413">Solver.h:413</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae05ada0e47dc55cf2f7597813a112bb8"><div class="ttname"><a href="classtk_1_1_solver.html#ae05ada0e47dc55cf2f7597813a112bb8">tk::Solver::m_div</a></div><div class="ttdeci">std::map&lt; std::pair&lt; std::size_t, std::size_t &gt;, int &gt; m_div</div><div class="ttdoc">PEs associated to lower and upper global row indices. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00436">Solver.h:436</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afff71961577fa755ed96de7b3ed938cb"><div class="ttname"><a href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">tk::Solver::m_rowimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rowimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00361">Solver.h:361</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aa0917fe1c723d52a9729c321a18c76e4"><div class="ttname"><a href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">tk::Solver::m_nchare</a></div><div class="ttdeci">std::size_t m_nchare</div><div class="ttdoc">Number of chares contributing to my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00351">Solver.h:351</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a463ecb7a4fe179cf728b681fd568d325"><div class="ttname"><a href="classtk_1_1_solver.html#a463ecb7a4fe179cf728b681fd568d325">tk::Solver::m_hypreMat</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreMat</div><div class="ttdoc">Matrix nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00426">Solver.h:426</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a89057b993f4b676ce381d22f580b1122"><div class="ttname"><a href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">tk::Solver::m_lhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; m_lhs</div><div class="ttdoc">Part of left-hand side matrix owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00391">Solver.h:391</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ad006a029a5dec2e2fbb234ec39ac0e79"><div class="ttname"><a href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">tk::Solver::m_hypreSol</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreSol</div><div class="ttdoc">Solution vector nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00430">Solver.h:430</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a093deef03f663d258ae53716c60eb77b"><div class="ttname"><a href="classtk_1_1_solver.html#a093deef03f663d258ae53716c60eb77b">tk::Solver::m_cb</a></div><div class="ttdeci">tk::tuple::tagged_tuple&lt; tag::com, CkCallback, tag::coord, CkCallback, tag::diag, CkCallback &gt; m_cb</div><div class="ttdoc">Charm++ reduction callbacks associated to compile-time tags. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00347">Solver.h:347</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2d617950c03716f48d61da94069e9e66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d617950c03716f48d61da94069e9e66">&#9670;&nbsp;</a></span>addbc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::addbc </td>
          <td>(</td>
          <td class="paramtype">CkReductionMsg *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reduction target collecting the final aggregated BC node list map. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00655">655</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00454">m_bc</a>, and <a class="el" href="_solver_8h_source.html#l00353">m_nchbc</a>.</p>
<div class="fragment"><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;{</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  PUP::fromMem creator( msg-&gt;getData() );</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  creator | <a class="code" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">m_bc</a>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keyword">delete</span> msg;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">//if (m_feedback) m_host.pebccomplete();    // send progress report to host</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <a class="code" href="classtk_1_1_solver.html#acd9d7306f5a5e0a30709c61c9e6f4bcb">m_nchbc</a> = 0;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  bc_complete();  bc_complete();</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a15cb29c1ed768f5e288c4c1cc1dbfe3c"><div class="ttname"><a href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">tk::Solver::m_bc</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; m_bc</div><div class="ttdoc">Values (for each scalar equation solved) of Dirichlet boundary conditions assigned to global node IDs...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00454">Solver.h:454</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_acd9d7306f5a5e0a30709c61c9e6f4bcb"><div class="ttname"><a href="classtk_1_1_solver.html#acd9d7306f5a5e0a30709c61c9e6f4bcb">tk::Solver::m_nchbc</a></div><div class="ttdeci">std::size_t m_nchbc</div><div class="ttdoc">Number of chares we received bcs from. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00353">Solver.h:353</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b7772900d005ff050b53d9d367c1ba6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b7772900d005ff050b53d9d367c1ba6">&#9670;&nbsp;</a></span>adddiag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::adddiag </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::size_t, std::vector&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive numerical and analytical solution vector nonzeros from fellow group branches for computing diagnostics. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">solution</td><td>Portion of the solution vector contributed, containing global row indices and values for all components of the numerical and analytical solutions (if available) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00713">713</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00472">diagcomplete()</a>, <a class="el" href="_solver_8_c_source.html#l01231">diagnostics()</a>, <a class="el" href="_solver_8h_source.html#l00380">m_diagimport</a>, and <a class="el" href="_solver_8_c_source.html#l01198">updateDiag()</a>.</p>
<div class="fragment"><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;{</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp;&amp; r : solution) {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">m_diagimport</a>[ fromch ].push_back( r.first );</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <a class="code" href="classtk_1_1_solver.html#a779d2ccb6a57583bde1c77bc3589504f">updateDiag</a>( r.first, std::move(r.second[0]), std::move(r.second[1]),</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                r.second[2][0] );</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  }</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#a82facd8e5dc1f7c3715e176e747bd268">diagcomplete</a>()) <a class="code" href="classtk_1_1_solver.html#ab94d600572564911f7faa8e7d3168fb9">diagnostics</a>();</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_ab94d600572564911f7faa8e7d3168fb9"><div class="ttname"><a href="classtk_1_1_solver.html#ab94d600572564911f7faa8e7d3168fb9">tk::Solver::diagnostics</a></div><div class="ttdeci">void diagnostics()</div><div class="ttdoc">Compute diagnostics (residuals) and contribute them back to host. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01231">Solver.C:1231</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a779d2ccb6a57583bde1c77bc3589504f"><div class="ttname"><a href="classtk_1_1_solver.html#a779d2ccb6a57583bde1c77bc3589504f">tk::Solver::updateDiag</a></div><div class="ttdeci">void updateDiag(std::size_t row, std::vector&lt; tk::real &gt; &amp;&amp;u, std::vector&lt; tk::real &gt; &amp;&amp;a, tk::real v)</div><div class="ttdoc">Update diagnostics vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01198">Solver.C:1198</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5075ce717bdb9d6dfd18d1b124f542d0"><div class="ttname"><a href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">tk::Solver::m_diagimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_diagimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00380">Solver.h:380</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a82facd8e5dc1f7c3715e176e747bd268"><div class="ttname"><a href="classtk_1_1_solver.html#a82facd8e5dc1f7c3715e176e747bd268">tk::Solver::diagcomplete</a></div><div class="ttdeci">bool diagcomplete() const</div><div class="ttdoc">Check if our portion of the solution vector values (for diagnostics) is complete. ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00472">Solver.h:472</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a9b7772900d005ff050b53d9d367c1ba6_cgraph.svg" width="582" height="134"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4d1489fadc01b7698a464c1dd04d10aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d1489fadc01b7698a464c1dd04d10aa">&#9670;&nbsp;</a></span>addlhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::addlhs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive matrix nonzeros from fellow group branches. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">l</td><td>Portion of the left-hand side matrix contributed, containing global row and column indices and non-zero values </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00405">405</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00468">lhscomplete()</a>, <a class="el" href="_solver_8h_source.html#l00391">m_lhs</a>, and <a class="el" href="_solver_8h_source.html#l00367">m_lhsimport</a>.</p>
<div class="fragment"><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;{</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : l) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="classtk_1_1_solver.html#a7fb039115d7990655180a208b2db100e">m_lhsimport</a>[ fromch ].push_back( r.first );</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keyword">auto</span>&amp; row = <a class="code" href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">m_lhs</a>[ r.first ];</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; c : r.second) row[ c.first ] += c.second;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#adff512ead1e7f2b5d24801531019aced">lhscomplete</a>()) lhs_complete();</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_adff512ead1e7f2b5d24801531019aced"><div class="ttname"><a href="classtk_1_1_solver.html#adff512ead1e7f2b5d24801531019aced">tk::Solver::lhscomplete</a></div><div class="ttdeci">bool lhscomplete() const</div><div class="ttdoc">Check if our portion of the matrix values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00468">Solver.h:468</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a7fb039115d7990655180a208b2db100e"><div class="ttname"><a href="classtk_1_1_solver.html#a7fb039115d7990655180a208b2db100e">tk::Solver::m_lhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00367">Solver.h:367</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a89057b993f4b676ce381d22f580b1122"><div class="ttname"><a href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">tk::Solver::m_lhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; m_lhs</div><div class="ttdoc">Part of left-hand side matrix owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00391">Solver.h:391</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a4d1489fadc01b7698a464c1dd04d10aa_cgraph.svg" width="355" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad4db9887c8edf07d0e4bcb54c0dcdb93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4db9887c8edf07d0e4bcb54c0dcdb93">&#9670;&nbsp;</a></span>addlowlhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::addlowlhs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>lowlhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive and add lhs vector to the low-order system from fellow group branches. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lowlhs</td><td>Portion of the lhs vector contributed to the low-order linear system, containing global row indices and values </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00575">575</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00481">lowlhscomplete()</a>, <a class="el" href="_solver_8h_source.html#l00405">m_lowlhs</a>, and <a class="el" href="_solver_8h_source.html#l00376">m_lowlhsimport</a>.</p>
<div class="fragment"><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;{</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keyword">using</span> tk::operator+=;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : lowlhs) {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="classtk_1_1_solver.html#a0e65b31fc4d20bebd4f8fa9d12f4f11e">m_lowlhsimport</a>[ fromch ].push_back( r.first );</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">m_lowlhs</a>[ r.first ] += r.second;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#ac9ac9815d3617f4bae94ba9eb9309f44">lowlhscomplete</a>()) lowlhs_complete();</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a0e65b31fc4d20bebd4f8fa9d12f4f11e"><div class="ttname"><a href="classtk_1_1_solver.html#a0e65b31fc4d20bebd4f8fa9d12f4f11e">tk::Solver::m_lowlhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lowlhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00376">Solver.h:376</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_af0c77bd852425a6506ffee14ffbddba2"><div class="ttname"><a href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">tk::Solver::m_lowlhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_lowlhs</div><div class="ttdoc">Part of the low-order system left-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00405">Solver.h:405</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ac9ac9815d3617f4bae94ba9eb9309f44"><div class="ttname"><a href="classtk_1_1_solver.html#ac9ac9815d3617f4bae94ba9eb9309f44">tk::Solver::lowlhscomplete</a></div><div class="ttdeci">bool lowlhscomplete() const</div><div class="ttdoc">Check if our portion of the low-order lhs vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00481">Solver.h:481</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_ad4db9887c8edf07d0e4bcb54c0dcdb93_cgraph.svg" width="395" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2750a5f1756091efb4fefef2e3c54e94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2750a5f1756091efb4fefef2e3c54e94">&#9670;&nbsp;</a></span>addlowrhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::addlowrhs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>lowrhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive+add low-order rhs vector nonzeros from fellow group branches. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lowrhs</td><td>Portion of the low-order rhs vector contributed, containing global row indices and values </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00517">517</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00478">lowrhscomplete()</a>, <a class="el" href="_solver_8h_source.html#l00400">m_lowrhs</a>, and <a class="el" href="_solver_8h_source.html#l00373">m_lowrhsimport</a>.</p>
<div class="fragment"><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;{</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keyword">using</span> tk::operator+=;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : lowrhs) {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">m_lowrhsimport</a>[ fromch ].push_back( r.first );</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">m_lowrhs</a>[ r.first ] += r.second;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  }</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#a4e3434316f4316977063b72bed398b10">lowrhscomplete</a>()) lowrhs_complete();</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a798bf7f5ab59aa65cfc00dfe0631ed7e"><div class="ttname"><a href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">tk::Solver::m_lowrhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_lowrhs</div><div class="ttdoc">Part of low-order right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00400">Solver.h:400</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a785b937d0f47b18b3f5a7dd41fb2a5b4"><div class="ttname"><a href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">tk::Solver::m_lowrhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lowrhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00373">Solver.h:373</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a4e3434316f4316977063b72bed398b10"><div class="ttname"><a href="classtk_1_1_solver.html#a4e3434316f4316977063b72bed398b10">tk::Solver::lowrhscomplete</a></div><div class="ttdeci">bool lowrhscomplete() const</div><div class="ttdoc">Check if our portion of the low-order rhs vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00478">Solver.h:478</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a2750a5f1756091efb4fefef2e3c54e94_cgraph.svg" width="398" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4c58ba59af290c75d153a475b278dd50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c58ba59af290c75d153a475b278dd50">&#9670;&nbsp;</a></span>addrhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::addrhs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive+add right-hand side vector nonzeros from fellow group branches. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Portion of the right-hand side vector contributed, containing global row indices and values </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00461">461</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00395">m_rhs</a>, <a class="el" href="_solver_8h_source.html#l00370">m_rhsimport</a>, and <a class="el" href="_solver_8h_source.html#l00475">rhscomplete()</a>.</p>
<div class="fragment"><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;{</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// Store rhs contributions</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; l : r) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">m_rhsimport</a>[ fromch ].push_back( l.first );</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">m_rhs</a>[ l.first ] += l.second;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#a08e43845db3aeb56e84388241d9138f6">rhscomplete</a>()) rhs_complete();</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a08e43845db3aeb56e84388241d9138f6"><div class="ttname"><a href="classtk_1_1_solver.html#a08e43845db3aeb56e84388241d9138f6">tk::Solver::rhscomplete</a></div><div class="ttdeci">bool rhscomplete() const</div><div class="ttdoc">Check if our portion of the right-hand side vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00475">Solver.h:475</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a989650135b8066b1d562bef134e6c74e"><div class="ttname"><a href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">tk::Solver::m_rhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00370">Solver.h:370</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5e9b584b84dbca204b2c55322a487d85"><div class="ttname"><a href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">tk::Solver::m_rhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_rhs</div><div class="ttdoc">Part of right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00395">Solver.h:395</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a4c58ba59af290c75d153a475b278dd50_cgraph.svg" width="360" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ae890e5746f0ed9790380e6acd2b6a358"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae890e5746f0ed9790380e6acd2b6a358">&#9670;&nbsp;</a></span>addrow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::addrow </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>frompe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::set&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>row</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive global row ids from fellow group branches. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">frompe</td><td>PE contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">row</td><td>Global mesh point (row) indices received </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00256">256</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00382">m_row</a>, and <a class="el" href="_solver_8h_source.html#l00361">m_rowimport</a>.</p>
<div class="fragment"><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;{</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> r : row) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">m_rowimport</a>[ fromch ].push_back( r );</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">m_row</a>.insert( r );</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  thisProxy[ frompe ].recrow();</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_ababfdb48bb065b69d1222582c61db6e1"><div class="ttname"><a href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">tk::Solver::m_row</a></div><div class="ttdeci">std::set&lt; std::size_t &gt; m_row</div><div class="ttdoc">Part of global row indices owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00382">Solver.h:382</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afff71961577fa755ed96de7b3ed938cb"><div class="ttname"><a href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">tk::Solver::m_rowimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rowimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00361">Solver.h:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a905fd2cbb41ec8daeaec028f694b8e24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a905fd2cbb41ec8daeaec028f694b8e24">&#9670;&nbsp;</a></span>addsol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::addsol </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive solution vector nonzeros from fellow group branches. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">solution</td><td>Portion of the unknown/solution vector contributed, containing global row indices and values for all components </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00328">328</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8_c_source.html#l00945">hypresol()</a>, <a class="el" href="_solver_8h_source.html#l00386">m_sol</a>, <a class="el" href="_solver_8h_source.html#l00364">m_solimport</a>, and <a class="el" href="_solver_8h_source.html#l00465">solcomplete()</a>.</p>
<div class="fragment"><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : solution) {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">m_solimport</a>[ fromch ].push_back( r.first );</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">m_sol</a>[ r.first ] = r.second;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#a70b0188cdae61d2b07ce14df43f51fde">solcomplete</a>()) <a class="code" href="classtk_1_1_solver.html#a3434a8203d2836c49abc55c324ed7a14">hypresol</a>();</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a7f94d0cea62cb5114ad313d79a1664f0"><div class="ttname"><a href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">tk::Solver::m_sol</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_sol</div><div class="ttdoc">Part of unknown/solution vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00386">Solver.h:386</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a3434a8203d2836c49abc55c324ed7a14"><div class="ttname"><a href="classtk_1_1_solver.html#a3434a8203d2836c49abc55c324ed7a14">tk::Solver::hypresol</a></div><div class="ttdeci">void hypresol()</div><div class="ttdoc">Build Hypre data for our portion of the solution vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00945">Solver.C:945</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a70b0188cdae61d2b07ce14df43f51fde"><div class="ttname"><a href="classtk_1_1_solver.html#a70b0188cdae61d2b07ce14df43f51fde">tk::Solver::solcomplete</a></div><div class="ttdeci">bool solcomplete() const</div><div class="ttdoc">Check if our portion of the solution vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00465">Solver.h:465</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae08497a429ae63351cebcbb73e8cdaa7"><div class="ttname"><a href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">tk::Solver::m_solimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_solimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00364">Solver.h:364</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a905fd2cbb41ec8daeaec028f694b8e24_cgraph.svg" width="544" height="62"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a773b1d4a6f183fef32bb7fb68574b2fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a773b1d4a6f183fef32bb7fb68574b2fd">&#9670;&nbsp;</a></span>assemblelhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tk::Solver::assemblelhs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Assemble distributed matrix. </p>

</div>
</div>
<a id="ae24a7a63d3a7487defc31dc823fd727d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae24a7a63d3a7487defc31dc823fd727d">&#9670;&nbsp;</a></span>assemblerhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tk::Solver::assemblerhs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Assemble distributed right-hand side vector. </p>

</div>
</div>
<a id="af612bfba25ce27cc095927841bf0a7c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af612bfba25ce27cc095927841bf0a7c8">&#9670;&nbsp;</a></span>assemblesol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tk::Solver::assemblesol </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Assemble distributed solution vector. </p>

</div>
</div>
<a id="ae64639059051bc44536ed5e7452632f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae64639059051bc44536ed5e7452632f4">&#9670;&nbsp;</a></span>bounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::bounds </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>lower</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>upper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive lower and upper global node IDs all PEs will operate on. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>PE whose bounds being received </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lower</td><td>Lower index of the global rows on my PE </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">upper</td><td>Upper index of the global rows on my PE </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00136">136</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_hypre_vector_8h_source.html#l00030">tk::hypre::HypreVector::create()</a>, <a class="el" href="_hypre_matrix_8h_source.html#l00030">tk::hypre::HypreMatrix::create()</a>, <a class="el" href="_hypre_solver_8h_source.html#l00032">tk::hypre::HypreSolver::create()</a>, <a class="el" href="_solver_8h_source.html#l00415">m_A</a>, <a class="el" href="_solver_8h_source.html#l00416">m_b</a>, <a class="el" href="_solver_8h_source.html#l00436">m_div</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>, <a class="el" href="_solver_8h_source.html#l00418">m_solver</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, and <a class="el" href="_solver_8h_source.html#l00414">m_x</a>.</p>
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;{</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( lower &lt; upper, <span class="stringliteral">&quot;Lower bound must be lower than the upper bound: &quot;</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          <span class="stringliteral">&quot;(&quot;</span> + std::to_string(lower) + <span class="stringliteral">&quot;...&quot;</span> +  std::to_string(upper) +</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <span class="stringliteral">&quot;) sent by PE &quot;</span> + std::to_string(p) );</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// Store our bounds</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">if</span> (p == CkMyPe()) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> = lower;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a> = upper;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// Store inverse of PE-division map stored on all PE</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="classtk_1_1_solver.html#ae05ada0e47dc55cf2f7597813a112bb8">m_div</a>[ {lower,upper} ] = p;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// If we have all PEs&#39; bounds, signal the runtime system to continue</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#ae05ada0e47dc55cf2f7597813a112bb8">m_div</a>.size() == <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(CkNumPes())) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// Create my PE&#39;s lhs matrix distributed across all PEs</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">m_A</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_matrix.html#a51a6fa96ea67c8cd696b97ed9a2a06a7">create</a>( <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a>*<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>, <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>*m_ncomp );</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// Create my PE&#39;s rhs and unknown vectors distributed across all PEs</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">m_b</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#ac60c4df056ed06e98447bd2264576c5f">create</a>( <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a>*m_ncomp, <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>*m_ncomp );</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">m_x</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#ac60c4df056ed06e98447bd2264576c5f">create</a>( <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a>*m_ncomp, <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>*m_ncomp );</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// Create linear solver</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classtk_1_1_solver.html#a8b9162f97c74ba4c2101da82cd00ae95">m_solver</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_solver.html#a5e3ef63b60590577a079082d5a1f028f">create</a>();</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    bounds_complete();</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_aee8a7b9bf4f8c3c4c85f6c246a5817cb"><div class="ttname"><a href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">tk::Solver::m_x</a></div><div class="ttdeci">tk::hypre::HypreVector m_x</div><div class="ttdoc">Hypre vector to store the solution/unknowns. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00414">Solver.h:414</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aaaa8b3117a8a96197d39b8a5e7eaae66"><div class="ttname"><a href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">tk::Solver::m_A</a></div><div class="ttdeci">tk::hypre::HypreMatrix m_A</div><div class="ttdoc">Hypre matrix to store the left-hand side. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00415">Solver.h:415</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a8b9162f97c74ba4c2101da82cd00ae95"><div class="ttname"><a href="classtk_1_1_solver.html#a8b9162f97c74ba4c2101da82cd00ae95">tk::Solver::m_solver</a></div><div class="ttdeci">tk::hypre::HypreSolver m_solver</div><div class="ttdoc">Hypre solver. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00418">Solver.h:418</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_matrix_html_a51a6fa96ea67c8cd696b97ed9a2a06a7"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_matrix.html#a51a6fa96ea67c8cd696b97ed9a2a06a7">tk::hypre::HypreMatrix::create</a></div><div class="ttdeci">void create(std::size_t lower, std::size_t upper)</div><div class="ttdoc">Create and initialize Hypre IJ matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_matrix_8h_source.html#l00030">HypreMatrix.h:30</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html_ac60c4df056ed06e98447bd2264576c5f"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html#ac60c4df056ed06e98447bd2264576c5f">tk::hypre::HypreVector::create</a></div><div class="ttdeci">void create(std::size_t lower, std::size_t upper)</div><div class="ttdoc">Create and initialize Hypre IJ vector. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00030">HypreVector.h:30</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_solver_html_a5e3ef63b60590577a079082d5a1f028f"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_solver.html#a5e3ef63b60590577a079082d5a1f028f">tk::hypre::HypreSolver::create</a></div><div class="ttdeci">void create()</div><div class="ttdoc">Create and initialize Hypre solver. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_solver_8h_source.html#l00032">HypreSolver.h:32</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ac698c274af8e024cd88cdd3243a6140e"><div class="ttname"><a href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">tk::Solver::m_b</a></div><div class="ttdeci">tk::hypre::HypreVector m_b</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00416">Solver.h:416</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae05ada0e47dc55cf2f7597813a112bb8"><div class="ttname"><a href="classtk_1_1_solver.html#ae05ada0e47dc55cf2f7597813a112bb8">tk::Solver::m_div</a></div><div class="ttdeci">std::map&lt; std::pair&lt; std::size_t, std::size_t &gt;, int &gt; m_div</div><div class="ttdoc">PEs associated to lower and upper global row indices. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00436">Solver.h:436</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_ae64639059051bc44536ed5e7452632f4_cgraph.svg" width="358" height="174"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a3850261483923550e6bedb0a66a0175a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3850261483923550e6bedb0a66a0175a">&#9670;&nbsp;</a></span>charebc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::charebc </td>
          <td>(</td>
          <td class="paramtype">const std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>bc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Chares contribute their global row ids and associated Dirichlet boundary condition values at which they set BCs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bc</td><td>Vector of pairs of bool and BC value (BC vector) associated to global node IDs at which the boundary condition is set. Here the bool indicates whether the BC value is set at the given node by the user. The size of the vectors is the number of PDEs integrated times the number of scalar components in all PDEs. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function does not have to be declared as a Charm++ entry method since it is always called by chares on the same PE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00623">623</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8_c_source.html#l00034">tk::BCMapMerger</a>, <a class="el" href="_solver_8h_source.html#l00454">m_bc</a>, <a class="el" href="_solver_8h_source.html#l00351">m_nchare</a>, <a class="el" href="_solver_8h_source.html#l00353">m_nchbc</a>, <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>, <a class="el" href="_solver_8h_source.html#l00341">m_shadow</a>, and <a class="el" href="_hash_map_reducer_8h_source.html#l00029">tk::serialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;{</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="comment">// Associate BC vectors to mesh nodes owned</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="keywordflow">if</span> (!bc.empty())  <span class="comment">// only if chare has anything to offer</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n : bc) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( n.second.size() == <a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>, <span class="stringliteral">&quot;The total number of scalar &quot;</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="stringliteral">&quot;components does not equal that of set in the BC vector.&quot;</span> );</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <a class="code" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">m_bc</a>[ n.first ] = n.second;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="comment">// Forward all BC vectors received to fellow branches</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordflow">if</span> (++<a class="code" href="classtk_1_1_solver.html#acd9d7306f5a5e0a30709c61c9e6f4bcb">m_nchbc</a> == <a class="code" href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">m_nchare</a>) {</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keyword">auto</span> stream = <a class="code" href="namespacetk.html#a8a928cb4648630899f34ee7ad08fd754">tk::serialize</a>( <a class="code" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">m_bc</a> );</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="classtk_1_1_solver.html#ae670c687250b64158b4adec9e1b9cb0f">m_shadow</a>.ckLocalBranch()-&gt;contribute(</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      stream.first, stream.second.get(), <a class="code" href="namespacetk.html#a1320fa5c795146f9a4ac4fc2eb4e2606">BCMapMerger</a>,</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      CkCallback(CkIndex_Solver::addbc(<span class="keyword">nullptr</span>),thisProxy) );</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;}</div><div class="ttc" id="namespacetk_html_a1320fa5c795146f9a4ac4fc2eb4e2606"><div class="ttname"><a href="namespacetk.html#a1320fa5c795146f9a4ac4fc2eb4e2606">tk::BCMapMerger</a></div><div class="ttdeci">static CkReduction::reducerType BCMapMerger</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00034">Solver.C:34</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a15cb29c1ed768f5e288c4c1cc1dbfe3c"><div class="ttname"><a href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">tk::Solver::m_bc</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; m_bc</div><div class="ttdoc">Values (for each scalar equation solved) of Dirichlet boundary conditions assigned to global node IDs...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00454">Solver.h:454</a></div></div>
<div class="ttc" id="namespacetk_html_a8a928cb4648630899f34ee7ad08fd754"><div class="ttname"><a href="namespacetk.html#a8a928cb4648630899f34ee7ad08fd754">tk::serialize</a></div><div class="ttdeci">std::pair&lt; int, std::unique_ptr&lt; char[]&gt; &gt; serialize(const std::unordered_map&lt; Key, T, Hash, KeyEqual &gt; &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="_hash_map_reducer_8h_source.html#l00029">HashMapReducer.h:29</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae670c687250b64158b4adec9e1b9cb0f"><div class="ttname"><a href="classtk_1_1_solver.html#ae670c687250b64158b4adec9e1b9cb0f">tk::Solver::m_shadow</a></div><div class="ttdeci">CProxy_SolverShadow m_shadow</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00341">Solver.h:341</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_acd9d7306f5a5e0a30709c61c9e6f4bcb"><div class="ttname"><a href="classtk_1_1_solver.html#acd9d7306f5a5e0a30709c61c9e6f4bcb">tk::Solver::m_nchbc</a></div><div class="ttdeci">std::size_t m_nchbc</div><div class="ttdoc">Number of chares we received bcs from. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00353">Solver.h:353</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aa0917fe1c723d52a9729c321a18c76e4"><div class="ttname"><a href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">tk::Solver::m_nchare</a></div><div class="ttdeci">std::size_t m_nchare</div><div class="ttdoc">Number of chares contributing to my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00351">Solver.h:351</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a3850261483923550e6bedb0a66a0175a_cgraph.svg" width="291" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2d4f34d3bc936f09c05ca3e10b443e83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d4f34d3bc936f09c05ca3e10b443e83">&#9670;&nbsp;</a></span>charecom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::charecom </td>
          <td>(</td>
          <td class="paramtype">const inciter::CProxy_CG &amp;&#160;</td>
          <td class="paramname"><em>worker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>row</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Chares contribute their global row ids for establishing communications. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">worker</td><td>Charm chare array proxy contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">row</td><td>Global mesh point (row) indices contributed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function does not have to be declared as a Charm++ entry method since it is always called by chares on the same PE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00217">217</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8_c_source.html#l00762">comcomplete()</a>, <a class="el" href="_solver_8h_source.html#l00347">m_cb</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00358">m_myworker</a>, <a class="el" href="_solver_8h_source.html#l00352">m_nperow</a>, <a class="el" href="_solver_8h_source.html#l00382">m_row</a>, <a class="el" href="_solver_8h_source.html#l00361">m_rowimport</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, <a class="el" href="_solver_8h_source.html#l00459">m_worker</a>, and <a class="el" href="_solver_8_c_source.html#l00735">pe()</a>.</p>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// Store worker proxy for solution update later</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a123c1061f4552868a1e44a14e1e65f9f">m_worker</a> = worker;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">// Collect chare ids of workers on my PE</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">m_myworker</a>.push_back( fromch );</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">// Store rows owned and pack those to be exported, also build import map</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// used to test for completion</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  std::map&lt; int, std::set&lt; std::size_t &gt; &gt; exp;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> gid : row) {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> (gid &gt;= <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> &amp;&amp; gid &lt; <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>) {  <span class="comment">// if own</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <a class="code" href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">m_rowimport</a>[ fromch ].push_back( gid );</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">m_row</a>.insert( gid );</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    } <span class="keywordflow">else</span> exp[ <a class="code" href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">pe</a>(gid) ].insert( gid );</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// Export non-owned parts to fellow branches that own them</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">m_nperow</a> += exp.size();</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : exp) {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">auto</span> tope = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( p.first );</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    thisProxy[ tope ].addrow( fromch, CkMyPe(), p.second );</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#a2f598b4321c7e287133afdc86df24b22">comcomplete</a>()) contribute( <a class="code" href="classtk_1_1_solver.html#a093deef03f663d258ae53716c60eb77b">m_cb</a>.get&lt; <a class="code" href="structtag_1_1com.html">tag::com</a> &gt;() );</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a0d82dd86315e09ac53e73bb1a70fd405"><div class="ttname"><a href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">tk::Solver::pe</a></div><div class="ttdeci">int pe(std::size_t gid)</div><div class="ttdoc">Return processing element for global mesh row id. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00735">Solver.C:735</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a123c1061f4552868a1e44a14e1e65f9f"><div class="ttname"><a href="classtk_1_1_solver.html#a123c1061f4552868a1e44a14e1e65f9f">tk::Solver::m_worker</a></div><div class="ttdeci">inciter::CProxy_CG m_worker</div><div class="ttdoc">Worker proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00459">Solver.h:459</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a2f598b4321c7e287133afdc86df24b22"><div class="ttname"><a href="classtk_1_1_solver.html#a2f598b4321c7e287133afdc86df24b22">tk::Solver::comcomplete</a></div><div class="ttdeci">bool comcomplete() const</div><div class="ttdoc">Check if we have done our part in storing and exporting global row ids. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00762">Solver.C:762</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ababfdb48bb065b69d1222582c61db6e1"><div class="ttname"><a href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">tk::Solver::m_row</a></div><div class="ttdeci">std::set&lt; std::size_t &gt; m_row</div><div class="ttdoc">Part of global row indices owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00382">Solver.h:382</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a4e3671da52361509cca6781a7aab834c"><div class="ttname"><a href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">tk::Solver::m_nperow</a></div><div class="ttdeci">std::size_t m_nperow</div><div class="ttdoc">Number of fellow PEs to send row ids to. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00352">Solver.h:352</a></div></div>
<div class="ttc" id="structtag_1_1com_html"><div class="ttname"><a href="structtag_1_1com.html">tag::com</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00158">Tags.h:158</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a311ab085fcb1950dcdbfdac6c978a1ad"><div class="ttname"><a href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">tk::Solver::m_myworker</a></div><div class="ttdeci">std::vector&lt; int &gt; m_myworker</div><div class="ttdoc">Ids of workers on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00358">Solver.h:358</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afff71961577fa755ed96de7b3ed938cb"><div class="ttname"><a href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">tk::Solver::m_rowimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rowimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00361">Solver.h:361</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a093deef03f663d258ae53716c60eb77b"><div class="ttname"><a href="classtk_1_1_solver.html#a093deef03f663d258ae53716c60eb77b">tk::Solver::m_cb</a></div><div class="ttdeci">tk::tuple::tagged_tuple&lt; tag::com, CkCallback, tag::coord, CkCallback, tag::diag, CkCallback &gt; m_cb</div><div class="ttdoc">Charm++ reduction callbacks associated to compile-time tags. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00347">Solver.h:347</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a2d4f34d3bc936f09c05ca3e10b443e83_cgraph.svg" width="384" height="84"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a79a081933d00a3e29ef1edae2b39858d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79a081933d00a3e29ef1edae2b39858d">&#9670;&nbsp;</a></span>charediag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::charediag </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>gid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Fields &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Fields &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Chares contribute their numerical and analytical solutions nonzero values for computing diagnostics. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gid</td><td>Global row indices of the vector contributed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Portion of the numerical unknown/solution vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Portion of the analytical solution vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Vector of nodal volumes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function does not have to be declared as a Charm++ entry method since it is always called by chares on the same PE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00669">669</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00472">diagcomplete()</a>, <a class="el" href="_solver_8_c_source.html#l01231">diagnostics()</a>, <a class="el" href="_solver_8h_source.html#l00380">m_diagimport</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, <a class="el" href="_solver_8_c_source.html#l00735">pe()</a>, and <a class="el" href="_solver_8_c_source.html#l01198">updateDiag()</a>.</p>
<div class="fragment"><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;{</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( gid.size() == u.nunk(),</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          <span class="stringliteral">&quot;Size of numerical solution and row ID vectors must equal&quot;</span> );</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="comment">// Store numerical and analytical solution vector nonzero values owned and</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">// pack those to be exported, also build import map used to test for</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="comment">// completion</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  std::map&lt; int, std::map&lt; std::size_t,</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                   std::vector&lt; std::vector&lt; tk::real &gt; &gt; &gt; &gt; exp;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">for</span> (std::size_t i=0; i&lt;gid.size(); ++i)</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">if</span> (gid[i] &gt;= <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> &amp;&amp; gid[i] &lt; <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>) {    <span class="comment">// if own</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <a class="code" href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">m_diagimport</a>[ fromch ].push_back( gid[i] );</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <a class="code" href="classtk_1_1_solver.html#a779d2ccb6a57583bde1c77bc3589504f">updateDiag</a>( gid[i], u[i], a[i], v[i] );</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    } <span class="keywordflow">else</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      exp[ <a class="code" href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">pe</a>(gid[i]) ][ gid[i] ] =</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        {{ u[i], a[i], std::vector&lt;tk::real&gt;(1,v[i]) }};</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="comment">// Export non-owned vector values to fellow branches that own them</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : exp) {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keyword">auto</span> tope = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( p.first );</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    thisProxy[ tope ].adddiag( fromch, p.second );</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#a82facd8e5dc1f7c3715e176e747bd268">diagcomplete</a>()) <a class="code" href="classtk_1_1_solver.html#ab94d600572564911f7faa8e7d3168fb9">diagnostics</a>();</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a0d82dd86315e09ac53e73bb1a70fd405"><div class="ttname"><a href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">tk::Solver::pe</a></div><div class="ttdeci">int pe(std::size_t gid)</div><div class="ttdoc">Return processing element for global mesh row id. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00735">Solver.C:735</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab94d600572564911f7faa8e7d3168fb9"><div class="ttname"><a href="classtk_1_1_solver.html#ab94d600572564911f7faa8e7d3168fb9">tk::Solver::diagnostics</a></div><div class="ttdeci">void diagnostics()</div><div class="ttdoc">Compute diagnostics (residuals) and contribute them back to host. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01231">Solver.C:1231</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a779d2ccb6a57583bde1c77bc3589504f"><div class="ttname"><a href="classtk_1_1_solver.html#a779d2ccb6a57583bde1c77bc3589504f">tk::Solver::updateDiag</a></div><div class="ttdeci">void updateDiag(std::size_t row, std::vector&lt; tk::real &gt; &amp;&amp;u, std::vector&lt; tk::real &gt; &amp;&amp;a, tk::real v)</div><div class="ttdoc">Update diagnostics vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01198">Solver.C:1198</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5075ce717bdb9d6dfd18d1b124f542d0"><div class="ttname"><a href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">tk::Solver::m_diagimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_diagimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00380">Solver.h:380</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a82facd8e5dc1f7c3715e176e747bd268"><div class="ttname"><a href="classtk_1_1_solver.html#a82facd8e5dc1f7c3715e176e747bd268">tk::Solver::diagcomplete</a></div><div class="ttdeci">bool diagcomplete() const</div><div class="ttdoc">Check if our portion of the solution vector values (for diagnostics) is complete. ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00472">Solver.h:472</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a79a081933d00a3e29ef1edae2b39858d_cgraph.svg" width="595" height="183"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2eb7392a5115a24b78e527ba1e7790ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eb7392a5115a24b78e527ba1e7790ac">&#9670;&nbsp;</a></span>charelhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::charelhs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>gid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>psup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>lhsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>lhso</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Chares contribute their matrix nonzero values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gid</td><td>Global row indices of the matrix chunk contributed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psup</td><td>Points surrounding points using local indices. See also <a class="el" href="namespacetk.html#ad2a88a65102c17149b44660db15d445b" title="Generate derived data structure, points surrounding points. ">tk::genPsup()</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lhsd</td><td>Portion of the left-hand side matrix contributed, containing non-zero values (for all scalar components of the equations solved) as a sparse matrix diagonal </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lhso</td><td>Portion of the left-hand side matrix contributed, containing non-zero values (for all scalar components of the equations solved) as a sparse matrix off-diagonal entries in compressed row storage format </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function does not have to be declared as a Charm++ entry method since it is always called by chares on the same PE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00347">347</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00468">lhscomplete()</a>, <a class="el" href="_solver_8h_source.html#l00391">m_lhs</a>, <a class="el" href="_solver_8h_source.html#l00367">m_lhsimport</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, and <a class="el" href="_solver_8_c_source.html#l00735">pe()</a>.</p>
<div class="fragment"><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;{</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( psup.second.size()-1 == gid.size(),</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;          <span class="stringliteral">&quot;Number of mesh points and number of global IDs unequal&quot;</span> );</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( psup.second.size()-1 == lhsd.nunk(),</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          <span class="stringliteral">&quot;Number of mesh points and number of diagonals unequal&quot;</span> );</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( psup.first.size() == lhso.nunk(),</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          <span class="stringliteral">&quot;Number of off-diagonals and their number of indices unequal&quot;</span> );</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="comment">// Store matrix nonzero values owned and pack those to be exported, also</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="comment">// build import map used to test for completion</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  std::map&lt; int, std::map&lt; std::size_t,</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                           std::map&lt; std::size_t,</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                     std::vector&lt; tk::real &gt; &gt; &gt; &gt; exp;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">for</span> (std::size_t i=0; i&lt;gid.size(); ++i)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> (gid[i] &gt;= <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> &amp;&amp; gid[i] &lt; <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>) {  <span class="comment">// if own</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <a class="code" href="classtk_1_1_solver.html#a7fb039115d7990655180a208b2db100e">m_lhsimport</a>[ fromch ].push_back( gid[i] );</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keyword">auto</span>&amp; row = <a class="code" href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">m_lhs</a>[ gid[i] ];</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      row[ gid[i] ] += lhsd[i];</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> j=psup.second[i]+1; j&lt;=psup.second[i+1]; ++j)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        row[ gid[ psup.first[j] ] ] += lhso[j];</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keyword">auto</span>&amp; row = exp[ <a class="code" href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">pe</a>(gid[i]) ][ gid[i] ];</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      row[ gid[i] ] = lhsd[i];</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> j=psup.second[i]+1; j&lt;=psup.second[i+1]; ++j)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        row[ gid[ psup.first[j] ] ] = lhso[j];</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">// Export non-owned matrix rows values to fellow branches that own them</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : exp)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    thisProxy[ p.first ].addlhs( fromch, p.second );</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#adff512ead1e7f2b5d24801531019aced">lhscomplete</a>()) lhs_complete();</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a0d82dd86315e09ac53e73bb1a70fd405"><div class="ttname"><a href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">tk::Solver::pe</a></div><div class="ttdeci">int pe(std::size_t gid)</div><div class="ttdoc">Return processing element for global mesh row id. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00735">Solver.C:735</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_adff512ead1e7f2b5d24801531019aced"><div class="ttname"><a href="classtk_1_1_solver.html#adff512ead1e7f2b5d24801531019aced">tk::Solver::lhscomplete</a></div><div class="ttdeci">bool lhscomplete() const</div><div class="ttdoc">Check if our portion of the matrix values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00468">Solver.h:468</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a7fb039115d7990655180a208b2db100e"><div class="ttname"><a href="classtk_1_1_solver.html#a7fb039115d7990655180a208b2db100e">tk::Solver::m_lhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00367">Solver.h:367</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a89057b993f4b676ce381d22f580b1122"><div class="ttname"><a href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">tk::Solver::m_lhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; m_lhs</div><div class="ttdoc">Part of left-hand side matrix owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00391">Solver.h:391</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a2eb7392a5115a24b78e527ba1e7790ac_cgraph.svg" width="368" height="84"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2e383a035e8831c2602783f03d1beb0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e383a035e8831c2602783f03d1beb0f">&#9670;&nbsp;</a></span>charelowlhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::charelowlhs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>gid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Fields &amp;&#160;</td>
          <td class="paramname"><em>lowlhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Chares contribute to the lhs of the low-order linear system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array the contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gid</td><td>Global row indices of the vector contributed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lowlhs</td><td>Portion of the low-order lhs vector contributed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function does not have to be declared as a Charm++ entry method since it is always called by chares on the same PE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00538">538</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00481">lowlhscomplete()</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00405">m_lowlhs</a>, <a class="el" href="_solver_8h_source.html#l00376">m_lowlhsimport</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, and <a class="el" href="_solver_8_c_source.html#l00735">pe()</a>.</p>
<div class="fragment"><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;{</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keyword">using</span> tk::operator+=;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( gid.size() == lowlhs.nunk(),</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;          <span class="stringliteral">&quot;Size of mass diffusion lhs and row ID vectors must equal&quot;</span> );</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// Store+add vector of nonzero values owned and pack those to be exported</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  std::map&lt; int, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; exp;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">for</span> (std::size_t i=0; i&lt;gid.size(); ++i)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span> (gid[i] &gt;= <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> &amp;&amp; gid[i] &lt; <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>) {  <span class="comment">// if own</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <a class="code" href="classtk_1_1_solver.html#a0e65b31fc4d20bebd4f8fa9d12f4f11e">m_lowlhsimport</a>[ fromch ].push_back( gid[i] );</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <a class="code" href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">m_lowlhs</a>[ gid[i] ] += lowlhs[i];</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    } <span class="keywordflow">else</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      exp[ <a class="code" href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">pe</a>(gid[i]) ][ gid[i] ] = lowlhs[i];</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">// Export non-owned vector values to fellow branches that own them</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : exp) {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keyword">auto</span> tope = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( p.first );</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    thisProxy[ tope ].addlowlhs( fromch, p.second );</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#ac9ac9815d3617f4bae94ba9eb9309f44">lowlhscomplete</a>()) lowlhs_complete();</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a0d82dd86315e09ac53e73bb1a70fd405"><div class="ttname"><a href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">tk::Solver::pe</a></div><div class="ttdeci">int pe(std::size_t gid)</div><div class="ttdoc">Return processing element for global mesh row id. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00735">Solver.C:735</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a0e65b31fc4d20bebd4f8fa9d12f4f11e"><div class="ttname"><a href="classtk_1_1_solver.html#a0e65b31fc4d20bebd4f8fa9d12f4f11e">tk::Solver::m_lowlhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lowlhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00376">Solver.h:376</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_af0c77bd852425a6506ffee14ffbddba2"><div class="ttname"><a href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">tk::Solver::m_lowlhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_lowlhs</div><div class="ttdoc">Part of the low-order system left-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00405">Solver.h:405</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ac9ac9815d3617f4bae94ba9eb9309f44"><div class="ttname"><a href="classtk_1_1_solver.html#ac9ac9815d3617f4bae94ba9eb9309f44">tk::Solver::lowlhscomplete</a></div><div class="ttdeci">bool lowlhscomplete() const</div><div class="ttdoc">Check if our portion of the low-order lhs vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00481">Solver.h:481</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a2e383a035e8831c2602783f03d1beb0f_cgraph.svg" width="406" height="84"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a654486524ba64903c8241c8ba988d066"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a654486524ba64903c8241c8ba988d066">&#9670;&nbsp;</a></span>charelowrhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::charelowrhs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>gid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Fields &amp;&#160;</td>
          <td class="paramname"><em>lowrhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Chares contribute to the rhs of the low-order linear system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gid</td><td>Global row indices of the vector contributed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lowrhs</td><td>Portion of the low-order rhs vector contributed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function does not have to be declared as a Charm++ entry method since it is always called by chares on the same PE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00480">480</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00478">lowrhscomplete()</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00400">m_lowrhs</a>, <a class="el" href="_solver_8h_source.html#l00373">m_lowrhsimport</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, and <a class="el" href="_solver_8_c_source.html#l00735">pe()</a>.</p>
<div class="fragment"><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keyword">using</span> tk::operator+=;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( gid.size() == lowrhs.nunk(),</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;          <span class="stringliteral">&quot;Size of mass diffusion rhs and row ID vectors must equal&quot;</span> );</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="comment">// Store+add vector of nonzero values owned and pack those to be exported</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  std::map&lt; int, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; exp;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">for</span> (std::size_t i=0; i&lt;gid.size(); ++i)</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">if</span> (gid[i] &gt;= <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> &amp;&amp; gid[i] &lt; <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>) {  <span class="comment">// if own</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <a class="code" href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">m_lowrhsimport</a>[ fromch ].push_back( gid[i] );</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <a class="code" href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">m_lowrhs</a>[ gid[i] ] += lowrhs[i];</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    } <span class="keywordflow">else</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      exp[ <a class="code" href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">pe</a>(gid[i]) ][ gid[i] ] = lowrhs[i];</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">// Export non-owned vector values to fellow branches that own them</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : exp) {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keyword">auto</span> tope = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( p.first );</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    thisProxy[ tope ].addlowrhs( fromch, p.second );</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#a4e3434316f4316977063b72bed398b10">lowrhscomplete</a>()) lowrhs_complete();</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a0d82dd86315e09ac53e73bb1a70fd405"><div class="ttname"><a href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">tk::Solver::pe</a></div><div class="ttdeci">int pe(std::size_t gid)</div><div class="ttdoc">Return processing element for global mesh row id. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00735">Solver.C:735</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a798bf7f5ab59aa65cfc00dfe0631ed7e"><div class="ttname"><a href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">tk::Solver::m_lowrhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_lowrhs</div><div class="ttdoc">Part of low-order right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00400">Solver.h:400</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a785b937d0f47b18b3f5a7dd41fb2a5b4"><div class="ttname"><a href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">tk::Solver::m_lowrhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lowrhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00373">Solver.h:373</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a4e3434316f4316977063b72bed398b10"><div class="ttname"><a href="classtk_1_1_solver.html#a4e3434316f4316977063b72bed398b10">tk::Solver::lowrhscomplete</a></div><div class="ttdeci">bool lowrhscomplete() const</div><div class="ttdoc">Check if our portion of the low-order rhs vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00478">Solver.h:478</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a654486524ba64903c8241c8ba988d066_cgraph.svg" width="411" height="84"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="abd01ce572c21d346cbe8340bf65ab842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd01ce572c21d346cbe8340bf65ab842">&#9670;&nbsp;</a></span>charerhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::charerhs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>gid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Fields &amp;&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Chares contribute their rhs nonzero values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gid</td><td>Global row indices of the vector contributed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Portion of the right-hand side vector contributed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function does not have to be declared as a Charm++ entry method since it is always called by chares on the same PE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00426">426</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00395">m_rhs</a>, <a class="el" href="_solver_8h_source.html#l00370">m_rhsimport</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, <a class="el" href="_solver_8_c_source.html#l00735">pe()</a>, and <a class="el" href="_solver_8h_source.html#l00475">rhscomplete()</a>.</p>
<div class="fragment"><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;{</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( gid.size() == r.nunk(),</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;          <span class="stringliteral">&quot;Size of right-hand side and row ID vectors must equal&quot;</span> );</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// Store+add vector of nonzero values owned and pack those to be exported</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  std::map&lt; int, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; exp;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">for</span> (std::size_t i=0; i&lt;gid.size(); ++i)</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">if</span> (gid[i] &gt;= <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> &amp;&amp; gid[i] &lt; <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>) {  <span class="comment">// if own</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <a class="code" href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">m_rhsimport</a>[ fromch ].push_back( gid[i] );</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <a class="code" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">m_rhs</a>[ gid[i] ] += r[i];</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    } <span class="keywordflow">else</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      exp[ <a class="code" href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">pe</a>(gid[i]) ][ gid[i] ] = r[i];</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">// Export non-owned vector values to fellow branches that own them</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : exp) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keyword">auto</span> tope = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( p.first );</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    thisProxy[ tope ].addrhs( fromch, p.second );</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#a08e43845db3aeb56e84388241d9138f6">rhscomplete</a>()) rhs_complete();</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a0d82dd86315e09ac53e73bb1a70fd405"><div class="ttname"><a href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">tk::Solver::pe</a></div><div class="ttdeci">int pe(std::size_t gid)</div><div class="ttdoc">Return processing element for global mesh row id. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00735">Solver.C:735</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a08e43845db3aeb56e84388241d9138f6"><div class="ttname"><a href="classtk_1_1_solver.html#a08e43845db3aeb56e84388241d9138f6">tk::Solver::rhscomplete</a></div><div class="ttdeci">bool rhscomplete() const</div><div class="ttdoc">Check if our portion of the right-hand side vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00475">Solver.h:475</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a989650135b8066b1d562bef134e6c74e"><div class="ttname"><a href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">tk::Solver::m_rhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00370">Solver.h:370</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5e9b584b84dbca204b2c55322a487d85"><div class="ttname"><a href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">tk::Solver::m_rhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_rhs</div><div class="ttdoc">Part of right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00395">Solver.h:395</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_abd01ce572c21d346cbe8340bf65ab842_cgraph.svg" width="371" height="84"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab8f9ed3f6abc92f43b34c70a7d832a1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8f9ed3f6abc92f43b34c70a7d832a1d">&#9670;&nbsp;</a></span>charesol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::charesol </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>gid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Fields &amp;&#160;</td>
          <td class="paramname"><em>solution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Chares contribute their solution nonzero values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromch</td><td>Charm chare array index contribution coming from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gid</td><td>Global row indices of the vector contributed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">solution</td><td>Portion of the unknown/solution vector contributed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function does not have to be declared as a Charm++ entry method since it is always called by chares on the same PE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00291">291</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8_c_source.html#l00945">hypresol()</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00386">m_sol</a>, <a class="el" href="_solver_8h_source.html#l00364">m_solimport</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, <a class="el" href="_solver_8_c_source.html#l00735">pe()</a>, and <a class="el" href="_solver_8h_source.html#l00465">solcomplete()</a>.</p>
<div class="fragment"><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;{</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( gid.size() == solution.nunk(),</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;          <span class="stringliteral">&quot;Size of solution and row ID vectors must equal&quot;</span> );</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">// Store solution vector nonzero values owned and pack those to be</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="comment">// exported, also build import map used to test for completion</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  std::map&lt; int, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; exp;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">for</span> (std::size_t i=0; i&lt;gid.size(); ++i)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span> (gid[i] &gt;= <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> &amp;&amp; gid[i] &lt; <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>) {    <span class="comment">// if own</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <a class="code" href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">m_solimport</a>[ fromch ].push_back( gid[i] );</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <a class="code" href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">m_sol</a>[ gid[i] ] = solution[i];</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      exp[ <a class="code" href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">pe</a>(gid[i]) ][ gid[i] ] = solution[i];</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">// Export non-owned vector values to fellow branches that own them</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : exp) {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keyword">auto</span> tope = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>( p.first );</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    thisProxy[ tope ].addsol( fromch, p.second );</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#a70b0188cdae61d2b07ce14df43f51fde">solcomplete</a>()) <a class="code" href="classtk_1_1_solver.html#a3434a8203d2836c49abc55c324ed7a14">hypresol</a>();</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a0d82dd86315e09ac53e73bb1a70fd405"><div class="ttname"><a href="classtk_1_1_solver.html#a0d82dd86315e09ac53e73bb1a70fd405">tk::Solver::pe</a></div><div class="ttdeci">int pe(std::size_t gid)</div><div class="ttdoc">Return processing element for global mesh row id. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00735">Solver.C:735</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a7f94d0cea62cb5114ad313d79a1664f0"><div class="ttname"><a href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">tk::Solver::m_sol</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_sol</div><div class="ttdoc">Part of unknown/solution vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00386">Solver.h:386</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a3434a8203d2836c49abc55c324ed7a14"><div class="ttname"><a href="classtk_1_1_solver.html#a3434a8203d2836c49abc55c324ed7a14">tk::Solver::hypresol</a></div><div class="ttdeci">void hypresol()</div><div class="ttdoc">Build Hypre data for our portion of the solution vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00945">Solver.C:945</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a70b0188cdae61d2b07ce14df43f51fde"><div class="ttname"><a href="classtk_1_1_solver.html#a70b0188cdae61d2b07ce14df43f51fde">tk::Solver::solcomplete</a></div><div class="ttdeci">bool solcomplete() const</div><div class="ttdoc">Check if our portion of the solution vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00465">Solver.h:465</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae08497a429ae63351cebcbb73e8cdaa7"><div class="ttname"><a href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">tk::Solver::m_solimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_solimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00364">Solver.h:364</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_ab8f9ed3f6abc92f43b34c70a7d832a1d_cgraph.svg" width="558" height="100"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2f598b4321c7e287133afdc86df24b22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f598b4321c7e287133afdc86df24b22">&#9670;&nbsp;</a></span>comcomplete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Solver::comcomplete </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if we have done our part in storing and exporting global row ids. </p>
<p>This does not mean the global row ids on our PE is complete (which is tested by an assert in comfinal), only that we have done our part of receiving contributions from chare array groups storing the parts that we own and have sent the parts we do not own to fellow PEs, i.e., we have nothing else to export. Only when all other fellow branches have received all contributions are the row ids complete on all PEs. This latter condition can only be tested after the global reduction initiated by signal2host_row_complete, which is called when all fellow branches have returned true from comcomplete. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="classtk_1_1_solver.html#aa39c0b56ceb812e85cbc9a4bbbd1b857" title="All communications have been establised among PEs. ">comfinal()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>True if we have done our part storing and exporting row ids </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00762">762</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00358">m_myworker</a>, <a class="el" href="_solver_8h_source.html#l00351">m_nchare</a>, and <a class="el" href="_solver_8h_source.html#l00352">m_nperow</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00217">charecom()</a>, and <a class="el" href="_solver_8_c_source.html#l00272">recrow()</a>.</p>
<div class="fragment"><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;{</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordflow">return</span> <span class="comment">// have heard from every chare on my PE</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;         <a class="code" href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">m_myworker</a>.size() == <a class="code" href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">m_nchare</a> &amp;&amp;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;         <span class="comment">// all fellow PEs have received my row ids contribution</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;         <a class="code" href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">m_nperow</a> == 0;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a4e3671da52361509cca6781a7aab834c"><div class="ttname"><a href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">tk::Solver::m_nperow</a></div><div class="ttdeci">std::size_t m_nperow</div><div class="ttdoc">Number of fellow PEs to send row ids to. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00352">Solver.h:352</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a311ab085fcb1950dcdbfdac6c978a1ad"><div class="ttname"><a href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">tk::Solver::m_myworker</a></div><div class="ttdeci">std::vector&lt; int &gt; m_myworker</div><div class="ttdoc">Ids of workers on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00358">Solver.h:358</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aa0917fe1c723d52a9729c321a18c76e4"><div class="ttname"><a href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">tk::Solver::m_nchare</a></div><div class="ttdeci">std::size_t m_nchare</div><div class="ttdoc">Number of chares contributing to my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00351">Solver.h:351</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa39c0b56ceb812e85cbc9a4bbbd1b857"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa39c0b56ceb812e85cbc9a4bbbd1b857">&#9670;&nbsp;</a></span>comfinal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::comfinal </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>All communications have been establised among PEs. </p>
<p>At this point all solver objects on all PEs must have received their global row ids which means that the communications have been established among all PEs and this the communications (maps) are final on all PEs. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00596">596</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8_c_source.html#l00785">hyprerow()</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00358">m_myworker</a>, <a class="el" href="_solver_8h_source.html#l00351">m_nchare</a>, <a class="el" href="_solver_8h_source.html#l00352">m_nperow</a>, <a class="el" href="_solver_8h_source.html#l00382">m_row</a>, and <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>.</p>
<div class="fragment"><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;{</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="comment">// Assert that all global row indices have been received on my PE.  The assert</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">// consists of three necessary conditions, which together comprise the</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="comment">// sufficient condition that all global row indices have been received owned</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="comment">// by this PE.</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <span class="comment">// 1. have heard from every chare on my PE</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          <a class="code" href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">m_myworker</a>.size() == <a class="code" href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">m_nchare</a> &amp;&amp;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          <span class="comment">// 2. number of rows equals that of the expected on my PE</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          <a class="code" href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">m_row</a>.size() == <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>-<a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> &amp;&amp;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <span class="comment">// 3. all fellow PEs have received my row ids contribution</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          <a class="code" href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">m_nperow</a> == 0,</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          <span class="comment">// if any of the above is unsatisfied, the row ids are incomplete</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;          <span class="stringliteral">&quot;Row ids are incomplete on PE &quot;</span> + std::to_string(CkMyPe()) );</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="comment">// now that the global row ids are complete, build Hypre data from it</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a3ed80bcf668e291b5f571a73650027a2">hyprerow</a>();</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a3ed80bcf668e291b5f571a73650027a2"><div class="ttname"><a href="classtk_1_1_solver.html#a3ed80bcf668e291b5f571a73650027a2">tk::Solver::hyprerow</a></div><div class="ttdeci">void hyprerow()</div><div class="ttdoc">Build Hypre data for our portion of the global row ids. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00785">Solver.C:785</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ababfdb48bb065b69d1222582c61db6e1"><div class="ttname"><a href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">tk::Solver::m_row</a></div><div class="ttdeci">std::set&lt; std::size_t &gt; m_row</div><div class="ttdoc">Part of global row indices owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00382">Solver.h:382</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a4e3671da52361509cca6781a7aab834c"><div class="ttname"><a href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">tk::Solver::m_nperow</a></div><div class="ttdeci">std::size_t m_nperow</div><div class="ttdoc">Number of fellow PEs to send row ids to. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00352">Solver.h:352</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a311ab085fcb1950dcdbfdac6c978a1ad"><div class="ttname"><a href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">tk::Solver::m_myworker</a></div><div class="ttdeci">std::vector&lt; int &gt; m_myworker</div><div class="ttdoc">Ids of workers on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00358">Solver.h:358</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aa0917fe1c723d52a9729c321a18c76e4"><div class="ttname"><a href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">tk::Solver::m_nchare</a></div><div class="ttdeci">std::size_t m_nchare</div><div class="ttdoc">Number of chares contributing to my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00351">Solver.h:351</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_aa39c0b56ceb812e85cbc9a4bbbd1b857_cgraph.svg" width="347" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a191685814cc6626319d0b17515d6c934"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a191685814cc6626319d0b17515d6c934">&#9670;&nbsp;</a></span>created()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::created </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Signal the runtime system that the workers have been created. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00282">282</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00347">m_cb</a>.</p>
<div class="fragment"><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;{</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  contribute( <a class="code" href="classtk_1_1_solver.html#a093deef03f663d258ae53716c60eb77b">m_cb</a>.get&lt; <a class="code" href="structtag_1_1com.html">tag::com</a> &gt;() );</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div><div class="ttc" id="structtag_1_1com_html"><div class="ttname"><a href="structtag_1_1com.html">tag::com</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00158">Tags.h:158</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a093deef03f663d258ae53716c60eb77b"><div class="ttname"><a href="classtk_1_1_solver.html#a093deef03f663d258ae53716c60eb77b">tk::Solver::m_cb</a></div><div class="ttdeci">tk::tuple::tagged_tuple&lt; tag::com, CkCallback, tag::coord, CkCallback, tag::diag, CkCallback &gt; m_cb</div><div class="ttdoc">Charm++ reduction callbacks associated to compile-time tags. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00347">Solver.h:347</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a82facd8e5dc1f7c3715e176e747bd268"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82facd8e5dc1f7c3715e176e747bd268">&#9670;&nbsp;</a></span>diagcomplete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool tk::Solver::diagcomplete </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if our portion of the solution vector values (for diagnostics) is complete. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00472">472</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00713">adddiag()</a>, <a class="el" href="_solver_8_c_source.html#l00669">charediag()</a>, and <a class="el" href="_solver_8_c_source.html#l01231">diagnostics()</a>.</p>
<div class="fragment"><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">m_diagimport</a> == <a class="code" href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">m_rowimport</a>; }</div><div class="ttc" id="classtk_1_1_solver_html_a5075ce717bdb9d6dfd18d1b124f542d0"><div class="ttname"><a href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">tk::Solver::m_diagimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_diagimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00380">Solver.h:380</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afff71961577fa755ed96de7b3ed938cb"><div class="ttname"><a href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">tk::Solver::m_rowimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rowimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00361">Solver.h:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab94d600572564911f7faa8e7d3168fb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab94d600572564911f7faa8e7d3168fb9">&#9670;&nbsp;</a></span>diagnostics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::diagnostics </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute diagnostics (residuals) and contribute them back to host. </p>
<p>Diagnostics: L2 norm for all components. </p><dl class="section see"><dt>See also</dt><dd>For info, see e.g., <a class="el" href="classinciter_1_1_c_g.html#aa53070cee37d3f2ce5d194aaa73100bd" title="Compute diagnostics, e.g., residuals. ">inciter::CG::diagnostics()</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l01231">1231</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00472">diagcomplete()</a>, <a class="el" href="_solver_8_c_source.html#l00035">tk::DiagMerger</a>, <a class="el" href="_solver_8h_source.html#l00347">m_cb</a>, <a class="el" href="_solver_8h_source.html#l00413">m_diag</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, and <a class="el" href="_hash_map_reducer_8h_source.html#l00029">tk::serialize()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00713">adddiag()</a>, and <a class="el" href="_solver_8_c_source.html#l00669">charediag()</a>.</p>
<div class="fragment"><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;{</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_solver.html#a82facd8e5dc1f7c3715e176e747bd268">diagcomplete</a>(),</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;          <span class="stringliteral">&quot;Values of distributed solution vector (for diagnostics) on PE &quot;</span> +</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;          std::to_string( CkMyPe() ) + <span class="stringliteral">&quot; is incomplete&quot;</span> );</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  std::vector&lt; std::vector&lt; tk::real &gt; &gt;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    diag( 3, std::vector&lt; tk::real &gt;( <a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>, 0.0 ) );</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; s : <a class="code" href="classtk_1_1_solver.html#aeb7e186805440317cd4368ee3a15eef0">m_diag</a>) {</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( s.second.size() == 3, <span class="stringliteral">&quot;Size of diagnostics vector must be 3&quot;</span> );</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keyword">auto</span> row = s.first;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="keywordflow">if</span> (row &gt;= <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> &amp;&amp; row &lt; <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>) {    <span class="comment">// only if own</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; u = s.second[0];    <span class="comment">// numerical solution (all components)</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; a = s.second[1];    <span class="comment">// analytical solution (all components)</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="keyword">auto</span> v = s.second[2][0];        <span class="comment">// nodal volume</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="comment">// Compute L2 norm of the numerical solution</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">for</span> (std::size_t c=0; c&lt;<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>; ++c)</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        diag[0][c] += u[c] * u[c] * v;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      <span class="comment">// Compute L2 norm of the numerical - analytical solution</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="keywordflow">for</span> (std::size_t c=0; c&lt;<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>; ++c)</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        diag[1][c] += (u[c]-a[c]) * (u[c]-a[c]) * v;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="comment">// Compute Linf norm of the numerical - analytical solution</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="keywordflow">for</span> (std::size_t c=0; c&lt;<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>; ++c) {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <span class="keyword">auto</span> err = std::abs( u[c] - a[c] );</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keywordflow">if</span> (err &gt; diag[2][c]) diag[2][c] = err;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      }</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    }</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  }</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="comment">// Contribute to diagnostics across all PEs</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="keyword">auto</span> stream = <a class="code" href="namespacetk.html#a8a928cb4648630899f34ee7ad08fd754">tk::serialize</a>( diag );</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  contribute( stream.first, stream.second.get(), <a class="code" href="namespacetk.html#ad252eef00813878543c56f7074e475f1">DiagMerger</a>,</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;              <a class="code" href="classtk_1_1_solver.html#a093deef03f663d258ae53716c60eb77b">m_cb</a>.get&lt; <a class="code" href="structtag_1_1diag.html">tag::diag</a> &gt;() );</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;}</div><div class="ttc" id="namespacetk_html_ad252eef00813878543c56f7074e475f1"><div class="ttname"><a href="namespacetk.html#ad252eef00813878543c56f7074e475f1">tk::DiagMerger</a></div><div class="ttdeci">static CkReduction::reducerType DiagMerger</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00035">Solver.C:35</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="namespacetk_html_a8a928cb4648630899f34ee7ad08fd754"><div class="ttname"><a href="namespacetk.html#a8a928cb4648630899f34ee7ad08fd754">tk::serialize</a></div><div class="ttdeci">std::pair&lt; int, std::unique_ptr&lt; char[]&gt; &gt; serialize(const std::unordered_map&lt; Key, T, Hash, KeyEqual &gt; &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="_hash_map_reducer_8h_source.html#l00029">HashMapReducer.h:29</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a82facd8e5dc1f7c3715e176e747bd268"><div class="ttname"><a href="classtk_1_1_solver.html#a82facd8e5dc1f7c3715e176e747bd268">tk::Solver::diagcomplete</a></div><div class="ttdeci">bool diagcomplete() const</div><div class="ttdoc">Check if our portion of the solution vector values (for diagnostics) is complete. ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00472">Solver.h:472</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeb7e186805440317cd4368ee3a15eef0"><div class="ttname"><a href="classtk_1_1_solver.html#aeb7e186805440317cd4368ee3a15eef0">tk::Solver::m_diag</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; std::vector&lt; tk::real &gt; &gt; &gt; m_diag</div><div class="ttdoc">Part of solution vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00413">Solver.h:413</a></div></div>
<div class="ttc" id="structtag_1_1diag_html"><div class="ttname"><a href="structtag_1_1diag.html">tag::diag</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00018">Tags.h:18</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a093deef03f663d258ae53716c60eb77b"><div class="ttname"><a href="classtk_1_1_solver.html#a093deef03f663d258ae53716c60eb77b">tk::Solver::m_cb</a></div><div class="ttdeci">tk::tuple::tagged_tuple&lt; tag::com, CkCallback, tag::coord, CkCallback, tag::diag, CkCallback &gt; m_cb</div><div class="ttdoc">Charm++ reduction callbacks associated to compile-time tags. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00347">Solver.h:347</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_ab94d600572564911f7faa8e7d3168fb9_cgraph.svg" width="392" height="84"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4761ce81512f1be3e7256b58d42f281e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4761ce81512f1be3e7256b58d42f281e">&#9670;&nbsp;</a></span>dirbc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt;&amp; tk::Solver::dirbc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Chares query Dirichlet boundary conditions </p><dl class="section note"><dt>Note</dt><dd>This function does not have to be declared as a Charm++ entry method since it is always called by chares on the same PE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00313">313</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">m_bc</a>; }</div><div class="ttc" id="classtk_1_1_solver_html_a15cb29c1ed768f5e288c4c1cc1dbfe3c"><div class="ttname"><a href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">tk::Solver::m_bc</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; m_bc</div><div class="ttdoc">Values (for each scalar equation solved) of Dirichlet boundary conditions assigned to global node IDs...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00454">Solver.h:454</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af9cb98d033677aaf8e1f9cd56e443f42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9cb98d033677aaf8e1f9cd56e443f42">&#9670;&nbsp;</a></span>hyprelhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::hyprelhs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build Hypre data for our portion of the matrix. </p>
<dl class="section note"><dt>Note</dt><dd>Hypre only likes one-based indexing. Zero-based row indexing fails to update the vector with HYPRE_IJVectorGetValues(). </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00965">965</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00468">lhscomplete()</a>, <a class="el" href="_solver_8h_source.html#l00424">m_hypreCols</a>, <a class="el" href="_solver_8h_source.html#l00426">m_hypreMat</a>, <a class="el" href="_solver_8h_source.html#l00422">m_hypreNcols</a>, <a class="el" href="_solver_8h_source.html#l00391">m_lhs</a>, and <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00804">lhsbc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;{</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_solver.html#adff512ead1e7f2b5d24801531019aced">lhscomplete</a>(),</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;          <span class="stringliteral">&quot;Nonzero values of distributed matrix on PE &quot;</span> +</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;          std::to_string( CkMyPe() ) + <span class="stringliteral">&quot; is incomplete: cannot convert&quot;</span> );</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : <a class="code" href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">m_lhs</a>)</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">for</span> (std::size_t i=0; i&lt;<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>; ++i) {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <a class="code" href="classtk_1_1_solver.html#aeaa19ea4a831054772289e836be73208">m_hypreNcols</a>.push_back( static_cast&lt; int &gt;( r.second.size() ) );</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; c : r.second) {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <a class="code" href="classtk_1_1_solver.html#a131b3e1a92fb6922fa01202d01f63da5">m_hypreCols</a>.push_back( static_cast&lt; int &gt;( c.first*m_ncomp+i+1 ) );</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <a class="code" href="classtk_1_1_solver.html#a463ecb7a4fe179cf728b681fd568d325">m_hypreMat</a>.push_back( c.second[i] );</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      }</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  hyprelhs_complete();</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a131b3e1a92fb6922fa01202d01f63da5"><div class="ttname"><a href="classtk_1_1_solver.html#a131b3e1a92fb6922fa01202d01f63da5">tk::Solver::m_hypreCols</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreCols</div><div class="ttdoc">Matrix column indices for rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00424">Solver.h:424</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_adff512ead1e7f2b5d24801531019aced"><div class="ttname"><a href="classtk_1_1_solver.html#adff512ead1e7f2b5d24801531019aced">tk::Solver::lhscomplete</a></div><div class="ttdeci">bool lhscomplete() const</div><div class="ttdoc">Check if our portion of the matrix values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00468">Solver.h:468</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeaa19ea4a831054772289e836be73208"><div class="ttname"><a href="classtk_1_1_solver.html#aeaa19ea4a831054772289e836be73208">tk::Solver::m_hypreNcols</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreNcols</div><div class="ttdoc">Number of matrix columns/rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00422">Solver.h:422</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a463ecb7a4fe179cf728b681fd568d325"><div class="ttname"><a href="classtk_1_1_solver.html#a463ecb7a4fe179cf728b681fd568d325">tk::Solver::m_hypreMat</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreMat</div><div class="ttdoc">Matrix nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00426">Solver.h:426</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a89057b993f4b676ce381d22f580b1122"><div class="ttname"><a href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">tk::Solver::m_lhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; m_lhs</div><div class="ttdoc">Part of left-hand side matrix owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00391">Solver.h:391</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_af9cb98d033677aaf8e1f9cd56e443f42_cgraph.svg" width="366" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a58ce170f76d94f412e0a5ac8a2e19ac7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58ce170f76d94f412e0a5ac8a2e19ac7">&#9670;&nbsp;</a></span>hyprerhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::hyprerhs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build Hypre data for our portion of the right-hand side vector. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00989">989</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00428">m_hypreRhs</a>, <a class="el" href="_solver_8h_source.html#l00395">m_rhs</a>, and <a class="el" href="_solver_8h_source.html#l00475">rhscomplete()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00906">rhsbc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;{</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_solver.html#a08e43845db3aeb56e84388241d9138f6">rhscomplete</a>(),</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;          <span class="stringliteral">&quot;Values of distributed right-hand-side vector on PE &quot;</span> +</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;          std::to_string( CkMyPe() ) + <span class="stringliteral">&quot; is incomplete: cannot convert&quot;</span> );</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : <a class="code" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">m_rhs</a>)</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <a class="code" href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">m_hypreRhs</a>.insert( end(<a class="code" href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">m_hypreRhs</a>), begin(r.second), end(r.second) );</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  hyprerhs_complete();</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_aa91c68e53e18f58cdc2ff5db1ea9477b"><div class="ttname"><a href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">tk::Solver::m_hypreRhs</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreRhs</div><div class="ttdoc">RHS vector nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00428">Solver.h:428</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a08e43845db3aeb56e84388241d9138f6"><div class="ttname"><a href="classtk_1_1_solver.html#a08e43845db3aeb56e84388241d9138f6">tk::Solver::rhscomplete</a></div><div class="ttdeci">bool rhscomplete() const</div><div class="ttdoc">Check if our portion of the right-hand side vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00475">Solver.h:475</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5e9b584b84dbca204b2c55322a487d85"><div class="ttname"><a href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">tk::Solver::m_rhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_rhs</div><div class="ttdoc">Part of right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00395">Solver.h:395</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a58ce170f76d94f412e0a5ac8a2e19ac7_cgraph.svg" width="371" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a3ed80bcf668e291b5f571a73650027a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ed80bcf668e291b5f571a73650027a2">&#9670;&nbsp;</a></span>hyprerow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::hyprerow </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build Hypre data for our portion of the global row ids. </p>
<dl class="section note"><dt>Note</dt><dd>Hypre only likes one-based indexing. Zero-based row indexing fails to update the vector with HYPRE_IJVectorGetValues(). </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00785">785</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00420">m_hypreRows</a>, <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>, and <a class="el" href="_solver_8h_source.html#l00382">m_row</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00596">comfinal()</a>.</p>
<div class="fragment"><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;{</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">//std::cout &lt;&lt; CkMyPe() &lt;&lt; &quot;: &quot; &lt;&lt; &quot;hyprerow\n&quot;;</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">m_hypreRows</a>.empty()) {</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> r : <a class="code" href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">m_row</a>) {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      std::vector&lt; int &gt; h( <a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a> );</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      std::iota( begin(h), end(h), r*<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>+1 );</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <a class="code" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">m_hypreRows</a>.insert( end(<a class="code" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">m_hypreRows</a>), begin(h), end(h) );</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    }</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    hyprerow_complete();  hyprerow_complete();  hyprerow_complete();</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  }</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ababfdb48bb065b69d1222582c61db6e1"><div class="ttname"><a href="classtk_1_1_solver.html#ababfdb48bb065b69d1222582c61db6e1">tk::Solver::m_row</a></div><div class="ttdeci">std::set&lt; std::size_t &gt; m_row</div><div class="ttdoc">Part of global row indices owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00382">Solver.h:382</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a2ec72eba8056ffe153131495383e8946"><div class="ttname"><a href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">tk::Solver::m_hypreRows</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreRows</div><div class="ttdoc">Row indices for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00420">Solver.h:420</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3434a8203d2836c49abc55c324ed7a14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3434a8203d2836c49abc55c324ed7a14">&#9670;&nbsp;</a></span>hypresol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::hypresol </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build Hypre data for our portion of the solution vector. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00945">945</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00430">m_hypreSol</a>, <a class="el" href="_solver_8h_source.html#l00432">m_lid</a>, <a class="el" href="_solver_8h_source.html#l00386">m_sol</a>, and <a class="el" href="_solver_8h_source.html#l00465">solcomplete()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00328">addsol()</a>, and <a class="el" href="_solver_8_c_source.html#l00291">charesol()</a>.</p>
<div class="fragment"><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;{</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">//  std::cout &lt;&lt; CkMyPe() &lt;&lt; &quot;: &quot; &lt;&lt; &quot;hypresol\n&quot;;</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_solver.html#a70b0188cdae61d2b07ce14df43f51fde">solcomplete</a>(),</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;          <span class="stringliteral">&quot;Values of distributed solution vector on PE &quot;</span> +</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;          std::to_string( CkMyPe() ) + <span class="stringliteral">&quot; is incomplete&quot;</span> );</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  std::size_t i = 0;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : <a class="code" href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">m_sol</a>) {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <a class="code" href="classtk_1_1_solver.html#aeb5c5c77b2cddf8dd06a5d64477a2bd7">m_lid</a>[ r.first ] = i++;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <a class="code" href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">m_hypreSol</a>.insert( end(<a class="code" href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">m_hypreSol</a>), begin(r.second), end(r.second) );</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  }</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  hypresol_complete();</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a7f94d0cea62cb5114ad313d79a1664f0"><div class="ttname"><a href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">tk::Solver::m_sol</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_sol</div><div class="ttdoc">Part of unknown/solution vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00386">Solver.h:386</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeb5c5c77b2cddf8dd06a5d64477a2bd7"><div class="ttname"><a href="classtk_1_1_solver.html#aeb5c5c77b2cddf8dd06a5d64477a2bd7">tk::Solver::m_lid</a></div><div class="ttdeci">std::map&lt; std::size_t, std::size_t &gt; m_lid</div><div class="ttdoc">Global-&gt;local row id map for sending back solution vector parts. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00432">Solver.h:432</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a70b0188cdae61d2b07ce14df43f51fde"><div class="ttname"><a href="classtk_1_1_solver.html#a70b0188cdae61d2b07ce14df43f51fde">tk::Solver::solcomplete</a></div><div class="ttdeci">bool solcomplete() const</div><div class="ttdoc">Check if our portion of the solution vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00465">Solver.h:465</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ad006a029a5dec2e2fbb234ec39ac0e79"><div class="ttname"><a href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">tk::Solver::m_hypreSol</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreSol</div><div class="ttdoc">Solution vector nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00430">Solver.h:430</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a3434a8203d2836c49abc55c324ed7a14_cgraph.svg" width="366" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a6f9c5ff09968b7b87d9cb0c22f4cf2e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f9c5ff09968b7b87d9cb0c22f4cf2e2">&#9670;&nbsp;</a></span>lhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::lhs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set our portion of values of the distributed matrix. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l01024">1024</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_hypre_matrix_8h_source.html#l00059">tk::hypre::HypreMatrix::assemble()</a>, <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00415">m_A</a>, <a class="el" href="_solver_8h_source.html#l00424">m_hypreCols</a>, <a class="el" href="_solver_8h_source.html#l00426">m_hypreMat</a>, <a class="el" href="_solver_8h_source.html#l00422">m_hypreNcols</a>, <a class="el" href="_solver_8h_source.html#l00420">m_hypreRows</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, and <a class="el" href="_hypre_matrix_8h_source.html#l00054">tk::hypre::HypreMatrix::set()</a>.</p>
<div class="fragment"><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;{</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_solver.html#a463ecb7a4fe179cf728b681fd568d325">m_hypreMat</a>.size() == <a class="code" href="classtk_1_1_solver.html#a131b3e1a92fb6922fa01202d01f63da5">m_hypreCols</a>.size(),</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;          <span class="stringliteral">&quot;Matrix values incomplete on PE &quot;</span> + std::to_string(CkMyPe()) );</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">// Set our portion of the matrix values</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">m_A</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_matrix.html#aab0b19556bceff4ed233cf80961ff613">set</a>( static_cast&lt; int &gt;( (<a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a> - <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a>)*<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a> ),</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;           <a class="code" href="classtk_1_1_solver.html#aeaa19ea4a831054772289e836be73208">m_hypreNcols</a>.data(),</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;           <a class="code" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">m_hypreRows</a>.data(),</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;           <a class="code" href="classtk_1_1_solver.html#a131b3e1a92fb6922fa01202d01f63da5">m_hypreCols</a>.data(),</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;           <a class="code" href="classtk_1_1_solver.html#a463ecb7a4fe179cf728b681fd568d325">m_hypreMat</a>.data() );</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">m_A</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_matrix.html#a950b0660f03241ea739c61eb79ff55ea">assemble</a>();</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  asmlhs_complete();</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_aaaa8b3117a8a96197d39b8a5e7eaae66"><div class="ttname"><a href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">tk::Solver::m_A</a></div><div class="ttdeci">tk::hypre::HypreMatrix m_A</div><div class="ttdoc">Hypre matrix to store the left-hand side. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00415">Solver.h:415</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a131b3e1a92fb6922fa01202d01f63da5"><div class="ttname"><a href="classtk_1_1_solver.html#a131b3e1a92fb6922fa01202d01f63da5">tk::Solver::m_hypreCols</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreCols</div><div class="ttdoc">Matrix column indices for rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00424">Solver.h:424</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_matrix_html_a950b0660f03241ea739c61eb79ff55ea"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_matrix.html#a950b0660f03241ea739c61eb79ff55ea">tk::hypre::HypreMatrix::assemble</a></div><div class="ttdeci">void assemble()</div><div class="ttdoc">Assemble matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_matrix_8h_source.html#l00059">HypreMatrix.h:59</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a2ec72eba8056ffe153131495383e8946"><div class="ttname"><a href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">tk::Solver::m_hypreRows</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreRows</div><div class="ttdoc">Row indices for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00420">Solver.h:420</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeaa19ea4a831054772289e836be73208"><div class="ttname"><a href="classtk_1_1_solver.html#aeaa19ea4a831054772289e836be73208">tk::Solver::m_hypreNcols</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreNcols</div><div class="ttdoc">Number of matrix columns/rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00422">Solver.h:422</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_matrix_html_aab0b19556bceff4ed233cf80961ff613"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_matrix.html#aab0b19556bceff4ed233cf80961ff613">tk::hypre::HypreMatrix::set</a></div><div class="ttdeci">void set(int nrows, int *ncols, const int *rows, const int *cols, const double *values)</div><div class="ttdoc">Set values of matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_matrix_8h_source.html#l00054">HypreMatrix.h:54</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a463ecb7a4fe179cf728b681fd568d325"><div class="ttname"><a href="classtk_1_1_solver.html#a463ecb7a4fe179cf728b681fd568d325">tk::Solver::m_hypreMat</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreMat</div><div class="ttdoc">Matrix nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00426">Solver.h:426</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a6f9c5ff09968b7b87d9cb0c22f4cf2e2_cgraph.svg" width="352" height="98"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="af6deaa8e458f6df24e635265d0b51584"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6deaa8e458f6df24e635265d0b51584">&#9670;&nbsp;</a></span>lhsbc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::lhsbc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set boundary conditions on the left-hand side matrix. </p>
<p>Setting boundary conditions on the left-hand side matrix is done by zeroing all nonzero entries in rows where BCs are prescribed and putting in 1.0 for the diagonal. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00804">804</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8_c_source.html#l00965">hyprelhs()</a>, <a class="el" href="_solver_8h_source.html#l00468">lhscomplete()</a>, <a class="el" href="_solver_8h_source.html#l00454">m_bc</a>, <a class="el" href="_solver_8h_source.html#l00391">m_lhs</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, and <a class="el" href="_container_util_8h_source.html#l00053">tk::ref_find()</a>.</p>
<div class="fragment"><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;{</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_solver.html#adff512ead1e7f2b5d24801531019aced">lhscomplete</a>(),</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;          <span class="stringliteral">&quot;Nonzero values of distributed matrix on PE &quot;</span> +</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;          std::to_string( CkMyPe() ) + <span class="stringliteral">&quot; is incomplete: cannot set BCs&quot;</span> );</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="comment">// Set Dirichlet BCs on the lhs matrix. Loop through all BCs and if a BC</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">// is prescribed on a row we own, find that row (r) and in that row the</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="comment">// position of the diagonal entry (diag) in the LHS matrix. Then for all</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="comment">// scalar components the system of system of PDEs we intagrate, query the</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="comment">// entry in the BC data structure to see if we need to set BC for the</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="comment">// given component and set the off-diagonals to zero while put 1.0 into</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="comment">// the diagonal.</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">//std::cout &lt;&lt; &quot;l: &quot;;</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">// std::map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt;</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">//   s( begin(m_bc), end(m_bc) );</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">// for (const auto&amp; n : s) std::cout &lt;&lt; n.first &lt;&lt; &#39; &#39;; std::cout &lt;&lt; &#39;\n&#39;;</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n : <a class="code" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">m_bc</a>) {</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">if</span> (n.first &gt;= <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> &amp;&amp; n.first &lt; <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>) {</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      <span class="keyword">auto</span>&amp; r = <a class="code" href="namespacetk.html#ab2aac5f0fd93d5119cfe50a39f3515c9">tk::ref_find</a>( <a class="code" href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">m_lhs</a>, n.first );</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keyword">auto</span>&amp; diag = <a class="code" href="namespacetk.html#ab2aac5f0fd93d5119cfe50a39f3515c9">tk::ref_find</a>( r, n.first );</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">for</span> (std::size_t i=0; i&lt;<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>; ++i)</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="keywordflow">if</span> (n.second[i].first) {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; c : r) c.second[i] = 0.0;  <span class="comment">// zero columns in BC row</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;          diag[i] = 1.0;    <span class="comment">// put 1.0 in diagonal of BC row</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        }</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">//   for (const auto&amp; n : m_bc) {</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">//     auto r = m_lhs.find( n.first );</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">//     if (r != end(m_lhs)) {</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">//       m_bca[ n.first ] = r-&gt;second;</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">//       for (const auto&amp; c : r-&gt;second)</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">//         if (c.first != n.first ) {</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">//           auto a = m_lhs.find( c.first );</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">//           if (a != end(m_lhs)) {</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">//             auto&amp; b = tk::ref_find( a-&gt;second, n.first );</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">//             for (std::size_t i=0; i&lt;m_ncomp; ++i)</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">//               if (n.second[i].first)</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">//                 b[i] = 0.0;</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">//           }</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">//         }</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">//     }</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">//   }</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">// </span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">//   // test BCs in matrix (only in serial)</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">//   auto eps = std::numeric_limits&lt; tk::real &gt;::epsilon();</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">//   for (const auto&amp; n : m_bc) {</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">//     auto r = m_lhs.find( n.first );</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">//     if (r != end(m_lhs)) {</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">//       std::size_t ver_row = 0, ver_col = 0;</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">//       for (const auto&amp; c : r-&gt;second)</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">//         if (c.first != n.first) {</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">//           // test row</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">//           for (std::size_t i=0; i&lt;m_ncomp; ++i)</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">//             if (std::abs(c.second[i]) &gt; eps)      // test zero</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">//               std::cout &lt;&lt; &#39;r&#39;;</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">//             else                                  // count nonzeros</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">//               ++ver_row;</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">//           // test column</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">//           auto b = m_lhs.find( c.first );</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">//           if (b !=end(m_lhs)) {</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">//             auto d = b-&gt;second.find( n.first );</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">//             if (d != end(b-&gt;second)) {</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">//               for (std::size_t i=0; i&lt;m_ncomp; ++i)</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">//                 if (std::abs(d-&gt;second[i]) &gt; eps)  // test zero</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">//                   std::cout &lt;&lt; &#39;c&#39;;</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">//                 else</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">//                   ++ver_col;                       // count nonzeros</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">//             }</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">//           }</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">//         }</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">//       // test number of nonzeros in BC row</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">//       if (ver_row != (r-&gt;second.size()-1)*m_ncomp) std::cout &lt;&lt; &#39;R&#39;;</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">//       // test number of nonzeros in BC column</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">//       if (ver_col != (r-&gt;second.size()-1)*m_ncomp) std::cout &lt;&lt; &#39;C&#39;;</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">//     }</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">//   }</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">// </span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">//   // test symmetry of matrix (only in serial)</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">//   for (const auto&amp; r : m_lhs)</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">//     for (const auto&amp; c : r.second) {</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">//       const auto&amp; v = tk::cref_find( m_lhs, c.first );</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">//       const auto&amp; w = tk::cref_find( v, r.first );</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">//       for (std::size_t i=0; i&lt;m_ncomp; ++i)</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">//         if (std::abs(c.second[i]-w[i]) &gt; 1.0e-14)</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">//           std::cout &lt;&lt; &#39;s&#39;;</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">//     }</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <a class="code" href="classtk_1_1_solver.html#af9cb98d033677aaf8e1f9cd56e443f42">hyprelhs</a>();</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;}</div><div class="ttc" id="namespacetk_html_ab2aac5f0fd93d5119cfe50a39f3515c9"><div class="ttname"><a href="namespacetk.html#ab2aac5f0fd93d5119cfe50a39f3515c9">tk::ref_find</a></div><div class="ttdeci">auto ref_find(const Container &amp;map, const typename Container::key_type &amp;key) -&gt; typename Container::mapped_type &amp;</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00053">ContainerUtil.h:53</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a15cb29c1ed768f5e288c4c1cc1dbfe3c"><div class="ttname"><a href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">tk::Solver::m_bc</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; m_bc</div><div class="ttdoc">Values (for each scalar equation solved) of Dirichlet boundary conditions assigned to global node IDs...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00454">Solver.h:454</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_adff512ead1e7f2b5d24801531019aced"><div class="ttname"><a href="classtk_1_1_solver.html#adff512ead1e7f2b5d24801531019aced">tk::Solver::lhscomplete</a></div><div class="ttdeci">bool lhscomplete() const</div><div class="ttdoc">Check if our portion of the matrix values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00468">Solver.h:468</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_af9cb98d033677aaf8e1f9cd56e443f42"><div class="ttname"><a href="classtk_1_1_solver.html#af9cb98d033677aaf8e1f9cd56e443f42">tk::Solver::hyprelhs</a></div><div class="ttdeci">void hyprelhs()</div><div class="ttdoc">Build Hypre data for our portion of the matrix. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00965">Solver.C:965</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a89057b993f4b676ce381d22f580b1122"><div class="ttname"><a href="classtk_1_1_solver.html#a89057b993f4b676ce381d22f580b1122">tk::Solver::m_lhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; &gt; m_lhs</div><div class="ttdoc">Part of left-hand side matrix owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00391">Solver.h:391</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_af6deaa8e458f6df24e635265d0b51584_cgraph.svg" width="536" height="136"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="adff512ead1e7f2b5d24801531019aced"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adff512ead1e7f2b5d24801531019aced">&#9670;&nbsp;</a></span>lhscomplete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool tk::Solver::lhscomplete </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if our portion of the matrix values is complete. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00468">468</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00405">addlhs()</a>, <a class="el" href="_solver_8_c_source.html#l00347">charelhs()</a>, <a class="el" href="_solver_8_c_source.html#l00965">hyprelhs()</a>, and <a class="el" href="_solver_8_c_source.html#l00804">lhsbc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classtk_1_1_solver.html#a7fb039115d7990655180a208b2db100e">m_lhsimport</a> == <a class="code" href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">m_rowimport</a>; }</div><div class="ttc" id="classtk_1_1_solver_html_a7fb039115d7990655180a208b2db100e"><div class="ttname"><a href="classtk_1_1_solver.html#a7fb039115d7990655180a208b2db100e">tk::Solver::m_lhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00367">Solver.h:367</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afff71961577fa755ed96de7b3ed938cb"><div class="ttname"><a href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">tk::Solver::m_rowimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rowimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00361">Solver.h:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9ac9815d3617f4bae94ba9eb9309f44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9ac9815d3617f4bae94ba9eb9309f44">&#9670;&nbsp;</a></span>lowlhscomplete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool tk::Solver::lowlhscomplete </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if our portion of the low-order lhs vector values is complete. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00481">481</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00575">addlowlhs()</a>, <a class="el" href="_solver_8_c_source.html#l00538">charelowlhs()</a>, and <a class="el" href="_solver_8_c_source.html#l01138">lowsolve()</a>.</p>
<div class="fragment"><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classtk_1_1_solver.html#a0e65b31fc4d20bebd4f8fa9d12f4f11e">m_lowlhsimport</a> == <a class="code" href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">m_rowimport</a>; }</div><div class="ttc" id="classtk_1_1_solver_html_a0e65b31fc4d20bebd4f8fa9d12f4f11e"><div class="ttname"><a href="classtk_1_1_solver.html#a0e65b31fc4d20bebd4f8fa9d12f4f11e">tk::Solver::m_lowlhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lowlhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00376">Solver.h:376</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afff71961577fa755ed96de7b3ed938cb"><div class="ttname"><a href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">tk::Solver::m_rowimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rowimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00361">Solver.h:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e3434316f4316977063b72bed398b10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e3434316f4316977063b72bed398b10">&#9670;&nbsp;</a></span>lowrhscomplete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool tk::Solver::lowrhscomplete </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if our portion of the low-order rhs vector values is complete. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00478">478</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00517">addlowrhs()</a>, <a class="el" href="_solver_8_c_source.html#l00480">charelowrhs()</a>, and <a class="el" href="_solver_8_c_source.html#l01138">lowsolve()</a>.</p>
<div class="fragment"><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">m_lowrhsimport</a> == <a class="code" href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">m_rowimport</a>; }</div><div class="ttc" id="classtk_1_1_solver_html_a785b937d0f47b18b3f5a7dd41fb2a5b4"><div class="ttname"><a href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">tk::Solver::m_lowrhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lowrhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00373">Solver.h:373</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afff71961577fa755ed96de7b3ed938cb"><div class="ttname"><a href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">tk::Solver::m_rowimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rowimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00361">Solver.h:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7bfe4d55939e03e51bb0e9b9547f2e7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bfe4d55939e03e51bb0e9b9547f2e7a">&#9670;&nbsp;</a></span>lowsolve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::lowsolve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve low-order linear system. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l01138">1138</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_container_util_8h_source.html#l00135">tk::keyEqual()</a>, <a class="el" href="_solver_8h_source.html#l00481">lowlhscomplete()</a>, <a class="el" href="_solver_8h_source.html#l00478">lowrhscomplete()</a>, <a class="el" href="_solver_8h_source.html#l00454">m_bc</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00405">m_lowlhs</a>, <a class="el" href="_solver_8h_source.html#l00400">m_lowrhs</a>, <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>, <a class="el" href="_solver_8h_source.html#l00395">m_rhs</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, <a class="el" href="_container_util_8h_source.html#l00053">tk::ref_find()</a>, <a class="el" href="_solver_8h_source.html#l00475">rhscomplete()</a>, and <a class="el" href="_solver_8_c_source.html#l01114">updateLowSol()</a>.</p>
<div class="fragment"><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;{</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="comment">// Set boundary conditions on the low-order system</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n : <a class="code" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">m_bc</a>)</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keywordflow">if</span> (n.first &gt;= <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> &amp;&amp; n.first &lt; <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>) {</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="comment">// lhs</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="keyword">auto</span>&amp; l = <a class="code" href="namespacetk.html#ab2aac5f0fd93d5119cfe50a39f3515c9">tk::ref_find</a>( <a class="code" href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">m_lowlhs</a>, n.first );</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <span class="keywordflow">for</span> (std::size_t i=0; i&lt;<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>; ++i)</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <span class="keywordflow">if</span> (n.second[i].first) l[i] = 1.0;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <span class="comment">// rhs (set to zero instead of the solution increment at Dirichlet</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      <span class="comment">// BCs, because for the low order solution we solve for L = R + D,</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="comment">// where L is the lumped mass matrix, R is the high order RHS, and D</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="comment">// is mass diffusion, and R already has the Dirichlet BC set)</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <span class="keyword">auto</span>&amp; r = <a class="code" href="namespacetk.html#ab2aac5f0fd93d5119cfe50a39f3515c9">tk::ref_find</a>( <a class="code" href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">m_lowrhs</a>, n.first );</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keywordflow">for</span> (std::size_t i=0; i&lt;<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>; ++i)</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="keywordflow">if</span> (n.second[i].first) r[i] = 0.0;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    }</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="comment">// Solve low-order system</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_solver.html#a08e43845db3aeb56e84388241d9138f6">rhscomplete</a>(),</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;          <span class="stringliteral">&quot;Values of distributed right-hand-side vector on PE &quot;</span> +</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;          std::to_string( CkMyPe() ) + <span class="stringliteral">&quot; is incomplete: cannot solve low &quot;</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;          <span class="stringliteral">&quot;order system&quot;</span> );</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_solver.html#a4e3434316f4316977063b72bed398b10">lowrhscomplete</a>(),</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;          <span class="stringliteral">&quot;Values of distributed mass diffusion rhs vector on PE &quot;</span> +</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;          std::to_string( CkMyPe() ) + <span class="stringliteral">&quot; is incomplete: cannot solve low &quot;</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;          <span class="stringliteral">&quot;order system&quot;</span> );</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_solver.html#ac9ac9815d3617f4bae94ba9eb9309f44">lowlhscomplete</a>(),</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;          <span class="stringliteral">&quot;Values of distributed lumped mass lhs vector on PE &quot;</span> +</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;          std::to_string( CkMyPe() ) + <span class="stringliteral">&quot; is incomplete: cannot solve low &quot;</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;          <span class="stringliteral">&quot;order system&quot;</span> );</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="namespacetk.html#a6b203c3a87657090a5c477896ce94bf9">tk::keyEqual</a>( <a class="code" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">m_rhs</a>, <a class="code" href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">m_lowrhs</a> ), <span class="stringliteral">&quot;Row IDs of rhs and mass &quot;</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;          <span class="stringliteral">&quot;diffusion rhs vector unequal on PE &quot;</span> + std::to_string( CkMyPe() )</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;          + <span class="stringliteral">&quot;: cannot solve low order system&quot;</span> );</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="namespacetk.html#a6b203c3a87657090a5c477896ce94bf9">tk::keyEqual</a>( <a class="code" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">m_rhs</a>, <a class="code" href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">m_lowlhs</a> ), <span class="stringliteral">&quot;Row IDs of rhs and lumped mass &quot;</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;          <span class="stringliteral">&quot;lhs vector unequal on PE &quot;</span> + std::to_string( CkMyPe() ) + <span class="stringliteral">&quot;: &quot;</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;          <span class="stringliteral">&quot;cannot solve low order system&quot;</span> );</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="keyword">auto</span> ir = <a class="code" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">m_rhs</a>.cbegin();</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="keyword">auto</span> <span class="keywordtype">id</span> = <a class="code" href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">m_lowrhs</a>.begin();</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keyword">auto</span> im = <a class="code" href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">m_lowlhs</a>.cbegin();</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="keywordflow">while</span> (ir != <a class="code" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">m_rhs</a>.cend()) {</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; r = ir-&gt;second;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; m = im-&gt;second;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keyword">auto</span>&amp; d = <span class="keywordtype">id</span>-&gt;second;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( r.size()==m_ncomp &amp;&amp; m.size()==m_ncomp &amp;&amp; d.size()==<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>,</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            <span class="stringliteral">&quot;Wrong number of components in solving the low order system&quot;</span> );</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordflow">for</span> (std::size_t i=0; i&lt;<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>; ++i) d[i] = (r[i]+d[i])/m[i];</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    ++ir; ++id; ++im;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="comment">//lowsolve_complete();</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <a class="code" href="classtk_1_1_solver.html#afd2cf6f3695d1007aedfd69bcd847d36">updateLowSol</a>();</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;}</div><div class="ttc" id="namespacetk_html_ab2aac5f0fd93d5119cfe50a39f3515c9"><div class="ttname"><a href="namespacetk.html#ab2aac5f0fd93d5119cfe50a39f3515c9">tk::ref_find</a></div><div class="ttdeci">auto ref_find(const Container &amp;map, const typename Container::key_type &amp;key) -&gt; typename Container::mapped_type &amp;</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00053">ContainerUtil.h:53</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a15cb29c1ed768f5e288c4c1cc1dbfe3c"><div class="ttname"><a href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">tk::Solver::m_bc</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; m_bc</div><div class="ttdoc">Values (for each scalar equation solved) of Dirichlet boundary conditions assigned to global node IDs...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00454">Solver.h:454</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a798bf7f5ab59aa65cfc00dfe0631ed7e"><div class="ttname"><a href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">tk::Solver::m_lowrhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_lowrhs</div><div class="ttdoc">Part of low-order right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00400">Solver.h:400</a></div></div>
<div class="ttc" id="namespacetk_html_a6b203c3a87657090a5c477896ce94bf9"><div class="ttname"><a href="namespacetk.html#a6b203c3a87657090a5c477896ce94bf9">tk::keyEqual</a></div><div class="ttdeci">bool keyEqual(const Container &amp;a, const Container &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00135">ContainerUtil.h:135</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a08e43845db3aeb56e84388241d9138f6"><div class="ttname"><a href="classtk_1_1_solver.html#a08e43845db3aeb56e84388241d9138f6">tk::Solver::rhscomplete</a></div><div class="ttdeci">bool rhscomplete() const</div><div class="ttdoc">Check if our portion of the right-hand side vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00475">Solver.h:475</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_af0c77bd852425a6506ffee14ffbddba2"><div class="ttname"><a href="classtk_1_1_solver.html#af0c77bd852425a6506ffee14ffbddba2">tk::Solver::m_lowlhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_lowlhs</div><div class="ttdoc">Part of the low-order system left-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00405">Solver.h:405</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5e9b584b84dbca204b2c55322a487d85"><div class="ttname"><a href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">tk::Solver::m_rhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_rhs</div><div class="ttdoc">Part of right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00395">Solver.h:395</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afd2cf6f3695d1007aedfd69bcd847d36"><div class="ttname"><a href="classtk_1_1_solver.html#afd2cf6f3695d1007aedfd69bcd847d36">tk::Solver::updateLowSol</a></div><div class="ttdeci">void updateLowSol()</div><div class="ttdoc">Update low-order solution vector in our PE&amp;#39;s workers. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01114">Solver.C:1114</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a4e3434316f4316977063b72bed398b10"><div class="ttname"><a href="classtk_1_1_solver.html#a4e3434316f4316977063b72bed398b10">tk::Solver::lowrhscomplete</a></div><div class="ttdeci">bool lowrhscomplete() const</div><div class="ttdoc">Check if our portion of the low-order rhs vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00478">Solver.h:478</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ac9ac9815d3617f4bae94ba9eb9309f44"><div class="ttname"><a href="classtk_1_1_solver.html#ac9ac9815d3617f4bae94ba9eb9309f44">tk::Solver::lowlhscomplete</a></div><div class="ttdeci">bool lowlhscomplete() const</div><div class="ttdoc">Check if our portion of the low-order lhs vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00481">Solver.h:481</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a7bfe4d55939e03e51bb0e9b9547f2e7a_cgraph.svg" width="531" height="282"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a0297a6c08589267f294efba205c4527e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0297a6c08589267f294efba205c4527e">&#9670;&nbsp;</a></span>nchare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::nchare </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set number of worker chares expected to contribute on my PE. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Total number of chares (work units) across all PEs </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00202">202</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00351">m_nchare</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;{</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keyword">auto</span> chunksize = n / CkNumPes();</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keyword">auto</span> mynchare = chunksize;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">if</span> (CkMyPe() == CkNumPes()-1) mynchare += n % CkNumPes();</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">m_nchare</a> = <span class="keyword">static_cast&lt;</span> std::size_t <span class="keyword">&gt;</span>( mynchare );</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  nchare_complete();</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_aa0917fe1c723d52a9729c321a18c76e4"><div class="ttname"><a href="classtk_1_1_solver.html#aa0917fe1c723d52a9729c321a18c76e4">tk::Solver::m_nchare</a></div><div class="ttdeci">std::size_t m_nchare</div><div class="ttdoc">Number of chares contributing to my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00351">Solver.h:351</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59605a73c9c94190e2dec90277165e2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59605a73c9c94190e2dec90277165e2e">&#9670;&nbsp;</a></span>next()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::next </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare for next step. </p>
<p>Re-enable SDAG waits for rebuilding the right-hand side vector only </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00171">171</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00454">m_bc</a>, <a class="el" href="_solver_8h_source.html#l00413">m_diag</a>, <a class="el" href="_solver_8h_source.html#l00380">m_diagimport</a>, <a class="el" href="_solver_8h_source.html#l00428">m_hypreRhs</a>, <a class="el" href="_solver_8h_source.html#l00400">m_lowrhs</a>, <a class="el" href="_solver_8h_source.html#l00373">m_lowrhsimport</a>, <a class="el" href="_solver_8h_source.html#l00358">m_myworker</a>, <a class="el" href="_solver_8h_source.html#l00395">m_rhs</a>, <a class="el" href="_solver_8h_source.html#l00370">m_rhsimport</a>, and <a class="el" href="_solver_8h_source.html#l00459">m_worker</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  wait4rhsbc();</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  wait4hyprerhs();</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  wait4asm();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  wait4low();</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">m_rhsimport</a>.clear();</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">m_lowrhsimport</a>.clear();</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">m_lowrhs</a>.clear();</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">m_hypreRhs</a>.clear();</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">m_rhs</a>.clear();</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">m_diagimport</a>.clear();</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aeb7e186805440317cd4368ee3a15eef0">m_diag</a>.clear();</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">m_bc</a>.clear();</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  lowlhs_complete();</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  hyprerow_complete();</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  asmsol_complete();</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  asmlhs_complete();</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// Continue with next time step</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">m_myworker</a>) <a class="code" href="classtk_1_1_solver.html#a123c1061f4552868a1e44a14e1e65f9f">m_worker</a>[i].dt();</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_aa91c68e53e18f58cdc2ff5db1ea9477b"><div class="ttname"><a href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">tk::Solver::m_hypreRhs</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreRhs</div><div class="ttdoc">RHS vector nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00428">Solver.h:428</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a123c1061f4552868a1e44a14e1e65f9f"><div class="ttname"><a href="classtk_1_1_solver.html#a123c1061f4552868a1e44a14e1e65f9f">tk::Solver::m_worker</a></div><div class="ttdeci">inciter::CProxy_CG m_worker</div><div class="ttdoc">Worker proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00459">Solver.h:459</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a15cb29c1ed768f5e288c4c1cc1dbfe3c"><div class="ttname"><a href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">tk::Solver::m_bc</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; m_bc</div><div class="ttdoc">Values (for each scalar equation solved) of Dirichlet boundary conditions assigned to global node IDs...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00454">Solver.h:454</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a798bf7f5ab59aa65cfc00dfe0631ed7e"><div class="ttname"><a href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">tk::Solver::m_lowrhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_lowrhs</div><div class="ttdoc">Part of low-order right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00400">Solver.h:400</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a989650135b8066b1d562bef134e6c74e"><div class="ttname"><a href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">tk::Solver::m_rhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00370">Solver.h:370</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5e9b584b84dbca204b2c55322a487d85"><div class="ttname"><a href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">tk::Solver::m_rhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_rhs</div><div class="ttdoc">Part of right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00395">Solver.h:395</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a785b937d0f47b18b3f5a7dd41fb2a5b4"><div class="ttname"><a href="classtk_1_1_solver.html#a785b937d0f47b18b3f5a7dd41fb2a5b4">tk::Solver::m_lowrhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_lowrhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00373">Solver.h:373</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5075ce717bdb9d6dfd18d1b124f542d0"><div class="ttname"><a href="classtk_1_1_solver.html#a5075ce717bdb9d6dfd18d1b124f542d0">tk::Solver::m_diagimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_diagimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00380">Solver.h:380</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a311ab085fcb1950dcdbfdac6c978a1ad"><div class="ttname"><a href="classtk_1_1_solver.html#a311ab085fcb1950dcdbfdac6c978a1ad">tk::Solver::m_myworker</a></div><div class="ttdeci">std::vector&lt; int &gt; m_myworker</div><div class="ttdoc">Ids of workers on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00358">Solver.h:358</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeb7e186805440317cd4368ee3a15eef0"><div class="ttname"><a href="classtk_1_1_solver.html#aeb7e186805440317cd4368ee3a15eef0">tk::Solver::m_diag</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; std::vector&lt; tk::real &gt; &gt; &gt; m_diag</div><div class="ttdoc">Part of solution vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00413">Solver.h:413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d82dd86315e09ac53e73bb1a70fd405"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d82dd86315e09ac53e73bb1a70fd405">&#9670;&nbsp;</a></span>pe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Solver::pe </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>gid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return processing element for global mesh row id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gid</td><td>Global mesh point (matrix or vector row) id</td></tr>
  </table>
  </dd>
</dl>
<p>First we attempt to the point index in the cache. If that fails, we resort to a linear search across the division map. Once the PE is found, we store it in the cache, so next time the search is quicker. This procedure must find the PE for the id. </p><dl class="section return"><dt>Returns</dt><dd>PE that owns global row id </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00735">735</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00436">m_div</a>, and <a class="el" href="_solver_8h_source.html#l00442">m_pe</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00217">charecom()</a>, <a class="el" href="_solver_8_c_source.html#l00669">charediag()</a>, <a class="el" href="_solver_8_c_source.html#l00347">charelhs()</a>, <a class="el" href="_solver_8_c_source.html#l00538">charelowlhs()</a>, <a class="el" href="_solver_8_c_source.html#l00480">charelowrhs()</a>, <a class="el" href="_solver_8_c_source.html#l00426">charerhs()</a>, and <a class="el" href="_solver_8_c_source.html#l00291">charesol()</a>.</p>
<div class="fragment"><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;{</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordtype">int</span> p = -1;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keyword">auto</span> it = <a class="code" href="classtk_1_1_solver.html#aa7c5cb2402a3aa4b4f411a9f516c5ceb">m_pe</a>.find( gid );</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordflow">if</span> (it != end(<a class="code" href="classtk_1_1_solver.html#aa7c5cb2402a3aa4b4f411a9f516c5ceb">m_pe</a>))</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    p = it-&gt;second;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : <a class="code" href="classtk_1_1_solver.html#ae05ada0e47dc55cf2f7597813a112bb8">m_div</a>)</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="keywordflow">if</span> (gid &gt;= d.first.first &amp;&amp; gid &lt; d.first.second)</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        p = <a class="code" href="classtk_1_1_solver.html#aa7c5cb2402a3aa4b4f411a9f516c5ceb">m_pe</a>[ gid ] = d.second;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( p &gt;= 0, <span class="stringliteral">&quot;PE not found for node id &quot;</span> + std::to_string(gid) );</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( p &lt; CkNumPes(), <span class="stringliteral">&quot;Assigning to nonexistent PE&quot;</span> );</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordflow">return</span> p;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_aa7c5cb2402a3aa4b4f411a9f516c5ceb"><div class="ttname"><a href="classtk_1_1_solver.html#aa7c5cb2402a3aa4b4f411a9f516c5ceb">tk::Solver::m_pe</a></div><div class="ttdeci">std::map&lt; std::size_t, int &gt; m_pe</div><div class="ttdoc">PEs associated to global mesh point indices. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00442">Solver.h:442</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae05ada0e47dc55cf2f7597813a112bb8"><div class="ttname"><a href="classtk_1_1_solver.html#ae05ada0e47dc55cf2f7597813a112bb8">tk::Solver::m_div</a></div><div class="ttdeci">std::map&lt; std::pair&lt; std::size_t, std::size_t &gt;, int &gt; m_div</div><div class="ttdoc">PEs associated to lower and upper global row indices. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00436">Solver.h:436</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3c996911cb985352859098c77521c52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3c996911cb985352859098c77521c52">&#9670;&nbsp;</a></span>recrow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::recrow </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Acknowledge received row ids. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00272">272</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8_c_source.html#l00762">comcomplete()</a>, <a class="el" href="_solver_8h_source.html#l00347">m_cb</a>, and <a class="el" href="_solver_8h_source.html#l00352">m_nperow</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;{</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  --<a class="code" href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">m_nperow</a>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classtk_1_1_solver.html#a2f598b4321c7e287133afdc86df24b22">comcomplete</a>()) contribute( <a class="code" href="classtk_1_1_solver.html#a093deef03f663d258ae53716c60eb77b">m_cb</a>.get&lt; <a class="code" href="structtag_1_1com.html">tag::com</a> &gt;() );</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a2f598b4321c7e287133afdc86df24b22"><div class="ttname"><a href="classtk_1_1_solver.html#a2f598b4321c7e287133afdc86df24b22">tk::Solver::comcomplete</a></div><div class="ttdeci">bool comcomplete() const</div><div class="ttdoc">Check if we have done our part in storing and exporting global row ids. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00762">Solver.C:762</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a4e3671da52361509cca6781a7aab834c"><div class="ttname"><a href="classtk_1_1_solver.html#a4e3671da52361509cca6781a7aab834c">tk::Solver::m_nperow</a></div><div class="ttdeci">std::size_t m_nperow</div><div class="ttdoc">Number of fellow PEs to send row ids to. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00352">Solver.h:352</a></div></div>
<div class="ttc" id="structtag_1_1com_html"><div class="ttname"><a href="structtag_1_1com.html">tag::com</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00158">Tags.h:158</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a093deef03f663d258ae53716c60eb77b"><div class="ttname"><a href="classtk_1_1_solver.html#a093deef03f663d258ae53716c60eb77b">tk::Solver::m_cb</a></div><div class="ttdeci">tk::tuple::tagged_tuple&lt; tag::com, CkCallback, tag::coord, CkCallback, tag::diag, CkCallback &gt; m_cb</div><div class="ttdoc">Charm++ reduction callbacks associated to compile-time tags. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00347">Solver.h:347</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_ab3c996911cb985352859098c77521c52_cgraph.svg" width="363" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a5cf2b15c9104825539d97a8af94407dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cf2b15c9104825539d97a8af94407dd">&#9670;&nbsp;</a></span>registerReducers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::registerReducers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configure Charm++ reduction types for concatenating BC nodelists. </p>
<p>Since this is a [nodeinit] routine, the runtime system executes the routine exactly once on every logical node early on in the Charm++ init sequence. Must be static as it is called without an object. See also: Section "Initializations at Program Startup" at in the Charm++ manual <a href="http://charm.cs.illinois.edu/manuals/html/charm++/manual.html">http://charm.cs.illinois.edu/manuals/html/charm++/manual.html</a>. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00119">119</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8_c_source.html#l00034">tk::BCMapMerger</a>, <a class="el" href="_solver_8_c_source.html#l00035">tk::DiagMerger</a>, <a class="el" href="_diag_reducer_8_c_source.html#l00041">tk::mergeDiag()</a>, and <a class="el" href="_hash_map_reducer_8h_source.html#l00061">tk::mergeHashMap()</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="namespacetk.html#a1320fa5c795146f9a4ac4fc2eb4e2606">BCMapMerger</a> = CkReduction::addReducer(</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                  <a class="code" href="namespacetk.html#ac371117af5d2009dca83a8cb5539a43f">tk::mergeHashMap</a>&lt; std::size_t,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; );</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="namespacetk.html#ad252eef00813878543c56f7074e475f1">DiagMerger</a> = CkReduction::addReducer( <a class="code" href="namespacetk.html#a8508b6f96fc7cb65df8e1dbd4bf0a840">tk::mergeDiag</a> );</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div><div class="ttc" id="namespacetk_html_ac371117af5d2009dca83a8cb5539a43f"><div class="ttname"><a href="namespacetk.html#ac371117af5d2009dca83a8cb5539a43f">tk::mergeHashMap</a></div><div class="ttdeci">CkReductionMsg * mergeHashMap(int nmsg, CkReductionMsg **msgs)</div><div class="ttdoc">Charm++ custom reducer for merging std::unordered_maps during reduction across PEs. </div><div class="ttdef"><b>Definition:</b> <a href="_hash_map_reducer_8h_source.html#l00061">HashMapReducer.h:61</a></div></div>
<div class="ttc" id="namespacetk_html_ad252eef00813878543c56f7074e475f1"><div class="ttname"><a href="namespacetk.html#ad252eef00813878543c56f7074e475f1">tk::DiagMerger</a></div><div class="ttdeci">static CkReduction::reducerType DiagMerger</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00035">Solver.C:35</a></div></div>
<div class="ttc" id="namespacetk_html_a1320fa5c795146f9a4ac4fc2eb4e2606"><div class="ttname"><a href="namespacetk.html#a1320fa5c795146f9a4ac4fc2eb4e2606">tk::BCMapMerger</a></div><div class="ttdeci">static CkReduction::reducerType BCMapMerger</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00034">Solver.C:34</a></div></div>
<div class="ttc" id="namespacetk_html_a8508b6f96fc7cb65df8e1dbd4bf0a840"><div class="ttname"><a href="namespacetk.html#a8508b6f96fc7cb65df8e1dbd4bf0a840">tk::mergeDiag</a></div><div class="ttdeci">CkReductionMsg * mergeDiag(int nmsg, CkReductionMsg **msgs)</div><div class="ttdoc">Charm++ custom reducer for merging std::vectors during reduction across PEs. </div><div class="ttdef"><b>Definition:</b> <a href="_diag_reducer_8_c_source.html#l00041">DiagReducer.C:41</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a5cf2b15c9104825539d97a8af94407dd_cgraph.svg" width="536" height="84"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab2038dcb1e9162ace96fc410fc67991d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2038dcb1e9162ace96fc410fc67991d">&#9670;&nbsp;</a></span>rhs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::rhs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set our portion of values of the distributed right-hand side vector. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l01044">1044</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_hypre_vector_8h_source.html#l00060">tk::hypre::HypreVector::assemble()</a>, <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00416">m_b</a>, <a class="el" href="_solver_8h_source.html#l00428">m_hypreRhs</a>, <a class="el" href="_solver_8h_source.html#l00420">m_hypreRows</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, and <a class="el" href="_hypre_vector_8h_source.html#l00052">tk::hypre::HypreVector::set()</a>.</p>
<div class="fragment"><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;{</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">m_hypreRhs</a>.size() == <a class="code" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">m_hypreRows</a>.size(),</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;          <span class="stringliteral">&quot;RHS vector values incomplete on PE &quot;</span> + std::to_string(CkMyPe()) );</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="comment">// Set our portion of the vector values</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <a class="code" href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">m_b</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#a6c63796a63c7e8227b45bcffc3f505fb">set</a>( static_cast&lt; int &gt;( (<a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a> - <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a>)*<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a> ),</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;           <a class="code" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">m_hypreRows</a>.data(),</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;           <a class="code" href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">m_hypreRhs</a>.data() );</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <a class="code" href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">m_b</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#ac0428fffd8e423b0d8de48d43f26d944">assemble</a>();</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  asmrhs_complete();</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;}</div><div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html_ac0428fffd8e423b0d8de48d43f26d944"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html#ac0428fffd8e423b0d8de48d43f26d944">tk::hypre::HypreVector::assemble</a></div><div class="ttdeci">void assemble()</div><div class="ttdoc">Assemble vector. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00060">HypreVector.h:60</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aa91c68e53e18f58cdc2ff5db1ea9477b"><div class="ttname"><a href="classtk_1_1_solver.html#aa91c68e53e18f58cdc2ff5db1ea9477b">tk::Solver::m_hypreRhs</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreRhs</div><div class="ttdoc">RHS vector nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00428">Solver.h:428</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a2ec72eba8056ffe153131495383e8946"><div class="ttname"><a href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">tk::Solver::m_hypreRows</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreRows</div><div class="ttdoc">Row indices for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00420">Solver.h:420</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ac698c274af8e024cd88cdd3243a6140e"><div class="ttname"><a href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">tk::Solver::m_b</a></div><div class="ttdeci">tk::hypre::HypreVector m_b</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00416">Solver.h:416</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html_a6c63796a63c7e8227b45bcffc3f505fb"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html#a6c63796a63c7e8227b45bcffc3f505fb">tk::hypre::HypreVector::set</a></div><div class="ttdeci">void set(int nvalues, const int *indices, const double *values)</div><div class="ttdoc">Set values of vector. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00052">HypreVector.h:52</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_ab2038dcb1e9162ace96fc410fc67991d_cgraph.svg" width="358" height="98"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a07ff8b79a6fe088d62bef9347a50c4db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07ff8b79a6fe088d62bef9347a50c4db">&#9670;&nbsp;</a></span>rhsbc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::rhsbc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set Dirichlet boundary conditions on the right-hand side vector. </p>
<p>Since we solve for the solution increment, this amounts to enforcing zero rhs (no solution increment) at BC nodes </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l00906">906</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8_c_source.html#l00989">hyprerhs()</a>, <a class="el" href="_solver_8h_source.html#l00454">m_bc</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>, <a class="el" href="_solver_8h_source.html#l00395">m_rhs</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, <a class="el" href="_container_util_8h_source.html#l00053">tk::ref_find()</a>, and <a class="el" href="_solver_8h_source.html#l00475">rhscomplete()</a>.</p>
<div class="fragment"><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;{</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_solver.html#a08e43845db3aeb56e84388241d9138f6">rhscomplete</a>(),</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;          <span class="stringliteral">&quot;Values of distributed right-hand-side vector on PE &quot;</span> +</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;          std::to_string( CkMyPe() ) + <span class="stringliteral">&quot; is incomplete: cannot set BCs&quot;</span> );</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">//   for (const auto&amp; n : m_bc) {</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">//      auto r = m_bca.find( n.first );</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">//      if (r != end(m_bca))</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">//        for (const auto&amp; c : r-&gt;second)</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">//          if (c.first != n.first ) {</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">//            auto a = m_rhs.find( c.first );</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">//            if (a != end(m_rhs))</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">//              for (std::size_t i=0; i&lt;m_ncomp; ++i)</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">//                if (n.second[i].first)</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">//                  a-&gt;second[i] -= n.second[i].second * c.second[i];</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">//          }</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">//    }</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n : <a class="code" href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">m_bc</a>) {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">if</span> (n.first &gt;= <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a> &amp;&amp; n.first &lt; <a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a>) {</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      <span class="keyword">auto</span>&amp; r = <a class="code" href="namespacetk.html#ab2aac5f0fd93d5119cfe50a39f3515c9">tk::ref_find</a>( <a class="code" href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">m_rhs</a>, n.first );</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="keywordflow">for</span> (std::size_t i=0; i&lt;<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>; ++i)</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordflow">if</span> (n.second[i].first)</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;          r[i] = n.second[i].second;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    }</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  }</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a58ce170f76d94f412e0a5ac8a2e19ac7">hyprerhs</a>();</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  rhsbc_complete();</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;}</div><div class="ttc" id="namespacetk_html_ab2aac5f0fd93d5119cfe50a39f3515c9"><div class="ttname"><a href="namespacetk.html#ab2aac5f0fd93d5119cfe50a39f3515c9">tk::ref_find</a></div><div class="ttdeci">auto ref_find(const Container &amp;map, const typename Container::key_type &amp;key) -&gt; typename Container::mapped_type &amp;</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00053">ContainerUtil.h:53</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a15cb29c1ed768f5e288c4c1cc1dbfe3c"><div class="ttname"><a href="classtk_1_1_solver.html#a15cb29c1ed768f5e288c4c1cc1dbfe3c">tk::Solver::m_bc</a></div><div class="ttdeci">std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, tk::real &gt; &gt; &gt; m_bc</div><div class="ttdoc">Values (for each scalar equation solved) of Dirichlet boundary conditions assigned to global node IDs...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00454">Solver.h:454</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a08e43845db3aeb56e84388241d9138f6"><div class="ttname"><a href="classtk_1_1_solver.html#a08e43845db3aeb56e84388241d9138f6">tk::Solver::rhscomplete</a></div><div class="ttdeci">bool rhscomplete() const</div><div class="ttdoc">Check if our portion of the right-hand side vector values is complete. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00475">Solver.h:475</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a5e9b584b84dbca204b2c55322a487d85"><div class="ttname"><a href="classtk_1_1_solver.html#a5e9b584b84dbca204b2c55322a487d85">tk::Solver::m_rhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_rhs</div><div class="ttdoc">Part of right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00395">Solver.h:395</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a58ce170f76d94f412e0a5ac8a2e19ac7"><div class="ttname"><a href="classtk_1_1_solver.html#a58ce170f76d94f412e0a5ac8a2e19ac7">tk::Solver::hyprerhs</a></div><div class="ttdeci">void hyprerhs()</div><div class="ttdoc">Build Hypre data for our portion of the right-hand side vector. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l00989">Solver.C:989</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a07ff8b79a6fe088d62bef9347a50c4db_cgraph.svg" width="542" height="136"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a08e43845db3aeb56e84388241d9138f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08e43845db3aeb56e84388241d9138f6">&#9670;&nbsp;</a></span>rhscomplete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool tk::Solver::rhscomplete </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if our portion of the right-hand side vector values is complete. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00475">475</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00461">addrhs()</a>, <a class="el" href="_solver_8_c_source.html#l00426">charerhs()</a>, <a class="el" href="_solver_8_c_source.html#l00989">hyprerhs()</a>, <a class="el" href="_solver_8_c_source.html#l01138">lowsolve()</a>, and <a class="el" href="_solver_8_c_source.html#l00906">rhsbc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">m_rhsimport</a> == <a class="code" href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">m_rowimport</a>; }</div><div class="ttc" id="classtk_1_1_solver_html_a989650135b8066b1d562bef134e6c74e"><div class="ttname"><a href="classtk_1_1_solver.html#a989650135b8066b1d562bef134e6c74e">tk::Solver::m_rhsimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rhsimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00370">Solver.h:370</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afff71961577fa755ed96de7b3ed938cb"><div class="ttname"><a href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">tk::Solver::m_rowimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rowimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00361">Solver.h:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b3b523d096850165aa3853913b19640"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b3b523d096850165aa3853913b19640">&#9670;&nbsp;</a></span>side()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::map&lt; int, std::vector&lt; std::size_t &gt; &gt;&amp; tk::Solver::side </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Chares query side set info </p><dl class="section note"><dt>Note</dt><dd>This function does not have to be declared as a Charm++ entry method since it is always called by chares on the same PE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00306">306</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classtk_1_1_solver.html#a8c65ab8493c82ad5359d11e9e07b35c4">m_side</a>; }</div><div class="ttc" id="classtk_1_1_solver_html_a8c65ab8493c82ad5359d11e9e07b35c4"><div class="ttname"><a href="classtk_1_1_solver.html#a8c65ab8493c82ad5359d11e9e07b35c4">tk::Solver::m_side</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_side</div><div class="ttdoc">Global (as in file) mesh node IDs mapped to side set ids of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00349">Solver.h:349</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a71d371296bc61c43fd36386df31fcbc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71d371296bc61c43fd36386df31fcbc4">&#9670;&nbsp;</a></span>sol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::sol </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set our portion of values of the distributed solution vector. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l01005">1005</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_hypre_vector_8h_source.html#l00060">tk::hypre::HypreVector::assemble()</a>, <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_solver_8h_source.html#l00420">m_hypreRows</a>, <a class="el" href="_solver_8h_source.html#l00430">m_hypreSol</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, <a class="el" href="_solver_8h_source.html#l00414">m_x</a>, and <a class="el" href="_hypre_vector_8h_source.html#l00052">tk::hypre::HypreVector::set()</a>.</p>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;{</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">m_hypreSol</a>.size() == <a class="code" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">m_hypreRows</a>.size(),</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          <span class="stringliteral">&quot;Solution vector values incomplete on PE &quot;</span> +</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;          std::to_string(CkMyPe()) );</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="comment">// Set our portion of the vector values</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">m_x</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#a6c63796a63c7e8227b45bcffc3f505fb">set</a>( static_cast&lt; int &gt;( (<a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a> - <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a>)*<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a> ),</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;           <a class="code" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">m_hypreRows</a>.data(),</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;           <a class="code" href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">m_hypreSol</a>.data() );</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">m_x</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#ac0428fffd8e423b0d8de48d43f26d944">assemble</a>();</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  asmsol_complete();</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;}</div><div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html_ac0428fffd8e423b0d8de48d43f26d944"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html#ac0428fffd8e423b0d8de48d43f26d944">tk::hypre::HypreVector::assemble</a></div><div class="ttdeci">void assemble()</div><div class="ttdoc">Assemble vector. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00060">HypreVector.h:60</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aee8a7b9bf4f8c3c4c85f6c246a5817cb"><div class="ttname"><a href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">tk::Solver::m_x</a></div><div class="ttdeci">tk::hypre::HypreVector m_x</div><div class="ttdoc">Hypre vector to store the solution/unknowns. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00414">Solver.h:414</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a2ec72eba8056ffe153131495383e8946"><div class="ttname"><a href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">tk::Solver::m_hypreRows</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreRows</div><div class="ttdoc">Row indices for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00420">Solver.h:420</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html_a6c63796a63c7e8227b45bcffc3f505fb"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html#a6c63796a63c7e8227b45bcffc3f505fb">tk::hypre::HypreVector::set</a></div><div class="ttdeci">void set(int nvalues, const int *indices, const double *values)</div><div class="ttdoc">Set values of vector. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00052">HypreVector.h:52</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ad006a029a5dec2e2fbb234ec39ac0e79"><div class="ttname"><a href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">tk::Solver::m_hypreSol</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreSol</div><div class="ttdoc">Solution vector nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00430">Solver.h:430</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_a71d371296bc61c43fd36386df31fcbc4_cgraph.svg" width="355" height="98"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a70b0188cdae61d2b07ce14df43f51fde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70b0188cdae61d2b07ce14df43f51fde">&#9670;&nbsp;</a></span>solcomplete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool tk::Solver::solcomplete </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if our portion of the solution vector values is complete. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00465">465</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00328">addsol()</a>, <a class="el" href="_solver_8_c_source.html#l00291">charesol()</a>, and <a class="el" href="_solver_8_c_source.html#l00945">hypresol()</a>.</p>
<div class="fragment"><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">m_solimport</a> == <a class="code" href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">m_rowimport</a>; }</div><div class="ttc" id="classtk_1_1_solver_html_ae08497a429ae63351cebcbb73e8cdaa7"><div class="ttname"><a href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">tk::Solver::m_solimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_solimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00364">Solver.h:364</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afff71961577fa755ed96de7b3ed938cb"><div class="ttname"><a href="classtk_1_1_solver.html#afff71961577fa755ed96de7b3ed938cb">tk::Solver::m_rowimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_rowimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00361">Solver.h:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab651560a089c3beaf420deb61ea4bd87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab651560a089c3beaf420deb61ea4bd87">&#9670;&nbsp;</a></span>solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve hyigh-order linear system. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l01099">1099</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00415">m_A</a>, <a class="el" href="_solver_8h_source.html#l00416">m_b</a>, <a class="el" href="_solver_8h_source.html#l00418">m_solver</a>, <a class="el" href="_solver_8h_source.html#l00414">m_x</a>, <a class="el" href="_hypre_solver_8h_source.html#l00048">tk::hypre::HypreSolver::solve()</a>, and <a class="el" href="_solver_8_c_source.html#l01062">updateSol()</a>.</p>
<div class="fragment"><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;{</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <a class="code" href="classtk_1_1_solver.html#a8b9162f97c74ba4c2101da82cd00ae95">m_solver</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_solver.html#a631b1ab29a09cced63021f10487171c3">solve</a>( <a class="code" href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">m_A</a>, <a class="code" href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">m_b</a>, <a class="code" href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">m_x</a> );</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="comment">// send progress report to host</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="comment">//if (m_feedback) m_host.pesolve();</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="comment">//solve_complete();</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <a class="code" href="classtk_1_1_solver.html#ac4260f32744d54b5f8ea91fd492a456b">updateSol</a>();</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_aee8a7b9bf4f8c3c4c85f6c246a5817cb"><div class="ttname"><a href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">tk::Solver::m_x</a></div><div class="ttdeci">tk::hypre::HypreVector m_x</div><div class="ttdoc">Hypre vector to store the solution/unknowns. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00414">Solver.h:414</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aaaa8b3117a8a96197d39b8a5e7eaae66"><div class="ttname"><a href="classtk_1_1_solver.html#aaaa8b3117a8a96197d39b8a5e7eaae66">tk::Solver::m_A</a></div><div class="ttdeci">tk::hypre::HypreMatrix m_A</div><div class="ttdoc">Hypre matrix to store the left-hand side. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00415">Solver.h:415</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a8b9162f97c74ba4c2101da82cd00ae95"><div class="ttname"><a href="classtk_1_1_solver.html#a8b9162f97c74ba4c2101da82cd00ae95">tk::Solver::m_solver</a></div><div class="ttdeci">tk::hypre::HypreSolver m_solver</div><div class="ttdoc">Hypre solver. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00418">Solver.h:418</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ac4260f32744d54b5f8ea91fd492a456b"><div class="ttname"><a href="classtk_1_1_solver.html#ac4260f32744d54b5f8ea91fd492a456b">tk::Solver::updateSol</a></div><div class="ttdeci">void updateSol()</div><div class="ttdoc">Update solution vector in our PE&amp;#39;s workers. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8_c_source.html#l01062">Solver.C:1062</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ac698c274af8e024cd88cdd3243a6140e"><div class="ttname"><a href="classtk_1_1_solver.html#ac698c274af8e024cd88cdd3243a6140e">tk::Solver::m_b</a></div><div class="ttdeci">tk::hypre::HypreVector m_b</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00416">Solver.h:416</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_solver_html_a631b1ab29a09cced63021f10487171c3"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_solver.html#a631b1ab29a09cced63021f10487171c3">tk::hypre::HypreSolver::solve</a></div><div class="ttdeci">void solve(const HypreMatrix &amp;A, const HypreVector &amp;b, const HypreVector &amp;x) const</div><div class="ttdoc">Solve the linear system. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_solver_8h_source.html#l00048">HypreSolver.h:48</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_ab651560a089c3beaf420deb61ea4bd87_cgraph.svg" width="579" height="134"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a779d2ccb6a57583bde1c77bc3589504f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a779d2ccb6a57583bde1c77bc3589504f">&#9670;&nbsp;</a></span>updateDiag()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::updateDiag </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update diagnostics vector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">row</td><td>Global row index of the diagnostics vector to update </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Numerical solution vector for all components </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Analytical solution vector for all components </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Nodal volume</td></tr>
  </table>
  </dd>
</dl>
<p>This function is used to update the vector of diagnostics that collects (across PEs) the numerical solution, the analytical solution, and the nodal volumes at nodes. This involves communication across PEs and can be called for rows with first contributions or subsequent contributions to rows which already hold partial data. The correct policy for updates across PEs (i.e., at nodes that are shared across PEs) is: overwrite the numerical and analytical solutions and summing nodal volumes. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l01198">1198</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00413">m_diag</a>, and <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00713">adddiag()</a>, and <a class="el" href="_solver_8_c_source.html#l00669">charediag()</a>.</p>
<div class="fragment"><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;{</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keyword">auto</span>&amp; d = <a class="code" href="classtk_1_1_solver.html#aeb7e186805440317cd4368ee3a15eef0">m_diag</a>[ row ];</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordflow">if</span> (d.size() != 3) {</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    d.resize( 2, std::vector&lt;tk::real&gt;(<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a>,0.0) );</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    d.resize( 3, std::vector&lt;tk::real&gt;(1,0.0) );</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  }</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  d[0] = std::move( u );    <span class="comment">// overwrite numerical solution</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  d[1] = std::move( a );    <span class="comment">// overwrite analytical solution</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  d[2][0] += v;             <span class="comment">// sum nodal volume</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeb7e186805440317cd4368ee3a15eef0"><div class="ttname"><a href="classtk_1_1_solver.html#aeb7e186805440317cd4368ee3a15eef0">tk::Solver::m_diag</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; std::vector&lt; tk::real &gt; &gt; &gt; m_diag</div><div class="ttdoc">Part of solution vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00413">Solver.h:413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd2cf6f3695d1007aedfd69bcd847d36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd2cf6f3695d1007aedfd69bcd847d36">&#9670;&nbsp;</a></span>updateLowSol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::updateLowSol </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update low-order solution vector in our PE's workers. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l01114">1114</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_solver_8h_source.html#l00400">m_lowrhs</a>, <a class="el" href="_solver_8h_source.html#l00364">m_solimport</a>, <a class="el" href="_solver_8h_source.html#l00459">m_worker</a>, and <a class="el" href="_exception_8h_source.html#l00031">Throw</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l01138">lowsolve()</a>.</p>
<div class="fragment"><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;{</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; w : <a class="code" href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">m_solimport</a>) {</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    std::vector&lt; std::size_t &gt; gid;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    std::vector&lt; tk::real &gt; solution;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> r : w.second) {</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> it = <a class="code" href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">m_lowrhs</a>.find( r );</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <span class="keywordflow">if</span> (it != end(<a class="code" href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">m_lowrhs</a>)) {</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        gid.push_back( it-&gt;first );</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        solution.insert(end(solution), begin(it-&gt;second), end(it-&gt;second));</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <a class="code" href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a>( <span class="stringliteral">&quot;Can&#39;t find global row id &quot;</span> + std::to_string(r) +</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;               <span class="stringliteral">&quot; to export in low order solution vector&quot;</span> );</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    }</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <a class="code" href="classtk_1_1_solver.html#a123c1061f4552868a1e44a14e1e65f9f">m_worker</a>[ w.first ].updateLowSol( gid, solution );</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  }</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_a123c1061f4552868a1e44a14e1e65f9f"><div class="ttname"><a href="classtk_1_1_solver.html#a123c1061f4552868a1e44a14e1e65f9f">tk::Solver::m_worker</a></div><div class="ttdeci">inciter::CProxy_CG m_worker</div><div class="ttdoc">Worker proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00459">Solver.h:459</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a798bf7f5ab59aa65cfc00dfe0631ed7e"><div class="ttname"><a href="classtk_1_1_solver.html#a798bf7f5ab59aa65cfc00dfe0631ed7e">tk::Solver::m_lowrhs</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_lowrhs</div><div class="ttdoc">Part of low-order right-hand side vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00400">Solver.h:400</a></div></div>
<div class="ttc" id="_exception_8h_html_a0412f798470c18f503a2c2f63c970ba8"><div class="ttname"><a href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a></div><div class="ttdeci">#define Throw(...)</div><div class="ttdoc">Throw macro that always throws an exception. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00031">Exception.h:31</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae08497a429ae63351cebcbb73e8cdaa7"><div class="ttname"><a href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">tk::Solver::m_solimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_solimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00364">Solver.h:364</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4260f32744d54b5f8ea91fd492a456b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4260f32744d54b5f8ea91fd492a456b">&#9670;&nbsp;</a></span>updateSol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Solver::updateSol </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update solution vector in our PE's workers. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8_c_source.html#l01062">1062</a> of file <a class="el" href="_solver_8_c_source.html">Solver.C</a>.</p>

<p class="reference">References <a class="el" href="_container_util_8h_source.html#l00037">tk::cref_find()</a>, <a class="el" href="_hypre_vector_8h_source.html#l00056">tk::hypre::HypreVector::get()</a>, <a class="el" href="_solver_8h_source.html#l00420">m_hypreRows</a>, <a class="el" href="_solver_8h_source.html#l00430">m_hypreSol</a>, <a class="el" href="_solver_8h_source.html#l00432">m_lid</a>, <a class="el" href="_solver_8h_source.html#l00354">m_lower</a>, <a class="el" href="_solver_8h_source.html#l00350">m_ncomp</a>, <a class="el" href="_solver_8h_source.html#l00386">m_sol</a>, <a class="el" href="_solver_8h_source.html#l00364">m_solimport</a>, <a class="el" href="_solver_8h_source.html#l00355">m_upper</a>, <a class="el" href="_solver_8h_source.html#l00459">m_worker</a>, <a class="el" href="_solver_8h_source.html#l00414">m_x</a>, and <a class="el" href="_exception_8h_source.html#l00031">Throw</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l01099">solve()</a>.</p>
<div class="fragment"><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;{</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="comment">// Get solution vector values for our PE</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <a class="code" href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">m_x</a>.<a class="code" href="classtk_1_1hypre_1_1_hypre_vector.html#ac9d0c3a730133caf056d16be22a82865">get</a>( static_cast&lt; int &gt;( (<a class="code" href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">m_upper</a> - <a class="code" href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">m_lower</a>)*<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a> ),</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;           <a class="code" href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">m_hypreRows</a>.data(),</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;           <a class="code" href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">m_hypreSol</a>.data() );</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <span class="comment">// Group solution vector by workers and send each the parts back to workers</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="comment">// that own them</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; w : <a class="code" href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">m_solimport</a>) {</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    std::vector&lt; std::size_t &gt; gid;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    std::vector&lt; tk::real &gt; solution;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> r : w.second) {</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> it = <a class="code" href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">m_sol</a>.find( r );</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordflow">if</span> (it != end(<a class="code" href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">m_sol</a>)) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        gid.push_back( it-&gt;first );</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keyword">auto</span> i = <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>( <a class="code" href="classtk_1_1_solver.html#aeb5c5c77b2cddf8dd06a5d64477a2bd7">m_lid</a>, it-&gt;first );</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keyword">using</span> diff_type = <span class="keyword">typename</span> decltype(<a class="code" href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">m_hypreSol</a>)::difference_type;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <span class="keyword">auto</span> b = <span class="keyword">static_cast&lt;</span> diff_type <span class="keyword">&gt;</span>( i*<a class="code" href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">m_ncomp</a> );</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="keyword">auto</span> e = <span class="keyword">static_cast&lt;</span> diff_type <span class="keyword">&gt;</span>( (i+1)*m_ncomp );</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        solution.insert( end(solution),</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                         std::next( begin(<a class="code" href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">m_hypreSol</a>), b ),</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                         std::next( begin(<a class="code" href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">m_hypreSol</a>), e ) );</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <a class="code" href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a>( <span class="stringliteral">&quot;Can&#39;t find global row id &quot;</span> + std::to_string(r) +</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;               <span class="stringliteral">&quot; to export in solution vector&quot;</span> );</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    }</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <a class="code" href="classtk_1_1_solver.html#a123c1061f4552868a1e44a14e1e65f9f">m_worker</a>[ w.first ].updateSol( gid, solution );</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  }</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;}</div><div class="ttc" id="classtk_1_1_solver_html_aee8a7b9bf4f8c3c4c85f6c246a5817cb"><div class="ttname"><a href="classtk_1_1_solver.html#aee8a7b9bf4f8c3c4c85f6c246a5817cb">tk::Solver::m_x</a></div><div class="ttdeci">tk::hypre::HypreVector m_x</div><div class="ttdoc">Hypre vector to store the solution/unknowns. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00414">Solver.h:414</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a7f94d0cea62cb5114ad313d79a1664f0"><div class="ttname"><a href="classtk_1_1_solver.html#a7f94d0cea62cb5114ad313d79a1664f0">tk::Solver::m_sol</a></div><div class="ttdeci">std::map&lt; std::size_t, std::vector&lt; tk::real &gt; &gt; m_sol</div><div class="ttdoc">Part of unknown/solution vector owned by my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00386">Solver.h:386</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a123c1061f4552868a1e44a14e1e65f9f"><div class="ttname"><a href="classtk_1_1_solver.html#a123c1061f4552868a1e44a14e1e65f9f">tk::Solver::m_worker</a></div><div class="ttdeci">inciter::CProxy_CG m_worker</div><div class="ttdoc">Worker proxy. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00459">Solver.h:459</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a694b6eabfbceee8fd165a614b9992da4"><div class="ttname"><a href="classtk_1_1_solver.html#a694b6eabfbceee8fd165a614b9992da4">tk::Solver::m_ncomp</a></div><div class="ttdeci">std::size_t m_ncomp</div><div class="ttdoc">Number of scalar components per unknown. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00350">Solver.h:350</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ab9b1ac27e7fc5d0c36b30bad6d4aef06"><div class="ttname"><a href="classtk_1_1_solver.html#ab9b1ac27e7fc5d0c36b30bad6d4aef06">tk::Solver::m_lower</a></div><div class="ttdeci">std::size_t m_lower</div><div class="ttdoc">Lower index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00354">Solver.h:354</a></div></div>
<div class="ttc" id="classtk_1_1hypre_1_1_hypre_vector_html_ac9d0c3a730133caf056d16be22a82865"><div class="ttname"><a href="classtk_1_1hypre_1_1_hypre_vector.html#ac9d0c3a730133caf056d16be22a82865">tk::hypre::HypreVector::get</a></div><div class="ttdeci">void get(int nvalues, const int *indices, double *values)</div><div class="ttdoc">Get the local vector. </div><div class="ttdef"><b>Definition:</b> <a href="_hypre_vector_8h_source.html#l00056">HypreVector.h:56</a></div></div>
<div class="ttc" id="namespacetk_html_a2e002561a68875b091a264eb2a1e5f6c"><div class="ttname"><a href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a></div><div class="ttdeci">auto cref_find(const Container &amp;map, const typename Container::key_type &amp;key) -&gt; const typename Container::mapped_type &amp;</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00037">ContainerUtil.h:37</a></div></div>
<div class="ttc" id="_exception_8h_html_a0412f798470c18f503a2c2f63c970ba8"><div class="ttname"><a href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a></div><div class="ttdeci">#define Throw(...)</div><div class="ttdoc">Throw macro that always throws an exception. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00031">Exception.h:31</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_aeb5c5c77b2cddf8dd06a5d64477a2bd7"><div class="ttname"><a href="classtk_1_1_solver.html#aeb5c5c77b2cddf8dd06a5d64477a2bd7">tk::Solver::m_lid</a></div><div class="ttdeci">std::map&lt; std::size_t, std::size_t &gt; m_lid</div><div class="ttdoc">Global-&gt;local row id map for sending back solution vector parts. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00432">Solver.h:432</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_a2ec72eba8056ffe153131495383e8946"><div class="ttname"><a href="classtk_1_1_solver.html#a2ec72eba8056ffe153131495383e8946">tk::Solver::m_hypreRows</a></div><div class="ttdeci">std::vector&lt; int &gt; m_hypreRows</div><div class="ttdoc">Row indices for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00420">Solver.h:420</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ae08497a429ae63351cebcbb73e8cdaa7"><div class="ttname"><a href="classtk_1_1_solver.html#ae08497a429ae63351cebcbb73e8cdaa7">tk::Solver::m_solimport</a></div><div class="ttdeci">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; m_solimport</div><div class="ttdoc">Import map associating a list of global row ids to a worker chare id during the communication of the ...</div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00364">Solver.h:364</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_afb3da11c759216fb57e0dcf7b1803455"><div class="ttname"><a href="classtk_1_1_solver.html#afb3da11c759216fb57e0dcf7b1803455">tk::Solver::m_upper</a></div><div class="ttdeci">std::size_t m_upper</div><div class="ttdoc">Upper index of the global rows on my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00355">Solver.h:355</a></div></div>
<div class="ttc" id="classtk_1_1_solver_html_ad006a029a5dec2e2fbb234ec39ac0e79"><div class="ttname"><a href="classtk_1_1_solver.html#ad006a029a5dec2e2fbb234ec39ac0e79">tk::Solver::m_hypreSol</a></div><div class="ttdeci">std::vector&lt; tk::real &gt; m_hypreSol</div><div class="ttdoc">Solution vector nonzero values for my PE. </div><div class="ttdef"><b>Definition:</b> <a href="_solver_8h_source.html#l00430">Solver.h:430</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classtk_1_1_solver_ac4260f32744d54b5f8ea91fd492a456b_cgraph.svg" width="403" height="84"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aaaa8b3117a8a96197d39b8a5e7eaae66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaa8b3117a8a96197d39b8a5e7eaae66">&#9670;&nbsp;</a></span>m_A</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtk_1_1hypre_1_1_hypre_matrix.html">tk::hypre::HypreMatrix</a> tk::Solver::m_A</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Hypre matrix to store the left-hand side. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00415">415</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00136">bounds()</a>, <a class="el" href="_solver_8_c_source.html#l01024">lhs()</a>, and <a class="el" href="_solver_8_c_source.html#l01099">solve()</a>.</p>

</div>
</div>
<a id="ac698c274af8e024cd88cdd3243a6140e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac698c274af8e024cd88cdd3243a6140e">&#9670;&nbsp;</a></span>m_b</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtk_1_1hypre_1_1_hypre_vector.html">tk::hypre::HypreVector</a> tk::Solver::m_b</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Hypre vector to store the right-hand side </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00416">416</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00136">bounds()</a>, <a class="el" href="_solver_8_c_source.html#l01044">rhs()</a>, and <a class="el" href="_solver_8_c_source.html#l01099">solve()</a>.</p>

</div>
</div>
<a id="a15cb29c1ed768f5e288c4c1cc1dbfe3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15cb29c1ed768f5e288c4c1cc1dbfe3c">&#9670;&nbsp;</a></span>m_bc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; tk::Solver::m_bc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Values (for each scalar equation solved) of Dirichlet boundary conditions assigned to global node IDs we set. </p>
<p>The map key is the global mesh node/row ID, the value is a vector of pairs in which the bool (.first) indicates whether the boundary condition value (.second) is set at the given node. The size of the vectors is the number of PDEs integrated times the number of scalar components in all PDEs. This BC map stores all row IDs at which Dirichlet boundary conditions are prescribed, i.e., including boundary conditions set across all PEs, not just the ones need to be set on this PE. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00454">454</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00655">addbc()</a>, <a class="el" href="_solver_8_c_source.html#l00623">charebc()</a>, <a class="el" href="_solver_8_c_source.html#l00804">lhsbc()</a>, <a class="el" href="_solver_8_c_source.html#l01138">lowsolve()</a>, <a class="el" href="_solver_8_c_source.html#l00171">next()</a>, and <a class="el" href="_solver_8_c_source.html#l00906">rhsbc()</a>.</p>

</div>
</div>
<a id="acee52a58249f1160f1c705d9b6e29ddf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acee52a58249f1160f1c705d9b6e29ddf">&#9670;&nbsp;</a></span>m_bca</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt;<a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>&gt; &gt; &gt; tk::Solver::m_bca</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Matrix non-zero coefficients for Dirichlet boundary conditions. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00457">457</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

</div>
</div>
<a id="a093deef03f663d258ae53716c60eb77b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a093deef03f663d258ae53716c60eb77b">&#9670;&nbsp;</a></span>m_cb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtk_1_1tuple_1_1tagged__tuple.html">tk::tuple::tagged_tuple</a>&lt; <a class="el" href="structtag_1_1com.html">tag::com</a>, CkCallback , <a class="el" href="structtag_1_1coord.html">tag::coord</a>, CkCallback , <a class="el" href="structtag_1_1diag.html">tag::diag</a>, CkCallback &gt; tk::Solver::m_cb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Charm++ reduction callbacks associated to compile-time tags. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00347">347</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00217">charecom()</a>, <a class="el" href="_solver_8_c_source.html#l00282">created()</a>, <a class="el" href="_solver_8_c_source.html#l01231">diagnostics()</a>, and <a class="el" href="_solver_8_c_source.html#l00272">recrow()</a>.</p>

</div>
</div>
<a id="aeb7e186805440317cd4368ee3a15eef0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb7e186805440317cd4368ee3a15eef0">&#9670;&nbsp;</a></span>m_diag</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; std::size_t, std::vector&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; tk::Solver::m_diag</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Part of solution vector owned by my PE. </p>
<p>Vector of values (for each scalar equation solved) associated to global mesh point row IDs. The map-value is a pair of vectors, where the first one is the numerical and the second one is the analytical solution. If the analytical solution for a PDE is not defined, it is the initial condition. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="classtk_1_1_solver.html#a79a081933d00a3e29ef1edae2b39858d" title="Chares contribute their numerical and analytical solutions nonzero values for computing diagnostics...">charediag()</a>, <a class="el" href="classtk_1_1_solver.html#a9b7772900d005ff050b53d9d367c1ba6" title="Receive numerical and analytical solution vector nonzeros from fellow group branches for computing di...">adddiag()</a>, e.g., <a class="el" href="classinciter_1_1_c_g.html#aa53070cee37d3f2ce5d194aaa73100bd" title="Compute diagnostics, e.g., residuals. ">inciter::CG::diagnostics()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00413">413</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l01231">diagnostics()</a>, <a class="el" href="_solver_8_c_source.html#l00171">next()</a>, and <a class="el" href="_solver_8_c_source.html#l01198">updateDiag()</a>.</p>

</div>
</div>
<a id="a5075ce717bdb9d6dfd18d1b124f542d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5075ce717bdb9d6dfd18d1b124f542d0">&#9670;&nbsp;</a></span>m_diagimport</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; tk::Solver::m_diagimport</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Import map associating a list of global row ids to a worker chare id during the communication of the solution/unknown vector for computing diagnostics, e.g., residuals. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00380">380</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00713">adddiag()</a>, <a class="el" href="_solver_8_c_source.html#l00669">charediag()</a>, and <a class="el" href="_solver_8_c_source.html#l00171">next()</a>.</p>

</div>
</div>
<a id="ae05ada0e47dc55cf2f7597813a112bb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae05ada0e47dc55cf2f7597813a112bb8">&#9670;&nbsp;</a></span>m_div</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; std::pair&lt; std::size_t, std::size_t &gt;, int &gt; tk::Solver::m_div</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>PEs associated to lower and upper global row indices. </p>
<p>These are the divisions at which the linear system is divided along PE boundaries. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00436">436</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00136">bounds()</a>, and <a class="el" href="_solver_8_c_source.html#l00735">pe()</a>.</p>

</div>
</div>
<a id="a131b3e1a92fb6922fa01202d01f63da5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a131b3e1a92fb6922fa01202d01f63da5">&#9670;&nbsp;</a></span>m_hypreCols</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; tk::Solver::m_hypreCols</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Matrix column indices for rows on my PE. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00424">424</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00965">hyprelhs()</a>, and <a class="el" href="_solver_8_c_source.html#l01024">lhs()</a>.</p>

</div>
</div>
<a id="a463ecb7a4fe179cf728b681fd568d325"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a463ecb7a4fe179cf728b681fd568d325">&#9670;&nbsp;</a></span>m_hypreMat</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; tk::Solver::m_hypreMat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Matrix nonzero values for my PE. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00426">426</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00965">hyprelhs()</a>, and <a class="el" href="_solver_8_c_source.html#l01024">lhs()</a>.</p>

</div>
</div>
<a id="aeaa19ea4a831054772289e836be73208"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaa19ea4a831054772289e836be73208">&#9670;&nbsp;</a></span>m_hypreNcols</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; tk::Solver::m_hypreNcols</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of matrix columns/rows on my PE. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00422">422</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00965">hyprelhs()</a>, and <a class="el" href="_solver_8_c_source.html#l01024">lhs()</a>.</p>

</div>
</div>
<a id="aa91c68e53e18f58cdc2ff5db1ea9477b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa91c68e53e18f58cdc2ff5db1ea9477b">&#9670;&nbsp;</a></span>m_hypreRhs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; tk::Solver::m_hypreRhs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>RHS vector nonzero values for my PE. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00428">428</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00989">hyprerhs()</a>, <a class="el" href="_solver_8_c_source.html#l00171">next()</a>, and <a class="el" href="_solver_8_c_source.html#l01044">rhs()</a>.</p>

</div>
</div>
<a id="a2ec72eba8056ffe153131495383e8946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ec72eba8056ffe153131495383e8946">&#9670;&nbsp;</a></span>m_hypreRows</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; tk::Solver::m_hypreRows</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Row indices for my PE. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00420">420</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00785">hyprerow()</a>, <a class="el" href="_solver_8_c_source.html#l01024">lhs()</a>, <a class="el" href="_solver_8_c_source.html#l01044">rhs()</a>, <a class="el" href="_solver_8_c_source.html#l01005">sol()</a>, and <a class="el" href="_solver_8_c_source.html#l01062">updateSol()</a>.</p>

</div>
</div>
<a id="ad006a029a5dec2e2fbb234ec39ac0e79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad006a029a5dec2e2fbb234ec39ac0e79">&#9670;&nbsp;</a></span>m_hypreSol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; tk::Solver::m_hypreSol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solution vector nonzero values for my PE. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00430">430</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00945">hypresol()</a>, <a class="el" href="_solver_8_c_source.html#l01005">sol()</a>, and <a class="el" href="_solver_8_c_source.html#l01062">updateSol()</a>.</p>

</div>
</div>
<a id="a89057b993f4b676ce381d22f580b1122"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89057b993f4b676ce381d22f580b1122">&#9670;&nbsp;</a></span>m_lhs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; std::size_t, std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; tk::Solver::m_lhs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Part of left-hand side matrix owned by my PE. </p>
<p>Nonzero values (for each scalar equation solved) associated to global mesh point row and column IDs. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00391">391</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00405">addlhs()</a>, <a class="el" href="_solver_8_c_source.html#l00347">charelhs()</a>, <a class="el" href="_solver_8_c_source.html#l00965">hyprelhs()</a>, and <a class="el" href="_solver_8_c_source.html#l00804">lhsbc()</a>.</p>

</div>
</div>
<a id="a7fb039115d7990655180a208b2db100e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fb039115d7990655180a208b2db100e">&#9670;&nbsp;</a></span>m_lhsimport</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; tk::Solver::m_lhsimport</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Import map associating a list of global row ids to a worker chare id during the communication of the left-hand side matrix. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00367">367</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00405">addlhs()</a>, and <a class="el" href="_solver_8_c_source.html#l00347">charelhs()</a>.</p>

</div>
</div>
<a id="aeb5c5c77b2cddf8dd06a5d64477a2bd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb5c5c77b2cddf8dd06a5d64477a2bd7">&#9670;&nbsp;</a></span>m_lid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; std::size_t, std::size_t &gt; tk::Solver::m_lid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Global-&gt;local row id map for sending back solution vector parts. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00432">432</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00945">hypresol()</a>, and <a class="el" href="_solver_8_c_source.html#l01062">updateSol()</a>.</p>

</div>
</div>
<a id="ab9b1ac27e7fc5d0c36b30bad6d4aef06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9b1ac27e7fc5d0c36b30bad6d4aef06">&#9670;&nbsp;</a></span>m_lower</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t tk::Solver::m_lower</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Lower index of the global rows on my PE. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00354">354</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00136">bounds()</a>, <a class="el" href="_solver_8_c_source.html#l00217">charecom()</a>, <a class="el" href="_solver_8_c_source.html#l00669">charediag()</a>, <a class="el" href="_solver_8_c_source.html#l00347">charelhs()</a>, <a class="el" href="_solver_8_c_source.html#l00538">charelowlhs()</a>, <a class="el" href="_solver_8_c_source.html#l00480">charelowrhs()</a>, <a class="el" href="_solver_8_c_source.html#l00426">charerhs()</a>, <a class="el" href="_solver_8_c_source.html#l00291">charesol()</a>, <a class="el" href="_solver_8_c_source.html#l00596">comfinal()</a>, <a class="el" href="_solver_8_c_source.html#l01231">diagnostics()</a>, <a class="el" href="_solver_8_c_source.html#l01024">lhs()</a>, <a class="el" href="_solver_8_c_source.html#l00804">lhsbc()</a>, <a class="el" href="_solver_8_c_source.html#l01138">lowsolve()</a>, <a class="el" href="_solver_8_c_source.html#l01044">rhs()</a>, <a class="el" href="_solver_8_c_source.html#l00906">rhsbc()</a>, <a class="el" href="_solver_8_c_source.html#l01005">sol()</a>, and <a class="el" href="_solver_8_c_source.html#l01062">updateSol()</a>.</p>

</div>
</div>
<a id="af0c77bd852425a6506ffee14ffbddba2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0c77bd852425a6506ffee14ffbddba2">&#9670;&nbsp;</a></span>m_lowlhs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; tk::Solver::m_lowlhs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Part of the low-order system left-hand side vector owned by my PE. </p>
<p>Vector of values (for each scalar equation solved) associated to global mesh point row ids. This vector collects the nonzero values of the low-order system lhs "matrix" solution. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00405">405</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00575">addlowlhs()</a>, <a class="el" href="_solver_8_c_source.html#l00538">charelowlhs()</a>, and <a class="el" href="_solver_8_c_source.html#l01138">lowsolve()</a>.</p>

</div>
</div>
<a id="a0e65b31fc4d20bebd4f8fa9d12f4f11e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e65b31fc4d20bebd4f8fa9d12f4f11e">&#9670;&nbsp;</a></span>m_lowlhsimport</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; tk::Solver::m_lowlhsimport</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Import map associating a list of global row ids to a worker chare id during the communication of the low-order lhs vector. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00376">376</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00575">addlowlhs()</a>, and <a class="el" href="_solver_8_c_source.html#l00538">charelowlhs()</a>.</p>

</div>
</div>
<a id="a798bf7f5ab59aa65cfc00dfe0631ed7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a798bf7f5ab59aa65cfc00dfe0631ed7e">&#9670;&nbsp;</a></span>m_lowrhs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; tk::Solver::m_lowrhs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Part of low-order right-hand side vector owned by my PE. </p>
<p>Vector of values (for each scalar equation solved) associated to global mesh point row ids. This vector collects the rhs terms to be combined with the rhs to produce the low-order rhs. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00400">400</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00517">addlowrhs()</a>, <a class="el" href="_solver_8_c_source.html#l00480">charelowrhs()</a>, <a class="el" href="_solver_8_c_source.html#l01138">lowsolve()</a>, <a class="el" href="_solver_8_c_source.html#l00171">next()</a>, and <a class="el" href="_solver_8_c_source.html#l01114">updateLowSol()</a>.</p>

</div>
</div>
<a id="a785b937d0f47b18b3f5a7dd41fb2a5b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a785b937d0f47b18b3f5a7dd41fb2a5b4">&#9670;&nbsp;</a></span>m_lowrhsimport</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; tk::Solver::m_lowrhsimport</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Import map associating a list of global row ids to a worker chare id during the communication of the low-order rhs vector. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00373">373</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00517">addlowrhs()</a>, <a class="el" href="_solver_8_c_source.html#l00480">charelowrhs()</a>, and <a class="el" href="_solver_8_c_source.html#l00171">next()</a>.</p>

</div>
</div>
<a id="a311ab085fcb1950dcdbfdac6c978a1ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a311ab085fcb1950dcdbfdac6c978a1ad">&#9670;&nbsp;</a></span>m_myworker</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; tk::Solver::m_myworker</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ids of workers on my PE. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00358">358</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00217">charecom()</a>, <a class="el" href="_solver_8_c_source.html#l00762">comcomplete()</a>, <a class="el" href="_solver_8_c_source.html#l00596">comfinal()</a>, and <a class="el" href="_solver_8_c_source.html#l00171">next()</a>.</p>

</div>
</div>
<a id="aa0917fe1c723d52a9729c321a18c76e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0917fe1c723d52a9729c321a18c76e4">&#9670;&nbsp;</a></span>m_nchare</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t tk::Solver::m_nchare</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of chares contributing to my PE. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00351">351</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00623">charebc()</a>, <a class="el" href="_solver_8_c_source.html#l00762">comcomplete()</a>, <a class="el" href="_solver_8_c_source.html#l00596">comfinal()</a>, and <a class="el" href="_solver_8_c_source.html#l00202">nchare()</a>.</p>

</div>
</div>
<a id="acd9d7306f5a5e0a30709c61c9e6f4bcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd9d7306f5a5e0a30709c61c9e6f4bcb">&#9670;&nbsp;</a></span>m_nchbc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t tk::Solver::m_nchbc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of chares we received bcs from. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00353">353</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00655">addbc()</a>, and <a class="el" href="_solver_8_c_source.html#l00623">charebc()</a>.</p>

</div>
</div>
<a id="a694b6eabfbceee8fd165a614b9992da4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a694b6eabfbceee8fd165a614b9992da4">&#9670;&nbsp;</a></span>m_ncomp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t tk::Solver::m_ncomp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of scalar components per unknown. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00350">350</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00136">bounds()</a>, <a class="el" href="_solver_8_c_source.html#l00623">charebc()</a>, <a class="el" href="_solver_8_c_source.html#l01231">diagnostics()</a>, <a class="el" href="_solver_8_c_source.html#l00965">hyprelhs()</a>, <a class="el" href="_solver_8_c_source.html#l00785">hyprerow()</a>, <a class="el" href="_solver_8_c_source.html#l01024">lhs()</a>, <a class="el" href="_solver_8_c_source.html#l00804">lhsbc()</a>, <a class="el" href="_solver_8_c_source.html#l01138">lowsolve()</a>, <a class="el" href="_solver_8_c_source.html#l01044">rhs()</a>, <a class="el" href="_solver_8_c_source.html#l00906">rhsbc()</a>, <a class="el" href="_solver_8_c_source.html#l01005">sol()</a>, <a class="el" href="_solver_8_c_source.html#l01198">updateDiag()</a>, and <a class="el" href="_solver_8_c_source.html#l01062">updateSol()</a>.</p>

</div>
</div>
<a id="a4e3671da52361509cca6781a7aab834c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e3671da52361509cca6781a7aab834c">&#9670;&nbsp;</a></span>m_nperow</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t tk::Solver::m_nperow</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of fellow PEs to send row ids to. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00352">352</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00217">charecom()</a>, <a class="el" href="_solver_8_c_source.html#l00762">comcomplete()</a>, <a class="el" href="_solver_8_c_source.html#l00596">comfinal()</a>, and <a class="el" href="_solver_8_c_source.html#l00272">recrow()</a>.</p>

</div>
</div>
<a id="aa7c5cb2402a3aa4b4f411a9f516c5ceb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7c5cb2402a3aa4b4f411a9f516c5ceb">&#9670;&nbsp;</a></span>m_pe</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; std::size_t, int &gt; tk::Solver::m_pe</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>PEs associated to global mesh point indices. </p>
<p>This is used to cache the PE associated to mesh nodes communicated, so that a quicker-than-linear-cost search can be used to find the PE for a communicated mesh node after the node is in the cache. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00442">442</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00735">pe()</a>.</p>

</div>
</div>
<a id="a5e9b584b84dbca204b2c55322a487d85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e9b584b84dbca204b2c55322a487d85">&#9670;&nbsp;</a></span>m_rhs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; tk::Solver::m_rhs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Part of right-hand side vector owned by my PE. </p>
<p>Vector of values (for each scalar equation solved) associated to global mesh point row ids </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00395">395</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00461">addrhs()</a>, <a class="el" href="_solver_8_c_source.html#l00426">charerhs()</a>, <a class="el" href="_solver_8_c_source.html#l00989">hyprerhs()</a>, <a class="el" href="_solver_8_c_source.html#l01138">lowsolve()</a>, <a class="el" href="_solver_8_c_source.html#l00171">next()</a>, and <a class="el" href="_solver_8_c_source.html#l00906">rhsbc()</a>.</p>

</div>
</div>
<a id="a989650135b8066b1d562bef134e6c74e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a989650135b8066b1d562bef134e6c74e">&#9670;&nbsp;</a></span>m_rhsimport</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; tk::Solver::m_rhsimport</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Import map associating a list of global row ids to a worker chare id during the communication of the righ-hand side vector. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00370">370</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00461">addrhs()</a>, <a class="el" href="_solver_8_c_source.html#l00426">charerhs()</a>, and <a class="el" href="_solver_8_c_source.html#l00171">next()</a>.</p>

</div>
</div>
<a id="ababfdb48bb065b69d1222582c61db6e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ababfdb48bb065b69d1222582c61db6e1">&#9670;&nbsp;</a></span>m_row</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt; std::size_t &gt; tk::Solver::m_row</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Part of global row indices owned by my PE. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00382">382</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00256">addrow()</a>, <a class="el" href="_solver_8_c_source.html#l00217">charecom()</a>, <a class="el" href="_solver_8_c_source.html#l00596">comfinal()</a>, and <a class="el" href="_solver_8_c_source.html#l00785">hyprerow()</a>.</p>

</div>
</div>
<a id="afff71961577fa755ed96de7b3ed938cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afff71961577fa755ed96de7b3ed938cb">&#9670;&nbsp;</a></span>m_rowimport</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; tk::Solver::m_rowimport</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Import map associating a list of global row ids to a worker chare id during the communication of the global row ids. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00361">361</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00256">addrow()</a>, and <a class="el" href="_solver_8_c_source.html#l00217">charecom()</a>.</p>

</div>
</div>
<a id="ae670c687250b64158b4adec9e1b9cb0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae670c687250b64158b4adec9e1b9cb0f">&#9670;&nbsp;</a></span>m_shadow</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CProxy_SolverShadow tk::Solver::m_shadow</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00341">341</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00623">charebc()</a>.</p>

</div>
</div>
<a id="a8c65ab8493c82ad5359d11e9e07b35c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c65ab8493c82ad5359d11e9e07b35c4">&#9670;&nbsp;</a></span>m_side</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; tk::Solver::m_side</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Global (as in file) mesh node IDs mapped to side set ids of the mesh. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00349">349</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

</div>
</div>
<a id="a7f94d0cea62cb5114ad313d79a1664f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f94d0cea62cb5114ad313d79a1664f0">&#9670;&nbsp;</a></span>m_sol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; std::size_t, std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; tk::Solver::m_sol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Part of unknown/solution vector owned by my PE. </p>
<p>Vector of values (for each scalar equation solved) associated to global mesh point row IDs </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00386">386</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00328">addsol()</a>, <a class="el" href="_solver_8_c_source.html#l00291">charesol()</a>, <a class="el" href="_solver_8_c_source.html#l00945">hypresol()</a>, and <a class="el" href="_solver_8_c_source.html#l01062">updateSol()</a>.</p>

</div>
</div>
<a id="ae08497a429ae63351cebcbb73e8cdaa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae08497a429ae63351cebcbb73e8cdaa7">&#9670;&nbsp;</a></span>m_solimport</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; int, std::vector&lt; std::size_t &gt; &gt; tk::Solver::m_solimport</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Import map associating a list of global row ids to a worker chare id during the communication of the solution/unknown vector. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00364">364</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00328">addsol()</a>, <a class="el" href="_solver_8_c_source.html#l00291">charesol()</a>, <a class="el" href="_solver_8_c_source.html#l01114">updateLowSol()</a>, and <a class="el" href="_solver_8_c_source.html#l01062">updateSol()</a>.</p>

</div>
</div>
<a id="a8b9162f97c74ba4c2101da82cd00ae95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b9162f97c74ba4c2101da82cd00ae95">&#9670;&nbsp;</a></span>m_solver</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtk_1_1hypre_1_1_hypre_solver.html">tk::hypre::HypreSolver</a> tk::Solver::m_solver</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Hypre solver. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00418">418</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00136">bounds()</a>, and <a class="el" href="_solver_8_c_source.html#l01099">solve()</a>.</p>

</div>
</div>
<a id="afb3da11c759216fb57e0dcf7b1803455"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb3da11c759216fb57e0dcf7b1803455">&#9670;&nbsp;</a></span>m_upper</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t tk::Solver::m_upper</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Upper index of the global rows on my PE. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00355">355</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00136">bounds()</a>, <a class="el" href="_solver_8_c_source.html#l00217">charecom()</a>, <a class="el" href="_solver_8_c_source.html#l00669">charediag()</a>, <a class="el" href="_solver_8_c_source.html#l00347">charelhs()</a>, <a class="el" href="_solver_8_c_source.html#l00538">charelowlhs()</a>, <a class="el" href="_solver_8_c_source.html#l00480">charelowrhs()</a>, <a class="el" href="_solver_8_c_source.html#l00426">charerhs()</a>, <a class="el" href="_solver_8_c_source.html#l00291">charesol()</a>, <a class="el" href="_solver_8_c_source.html#l00596">comfinal()</a>, <a class="el" href="_solver_8_c_source.html#l01231">diagnostics()</a>, <a class="el" href="_solver_8_c_source.html#l01024">lhs()</a>, <a class="el" href="_solver_8_c_source.html#l00804">lhsbc()</a>, <a class="el" href="_solver_8_c_source.html#l01138">lowsolve()</a>, <a class="el" href="_solver_8_c_source.html#l01044">rhs()</a>, <a class="el" href="_solver_8_c_source.html#l00906">rhsbc()</a>, <a class="el" href="_solver_8_c_source.html#l01005">sol()</a>, and <a class="el" href="_solver_8_c_source.html#l01062">updateSol()</a>.</p>

</div>
</div>
<a id="a123c1061f4552868a1e44a14e1e65f9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a123c1061f4552868a1e44a14e1e65f9f">&#9670;&nbsp;</a></span>m_worker</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">inciter::CProxy_CG tk::Solver::m_worker</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Worker proxy. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00459">459</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00217">charecom()</a>, <a class="el" href="_solver_8_c_source.html#l00171">next()</a>, <a class="el" href="_solver_8_c_source.html#l01114">updateLowSol()</a>, and <a class="el" href="_solver_8_c_source.html#l01062">updateSol()</a>.</p>

</div>
</div>
<a id="aee8a7b9bf4f8c3c4c85f6c246a5817cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee8a7b9bf4f8c3c4c85f6c246a5817cb">&#9670;&nbsp;</a></span>m_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtk_1_1hypre_1_1_hypre_vector.html">tk::hypre::HypreVector</a> tk::Solver::m_x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Hypre vector to store the solution/unknowns. </p>

<p class="definition">Definition at line <a class="el" href="_solver_8h_source.html#l00414">414</a> of file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_solver_8_c_source.html#l00136">bounds()</a>, <a class="el" href="_solver_8_c_source.html#l01005">sol()</a>, <a class="el" href="_solver_8_c_source.html#l01099">solve()</a>, and <a class="el" href="_solver_8_c_source.html#l01062">updateSol()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/tmp/TeamCity-14/work/821a9fd6f64749d9/src/LinSys/<a class="el" href="_solver_8h_source.html">Solver.h</a></li>
<li>/tmp/TeamCity-14/work/821a9fd6f64749d9/src/LinSys/<a class="el" href="_solver_8_c_source.html">Solver.C</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Nov 22 2017 07:57:53 for Quinoa by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
