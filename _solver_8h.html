<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quinoa: /tmp/TeamCity-14/work/821a9fd6f64749d9/src/LinSys/Solver.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quinoa.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_3ca9c9eb36ab3ecb75ba69910724f6da.html">LinSys</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<div class="title">Solver.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Charm++ chare linear system merger group to solve a linear system.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;vector&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &lt;unordered_map&gt;</code><br />
<code>#include &quot;Types.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_tags_8h_source.html">Tags.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_fields_8h_source.html">Fields.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_tagged_tuple_8h_source.html">TaggedTuple.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_hypre_matrix_8h_source.html">HypreMatrix.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_hypre_vector_8h_source.html">HypreVector.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_hypre_solver_8h_source.html">HypreSolver.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="solver_8decl_8h_source.html">NoWarning/solver.decl.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cg_8decl_8h_source.html">NoWarning/cg.decl.h</a>&quot;</code><br />
</div>
<p><a href="_solver_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver_shadow.html">tk::SolverShadow</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtk_1_1_solver.html">tk::Solver</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacetk"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetk.html">tk</a></td></tr>
<tr class="memdesc:namespacetk"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toolkit declarations and definitions for general purpose utilities. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Charm++ chare linear system merger group to solve a linear system. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>2012-2015, J. Bakosi, 2016-2017, Los Alamos National Security, LLC.</dd></dl>
<p>Charm++ chare linear system merger group used to collect and assemble the left hand side matrix (lhs), the right hand side (rhs) vector, and the solution (unknown) vector from individual worker chares. Beside collection and assembly, the system is also solved. The solution is outsourced to hypre, an MPI-only library. Once the solution is available, the individual worker chares are updated with the new solution.</p>
<p>This class assembles and solves two linear systems, whose rhs vectors may change during time stepping. One of the two linear systems is called a high-order and the other one is the low-order linear system.</p>
<p>Characteristics of the low-order linear system: (1) the left hand side matrix is diagonal, (2) the right hand side vector is a combination of the high-order right hand side vector and another vector, assembled separately (and overlapped with that of the high-order system). This dual system solution is done here as required by the flux-corrected transport algorithm used for transport equations in inciter.</p>
<p>The implementation uses the Charm++ runtime system and is fully asynchronous, overlapping computation and communication. The algorithm utilizes the structured dagger (SDAG) Charm++ functionality. The high-level overview of the algorithm structure and how it interfaces with Charm++ is discussed in the Charm++ interface file <a class="el" href="solver_8ci.html">src/LinSys/solver.ci</a>.</p>
<h4>Call graph</h4>
<p>The following is a directed acyclic graph (DAG) that outlines the asynchronous algorithm implemented in this class The detailed discussion of the algorithm is given in the Charm++ interface file <a class="el" href="solver_8ci.html">solver.ci</a>. On the DAG orange fills denote global synchronization points that contain or eventually lead to global reductions. Dashed lines are potential shortcuts that allow jumping over some of the task-graph under some circumstances or optional code paths (taken, e.g., only in DEBUG mode). See the detailed discussion in <a class="el" href="solver_8ci.html">solver.ci</a>. </p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_inline_dotgraph_6.svg" width="1411" height="422"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
 <div class="fragment"><div class="line">// *****************************************************************************</div><div class="line">/*!</div><div class="line">  \file      src/LinSys/solver.ci</div><div class="line">  \copyright 2012-2015, J. Bakosi, 2016-2017, Los Alamos National Security, LLC.</div><div class="line">  \brief     Charm++ module interface file for merging a linear system</div><div class="line">  \details   Charm++ module interface file for merging a linear system. See more</div><div class="line">     in src/LinSys/Solver.h.</div><div class="line">*/</div><div class="line">// *****************************************************************************</div><div class="line"></div><div class="line">module solver {</div><div class="line"></div><div class="line">  namespace tk {</div><div class="line"></div><div class="line">    group SolverShadow { entry SolverShadow(); };</div><div class="line"></div><div class="line">    group Solver {</div><div class="line">      entry Solver( CProxy_SolverShadow sh,</div><div class="line">                    const std::vector&lt; CkCallback &gt;&amp; cb,</div><div class="line">                    const std::map&lt; int,</div><div class="line">                      std::vector&lt; std::size_t &gt; &gt;&amp; side,</div><div class="line">                    std::size_t ncomp,</div><div class="line">                    bool feedback );</div><div class="line">      entry void nchare( int n );</div><div class="line">      initnode void registerReducers();</div><div class="line">      entry void bounds( int pe, std::size_t lower, std::size_t upper );</div><div class="line">      entry void next();</div><div class="line">      entry void addrow( int fromch,</div><div class="line">                         int frompe,</div><div class="line">                         const std::set&lt; std::size_t &gt;&amp; row );</div><div class="line">      entry void recrow();</div><div class="line">      entry [reductiontarget] void addbc( CkReductionMsg* msg );</div><div class="line">      entry void addsol( int fromch,</div><div class="line">                         const std::map&lt; std::size_t,</div><div class="line">                                         std::vector&lt; tk::real &gt; &gt;&amp; solution );</div><div class="line">      entry void addlhs( int fromch,</div><div class="line">        const std::map&lt; std::size_t,</div><div class="line">                        std::map&lt; std::size_t,</div><div class="line">                                  std::vector&lt; tk::real &gt; &gt; &gt;&amp; lhs );</div><div class="line">      entry void addrhs( int fromch,</div><div class="line">                         const std::map&lt; std::size_t,</div><div class="line">                                         std::vector&lt; tk::real &gt; &gt;&amp; rhs );</div><div class="line">      entry void addlowrhs( int fromch,</div><div class="line">                            const std::map&lt; std::size_t,</div><div class="line">                                            std::vector&lt; tk::real &gt; &gt;&amp; lorhs );</div><div class="line">      entry void addlowlhs( int fromch,</div><div class="line">                            const std::map&lt; std::size_t,</div><div class="line">                                            std::vector&lt; tk::real &gt; &gt;&amp; lolhs );</div><div class="line">      entry void adddiag( int fromch,</div><div class="line">                          std::map&lt; std::size_t,</div><div class="line">                           std::vector&lt; std::vector&lt; tk::real &gt; &gt; &gt;&amp; solution );</div><div class="line">      entry void comfinal();</div><div class="line"></div><div class="line">      // SDAG code follows. See http://charm.cs.illinois.edu/manuals/html/</div><div class="line">      // charm++/manual.html, Sec. &quot;Structured Control Flow: Structured Dagger&quot;.</div><div class="line"></div><div class="line">      // High-level overview of the dependency and asynchronous call structure</div><div class="line">      // ---------------------------------------------------------------------</div><div class="line">      //</div><div class="line">      // Directed Acyclic Graph (DAG):</div><div class="line">      // -----------------------------</div><div class="line">      //</div><div class="line">      // See src/LinSys/Solver.h.</div><div class="line">      //</div><div class="line">      // Interpretation of the DAG in src/LinSys/Solver.h</div><div class="line">      // ------------------------------------------------------</div><div class="line">      // Control flow is from left to right and top to bottom.</div><div class="line">      //</div><div class="line">      // A word on multiple invokation of SDAG triggers: As the commit message</div><div class="line">      // of b79ea29 explains, the &quot;triggers&quot;, such as hyprerow_complete(),</div><div class="line">      // enumerated below, at threir call site should be thought of as messages</div><div class="line">      // being put in some message queue and consumed at &#39;when&#39; clauses wherever</div><div class="line">      // they appear. If they appear in multiple when clauses, they consume</div><div class="line">      // multple messages, thus they have to be triggered multiple times. See</div><div class="line">      // https://lists.cs.illinois.edu/lists/arc/charm/2016-09/msg00002.html.</div><div class="line"></div><div class="line">      entry void wait4nchare() {</div><div class="line">        when nchare_complete(), bounds_complete() serial &quot;nchare&quot; {</div><div class="line">          contribute( m_cb.get&lt; tag::coord &gt;() ); } };</div><div class="line"></div><div class="line">      entry void wait4lhsbc() {</div><div class="line">        when lhs_complete(), bc_complete() serial &quot;lhsbc&quot; { lhsbc(); } };</div><div class="line">      entry void wait4rhsbc() {</div><div class="line">        when rhs_complete(), bc_complete() serial &quot;rhsbc&quot; { rhsbc(); } };</div><div class="line"></div><div class="line">      entry void wait4hypresol() {</div><div class="line">        when hypresol_complete(), hyprerow_complete() serial &quot;sol&quot; { sol(); } };</div><div class="line">      entry void wait4hyprelhs() {</div><div class="line">        when hyprelhs_complete(), hyprerow_complete() serial &quot;lhs&quot; { lhs(); } };</div><div class="line">      entry void wait4hyprerhs() {</div><div class="line">        when hyprerhs_complete(), hyprerow_complete() serial &quot;rhs&quot; { rhs(); } };</div><div class="line"></div><div class="line">      entry void wait4asm() {</div><div class="line">        when asmsol_complete(), asmlhs_complete(), asmrhs_complete()</div><div class="line">          serial &quot;solve&quot; { solve(); } };</div><div class="line">      entry void wait4low() {</div><div class="line">        when rhsbc_complete(), lowlhs_complete(), lowrhs_complete()</div><div class="line">          serial &quot;low&quot; { lowsolve(); } };</div><div class="line"></div><div class="line">      entry void nchare_complete();</div><div class="line">      entry void bounds_complete();</div><div class="line">      entry void bc_complete();</div><div class="line">      entry void rhsbc_complete();</div><div class="line">      entry void hyprerow_complete();</div><div class="line">      entry void lhs_complete();</div><div class="line">      entry void rhs_complete();</div><div class="line">      entry void lowrhs_complete();</div><div class="line">      entry void lowlhs_complete();</div><div class="line">      entry void hyprelhs_complete();</div><div class="line">      entry void hyprerhs_complete();</div><div class="line">      entry void hypresol_complete();</div><div class="line">      entry void asmlhs_complete();</div><div class="line">      entry void asmrhs_complete();</div><div class="line">      entry void asmsol_complete();</div><div class="line">    };</div><div class="line"></div><div class="line">  } // tk::</div><div class="line"></div><div class="line">}</div></div><!-- fragment --> 
<p class="definition">Definition in file <a class="el" href="_solver_8h_source.html">Solver.h</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jan 12 2018 09:41:08 for Quinoa by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
