<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quinoa: inciter::CompFlow&lt; Physics, Problem &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quinoa.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceinciter.html">inciter</a></li><li class="navelem"><a class="el" href="classinciter_1_1_comp_flow.html">CompFlow</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classinciter_1_1_comp_flow-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">inciter::CompFlow&lt; Physics, Problem &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classinciter_1_1_comp_flow.html" title="CompFlow used polymorphically with tk::PDE. ">CompFlow</a> used polymorphically with tk::PDE.  
 <a href="classinciter_1_1_comp_flow.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab2c20e4f8350bdfec9b1c8f59cff97ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_comp_flow.html#ab2c20e4f8350bdfec9b1c8f59cff97ee">CompFlow</a> (<a class="el" href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">ncomp_t</a>)</td></tr>
<tr class="memdesc:ab2c20e4f8350bdfec9b1c8f59cff97ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ab2c20e4f8350bdfec9b1c8f59cff97ee">More...</a><br /></td></tr>
<tr class="separator:ab2c20e4f8350bdfec9b1c8f59cff97ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa07b25a5284965407ae74f4fb79c188"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_comp_flow.html#aaa07b25a5284965407ae74f4fb79c188">initialize</a> (const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;coord, tk::Fields &amp;unk, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>, const std::vector&lt; std::size_t &gt; &amp;gid, const std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; &amp;bc) const</td></tr>
<tr class="separator:aaa07b25a5284965407ae74f4fb79c188"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c4f3473137fac53a5bb69414dfd6a30"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_comp_flow.html#a9c4f3473137fac53a5bb69414dfd6a30">lhs</a> (const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;coord, const std::vector&lt; std::size_t &gt; &amp;inpoel, const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;psup, tk::Fields &amp;lhsd, tk::Fields &amp;lhso) const</td></tr>
<tr class="separator:a9c4f3473137fac53a5bb69414dfd6a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87d2d9481ec589ffe077934b71e0032f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_comp_flow.html#a87d2d9481ec589ffe077934b71e0032f">rhs</a> (<a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> mult, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> deltat, const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;coord, const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::Fields &amp;U, tk::Fields &amp;R) const</td></tr>
<tr class="separator:a87d2d9481ec589ffe077934b71e0032f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaabdc8efbe83458388b787c5c54972e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_comp_flow.html#aaabdc8efbe83458388b787c5c54972e1">dt</a> (const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;coord, const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::Fields &amp;U) const</td></tr>
<tr class="separator:aaabdc8efbe83458388b787c5c54972e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a780eb2a9adb53e09684ee6a2d6d23466"><td class="memItemLeft" align="right" valign="top">std::array&lt; std::array&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>, 4 &gt;, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_comp_flow.html#a780eb2a9adb53e09684ee6a2d6d23466">velocity</a> (const tk::Fields &amp;U, const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;, const std::array&lt; std::size_t, 4 &gt; &amp;N) const</td></tr>
<tr class="separator:a780eb2a9adb53e09684ee6a2d6d23466"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac35129c821564a46323dffef310d954e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_comp_flow.html#ac35129c821564a46323dffef310d954e">side</a> (std::unordered_set&lt; int &gt; &amp;conf) const</td></tr>
<tr class="memdesc:ac35129c821564a46323dffef310d954e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query all side set IDs the user has configured for all components in this <a class="el" href="classinciter_1_1_p_d_e.html" title="Partial differential equation. ">PDE</a> system.  <a href="#ac35129c821564a46323dffef310d954e">More...</a><br /></td></tr>
<tr class="separator:ac35129c821564a46323dffef310d954e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2079ae67870eef9e79361863f82b8542"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::pair&lt; bool, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_comp_flow.html#a2079ae67870eef9e79361863f82b8542">dirbc</a> (int sideset) const</td></tr>
<tr class="memdesc:a2079ae67870eef9e79361863f82b8542"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query Dirichlet boundary condition value on a given side set for all components in this <a class="el" href="classinciter_1_1_p_d_e.html" title="Partial differential equation. ">PDE</a> system.  <a href="#a2079ae67870eef9e79361863f82b8542">More...</a><br /></td></tr>
<tr class="separator:a2079ae67870eef9e79361863f82b8542"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5886e1cd585272a26703544efdb759f0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_comp_flow.html#a5886e1cd585272a26703544efdb759f0">names</a> () const</td></tr>
<tr class="separator:a5886e1cd585272a26703544efdb759f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcaf7def7f2bb0ed0cca9bba9ae56ebf"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_comp_flow.html#afcaf7def7f2bb0ed0cca9bba9ae56ebf">output</a> (<a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> t, const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;coord, const tk::Fields &amp;U) const</td></tr>
<tr class="separator:afcaf7def7f2bb0ed0cca9bba9ae56ebf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a528e9e3726f84402865a6713f78b1169"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">ncomp_t</a> = kw::ncomp::info::expect::type</td></tr>
<tr class="separator:a528e9e3726f84402865a6713f78b1169"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a4c5e6b336f4e8ffe1cf3e1082ba6f3af"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">ncomp_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a></td></tr>
<tr class="memdesc:a4c5e6b336f4e8ffe1cf3e1082ba6f3af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Offset <a class="el" href="classinciter_1_1_p_d_e.html" title="Partial differential equation. ">PDE</a> operates from.  <a href="#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">More...</a><br /></td></tr>
<tr class="separator:a4c5e6b336f4e8ffe1cf3e1082ba6f3af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class Physics, class Problem&gt;<br />
class inciter::CompFlow&lt; Physics, Problem &gt;</h3>

<p><a class="el" href="classinciter_1_1_comp_flow.html" title="CompFlow used polymorphically with tk::PDE. ">CompFlow</a> used polymorphically with tk::PDE. </p>
<p>The template arguments specify policies and are used to configure the behavior of the class. The policies are:</p><ul>
<li>Physics - physics configuration, see <a class="el" href="_comp_flow_physics_8h.html" title="Physics configurations for the compressible flow equations. ">PDE/CompFlowPhysics.h</a></li>
<li>Problem - problem configuration, see <a class="el" href="_comp_flow_problem_8h.html" title="Problem configurations for the compressible flow equations. ">PDE/CompFlowProblem.h</a> <dl class="section note"><dt>Note</dt><dd>The default physics is Euler, set in inciter::deck::check_compflow() </dd></dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00036">36</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a528e9e3726f84402865a6713f78b1169"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a528e9e3726f84402865a6713f78b1169">&#9670;&nbsp;</a></span>ncomp_t</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Physics , class Problem &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classinciter_1_1_comp_flow.html">inciter::CompFlow</a>&lt; Physics, Problem &gt;::<a class="el" href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">ncomp_t</a> =  kw::ncomp::info::expect::type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00039">39</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab2c20e4f8350bdfec9b1c8f59cff97ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2c20e4f8350bdfec9b1c8f59cff97ee">&#9670;&nbsp;</a></span>CompFlow()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Physics , class Problem &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classinciter_1_1_comp_flow.html">inciter::CompFlow</a>&lt; Physics, Problem &gt;::<a class="el" href="classinciter_1_1_comp_flow.html">CompFlow</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">ncomp_t</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="section author"><dt>Author</dt><dd>J. Bakosi </dd></dl>

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00044">44</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;: <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a>( 0 ) {}</div><div class="ttc" id="classinciter_1_1_comp_flow_html_a4c5e6b336f4e8ffe1cf3e1082ba6f3af"><div class="ttname"><a href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">inciter::CompFlow::m_offset</a></div><div class="ttdeci">const ncomp_t m_offset</div><div class="ttdoc">Offset PDE operates from. </div><div class="ttdef"><b>Definition:</b> <a href="_comp_flow_8h_source.html#l00359">CompFlow.h:359</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2079ae67870eef9e79361863f82b8542"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2079ae67870eef9e79361863f82b8542">&#9670;&nbsp;</a></span>dirbc()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Physics , class Problem &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::pair&lt; bool, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; <a class="el" href="classinciter_1_1_comp_flow.html">inciter::CompFlow</a>&lt; Physics, Problem &gt;::dirbc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sideset</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Query Dirichlet boundary condition value on a given side set for all components in this <a class="el" href="classinciter_1_1_p_d_e.html" title="Partial differential equation. ">PDE</a> system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sideset</td><td>Side set ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of pairs of bool and BC value for all components </dd></dl>

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00343">343</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;{ <span class="keywordflow">return</span> Problem::dirbc( sideset ); }</div></div><!-- fragment -->
</div>
</div>
<a id="aaabdc8efbe83458388b787c5c54972e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaabdc8efbe83458388b787c5c54972e1">&#9670;&nbsp;</a></span>dt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Physics , class Problem &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> <a class="el" href="classinciter_1_1_comp_flow.html">inciter::CompFlow</a>&lt; Physics, Problem &gt;::dt </td>
          <td>(</td>
          <td class="paramtype">const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>U</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute the minimum time step size </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">U</td><td>Solution vector at recent time step stage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coord</td><td>Mesh node coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Minimum time step size </dd></dl>

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00255">255</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_comp_flow_8h_source.html#l00359">inciter::CompFlow&lt; Physics, Problem &gt;::m_offset</a>, <a class="el" href="_data_8h_source.html#l00581">tk::max()</a>, <a class="el" href="_data_8h_source.html#l00561">tk::min()</a>, and <a class="el" href="_base_2_vector_8h_source.html#l00067">tk::triple()</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( U.nunk() == coord[0].size(), <span class="stringliteral">&quot;Number of unknowns in solution &quot;</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;              <span class="stringliteral">&quot;vector at recent time step incorrect&quot;</span> );</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; x = coord[0];</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; y = coord[1];</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; z = coord[2];</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="comment">// ratio of specific heats</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keyword">auto</span> g = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1param.html">tag::param</a>, <a class="code" href="structtag_1_1compflow.html">tag::compflow</a>, <a class="code" href="structtag_1_1gamma.html">tag::gamma</a> &gt;()[0];</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="comment">// compute the minimum dt across all elements we own</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <a class="code" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> mindt = <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">std::numeric_limits&lt; tk::real &gt;::max</a>();</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                               inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">// compute cubic root of element volume as the characteristic length</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keyword">const</span> std::array&lt; tk::real, 3 &gt;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          ba{{ x[N[1]]-x[N[0]], y[N[1]]-y[N[0]], z[N[1]]-z[N[0]] }},</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          ca{{ x[N[2]]-x[N[0]], y[N[2]]-y[N[0]], z[N[2]]-z[N[0]] }},</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          da{{ x[N[3]]-x[N[0]], y[N[3]]-y[N[0]], z[N[3]]-z[N[0]] }};</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> L = std::cbrt( <a class="code" href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a>( ba, ca, da ) / 6.0 );</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">// access solution at element nodes at recent time step stage</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        std::array&lt; std::array&lt; tk::real, 4 &gt;, 5 &gt; u;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">ncomp_t</a> c=0; c&lt;5; ++c) u[c] = U.extract( c, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a>, N );</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="comment">// compute the maximum length of the characteristic velocity (fluid</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">// velocity + sound velocity) across the four element nodes</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <a class="code" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> maxvel = 0.0;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          <span class="keyword">auto</span>&amp; r  = u[0][j];    <span class="comment">// rho</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          <span class="keyword">auto</span>&amp; ru = u[1][j];    <span class="comment">// rho * u</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          <span class="keyword">auto</span>&amp; rv = u[2][j];    <span class="comment">// rho * v</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          <span class="keyword">auto</span>&amp; rw = u[3][j];    <span class="comment">// rho * w</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          <span class="keyword">auto</span>&amp; re = u[4][j];    <span class="comment">// rho * e</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          <span class="keyword">auto</span> p = (g-1.0)*(re - (ru*ru + rv*rv + rw*rw)/2.0/r); <span class="comment">// pressure</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          <span class="keyword">auto</span> c = std::sqrt(g*p/r);     <span class="comment">// sound speed</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;          <span class="keyword">auto</span> v = std::sqrt((ru*ru + rv*rv + rw*rw)/r) + c; <span class="comment">// char. velocity</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <span class="keywordflow">if</span> (v &gt; maxvel) maxvel = v;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">// compute element dt for the Euler equations</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keyword">auto</span> euler_dt = L / maxvel;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">// compute element dt based on the viscous force</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keyword">auto</span> viscous_dt = Physics::viscous_dt( L, u );</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="comment">// compute element dt based on thermal diffusion</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keyword">auto</span> heat_diffusion_dt = Physics::heat_diffusion_dt( L, u );</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">// compute minimum element dt</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keyword">auto</span> elemdt = <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>( euler_dt,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                        <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>( viscous_dt, heat_diffusion_dt ) );</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">// find minimum dt across all elements</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">if</span> (elemdt &lt; mindt) mindt = elemdt;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">return</span> mindt;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div><div class="ttc" id="namespacetk_html_afd730d099e698f124362ef8c01483e0f"><div class="ttname"><a href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">tk::min</a></div><div class="ttdeci">Data&lt; Layout &gt; min(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00561">Data.h:561</a></div></div>
<div class="ttc" id="classinciter_1_1_comp_flow_html_a528e9e3726f84402865a6713f78b1169"><div class="ttname"><a href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">inciter::CompFlow::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_comp_flow_8h_source.html#l00039">CompFlow.h:39</a></div></div>
<div class="ttc" id="structtag_1_1compflow_html"><div class="ttname"><a href="structtag_1_1compflow.html">tag::compflow</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00143">Tags.h:143</a></div></div>
<div class="ttc" id="structtag_1_1param_html"><div class="ttname"><a href="structtag_1_1param.html">tag::param</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00126">Tags.h:126</a></div></div>
<div class="ttc" id="classinciter_1_1_comp_flow_html_a4c5e6b336f4e8ffe1cf3e1082ba6f3af"><div class="ttname"><a href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">inciter::CompFlow::m_offset</a></div><div class="ttdeci">const ncomp_t m_offset</div><div class="ttdoc">Offset PDE operates from. </div><div class="ttdef"><b>Definition:</b> <a href="_comp_flow_8h_source.html#l00359">CompFlow.h:359</a></div></div>
<div class="ttc" id="namespacetk_html_ae5b04b00aa51667b944b7188545ec5ae"><div class="ttname"><a href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a></div><div class="ttdeci">T triple(const std::array&lt; T, 3 &gt; &amp;v1, const std::array&lt; T, 3 &gt; &amp;v2, const std::array&lt; T, 3 &gt; &amp;v3)</div><div class="ttdef"><b>Definition:</b> <a href="_base_2_vector_8h_source.html#l00067">Vector.h:67</a></div></div>
<div class="ttc" id="structtag_1_1gamma_html"><div class="ttname"><a href="structtag_1_1gamma.html">tag::gamma</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00058">Tags.h:58</a></div></div>
<div class="ttc" id="namespacetk_html_ac9a26e30d19b940a12990a866a514cb5"><div class="ttname"><a href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">tk::max</a></div><div class="ttdeci">Data&lt; Layout &gt; max(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00581">Data.h:581</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00049">Control.h:49</a></div></div>
<div class="ttc" id="namespacetk_html_a1a96ada94b7e2911ecca0a360f305575"><div class="ttname"><a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a></div><div class="ttdeci">double real</div><div class="ttdoc">Real number type used throughout the whole code. </div><div class="ttdef"><b>Definition:</b> <a href="_base_2_types_8h_source.html#l00018">Types.h:18</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00049">Exception.h:49</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_carrier_8_c_source.html#l00043">Carrier.C:43</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_comp_flow_aaabdc8efbe83458388b787c5c54972e1_cgraph.svg" width="450" height="234"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aaa07b25a5284965407ae74f4fb79c188"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa07b25a5284965407ae74f4fb79c188">&#9670;&nbsp;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Physics , class Problem &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classinciter_1_1_comp_flow.html">inciter::CompFlow</a>&lt; Physics, Problem &gt;::initialize </td>
          <td>(</td>
          <td class="paramtype">const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>unk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>gid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>bc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initalize the compressible flow equations, prepare for time integration </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coord</td><td>Mesh node coordinates </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">unk</td><td>Array of unknowns </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gid</td><td>Global node IDs of owned elements </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bc</td><td>Vector of pairs of bool and boundary condition value associated to mesh node IDs at which to set Dirichlet boundary conditions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>J. Bakosi </dd></dl>

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00054">54</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>

<p class="reference">References <a class="el" href="_comp_flow_8h_source.html#l00359">inciter::CompFlow&lt; Physics, Problem &gt;::m_offset</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;          {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="comment">// Set initial conditions using problem configuration policy</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      Problem::init( coord, gid, bc, unk, 0, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a> );</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div><div class="ttc" id="classinciter_1_1_comp_flow_html_a4c5e6b336f4e8ffe1cf3e1082ba6f3af"><div class="ttname"><a href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">inciter::CompFlow::m_offset</a></div><div class="ttdeci">const ncomp_t m_offset</div><div class="ttdoc">Offset PDE operates from. </div><div class="ttdef"><b>Definition:</b> <a href="_comp_flow_8h_source.html#l00359">CompFlow.h:359</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c4f3473137fac53a5bb69414dfd6a30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c4f3473137fac53a5bb69414dfd6a30">&#9670;&nbsp;</a></span>lhs()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Physics , class Problem &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classinciter_1_1_comp_flow.html">inciter::CompFlow</a>&lt; Physics, Problem &gt;::lhs </td>
          <td>(</td>
          <td class="paramtype">const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>psup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>lhsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>lhso</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute the left hand side sparse matrix </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coord</td><td>Mesh node coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psup</td><td>Linked lists storing IDs of points surrounding points </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lhsd</td><td>Diagonal of the sparse matrix storing nonzeros </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lhso</td><td>Off-diagonal of the sparse matrix storing nonzeros</td></tr>
  </table>
  </dd>
</dl>
<p>Sparse matrix storing the nonzero matrix values at rows and columns given by psup. The format is similar to compressed row storage, but the diagonal and off-diagonal data are stored in separate vectors. For the off-diagonal data the local row and column indices, at which values are nonzero, are stored by psup (psup1 and psup2, where psup2 holds the indices at which psup1 holds the point ids surrounding points, see also <a class="el" href="namespacetk.html#ad2a88a65102c17149b44660db15d445b" title="Generate derived data structure, points surrounding points. ">tk::genPsup()</a>). Note that the number of mesh points (our chunk) npoin = psup.second.size()-1. </p><dl class="section author"><dt>Author</dt><dd>J. Bakosi </dd></dl>

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00080">80</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_comp_flow_8h_source.html#l00359">inciter::CompFlow&lt; Physics, Problem &gt;::m_offset</a>, <a class="el" href="_exception_8h_source.html#l00034">Throw</a>, and <a class="el" href="_base_2_vector_8h_source.html#l00067">tk::triple()</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( psup.second.size()-1 == coord[0].size(),</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;              <span class="stringliteral">&quot;Number of mesh points and number of global IDs unequal&quot;</span> );</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( lhsd.nunk() == psup.second.size()-1, <span class="stringliteral">&quot;Number of unknowns in &quot;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;              <span class="stringliteral">&quot;diagonal sparse matrix storage incorrect&quot;</span> );</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( lhso.nunk() == psup.first.size(), <span class="stringliteral">&quot;Number of unknowns in &quot;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;              <span class="stringliteral">&quot;off-diagonal sparse matrix storage incorrect&quot;</span> );</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="comment">// Lambda to compute the sparse matrix vector index for row and column</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="comment">// indices. Used only for off-diagonal entries.</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keyword">auto</span> spidx = [ &amp;psup ]( std::size_t r, std::size_t c ) -&gt; std::size_t {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( r != c, <span class="stringliteral">&quot;Only for computing the off-diagonal indices&quot;</span> );</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i=psup.second[r]+1; i&lt;=psup.second[r+1]; ++i)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          <span class="keywordflow">if</span> (c == psup.first[i]) <span class="keywordflow">return</span> i;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a>( <span class="stringliteral">&quot;Cannot find row, column: &quot;</span> + std::to_string(r) + <span class="charliteral">&#39;,&#39;</span> +</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;               std::to_string(c) + <span class="stringliteral">&quot; in sparse matrix&quot;</span> );</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      };</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; x = coord[0];</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; y = coord[1];</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; z = coord[2];</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="comment">// Zero matrix for all components</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">ncomp_t</a> c=0; c&lt;5; ++c) {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        lhsd.fill( c, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a>, 0.0 );</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        lhso.fill( c, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a>, 0.0 );</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> A = inpoel[e*4+0];</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> B = inpoel[e*4+1];</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> C = inpoel[e*4+2];</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> D = inpoel[e*4+3];</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        std::array&lt; tk::real, 3 &gt; ba{{ x[B]-x[A], y[B]-y[A], z[B]-z[A] }},</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                  ca{{ x[C]-x[A], y[C]-y[A], z[C]-z[A] }},</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                  da{{ x[D]-x[A], y[D]-y[A], z[D]-z[A] }};</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> J = <a class="code" href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a>( ba, ca, da ) / 120.0;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">ncomp_t</a> c=0; c&lt;5; ++c) {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> r = lhsd.cptr( c, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a> );</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          lhsd.var( r, A ) += 2.0 * J;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          lhsd.var( r, B ) += 2.0 * J;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          lhsd.var( r, C ) += 2.0 * J;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          lhsd.var( r, D ) += 2.0 * J;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> s = lhso.cptr( c, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a> );</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          lhso.var( s, spidx(A,B) ) += J;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          lhso.var( s, spidx(A,C) ) += J;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          lhso.var( s, spidx(A,D) ) += J;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          lhso.var( s, spidx(B,A) ) += J;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          lhso.var( s, spidx(B,C) ) += J;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          lhso.var( s, spidx(B,D) ) += J;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          lhso.var( s, spidx(C,A) ) += J;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          lhso.var( s, spidx(C,B) ) += J;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          lhso.var( s, spidx(C,D) ) += J;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          lhso.var( s, spidx(D,A) ) += J;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          lhso.var( s, spidx(D,B) ) += J;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          lhso.var( s, spidx(D,C) ) += J;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div><div class="ttc" id="classinciter_1_1_comp_flow_html_a528e9e3726f84402865a6713f78b1169"><div class="ttname"><a href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">inciter::CompFlow::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_comp_flow_8h_source.html#l00039">CompFlow.h:39</a></div></div>
<div class="ttc" id="_exception_8h_html_a0412f798470c18f503a2c2f63c970ba8"><div class="ttname"><a href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a></div><div class="ttdeci">#define Throw(...)</div><div class="ttdoc">Throw macro that always throws an exception. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00034">Exception.h:34</a></div></div>
<div class="ttc" id="classinciter_1_1_comp_flow_html_a4c5e6b336f4e8ffe1cf3e1082ba6f3af"><div class="ttname"><a href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">inciter::CompFlow::m_offset</a></div><div class="ttdeci">const ncomp_t m_offset</div><div class="ttdoc">Offset PDE operates from. </div><div class="ttdef"><b>Definition:</b> <a href="_comp_flow_8h_source.html#l00359">CompFlow.h:359</a></div></div>
<div class="ttc" id="namespacetk_html_ae5b04b00aa51667b944b7188545ec5ae"><div class="ttname"><a href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a></div><div class="ttdeci">T triple(const std::array&lt; T, 3 &gt; &amp;v1, const std::array&lt; T, 3 &gt; &amp;v2, const std::array&lt; T, 3 &gt; &amp;v3)</div><div class="ttdef"><b>Definition:</b> <a href="_base_2_vector_8h_source.html#l00067">Vector.h:67</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00049">Exception.h:49</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_comp_flow_a9c4f3473137fac53a5bb69414dfd6a30_cgraph.svg" width="414" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a5886e1cd585272a26703544efdb759f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5886e1cd585272a26703544efdb759f0">&#9670;&nbsp;</a></span>names()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Physics , class Problem &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; <a class="el" href="classinciter_1_1_comp_flow.html">inciter::CompFlow</a>&lt; Physics, Problem &gt;::names </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return field names to be output to file </p><dl class="section return"><dt>Returns</dt><dd>Vector of strings labelling fields output in file </dd></dl>

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00347">347</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;{ <span class="keywordflow">return</span> Problem::names(); }</div></div><!-- fragment -->
</div>
</div>
<a id="afcaf7def7f2bb0ed0cca9bba9ae56ebf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcaf7def7f2bb0ed0cca9bba9ae56ebf">&#9670;&nbsp;</a></span>output()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Physics , class Problem &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; <a class="el" href="classinciter_1_1_comp_flow.html">inciter::CompFlow</a>&lt; Physics, Problem &gt;::output </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>U</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return field output going to file </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">U</td><td>Solution vector at recent time step stage </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of vectors to be output to file </dd></dl>

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00353">353</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>

<p class="reference">References <a class="el" href="_comp_flow_8h_source.html#l00359">inciter::CompFlow&lt; Physics, Problem &gt;::m_offset</a>.</p>
<div class="fragment"><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    { <span class="keywordflow">return</span> Problem::output( 0, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a>, t, coord, U ); }</div><div class="ttc" id="classinciter_1_1_comp_flow_html_a4c5e6b336f4e8ffe1cf3e1082ba6f3af"><div class="ttname"><a href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">inciter::CompFlow::m_offset</a></div><div class="ttdeci">const ncomp_t m_offset</div><div class="ttdoc">Offset PDE operates from. </div><div class="ttdef"><b>Definition:</b> <a href="_comp_flow_8h_source.html#l00359">CompFlow.h:359</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87d2d9481ec589ffe077934b71e0032f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87d2d9481ec589ffe077934b71e0032f">&#9670;&nbsp;</a></span>rhs()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Physics , class Problem &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classinciter_1_1_comp_flow.html">inciter::CompFlow</a>&lt; Physics, Problem &gt;::rhs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>&#160;</td>
          <td class="paramname"><em>mult</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>&#160;</td>
          <td class="paramname"><em>deltat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute right hand side </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mult</td><td>Multiplier differentiating the different stages in multi-stage time stepping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">deltat</td><td>Size of time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coord</td><td>Mesh node coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">U</td><td>Solution vector at recent time step stage </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">R</td><td>Right-hand side vector computed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>J. Bakosi </dd></dl>

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00160">160</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_base_2_vector_8h_source.html#l00036">tk::crossdiv()</a>, <a class="el" href="_comp_flow_8h_source.html#l00359">inciter::CompFlow&lt; Physics, Problem &gt;::m_offset</a>, and <a class="el" href="_base_2_vector_8h_source.html#l00067">tk::triple()</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( U.nunk() == coord[0].size(), <span class="stringliteral">&quot;Number of unknowns in solution &quot;</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;              <span class="stringliteral">&quot;vector at recent time step incorrect&quot;</span> );</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( R.nunk() == coord[0].size() &amp;&amp; R.nprop() == 5,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;              <span class="stringliteral">&quot;Number of unknowns and/or number of components in right-hand &quot;</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;              <span class="stringliteral">&quot;side vector incorrect&quot;</span> );</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; x = coord[0];</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; y = coord[1];</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; z = coord[2];</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="comment">// zero right hand side for all components</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">ncomp_t</a> c=0; c&lt;5; ++c) R.fill( c, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a>, 0.0 );</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                               inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">// compute element Jacobi determinant</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keyword">const</span> std::array&lt; tk::real, 3 &gt;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          ba{{ x[N[1]]-x[N[0]], y[N[1]]-y[N[0]], z[N[1]]-z[N[0]] }},</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          ca{{ x[N[2]]-x[N[0]], y[N[2]]-y[N[0]], z[N[2]]-z[N[0]] }},</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          da{{ x[N[3]]-x[N[0]], y[N[3]]-y[N[0]], z[N[3]]-z[N[0]] }};</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> J = <a class="code" href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a>( ba, ca, da );        <span class="comment">// J = 6V</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">// consistent mass, nnode*nnode [4][4]</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        std::array&lt; std::array&lt; tk::real, 4 &gt;, 4 &gt; mass;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        mass[0][0] = mass[1][1] = mass[2][2] = mass[3][3] = J/60.0;  <span class="comment">// diagonal</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        mass[0][1] = mass[0][2] = mass[0][3] =                   <span class="comment">// off-diagonal</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        mass[1][0] = mass[1][2] = mass[1][3] =</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        mass[2][0] = mass[2][1] = mass[2][3] =</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        mass[3][0] = mass[3][1] = mass[3][2] = J/120.0;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">// shape function derivatives, nnode*ndim [4][3]</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        std::array&lt; std::array&lt; tk::real, 3 &gt;, 4 &gt; grad;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        grad[1] = <a class="code" href="namespacetk.html#a77ef9600b5075a8bbee89b6e4991fd69">tk::crossdiv</a>( ca, da, J );</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        grad[2] = <a class="code" href="namespacetk.html#a77ef9600b5075a8bbee89b6e4991fd69">tk::crossdiv</a>( da, ba, J );</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        grad[3] = <a class="code" href="namespacetk.html#a77ef9600b5075a8bbee89b6e4991fd69">tk::crossdiv</a>( ba, ca, J );</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;3; ++i)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          grad[0][i] = -grad[1][i]-grad[2][i]-grad[3][i];</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">// access solution at element nodes at recent time step stage</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        std::array&lt; std::array&lt; tk::real, 4 &gt;, 5 &gt; u;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">ncomp_t</a> c=0; c&lt;5; ++c) u[c] = U.extract( c, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a>, N );</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">// access pointer to right hand side at component and offset</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        std::array&lt; const tk::real*, 5 &gt; r;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">ncomp_t</a> c=0; c&lt;5; ++c) r[c] = R.cptr( c, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a> );</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="comment">// ratio of specific heats</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keyword">auto</span> g = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1param.html">tag::param</a>, <a class="code" href="structtag_1_1compflow.html">tag::compflow</a>, <a class="code" href="structtag_1_1gamma.html">tag::gamma</a> &gt;()[0];</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="comment">// compute pressure</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        std::array&lt; tk::real, 4 &gt; p;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;4; ++i)</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          p[i] = (g-1.0)*(u[4][i] - (u[1][i]*u[1][i] +</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                     u[2][i]*u[2][i] +</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                     u[3][i]*u[3][i])/2.0/u[0][i]);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">// scatter-add mass, momentum, and energy contributions to rhs</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> c = mult * deltat * J/24.0;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;3; ++i)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordflow">for</span> (std::size_t k=0; k&lt;4; ++k) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;              <span class="comment">// advection contribution to mass rhs</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;              R.var(r[0],N[j]) -= c * grad[k][i] * u[i+1][k];</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;              <span class="comment">// advection contribution to momentum rhs</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;              <span class="keywordflow">for</span> (std::size_t l=0; l&lt;3; ++l)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                R.var(r[l+1],N[j]) -= c * grad[k][i] *</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                      u[l+1][k]*u[i+1][k]/u[0][k];</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;              <span class="comment">// pressure gradient contribution to momentum rhs</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;              R.var(r[i+1],N[j]) -= c * grad[k][i] * p[k];</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;              <span class="comment">// advection and pressure gradient contribution to energy rhs</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;              R.var(r[4],N[j]) -= c * grad[k][i] *</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                                  (u[4][k] + p[k]) * u[i+1][k]/u[0][k];</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="comment">// add viscous stress contribution to momentum and energy rhs</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        Physics::viscousRhs( mult, deltat, J, N, grad, u, r, R );</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="comment">// add heat conduction contribution to energy rhs</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        Physics::conductRhs( mult, deltat, J, N, grad, u, r, R );</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="comment">// add source to rhs for all equations</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        Problem::sourceRhs( coord, 0, mult, deltat, J, N, mass, grad, r, u, R );</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div><div class="ttc" id="classinciter_1_1_comp_flow_html_a528e9e3726f84402865a6713f78b1169"><div class="ttname"><a href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">inciter::CompFlow::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_comp_flow_8h_source.html#l00039">CompFlow.h:39</a></div></div>
<div class="ttc" id="structtag_1_1compflow_html"><div class="ttname"><a href="structtag_1_1compflow.html">tag::compflow</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00143">Tags.h:143</a></div></div>
<div class="ttc" id="structtag_1_1param_html"><div class="ttname"><a href="structtag_1_1param.html">tag::param</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00126">Tags.h:126</a></div></div>
<div class="ttc" id="namespacetk_html_a77ef9600b5075a8bbee89b6e4991fd69"><div class="ttname"><a href="namespacetk.html#a77ef9600b5075a8bbee89b6e4991fd69">tk::crossdiv</a></div><div class="ttdeci">std::array&lt; T, 3 &gt; crossdiv(const std::array&lt; T, 3 &gt; &amp;v1, const std::array&lt; T, 3 &gt; &amp;v2, T j)</div><div class="ttdef"><b>Definition:</b> <a href="_base_2_vector_8h_source.html#l00036">Vector.h:36</a></div></div>
<div class="ttc" id="classinciter_1_1_comp_flow_html_a4c5e6b336f4e8ffe1cf3e1082ba6f3af"><div class="ttname"><a href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">inciter::CompFlow::m_offset</a></div><div class="ttdeci">const ncomp_t m_offset</div><div class="ttdoc">Offset PDE operates from. </div><div class="ttdef"><b>Definition:</b> <a href="_comp_flow_8h_source.html#l00359">CompFlow.h:359</a></div></div>
<div class="ttc" id="namespacetk_html_ae5b04b00aa51667b944b7188545ec5ae"><div class="ttname"><a href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a></div><div class="ttdeci">T triple(const std::array&lt; T, 3 &gt; &amp;v1, const std::array&lt; T, 3 &gt; &amp;v2, const std::array&lt; T, 3 &gt; &amp;v3)</div><div class="ttdef"><b>Definition:</b> <a href="_base_2_vector_8h_source.html#l00067">Vector.h:67</a></div></div>
<div class="ttc" id="structtag_1_1gamma_html"><div class="ttname"><a href="structtag_1_1gamma.html">tag::gamma</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00058">Tags.h:58</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00049">Control.h:49</a></div></div>
<div class="ttc" id="namespacetk_html_a1a96ada94b7e2911ecca0a360f305575"><div class="ttname"><a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a></div><div class="ttdeci">double real</div><div class="ttdoc">Real number type used throughout the whole code. </div><div class="ttdef"><b>Definition:</b> <a href="_base_2_types_8h_source.html#l00018">Types.h:18</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00049">Exception.h:49</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_carrier_8_c_source.html#l00043">Carrier.C:43</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_comp_flow_a87d2d9481ec589ffe077934b71e0032f_cgraph.svg" width="435" height="110"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ac35129c821564a46323dffef310d954e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac35129c821564a46323dffef310d954e">&#9670;&nbsp;</a></span>side()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Physics , class Problem &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classinciter_1_1_comp_flow.html">inciter::CompFlow</a>&lt; Physics, Problem &gt;::side </td>
          <td>(</td>
          <td class="paramtype">std::unordered_set&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>conf</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Query all side set IDs the user has configured for all components in this <a class="el" href="classinciter_1_1_p_d_e.html" title="Partial differential equation. ">PDE</a> system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">conf</td><td>Set of unique side set IDs to add to </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00335">335</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    { Problem::side( conf ); }</div></div><!-- fragment -->
</div>
</div>
<a id="a780eb2a9adb53e09684ee6a2d6d23466"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a780eb2a9adb53e09684ee6a2d6d23466">&#9670;&nbsp;</a></span>velocity()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Physics , class Problem &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::array&lt; std::array&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>, 4 &gt;, 3 &gt; <a class="el" href="classinciter_1_1_comp_flow.html">inciter::CompFlow</a>&lt; Physics, Problem &gt;::velocity </td>
          <td>(</td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; std::size_t, 4 &gt; &amp;&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Extract the velocity field at cell nodes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">U</td><td>Solution vector at recent time step stage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>Element node indices </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of the four values of the velocity field </dd></dl>

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00314">314</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>

<p class="reference">References <a class="el" href="_comp_flow_8h_source.html#l00359">inciter::CompFlow&lt; Physics, Problem &gt;::m_offset</a>.</p>
<div class="fragment"><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      std::array&lt; std::array&lt; tk::real, 4 &gt;, 3 &gt; v;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      v[0] = U.extract( 1, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a>, N );</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      v[1] = U.extract( 2, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a>, N );</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      v[2] = U.extract( 3, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a>, N );</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keyword">auto</span> r = U.extract( 0, <a class="code" href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">m_offset</a>, N );</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      std::transform( r.begin(), r.end(), v[0].begin(), v[0].begin(),</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                      []( <a class="code" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> s, <a class="code" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>&amp; d ){ <span class="keywordflow">return</span> d /= s; } );</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      std::transform( r.begin(), r.end(), v[1].begin(), v[1].begin(),</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                      []( <a class="code" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> s, <a class="code" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>&amp; d ){ <span class="keywordflow">return</span> d /= s; } );</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      std::transform( r.begin(), r.end(), v[2].begin(), v[2].begin(),</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                      []( <a class="code" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> s, <a class="code" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a>&amp; d ){ <span class="keywordflow">return</span> d /= s; } );</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordflow">return</span> v;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div><div class="ttc" id="classinciter_1_1_comp_flow_html_a4c5e6b336f4e8ffe1cf3e1082ba6f3af"><div class="ttname"><a href="classinciter_1_1_comp_flow.html#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">inciter::CompFlow::m_offset</a></div><div class="ttdeci">const ncomp_t m_offset</div><div class="ttdoc">Offset PDE operates from. </div><div class="ttdef"><b>Definition:</b> <a href="_comp_flow_8h_source.html#l00359">CompFlow.h:359</a></div></div>
<div class="ttc" id="namespacetk_html_a1a96ada94b7e2911ecca0a360f305575"><div class="ttname"><a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a></div><div class="ttdeci">double real</div><div class="ttdoc">Real number type used throughout the whole code. </div><div class="ttdef"><b>Definition:</b> <a href="_base_2_types_8h_source.html#l00018">Types.h:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a4c5e6b336f4e8ffe1cf3e1082ba6f3af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c5e6b336f4e8ffe1cf3e1082ba6f3af">&#9670;&nbsp;</a></span>m_offset</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Physics , class Problem &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classinciter_1_1_comp_flow.html#a528e9e3726f84402865a6713f78b1169">ncomp_t</a> <a class="el" href="classinciter_1_1_comp_flow.html">inciter::CompFlow</a>&lt; Physics, Problem &gt;::m_offset</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Offset <a class="el" href="classinciter_1_1_p_d_e.html" title="Partial differential equation. ">PDE</a> operates from. </p>

<p class="definition">Definition at line <a class="el" href="_comp_flow_8h_source.html#l00359">359</a> of file <a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_comp_flow_8h_source.html#l00255">inciter::CompFlow&lt; Physics, Problem &gt;::dt()</a>, <a class="el" href="_comp_flow_8h_source.html#l00054">inciter::CompFlow&lt; Physics, Problem &gt;::initialize()</a>, <a class="el" href="_comp_flow_8h_source.html#l00080">inciter::CompFlow&lt; Physics, Problem &gt;::lhs()</a>, <a class="el" href="_comp_flow_8h_source.html#l00353">inciter::CompFlow&lt; Physics, Problem &gt;::output()</a>, <a class="el" href="_comp_flow_8h_source.html#l00160">inciter::CompFlow&lt; Physics, Problem &gt;::rhs()</a>, and <a class="el" href="_comp_flow_8h_source.html#l00314">inciter::CompFlow&lt; Physics, Problem &gt;::velocity()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/tmp/q/quinoa/src/PDE/<a class="el" href="_comp_flow_8h_source.html">CompFlow.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Feb 23 2017 06:14:47 for Quinoa by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
