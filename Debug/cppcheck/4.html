
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [<a href="https://github.com/quinoacomputing/quinoa/commit/5d5ec27">Quinoa_v0.2-1523-g5d5ec27</a>]</title>
    <link rel="stylesheet" href="style.css">
    <style>
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script language="javascript">
      function getStyle(el,styleProp) {
        if (el.currentStyle)
          var y = el.currentStyle[styleProp];
        else if (window.getComputedStyle)
          var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
        return y;
      }
      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;
        if (el.style.display == "block") {
          el.style.display = "none";
          mark.innerHTML = "[+]";
        } else {
          el.style.display = "block";
          mark.innerHTML = "[-]";
        }
      }
      function init_expandables() {
        var elts = document.getElementsByClassName("expandable");
        for (var i = 0; i < elts.length; i++) {
          var el = elts[i];
          var clickable = el.getElementsByTagName("span")[0];
          var marker = clickable.getElementsByClassName("marker")[0];
          var content = el.getElementsByClassName("content")[0];
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.onclick = toggle;
        }
      }
      function set_class_display(c, st) {
        var elements = document.querySelectorAll('.' + c),
            len = elements.length;
        for (i = 0; i < len; i++) {
            elements[i].style.display = st;
        }
      }
      function toggle_class_visibility(id) {
        var box = document.getElementById(id);
        set_class_display(id, box.checked ? '' : 'none');
      }
    </script>
  </head>
  <body onload="init_expandables()">
      <div id="header">
        <h1>Cppcheck report - [<a href="https://github.com/quinoacomputing/quinoa/commit/5d5ec27">Quinoa_v0.2-1523-g5d5ec27</a>]: /tmp/TeamCity-14/work/821a9fd6f64749d9/src/Control/FileParser.C </h1>
      </div>
      <div id="menu" dir="rtl">
       <p id="filename"><a href="index.html">Defects:</a> FileParser.C</p>
<a href='4.html#line-76'> noExplicitConstructor 76</a>
      </div>
      <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="c1">// *****************************************************************************</span>
<a name="line-2"></a><span class="cm">/*!</span>
<a name="line-3"></a><span class="cm">  \file      src/Control/FileParser.C</span>
<a name="line-4"></a><span class="cm">  \copyright 2012-2015, J. Bakosi, 2016-2018, Los Alamos National Security, LLC.</span>
<a name="line-5"></a><span class="cm">  \brief     File parser base class definition</span>
<a name="line-6"></a><span class="cm">  \details   File parser base class defintion. File parser base serves as a</span>
<a name="line-7"></a><span class="cm">    base class for various file parsers, e.g., input deck parsers. It does</span>
<a name="line-8"></a><span class="cm">    generic low-level I/O, e.g., testing whether the file to be parsed exits or</span>
<a name="line-9"></a><span class="cm">    not and associated error handling, as well as after-parser diagnostics.</span>
<a name="line-10"></a><span class="cm">*/</span>
<a name="line-11"></a><span class="c1">// *****************************************************************************</span>
<a name="line-12"></a>
<a name="line-13"></a><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp"></span>
<a name="line-14"></a>
<a name="line-15"></a><span class="cp">#include</span> <span class="cpf">&quot;FileParser.h&quot;</span><span class="cp"></span>
<a name="line-16"></a><span class="cp">#include</span> <span class="cpf">&quot;Exception.h&quot;</span><span class="cp"></span>
<a name="line-17"></a><span class="cp">#include</span> <span class="cpf">&quot;Reader.h&quot;</span><span class="cp"></span>
<a name="line-18"></a><span class="cp">#include</span> <span class="cpf">&quot;Print.h&quot;</span><span class="cp"></span>
<a name="line-19"></a>
<a name="line-20"></a><span class="k">using</span> <span class="n">tk</span><span class="o">::</span><span class="n">FileParser</span><span class="p">;</span>
<a name="line-21"></a>
<a name="line-22"></a><span class="n">FileParser</span><span class="o">::</span><span class="n">FileParser</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">filename</span> <span class="p">)</span> <span class="o">:</span> <span class="n">m_filename</span><span class="p">(</span> <span class="n">filename</span> <span class="p">)</span>
<a name="line-23"></a><span class="c1">// *****************************************************************************</span>
<a name="line-24"></a><span class="c1">//  Constructor</span>
<a name="line-25"></a><span class="c1">//! \param[in] filename File to be parsed by the parser</span>
<a name="line-26"></a><span class="c1">//! \details This constructor does basic tests in an attempt to determine if the</span>
<a name="line-27"></a><span class="c1">//!   file to be parsed exists and is in good shape and does associated error</span>
<a name="line-28"></a><span class="c1">//!   handling. This file stream is local, only used for error checking, and</span>
<a name="line-29"></a><span class="c1">//!   thus is not part of the object state here since the parser, inheriting</span>
<a name="line-30"></a><span class="c1">//!   from FileParser, e.g., walker::InputDeckParser, parses by completely</span>
<a name="line-31"></a><span class="c1">//!   outsourcing the parsing (to PEGTL), so there is no need to store the file</span>
<a name="line-32"></a><span class="c1">//!   stream handle here.</span>
<a name="line-33"></a><span class="c1">// *****************************************************************************</span>
<a name="line-34"></a><span class="p">{</span>
<a name="line-35"></a>  <span class="c1">// Make sure there is a filename</span>
<a name="line-36"></a>  <span class="n">Assert</span><span class="p">(</span> <span class="o">!</span><span class="n">filename</span><span class="p">.</span><span class="n">empty</span><span class="p">(),</span> <span class="s">&quot;No filename specified&quot;</span> <span class="p">);</span>
<a name="line-37"></a>
<a name="line-38"></a>  <span class="c1">// Local file stream handle</span>
<a name="line-39"></a>  <span class="n">std</span><span class="o">::</span><span class="n">ifstream</span> <span class="n">q</span><span class="p">;</span>
<a name="line-40"></a>
<a name="line-41"></a>  <span class="c1">// Check if file exists, throw exception if it does not</span>
<a name="line-42"></a>  <span class="n">q</span><span class="p">.</span><span class="n">open</span><span class="p">(</span> <span class="n">filename</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">ifstream</span><span class="o">::</span><span class="n">in</span> <span class="p">);</span>
<a name="line-43"></a>  <span class="n">ErrChk</span><span class="p">(</span> <span class="n">q</span><span class="p">.</span><span class="n">good</span><span class="p">(),</span> <span class="s">&quot;Failed to open file: &quot;</span> <span class="o">+</span> <span class="n">filename</span> <span class="p">);</span>
<a name="line-44"></a>
<a name="line-45"></a>  <span class="c1">// Attempt to read a character, throw if it fails</span>
<a name="line-46"></a>  <span class="c1">// It is curious that on some systems opening a directory instead of a file</span>
<a name="line-47"></a>  <span class="c1">// with the above ifstream::open() call does not set the failbit. Thus we get</span>
<a name="line-48"></a>  <span class="c1">// here fine, so we try to read a character from it. If it is a directory or</span>
<a name="line-49"></a>  <span class="c1">// an empty file the read will fail, so we throw. Read more at: http://</span>
<a name="line-50"></a>  <span class="c1">// stackoverflow.com/questions/9591036/</span>
<a name="line-51"></a>  <span class="c1">// ifstream-open-doesnt-set-error-bits-when-argument-is-a-directory.</span>
<a name="line-52"></a>  <span class="n">q</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
<a name="line-53"></a>  <span class="n">ErrChk</span><span class="p">(</span> <span class="n">q</span><span class="p">.</span><span class="n">good</span><span class="p">(),</span> <span class="s">&quot;Failed to read from file: &quot;</span> <span class="o">+</span> <span class="n">filename</span> <span class="p">);</span>
<a name="line-54"></a>
<a name="line-55"></a>  <span class="c1">// Close it</span>
<a name="line-56"></a>  <span class="n">q</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
<a name="line-57"></a>  <span class="n">ErrChk</span><span class="p">(</span> <span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">fail</span><span class="p">(),</span> <span class="s">&quot;Failed to close file: &quot;</span> <span class="o">+</span> <span class="n">filename</span> <span class="p">);</span>
<a name="line-58"></a><span class="p">}</span>
<a name="line-59"></a>
<a name="line-60"></a><span class="kt">void</span>
<a name="line-61"></a><span class="n">FileParser</span><span class="o">::</span><span class="n">diagnostics</span><span class="p">(</span> <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">Print</span><span class="o">&amp;</span> <span class="n">print</span><span class="p">,</span>
<a name="line-62"></a>                         <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&gt;&amp;</span> <span class="n">messages</span> <span class="p">)</span>
<a name="line-63"></a><span class="c1">// *****************************************************************************</span>
<a name="line-64"></a><span class="c1">//  Echo errors and warnings accumulated during parsing</span>
<a name="line-65"></a><span class="c1">//! \param[in] print    Pretty printer</span>
<a name="line-66"></a><span class="c1">//! \param[in] messages Vector of strings of errors and warnings</span>
<a name="line-67"></a><span class="c1">// *****************************************************************************</span>
<a name="line-68"></a><span class="p">{</span>
<a name="line-69"></a>  <span class="c1">// Bundle storing multiple messages for a single errouneous line</span>
<a name="line-70"></a>  <span class="k">struct</span> <span class="n">ErroneousLine</span> <span class="p">{</span>
<a name="line-71"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">dlnum</span><span class="p">;</span>                       <span class="c1">//!&lt; number of digits of line num</span>
<a name="line-72"></a>    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">parsed</span><span class="p">;</span>                      <span class="c1">//!&lt; original line parsed</span>
<a name="line-73"></a>    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">underline</span><span class="p">;</span>                   <span class="c1">//!&lt; underline</span>
<a name="line-74"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&gt;</span> <span class="n">msg</span><span class="p">;</span>          <span class="c1">//!&lt; error or warning messages</span>
<a name="line-75"></a>    <span class="n">ErroneousLine</span><span class="p">()</span> <span class="o">:</span> <span class="n">dlnum</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">parsed</span><span class="p">(),</span> <span class="n">underline</span><span class="p">(),</span> <span class="n">msg</span><span class="p">()</span> <span class="p">{}</span>
<a name="line-76"></a><span class="hll">    <span class="n">ErroneousLine</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">m</span> <span class="p">)</span> <span class="o">:</span><div class='verbose expandable'><span class='error2'>&lt;--- Struct 'ErroneousLine' has a constructor with 1 argument that is not explicit. <span class='marker'>[+]</span></span><div class='content'>Struct &apos;ErroneousLine&apos; has a constructor with 1 argument that is not explicit. Such constructors should in general be explicit for type safety reasons. Using the explicit keyword in the constructor means some mistakes when using the class can be avoided.</div></div>
</span><a name="line-77"></a>      <span class="n">dlnum</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">parsed</span><span class="p">(),</span> <span class="n">underline</span><span class="p">(),</span> <span class="n">msg</span><span class="p">({{</span><span class="n">m</span><span class="p">}})</span> <span class="p">{}</span>
<a name="line-78"></a>  <span class="p">};</span>
<a name="line-79"></a>
<a name="line-80"></a>  <span class="n">Reader</span> <span class="nf">id</span><span class="p">(</span> <span class="n">m_filename</span> <span class="p">);</span>        <span class="c1">// file reader for extracting erroneous lines</span>
<a name="line-81"></a>  <span class="kt">bool</span> <span class="n">err</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>               <span class="c1">// signaling whether there were any errors</span>
<a name="line-82"></a>  <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">ErroneousLine</span> <span class="o">&gt;</span> <span class="n">lines</span><span class="p">;</span> <span class="c1">// erroneous lines, key: lineno</span>
<a name="line-83"></a>
<a name="line-84"></a>  <span class="c1">// Underline errors and warnings</span>
<a name="line-85"></a>  <span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="nl">e</span> <span class="p">:</span> <span class="n">messages</span><span class="p">)</span> <span class="p">{</span>
<a name="line-86"></a>    <span class="c1">// decide if error or warning</span>
<a name="line-87"></a>    <span class="kt">char</span> <span class="n">underchar</span> <span class="o">=</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
<a name="line-88"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">find</span><span class="p">(</span> <span class="s">&quot;Error&quot;</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span><span class="p">)</span> <span class="p">{</span> <span class="n">err</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span> <span class="n">underchar</span> <span class="o">=</span> <span class="sc">&#39;^&#39;</span><span class="p">;</span> <span class="p">}</span>
<a name="line-89"></a>    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">find</span><span class="p">(</span> <span class="s">&quot;Warning&quot;</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span><span class="p">)</span> <span class="n">underchar</span> <span class="o">=</span> <span class="sc">&#39;~&#39;</span><span class="p">;</span>
<a name="line-90"></a>
<a name="line-91"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">underchar</span> <span class="o">==</span> <span class="sc">&#39;^&#39;</span> <span class="o">||</span> <span class="n">underchar</span> <span class="o">==</span> <span class="sc">&#39;~&#39;</span><span class="p">)</span> <span class="p">{</span>
<a name="line-92"></a>      <span class="k">auto</span> <span class="n">sloc</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">find</span><span class="p">(</span> <span class="s">&quot;at &quot;</span> <span class="p">);</span>
<a name="line-93"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">sloc</span> <span class="o">!=</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// if we have location info</span>
<a name="line-94"></a>        <span class="c1">// skip &quot;at &quot;</span>
<a name="line-95"></a>        <span class="n">sloc</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
<a name="line-96"></a>        <span class="c1">// find a comma starting from after &quot;at &quot;</span>
<a name="line-97"></a>        <span class="k">auto</span> <span class="n">eloc</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">find_first_of</span><span class="p">(</span> <span class="sc">&#39;,&#39;</span><span class="p">,</span> <span class="n">sloc</span> <span class="p">);</span>
<a name="line-98"></a>        <span class="c1">// extract line number of error from error message</span>
<a name="line-99"></a>        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">lnum</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">stoul</span><span class="p">(</span> <span class="n">e</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span> <span class="n">sloc</span><span class="p">,</span> <span class="n">eloc</span><span class="o">-</span><span class="n">sloc</span> <span class="p">)</span> <span class="p">);</span>
<a name="line-100"></a>        <span class="c1">// store number of digits in line number</span>
<a name="line-101"></a>        <span class="k">const</span> <span class="k">auto</span> <span class="n">dlnum</span> <span class="o">=</span> <span class="n">eloc</span> <span class="o">-</span> <span class="n">sloc</span><span class="p">;</span>
<a name="line-102"></a>        <span class="c1">// find a dot starting from after &quot;at &quot;</span>
<a name="line-103"></a>        <span class="n">eloc</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">find_first_of</span><span class="p">(</span> <span class="sc">&#39;.&#39;</span><span class="p">,</span> <span class="n">sloc</span> <span class="p">);</span>
<a name="line-104"></a>        <span class="c1">// skip line number</span>
<a name="line-105"></a>        <span class="n">sloc</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">find_first_of</span><span class="p">(</span> <span class="sc">&#39;,&#39;</span><span class="p">,</span> <span class="n">sloc</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<a name="line-106"></a>        <span class="c1">// extract column number of error from error message</span>
<a name="line-107"></a>        <span class="k">const</span> <span class="nf">decltype</span><span class="p">(</span><span class="n">sloc</span><span class="p">)</span> <span class="n">cnum</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">stoul</span><span class="p">(</span> <span class="n">e</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span> <span class="n">sloc</span><span class="p">,</span> <span class="n">eloc</span><span class="o">-</span><span class="n">sloc</span> <span class="p">)</span> <span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<a name="line-108"></a>        <span class="c1">// store erroneous line information in map</span>
<a name="line-109"></a>        <span class="k">auto</span><span class="o">&amp;</span> <span class="n">l</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span> <span class="n">lnum</span> <span class="p">];</span>
<a name="line-110"></a>        <span class="c1">// store number of digits in line number</span>
<a name="line-111"></a>        <span class="n">l</span><span class="p">.</span><span class="n">dlnum</span> <span class="o">=</span> <span class="n">dlnum</span><span class="p">;</span>
<a name="line-112"></a>        <span class="c1">// get erroneous line from file and store</span>
<a name="line-113"></a>        <span class="n">l</span><span class="p">.</span><span class="n">parsed</span> <span class="o">=</span> <span class="n">id</span><span class="p">.</span><span class="n">line</span><span class="p">(</span> <span class="n">lnum</span> <span class="p">);</span>
<a name="line-114"></a>        <span class="c1">// store message</span>
<a name="line-115"></a>        <span class="n">l</span><span class="p">.</span><span class="n">msg</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">e</span> <span class="p">);</span>
<a name="line-116"></a>        <span class="c1">// start constructing underline (from scratch if first error on line)</span>
<a name="line-117"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">underline</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="n">l</span><span class="p">.</span><span class="n">underline</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">parsed</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="sc">&#39; &#39;</span><span class="p">);</span>
<a name="line-118"></a>        <span class="c1">// find beginning of erroneous argument, this can be found in either e</span>
<a name="line-119"></a>        <span class="c1">// (the full error message which may contain the erroneous substring</span>
<a name="line-120"></a>        <span class="c1">// between single quotes and can also contain white space), or in</span>
<a name="line-121"></a>        <span class="c1">// l.parsed (the erroneouss line from the file), if we find a</span>
<a name="line-122"></a>        <span class="c1">// singly-quoted substring in e, we find the location of that substring</span>
<a name="line-123"></a>        <span class="c1">// in l.parsed, if we don&#39;t find a singly-quoted substring in e,</span>
<a name="line-124"></a>        <span class="c1">// we reverse-search l.parsed until a white space, in which case the</span>
<a name="line-125"></a>        <span class="c1">// error that will be underlined will be a single word</span>
<a name="line-126"></a>        <span class="n">sloc</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">find</span><span class="p">(</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="p">);</span>
<a name="line-127"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">sloc</span> <span class="o">==</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span><span class="p">)</span> <span class="p">{</span>
<a name="line-128"></a>          <span class="n">sloc</span> <span class="o">=</span> <span class="n">l</span><span class="p">.</span><span class="n">parsed</span><span class="p">.</span><span class="n">rfind</span><span class="p">(</span> <span class="sc">&#39; &#39;</span><span class="p">,</span> <span class="n">cnum</span><span class="o">-</span><span class="mi">1</span> <span class="p">);</span>
<a name="line-129"></a>        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<a name="line-130"></a>          <span class="k">auto</span> <span class="n">sloc2</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">find</span><span class="p">(</span> <span class="sc">&#39;\&#39;&#39;</span><span class="p">,</span> <span class="n">sloc</span><span class="o">+</span><span class="mi">1</span> <span class="p">);</span>
<a name="line-131"></a>          <span class="n">sloc</span> <span class="o">=</span> <span class="n">l</span><span class="p">.</span><span class="n">parsed</span><span class="p">.</span><span class="n">find</span><span class="p">(</span> <span class="n">e</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span> <span class="n">sloc</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">sloc2</span><span class="o">-</span><span class="n">sloc</span><span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
<a name="line-132"></a>        <span class="p">}</span>
<a name="line-133"></a>        <span class="c1">// special-handle the beginning of the line with no space in front of it</span>
<a name="line-134"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">sloc</span> <span class="o">==</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span><span class="p">)</span> <span class="n">sloc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="k">else</span> <span class="o">++</span><span class="n">sloc</span><span class="p">;</span>
<a name="line-135"></a>        <span class="c1">// underline error and warning differently</span>
<a name="line-136"></a>        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">i</span><span class="o">=</span><span class="n">sloc</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">cnum</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">l</span><span class="p">.</span><span class="n">underline</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">underchar</span><span class="p">;</span>
<a name="line-137"></a>      <span class="p">}</span>
<a name="line-138"></a>    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">e</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="n">lines</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ErroneousLine</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">);</span>
<a name="line-139"></a>  <span class="p">}</span>
<a name="line-140"></a>
<a name="line-141"></a>  <span class="c1">// Output errors and warnings underlined to quiet stream and message</span>
<a name="line-142"></a>  <span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="nl">l</span> <span class="p">:</span> <span class="n">lines</span><span class="p">)</span> <span class="p">{</span>
<a name="line-143"></a>    <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">l</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
<a name="line-144"></a>    <span class="n">print</span> <span class="o">%</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<a name="line-145"></a>    <span class="n">print</span> <span class="o">%</span> <span class="s">&quot;&gt;&gt;&gt; Line &quot;</span> <span class="o">%</span> <span class="n">l</span><span class="p">.</span><span class="n">first</span> <span class="o">%</span> <span class="s">&quot;: &#39;&quot;</span> <span class="o">%</span> <span class="n">e</span><span class="p">.</span><span class="n">parsed</span> <span class="o">%</span> <span class="s">&quot;&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<a name="line-146"></a>    <span class="n">print</span> <span class="o">%</span> <span class="s">&quot;&gt;&gt;&gt;&quot;</span> <span class="o">%</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span> <span class="n">e</span><span class="p">.</span><span class="n">dlnum</span><span class="o">+</span><span class="mi">9</span><span class="p">,</span> <span class="sc">&#39; &#39;</span> <span class="p">)</span> <span class="o">%</span> <span class="n">e</span><span class="p">.</span><span class="n">underline</span> <span class="o">%</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<a name="line-147"></a>    <span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="nl">m</span> <span class="p">:</span> <span class="n">e</span><span class="p">.</span><span class="n">msg</span><span class="p">)</span> <span class="n">print</span> <span class="o">%</span> <span class="s">&quot;&gt;&gt;&gt; &quot;</span> <span class="o">%</span> <span class="n">m</span> <span class="o">%</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<a name="line-148"></a>    <span class="n">print</span> <span class="o">%</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<a name="line-149"></a>  <span class="p">}</span>
<a name="line-150"></a>
<a name="line-151"></a>  <span class="c1">// Exit if there were any errors</span>
<a name="line-152"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="n">Throw</span><span class="p">(</span> <span class="s">&quot;Error(s) occurred while parsing file &quot;</span> <span class="o">+</span> <span class="n">m_filename</span> <span class="p">);</span>
<a name="line-153"></a><span class="p">}</span>
</pre></div>
</td></tr></table>
      </div>
      <div id="footer">
        <p>
         Cppcheck 1.83 - a tool for static C/C++ code analysis</br>
         </br>
         Internet: <a href="http://cppcheck.net">http://cppcheck.net</a></br>
         IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a></br>
        <p>
      </div>
  </body>
</html>
