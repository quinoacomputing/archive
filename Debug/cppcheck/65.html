
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [<a href="https://github.com/quinoacomputing/quinoa/commit/ea83c66">Quinoa_v0.2-1040-gea83c66</a>]</title>
    <link rel="stylesheet" href="style.css">
    <style>
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script language="javascript">
      function getStyle(el,styleProp) {
        if (el.currentStyle)
          var y = el.currentStyle[styleProp];
        else if (window.getComputedStyle)
          var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
        return y;
      }
      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;
        if (el.style.display == "block") {
          el.style.display = "none";
          mark.innerHTML = "[+]";
        } else {
          el.style.display = "block";
          mark.innerHTML = "[-]";
        }
      }
      function init_expandables() {
        var elts = document.getElementsByClassName("expandable");
        for (var i = 0; i < elts.length; i++) {
          var el = elts[i];
          var clickable = el.getElementsByTagName("span")[0];
          var marker = clickable.getElementsByClassName("marker")[0];
          var content = el.getElementsByClassName("content")[0];
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.onclick = toggle;
        }
      }
      function set_class_display(c, st) {
        var elements = document.querySelectorAll('.' + c),
            len = elements.length;
        for (i = 0; i < len; i++) {
            elements[i].style.display = st;
        }
      }
      function toggle_class_visibility(id) {
        var box = document.getElementById(id);
        set_class_display(id, box.checked ? '' : 'none');
      }
    </script>
  </head>
  <body onload="init_expandables()">
      <div id="header">
        <h1>Cppcheck report - [<a href="https://github.com/quinoacomputing/quinoa/commit/ea83c66">Quinoa_v0.2-1040-gea83c66</a>]: /tmp/TeamCity-14/work/821a9fd6f64749d9/src/LoadBalance/ZoltanInterOp.C </h1>
      </div>
      <div id="menu" dir="rtl">
       <p id="filename"><a href="index.html">Defects:</a> ZoltanInterOp.C</p>
<a href='65.html#line-52'> unusedFunction 52</a><a href='65.html#line-58'> unusedFunction 58</a><a href='65.html#line-63'> unusedFunction 63</a><a href='65.html#line-69'> unusedFunction 69</a><a href='65.html#line-80'> unusedFunction 80</a>
      </div>
      <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="c1">// *****************************************************************************</span>
<a name="line-2"></a><span class="cm">/*!</span>
<a name="line-3"></a><span class="cm">  \file      src/LoadBalance/ZoltanInterOp.C</span>
<a name="line-4"></a><span class="cm">  \copyright 2012-2015, J. Bakosi, 2016-2018, Los Alamos National Security, LLC.</span>
<a name="line-5"></a><span class="cm">  \brief     Interoperation with the Zoltan library</span>
<a name="line-6"></a><span class="cm">  \details   Interoperation with the Zoltan library, used for static mesh graph</span>
<a name="line-7"></a><span class="cm">    partitioning.</span>
<a name="line-8"></a><span class="cm">*/</span>
<a name="line-9"></a><span class="c1">// *****************************************************************************</span>
<a name="line-10"></a>
<a name="line-11"></a><span class="cp">#include</span> <span class="cpf">&quot;NoWarning/Zoltan2_MeshAdapter.h&quot;</span><span class="cp"></span>
<a name="line-12"></a><span class="cp">#include</span> <span class="cpf">&quot;NoWarning/Zoltan2_PartitioningProblem.h&quot;</span><span class="cp"></span>
<a name="line-13"></a><span class="cp">#include</span> <span class="cpf">&lt;Zoltan2_PartitioningSolution.hpp&gt;</span><span class="cp"></span>
<a name="line-14"></a>
<a name="line-15"></a><span class="cp">#include</span> <span class="cpf">&quot;ZoltanInterOp.h&quot;</span><span class="cp"></span>
<a name="line-16"></a>
<a name="line-17"></a><span class="k">namespace</span> <span class="n">tk</span> <span class="p">{</span>
<a name="line-18"></a><span class="k">namespace</span> <span class="n">zoltan</span> <span class="p">{</span>
<a name="line-19"></a>
<a name="line-20"></a><span class="c1">//! GeometricMeshElemAdapter : Zoltan2::MeshAdapter</span>
<a name="line-21"></a><span class="c1">//! \details GeometricMeshElemAdapter specializes those virtual member functions</span>
<a name="line-22"></a><span class="c1">//!   of Zoltan2::MeshAdapter that are required for mesh-element-based</span>
<a name="line-23"></a><span class="c1">//!   geometric partitioning with Zoltan2</span>
<a name="line-24"></a><span class="k">template</span><span class="o">&lt;</span> <span class="k">typename</span> <span class="n">ZoltanTypes</span> <span class="o">&gt;</span>
<a name="line-25"></a><span class="k">class</span> <span class="nc">GeometricMeshElemAdapter</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Zoltan2</span><span class="o">::</span><span class="n">MeshAdapter</span><span class="o">&lt;</span> <span class="n">ZoltanTypes</span> <span class="o">&gt;</span> <span class="p">{</span>
<a name="line-26"></a>
<a name="line-27"></a>  <span class="k">private</span><span class="o">:</span>
<a name="line-28"></a>    <span class="k">using</span> <span class="n">MeshEntityType</span> <span class="o">=</span> <span class="n">Zoltan2</span><span class="o">::</span><span class="n">MeshEntityType</span><span class="p">;</span>
<a name="line-29"></a>    <span class="k">using</span> <span class="n">EntityTopologyType</span> <span class="o">=</span> <span class="n">Zoltan2</span><span class="o">::</span><span class="n">EntityTopologyType</span><span class="p">;</span>
<a name="line-30"></a>
<a name="line-31"></a>  <span class="k">public</span><span class="o">:</span>
<a name="line-32"></a>    <span class="k">using</span> <span class="n">gno_t</span> <span class="o">=</span> <span class="k">typename</span> <span class="n">Zoltan2</span><span class="o">::</span><span class="n">InputTraits</span><span class="o">&lt;</span> <span class="n">ZoltanTypes</span> <span class="o">&gt;::</span><span class="n">gno_t</span><span class="p">;</span>
<a name="line-33"></a>    <span class="k">using</span> <span class="n">scalar_t</span> <span class="o">=</span> <span class="k">typename</span> <span class="n">Zoltan2</span><span class="o">::</span><span class="n">InputTraits</span><span class="o">&lt;</span> <span class="n">ZoltanTypes</span> <span class="o">&gt;::</span><span class="n">scalar_t</span><span class="p">;</span>
<a name="line-34"></a>    <span class="k">using</span> <span class="n">base_adapter_t</span> <span class="o">=</span> <span class="n">Zoltan2</span><span class="o">::</span><span class="n">MeshAdapter</span><span class="o">&lt;</span> <span class="n">ZoltanTypes</span> <span class="o">&gt;</span><span class="p">;</span>
<a name="line-35"></a>
<a name="line-36"></a>    <span class="c1">//! Constructor</span>
<a name="line-37"></a>    <span class="c1">//! \param[in] nelem Number of elements in mesh graph on this rank</span>
<a name="line-38"></a>    <span class="c1">//! \param[in] centroid Mesh element coordinates (centroids)</span>
<a name="line-39"></a>    <span class="c1">//! \param[in] elemid Mesh element global IDs</span>
<a name="line-40"></a>    <span class="n">GeometricMeshElemAdapter</span><span class="p">(</span>
<a name="line-41"></a>      <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">nelem</span><span class="p">,</span>
<a name="line-42"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;&amp;</span> <span class="n">centroid</span><span class="p">,</span>
<a name="line-43"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">long</span> <span class="o">&gt;&amp;</span> <span class="n">elemid</span> <span class="p">)</span>
<a name="line-44"></a>    <span class="o">:</span> <span class="n">m_nelem</span><span class="p">(</span> <span class="n">nelem</span> <span class="p">),</span>
<a name="line-45"></a>      <span class="n">m_topology</span><span class="p">(</span> <span class="n">EntityTopologyType</span><span class="o">::</span><span class="n">TETRAHEDRON</span> <span class="p">),</span>
<a name="line-46"></a>      <span class="n">m_centroid</span><span class="p">(</span> <span class="n">centroid</span> <span class="p">),</span>
<a name="line-47"></a>      <span class="n">m_elemid</span><span class="p">(</span> <span class="n">elemid</span> <span class="p">)</span>
<a name="line-48"></a>    <span class="p">{}</span>
<a name="line-49"></a>
<a name="line-50"></a>    <span class="c1">//! Returns the number of mesh entities on this rank</span>
<a name="line-51"></a>    <span class="c1">//! \return Number of mesh elements on this rank</span>
<a name="line-52"></a><span class="hll">    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">getLocalNumOf</span><span class="p">(</span> <span class="n">MeshEntityType</span> <span class="p">)</span> <span class="k">const</span> <span class="k">override</span><span class='error2'>&lt;--- The function 'getLocalNumOf' is never used.</span>
</span><a name="line-53"></a>    <span class="p">{</span> <span class="k">return</span> <span class="n">m_nelem</span><span class="p">;</span> <span class="p">}</span>
<a name="line-54"></a>
<a name="line-55"></a>    <span class="c1">//! Provide a pointer to this rank&#39;s identifiers</span>
<a name="line-56"></a>    <span class="c1">//! \param[in,out] Ids Pointer to the list of global element Ids on this</span>
<a name="line-57"></a>    <span class="c1">//!   rank</span>
<a name="line-58"></a><span class="hll">    <span class="kt">void</span> <span class="n">getIDsViewOf</span><span class="p">(</span> <span class="n">MeshEntityType</span><span class="p">,</span> <span class="k">const</span> <span class="n">gno_t</span><span class="o">*&amp;</span> <span class="n">Ids</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span><span class='error2'>&lt;--- The function 'getIDsViewOf' is never used.</span>
</span><a name="line-59"></a>    <span class="p">{</span> <span class="n">Ids</span> <span class="o">=</span> <span class="n">m_elemid</span><span class="p">.</span><span class="n">data</span><span class="p">();</span> <span class="p">}</span>
<a name="line-60"></a>
<a name="line-61"></a>    <span class="c1">//! Provide a pointer to the entity topology types</span>
<a name="line-62"></a>    <span class="c1">//! \param Types Pointer to the list of entity topology types on this rank</span>
<a name="line-63"></a><span class="hll">    <span class="kt">void</span> <span class="n">getTopologyViewOf</span><span class="p">(</span> <span class="n">MeshEntityType</span><span class="p">,</span><span class='error2'>&lt;--- The function 'getTopologyViewOf' is never used.</span>
</span><a name="line-64"></a>                            <span class="k">const</span> <span class="n">EntityTopologyType</span><span class="o">*&amp;</span> <span class="n">Types</span> <span class="p">)</span> <span class="k">const</span> <span class="k">override</span>
<a name="line-65"></a>    <span class="p">{</span> <span class="n">Types</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">m_topology</span><span class="p">;</span> <span class="p">}</span>
<a name="line-66"></a>
<a name="line-67"></a>    <span class="c1">//! Return dimensionality of the mesh</span>
<a name="line-68"></a>    <span class="c1">//! \return Number of mesh dimension</span>
<a name="line-69"></a><span class="hll">    <span class="kt">int</span> <span class="n">getDimension</span><span class="p">()</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">3</span><span class="p">;</span> <span class="p">}</span><span class='error2'>&lt;--- The function 'getDimension' is never used.</span>
</span><a name="line-70"></a>
<a name="line-71"></a>    <span class="c1">//! Provide a pointer to one dimension of mesh element coordinates</span>
<a name="line-72"></a>    <span class="c1">//! \param[in] coords Pointer to a list of coordinate values for the</span>
<a name="line-73"></a>    <span class="c1">//!   dimension</span>
<a name="line-74"></a>    <span class="c1">//! \param[in,out] stride Describes the layout of the coordinate values in</span>
<a name="line-75"></a>    <span class="c1">//!   the coords list. If stride is one, then the ith coordinate value is</span>
<a name="line-76"></a>    <span class="c1">//!   coords[i], but if stride is two, then the ith coordinate value is</span>
<a name="line-77"></a>    <span class="c1">//!   coords[2*i]</span>
<a name="line-78"></a>    <span class="c1">//! \param dim Value from 0 to one less than getEntityCoordinateDimension()</span>
<a name="line-79"></a>    <span class="c1">//!   specifying which dimension is being provided in the coords list</span>
<a name="line-80"></a><span class="hll">    <span class="kt">void</span> <span class="n">getCoordinatesViewOf</span><span class="p">(</span> <span class="n">MeshEntityType</span><span class="p">,</span><span class='error2'>&lt;--- The function 'getCoordinatesViewOf' is never used.</span>
</span><a name="line-81"></a>                               <span class="k">const</span> <span class="n">scalar_t</span><span class="o">*&amp;</span> <span class="n">coords</span><span class="p">,</span>
<a name="line-82"></a>                               <span class="kt">int</span> <span class="o">&amp;</span><span class="n">stride</span><span class="p">,</span>
<a name="line-83"></a>                               <span class="kt">int</span> <span class="n">dim</span> <span class="p">)</span> <span class="k">const</span> <span class="k">override</span>
<a name="line-84"></a>    <span class="p">{</span>
<a name="line-85"></a>      <span class="n">coords</span> <span class="o">=</span> <span class="n">m_centroid</span><span class="p">[</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="p">].</span><span class="n">data</span><span class="p">();</span>
<a name="line-86"></a>      <span class="n">stride</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<a name="line-87"></a>    <span class="p">}</span>
<a name="line-88"></a>
<a name="line-89"></a>  <span class="k">private</span><span class="o">:</span>
<a name="line-90"></a>    <span class="c1">//! Number of elements on this rank</span>
<a name="line-91"></a>    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nelem</span><span class="p">;</span>
<a name="line-92"></a>    <span class="c1">//! Mesh element topology types</span>
<a name="line-93"></a>    <span class="k">const</span> <span class="n">EntityTopologyType</span> <span class="n">m_topology</span><span class="p">;</span>
<a name="line-94"></a>    <span class="c1">//! Mesh element coordinates (centroids)</span>
<a name="line-95"></a>    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;&amp;</span> <span class="n">m_centroid</span><span class="p">;</span>
<a name="line-96"></a>    <span class="c1">//! Global mesh element ids</span>
<a name="line-97"></a>    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">long</span> <span class="o">&gt;&amp;</span> <span class="n">m_elemid</span><span class="p">;</span>
<a name="line-98"></a><span class="p">};</span>
<a name="line-99"></a>
<a name="line-100"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span>
<a name="line-101"></a><span class="n">geomPartMesh</span><span class="p">(</span> <span class="n">tk</span><span class="o">::</span><span class="n">ctr</span><span class="o">::</span><span class="n">PartitioningAlgorithmType</span> <span class="n">algorithm</span><span class="p">,</span>
<a name="line-102"></a>              <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;&amp;</span> <span class="n">centroid</span><span class="p">,</span>
<a name="line-103"></a>              <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">long</span> <span class="o">&gt;&amp;</span> <span class="n">elemid</span><span class="p">,</span>
<a name="line-104"></a>              <span class="kt">int</span> <span class="n">npart</span> <span class="p">)</span>
<a name="line-105"></a><span class="c1">// *****************************************************************************</span>
<a name="line-106"></a><span class="c1">//  Partition mesh using Zoltan2 with a geometric partitioner, such as RCB, RIB</span>
<a name="line-107"></a><span class="c1">//! \param[in] algorithm Partitioning algorithm type</span>
<a name="line-108"></a><span class="c1">//! \param[in] centroid Mesh element coordinates</span>
<a name="line-109"></a><span class="c1">//! \param[in] elemid Global mesh element ids</span>
<a name="line-110"></a><span class="c1">//! \param[in] npart Number of desired graph partitions</span>
<a name="line-111"></a><span class="c1">//! \return Array of chare ownership IDs mapping graph points to concurrent</span>
<a name="line-112"></a><span class="c1">//!   async chares</span>
<a name="line-113"></a><span class="c1">//! \details This function uses Zoltan to partition the mesh graph in parallel.</span>
<a name="line-114"></a><span class="c1">//!   It assumes that the mesh graph is distributed among all the MPI ranks.</span>
<a name="line-115"></a><span class="c1">// *****************************************************************************</span>
<a name="line-116"></a><span class="p">{</span>
<a name="line-117"></a>  <span class="c1">// Set Zoltan parameters</span>
<a name="line-118"></a>  <span class="n">Teuchos</span><span class="o">::</span><span class="n">ParameterList</span> <span class="n">params</span><span class="p">(</span> <span class="s">&quot;Zoltan parameters&quot;</span> <span class="p">);</span>
<a name="line-119"></a>  <span class="n">params</span><span class="p">.</span><span class="n">set</span><span class="p">(</span> <span class="s">&quot;algorithm&quot;</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">ctr</span><span class="o">::</span><span class="n">PartitioningAlgorithm</span><span class="p">().</span><span class="n">param</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span> <span class="p">);</span>
<a name="line-120"></a>  <span class="n">params</span><span class="p">.</span><span class="n">set</span><span class="p">(</span> <span class="s">&quot;num_global_parts&quot;</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">npart</span><span class="p">)</span> <span class="p">);</span>
<a name="line-121"></a>  <span class="n">params</span><span class="p">.</span><span class="n">set</span><span class="p">(</span> <span class="s">&quot;objects_to_partition&quot;</span><span class="p">,</span> <span class="s">&quot;mesh_elements&quot;</span> <span class="p">);</span>
<a name="line-122"></a>
<a name="line-123"></a>  <span class="c1">// Define types for Zoltan2</span>
<a name="line-124"></a>  <span class="c1">//  * 1st argument, &#39;scalar&#39;: the data type for element values, weights and</span>
<a name="line-125"></a>  <span class="c1">//    coordinates</span>
<a name="line-126"></a>  <span class="c1">//  * 2nd argument, &#39;lno&#39; (local number): the integral data type used by</span>
<a name="line-127"></a>  <span class="c1">//    the application, i.e, quinoa, and by Zoltan2 for local indices and local</span>
<a name="line-128"></a>  <span class="c1">//    counts</span>
<a name="line-129"></a>  <span class="c1">//  * 3rd argument &#39;gno&#39; (global number): is the integral data type used by</span>
<a name="line-130"></a>  <span class="c1">//    the application, i.e., quinoa, and Zoltan2 to represent global</span>
<a name="line-131"></a>  <span class="c1">//    identifiers and global counts</span>
<a name="line-132"></a>  <span class="c1">// See also</span>
<a name="line-133"></a>  <span class="c1">// tpl/src/trilinos/packages/zoltan2/src/input/Zoltan2_InputTraits.hpp</span>
<a name="line-134"></a>  <span class="k">using</span> <span class="n">ZoltanTypes</span> <span class="o">=</span> <span class="n">Zoltan2</span><span class="o">::</span><span class="n">BasicUserTypes</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="p">,</span> <span class="kt">long</span><span class="p">,</span> <span class="kt">long</span> <span class="o">&gt;</span><span class="p">;</span>
<a name="line-135"></a>
<a name="line-136"></a>  <span class="c1">// Create mesh adapter for Zoltan for mesh element partitioning</span>
<a name="line-137"></a>  <span class="k">using</span> <span class="n">InciterZoltanAdapter</span> <span class="o">=</span> <span class="n">GeometricMeshElemAdapter</span><span class="o">&lt;</span> <span class="n">ZoltanTypes</span> <span class="o">&gt;</span><span class="p">;</span>
<a name="line-138"></a>  <span class="n">InciterZoltanAdapter</span> <span class="nf">adapter</span><span class="p">(</span> <span class="n">elemid</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">centroid</span><span class="p">,</span> <span class="n">elemid</span> <span class="p">);</span>
<a name="line-139"></a>
<a name="line-140"></a>  <span class="c1">// Create Zoltan2 partitioning problem using our mesh input adapter</span>
<a name="line-141"></a>  <span class="n">Zoltan2</span><span class="o">::</span><span class="n">PartitioningProblem</span><span class="o">&lt;</span> <span class="n">InciterZoltanAdapter</span> <span class="o">&gt;</span>
<a name="line-142"></a>    <span class="n">partitioner</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">adapter</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">params</span> <span class="p">);</span>
<a name="line-143"></a>
<a name="line-144"></a>  <span class="c1">// Perform partitioning using Zoltan</span>
<a name="line-145"></a>  <span class="n">partitioner</span><span class="p">.</span><span class="n">solve</span><span class="p">();</span>
<a name="line-146"></a>
<a name="line-147"></a>  <span class="c1">// Copy over array of chare IDs corresponding to the ownership of elements</span>
<a name="line-148"></a>  <span class="c1">// in our chunk of the mesh graph, i.e., the coloring or chare ids for the</span>
<a name="line-149"></a>  <span class="c1">// mesh elements we operated on</span>
<a name="line-150"></a>  <span class="k">auto</span> <span class="n">partlist</span> <span class="o">=</span> <span class="n">partitioner</span><span class="p">.</span><span class="n">getSolution</span><span class="p">().</span><span class="n">getPartListView</span><span class="p">();</span>
<a name="line-151"></a>  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">chare</span><span class="p">(</span> <span class="n">elemid</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="p">);</span>
<a name="line-152"></a>  <span class="k">for</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">p</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">p</span><span class="o">&lt;</span><span class="n">elemid</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">p</span> <span class="p">)</span>
<a name="line-153"></a>    <span class="n">chare</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">partlist</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="p">);</span>
<a name="line-154"></a>
<a name="line-155"></a>  <span class="k">return</span> <span class="n">chare</span><span class="p">;</span>
<a name="line-156"></a><span class="p">}</span>
<a name="line-157"></a>
<a name="line-158"></a><span class="p">}</span> <span class="c1">// zoltan::</span>
<a name="line-159"></a><span class="p">}</span> <span class="c1">// tk::</span>
</pre></div>
</td></tr></table>
      </div>
      <div id="footer">
        <p>
         Cppcheck 1.83 - a tool for static C/C++ code analysis</br>
         </br>
         Internet: <a href="http://cppcheck.net">http://cppcheck.net</a></br>
         IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a></br>
        <p>
      </div>
  </body>
</html>
