
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [<a href="https://github.com/quinoacomputing/quinoa/commit/5d5ec27">Quinoa_v0.2-1523-g5d5ec27</a>]</title>
    <link rel="stylesheet" href="style.css">
    <style>
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script language="javascript">
      function getStyle(el,styleProp) {
        if (el.currentStyle)
          var y = el.currentStyle[styleProp];
        else if (window.getComputedStyle)
          var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
        return y;
      }
      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;
        if (el.style.display == "block") {
          el.style.display = "none";
          mark.innerHTML = "[+]";
        } else {
          el.style.display = "block";
          mark.innerHTML = "[-]";
        }
      }
      function init_expandables() {
        var elts = document.getElementsByClassName("expandable");
        for (var i = 0; i < elts.length; i++) {
          var el = elts[i];
          var clickable = el.getElementsByTagName("span")[0];
          var marker = clickable.getElementsByClassName("marker")[0];
          var content = el.getElementsByClassName("content")[0];
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.onclick = toggle;
        }
      }
      function set_class_display(c, st) {
        var elements = document.querySelectorAll('.' + c),
            len = elements.length;
        for (i = 0; i < len; i++) {
            elements[i].style.display = st;
        }
      }
      function toggle_class_visibility(id) {
        var box = document.getElementById(id);
        set_class_display(id, box.checked ? '' : 'none');
      }
    </script>
  </head>
  <body onload="init_expandables()">
      <div id="header">
        <h1>Cppcheck report - [<a href="https://github.com/quinoacomputing/quinoa/commit/5d5ec27">Quinoa_v0.2-1523-g5d5ec27</a>]: /tmp/TeamCity-14/work/821a9fd6f64749d9/src/LinSys/Solver.h </h1>
      </div>
      <div id="menu" dir="rtl">
       <p id="filename"><a href="index.html">Defects:</a> Solver.h</p>
<a href='39.html#line-64'> noConstructor 64</a>
      </div>
      <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="c1">// *****************************************************************************</span>
<a name="line-2"></a><span class="cm">/*!</span>
<a name="line-3"></a><span class="cm">  \file      src/LinSys/Solver.h</span>
<a name="line-4"></a><span class="cm">  \copyright 2012-2015, J. Bakosi, 2016-2018, Los Alamos National Security, LLC.</span>
<a name="line-5"></a><span class="cm">  \brief     Charm++ chare linear system merger group to solve a linear system</span>
<a name="line-6"></a><span class="cm">  \details   Charm++ chare linear system merger group used to collect and</span>
<a name="line-7"></a><span class="cm">    assemble the left hand side matrix (lhs), the right hand side (rhs) vector,</span>
<a name="line-8"></a><span class="cm">    and the solution (unknown) vector from individual worker</span>
<a name="line-9"></a><span class="cm">    chares. Beside collection and assembly, the system is also solved. The</span>
<a name="line-10"></a><span class="cm">    solution is outsourced to hypre, an MPI-only library. Once the solution is</span>
<a name="line-11"></a><span class="cm">    available, the individual worker chares are updated with the new solution.</span>
<a name="line-12"></a>
<a name="line-13"></a><span class="cm">    This class assembles and solves two linear systems, whose rhs vectors may</span>
<a name="line-14"></a><span class="cm">    change during time stepping. One of the two linear systems is called a</span>
<a name="line-15"></a><span class="cm">    high-order and the other one is the low-order linear system.</span>
<a name="line-16"></a>
<a name="line-17"></a><span class="cm">    Characteristics of the low-order linear system: (1) the left hand side</span>
<a name="line-18"></a><span class="cm">    matrix is diagonal, (2) the right hand side vector is a combination of the</span>
<a name="line-19"></a><span class="cm">    high-order right hand side vector and another vector, assembled separately</span>
<a name="line-20"></a><span class="cm">    (and overlapped with that of the high-order system). This dual system</span>
<a name="line-21"></a><span class="cm">    solution is done here as required by the flux-corrected transport algorithm</span>
<a name="line-22"></a><span class="cm">    used for transport equations in inciter.</span>
<a name="line-23"></a>
<a name="line-24"></a><span class="cm">    The implementation uses the Charm++ runtime system and is fully</span>
<a name="line-25"></a><span class="cm">    asynchronous, overlapping computation and communication. The algorithm</span>
<a name="line-26"></a><span class="cm">    utilizes the structured dagger (SDAG) Charm++ functionality. The high-level</span>
<a name="line-27"></a><span class="cm">    overview of the algorithm structure and how it interfaces with Charm++ is</span>
<a name="line-28"></a><span class="cm">    discussed in the Charm++ interface file src/LinSys/solver.ci.</span>
<a name="line-29"></a><span class="cm">*/</span>
<a name="line-30"></a><span class="c1">// *****************************************************************************</span>
<a name="line-31"></a><span class="cp">#ifndef Solver_h</span>
<a name="line-32"></a><span class="cp">#define Solver_h</span>
<a name="line-33"></a>
<a name="line-34"></a><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp"></span>
<a name="line-35"></a><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp"></span>
<a name="line-36"></a><span class="cp">#include</span> <span class="cpf">&lt;unordered_map&gt;</span><span class="cp"></span>
<a name="line-37"></a>
<a name="line-38"></a><span class="cp">#include</span> <span class="cpf">&quot;Types.h&quot;</span><span class="cp"></span>
<a name="line-39"></a><span class="cp">#include</span> <span class="cpf">&quot;Tags.h&quot;</span><span class="cp"></span>
<a name="line-40"></a><span class="cp">#include</span> <span class="cpf">&quot;Fields.h&quot;</span><span class="cp"></span>
<a name="line-41"></a><span class="cp">#include</span> <span class="cpf">&quot;TaggedTuple.h&quot;</span><span class="cp"></span>
<a name="line-42"></a><span class="cp">#include</span> <span class="cpf">&quot;HypreMatrix.h&quot;</span><span class="cp"></span>
<a name="line-43"></a><span class="cp">#include</span> <span class="cpf">&quot;HypreVector.h&quot;</span><span class="cp"></span>
<a name="line-44"></a><span class="cp">#include</span> <span class="cpf">&quot;HypreSolver.h&quot;</span><span class="cp"></span>
<a name="line-45"></a>
<a name="line-46"></a><span class="cp">#include</span> <span class="cpf">&quot;NoWarning/solver.decl.h&quot;</span><span class="cp"></span>
<a name="line-47"></a><span class="cp">#include</span> <span class="cpf">&quot;NoWarning/matcg.decl.h&quot;</span><span class="cp"></span>
<a name="line-48"></a>
<a name="line-49"></a><span class="n">namespace</span> <span class="n">tk</span> <span class="p">{</span>
<a name="line-50"></a>
<a name="line-51"></a><span class="c1">//! Solver shadow class used to fire off a reduction different from Solver</span>
<a name="line-52"></a><span class="c1">//! \details Solver shadow class constructor used to fire off a reduction</span>
<a name="line-53"></a><span class="c1">//!   different from Solver to avoid the runtime error &quot;mis-matched client</span>
<a name="line-54"></a><span class="c1">//!   callbacks in reduction messages&quot;</span>
<a name="line-55"></a><span class="n">class</span> <span class="nl">SolverShadow</span> <span class="p">:</span> <span class="n">public</span> <span class="n">CBase_SolverShadow</span> <span class="p">{</span> <span class="nl">public</span><span class="p">:</span> <span class="n">SolverShadow</span><span class="p">();</span> <span class="p">};</span>
<a name="line-56"></a>
<a name="line-57"></a><span class="c1">//! Linear system merger and solver Charm++ chare group class</span>
<a name="line-58"></a><span class="c1">//! \details Instantiations of Solver comprise a processor aware Charm++</span>
<a name="line-59"></a><span class="c1">//!   chare group. When instantiated, a new object is created on each PE and not</span>
<a name="line-60"></a><span class="c1">//!   more (as opposed to individual chares or chare array object elements). The</span>
<a name="line-61"></a><span class="c1">//!   group&#39;s elements are used to collect information from all chare objects</span>
<a name="line-62"></a><span class="c1">//!   that happen to be on a given PE. See also the Charm++ interface file</span>
<a name="line-63"></a><span class="c1">//!   solver.ci.</span>
<a name="line-64"></a><span class="hll"><span class="n">class</span> <span class="nl">Solver</span> <span class="p">:</span> <span class="n">public</span> <span class="n">CBase_Solver</span> <span class="p">{</span><div class='verbose expandable'><span class='error2'>&lt;--- The class 'Solver' does not have a constructor. <span class='marker'>[+]</span></span><div class='content'>The class &apos;Solver&apos; does not have a constructor although it has private member variables. Member variables of builtin types are left uninitialized when the class is instantiated. That may cause bugs or undefined behavior.</div></div>
</span><a name="line-65"></a>
<a name="line-66"></a>  <span class="cp">#if defined(__clang__)</span>
<a name="line-67"></a>    <span class="cp">#pragma clang diagnostic push</span>
<a name="line-68"></a>    <span class="cp">#pragma clang diagnostic ignored &quot;-Wunused-parameter&quot;</span>
<a name="line-69"></a>    <span class="cp">#pragma clang diagnostic ignored &quot;-Wdeprecated-declarations&quot;</span>
<a name="line-70"></a>  <span class="cp">#elif defined(STRICT_GNUC)</span>
<a name="line-71"></a>    <span class="cp">#pragma GCC diagnostic push</span>
<a name="line-72"></a>    <span class="cp">#pragma GCC diagnostic ignored &quot;-Wdeprecated-declarations&quot;</span>
<a name="line-73"></a>    <span class="cp">#pragma GCC diagnostic ignored &quot;-Wunused-parameter&quot;</span>
<a name="line-74"></a>  <span class="cp">#elif defined(__INTEL_COMPILER)</span>
<a name="line-75"></a>    <span class="cp">#pragma warning( push )</span>
<a name="line-76"></a>    <span class="cp">#pragma warning( disable: 1478 )</span>
<a name="line-77"></a>  <span class="cp">#endif</span>
<a name="line-78"></a>  <span class="c1">// Include Charm++ SDAG code. See http://charm.cs.illinois.edu/manuals/html/</span>
<a name="line-79"></a>  <span class="c1">// charm++/manual.html, Sec. &quot;Structured Control Flow: Structured Dagger&quot;.</span>
<a name="line-80"></a>  <span class="n">Solver_SDAG_CODE</span>
<a name="line-81"></a>  <span class="cp">#if defined(__clang__)</span>
<a name="line-82"></a>    <span class="cp">#pragma clang diagnostic pop</span>
<a name="line-83"></a>  <span class="cp">#elif defined(STRICT_GNUC)</span>
<a name="line-84"></a>    <span class="cp">#pragma GCC diagnostic pop</span>
<a name="line-85"></a>  <span class="cp">#elif defined(__INTEL_COMPILER)</span>
<a name="line-86"></a>    <span class="cp">#pragma warning( pop )</span>
<a name="line-87"></a>  <span class="cp">#endif</span>
<a name="line-88"></a>
<a name="line-89"></a>  <span class="nl">public</span><span class="p">:</span>
<a name="line-90"></a>    <span class="c1">//! Constructor</span>
<a name="line-91"></a>    <span class="n">Solver</span><span class="p">(</span> <span class="n">CProxy_SolverShadow</span> <span class="n">sh</span><span class="p">,</span>
<a name="line-92"></a>            <span class="k">const</span> <span class="n">SolverCallback</span><span class="o">&amp;</span> <span class="n">cb</span><span class="p">,</span>
<a name="line-93"></a>            <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">n</span> <span class="p">);</span>
<a name="line-94"></a>
<a name="line-95"></a>    <span class="c1">//! Configure Charm++ reduction types for concatenating BC nodelists</span>
<a name="line-96"></a>    <span class="k">static</span> <span class="kt">void</span> <span class="nf">registerReducers</span><span class="p">();</span>
<a name="line-97"></a>
<a name="line-98"></a>    <span class="c1">//!  Receive lower and upper global node IDs from chares</span>
<a name="line-99"></a>    <span class="c1">//! \note This is not a Charm++ entry method but public because it is called</span>
<a name="line-100"></a>    <span class="c1">//!    by chares on this PE.</span>
<a name="line-101"></a>    <span class="kt">void</span> <span class="nf">chbounds</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">lower</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">upper</span> <span class="p">);</span>
<a name="line-102"></a>
<a name="line-103"></a>    <span class="c1">//!  Compute lower and upper bounds across all PEs</span>
<a name="line-104"></a>    <span class="kt">void</span> <span class="nf">pebounds</span><span class="p">(</span> <span class="kt">int</span> <span class="n">p</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">lower</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">upper</span> <span class="p">);</span>
<a name="line-105"></a>
<a name="line-106"></a>    <span class="c1">//! Compute lower and upper bounds across PEs</span>
<a name="line-107"></a>    <span class="kt">void</span> <span class="nf">computeBounds</span><span class="p">(</span> <span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">lower</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">upper</span> <span class="p">);</span>
<a name="line-108"></a>
<a name="line-109"></a>    <span class="c1">//! Prepare for next step</span>
<a name="line-110"></a>    <span class="c1">//! Prepare for next step</span>
<a name="line-111"></a>    <span class="kt">void</span> <span class="nf">next</span><span class="p">();</span>
<a name="line-112"></a>
<a name="line-113"></a>    <span class="c1">//! Set number of worker chares expected to contribute on my PE</span>
<a name="line-114"></a>    <span class="kt">void</span> <span class="nf">nchare</span><span class="p">(</span> <span class="kt">int</span> <span class="n">n</span> <span class="p">);</span>
<a name="line-115"></a>
<a name="line-116"></a>    <span class="c1">//! Chares contribute their global row ids for establishing communications</span>
<a name="line-117"></a>    <span class="kt">void</span> <span class="nf">charecom</span><span class="p">(</span> <span class="k">const</span> <span class="n">inciter</span><span class="o">::</span><span class="n">CProxy_MatCG</span><span class="o">&amp;</span> <span class="n">worker</span><span class="p">,</span>
<a name="line-118"></a>                   <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-119"></a>                   <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">row</span> <span class="p">);</span>
<a name="line-120"></a>
<a name="line-121"></a>    <span class="c1">//! Signal the runtime system that the workers have been created</span>
<a name="line-122"></a>    <span class="kt">void</span> <span class="nf">created</span><span class="p">();</span>
<a name="line-123"></a>
<a name="line-124"></a>    <span class="c1">//! Receive global row ids from fellow group branches</span>
<a name="line-125"></a>    <span class="kt">void</span> <span class="nf">addrow</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span> <span class="kt">int</span> <span class="n">frompe</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">row</span> <span class="p">);</span>
<a name="line-126"></a>
<a name="line-127"></a>    <span class="c1">//! Acknowledge received row ids</span>
<a name="line-128"></a>    <span class="kt">void</span> <span class="nf">recrow</span><span class="p">();</span>
<a name="line-129"></a>
<a name="line-130"></a>    <span class="c1">//! Chares contribute their solution nonzero values</span>
<a name="line-131"></a>    <span class="kt">void</span> <span class="nf">charesol</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-132"></a>                   <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">gid</span><span class="p">,</span>
<a name="line-133"></a>                   <span class="k">const</span> <span class="n">Fields</span><span class="o">&amp;</span> <span class="n">solution</span> <span class="p">);</span>
<a name="line-134"></a>
<a name="line-135"></a>    <span class="c1">//! Receive solution vector nonzeros from fellow group branches</span>
<a name="line-136"></a>    <span class="kt">void</span> <span class="nf">addsol</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-137"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span>
<a name="line-138"></a>                                 <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">solution</span> <span class="p">);</span>
<a name="line-139"></a>
<a name="line-140"></a>    <span class="c1">//! Chares contribute their matrix nonzero values</span>
<a name="line-141"></a>    <span class="kt">void</span> <span class="nf">charelhs</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-142"></a>                   <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">gid</span><span class="p">,</span>
<a name="line-143"></a>                   <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span><span class="p">,</span>
<a name="line-144"></a>                                    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">psup</span><span class="p">,</span>
<a name="line-145"></a>                   <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span><span class="o">&amp;</span> <span class="n">lhsd</span><span class="p">,</span>
<a name="line-146"></a>                   <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">Fields</span><span class="o">&amp;</span> <span class="n">lhso</span> <span class="p">);</span>
<a name="line-147"></a>
<a name="line-148"></a>    <span class="c1">//! Receive matrix nonzeros from fellow group branches</span>
<a name="line-149"></a>    <span class="kt">void</span> <span class="nf">addlhs</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-150"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span>
<a name="line-151"></a>                                 <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span>
<a name="line-152"></a>                                           <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">l</span> <span class="p">);</span>
<a name="line-153"></a>
<a name="line-154"></a>    <span class="c1">//! Chares contribute their rhs nonzero values</span>
<a name="line-155"></a>    <span class="kt">void</span> <span class="nf">charerhs</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-156"></a>                   <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">gid</span><span class="p">,</span>
<a name="line-157"></a>                   <span class="k">const</span> <span class="n">Fields</span><span class="o">&amp;</span> <span class="n">r</span> <span class="p">);</span>
<a name="line-158"></a>
<a name="line-159"></a>    <span class="c1">//! Receive+add right-hand side vector nonzeros from fellow group branches</span>
<a name="line-160"></a>    <span class="kt">void</span> <span class="nf">addrhs</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-161"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">r</span> <span class="p">);</span>
<a name="line-162"></a>
<a name="line-163"></a>    <span class="c1">//! Chares contribute to the rhs of the low-order linear system</span>
<a name="line-164"></a>    <span class="kt">void</span> <span class="nf">charelowrhs</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-165"></a>                      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">gid</span><span class="p">,</span>
<a name="line-166"></a>                      <span class="k">const</span> <span class="n">Fields</span><span class="o">&amp;</span> <span class="n">lowrhs</span> <span class="p">);</span>
<a name="line-167"></a>
<a name="line-168"></a>    <span class="c1">//! Receive+add low-order rhs vector nonzeros from fellow group branches</span>
<a name="line-169"></a>    <span class="kt">void</span> <span class="nf">addlowrhs</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-170"></a>                    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span>
<a name="line-171"></a>                                    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">lowrhs</span> <span class="p">);</span>
<a name="line-172"></a>
<a name="line-173"></a>    <span class="c1">//! Chares contribute to the lhs of the low-order linear system</span>
<a name="line-174"></a>    <span class="kt">void</span> <span class="nf">charelowlhs</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-175"></a>                      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">gid</span><span class="p">,</span>
<a name="line-176"></a>                      <span class="k">const</span> <span class="n">Fields</span><span class="o">&amp;</span> <span class="n">lowlhs</span> <span class="p">);</span>
<a name="line-177"></a>
<a name="line-178"></a>    <span class="c1">//! \brief Receive and add lhs vector to the low-order system from fellow</span>
<a name="line-179"></a>    <span class="c1">//!   group branches</span>
<a name="line-180"></a>    <span class="kt">void</span> <span class="nf">addlowlhs</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-181"></a>                    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span>
<a name="line-182"></a>                                    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">lowlhs</span> <span class="p">);</span>
<a name="line-183"></a>
<a name="line-184"></a>    <span class="c1">//! All communications have been establised among PEs</span>
<a name="line-185"></a>    <span class="kt">void</span> <span class="nf">comfinal</span><span class="p">();</span>
<a name="line-186"></a>
<a name="line-187"></a>    <span class="c1">//! Chares query Dirichlet boundary conditions</span>
<a name="line-188"></a>    <span class="c1">//! \note This function does not have to be declared as a Charm++ entry</span>
<a name="line-189"></a>    <span class="c1">//!   method since it is always called by chares on the same PE.</span>
<a name="line-190"></a>    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span>
<a name="line-191"></a>            <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span> <span class="kt">bool</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span>
<a name="line-192"></a>      <span class="n">dirbc</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_bc</span><span class="p">;</span> <span class="p">}</span>
<a name="line-193"></a>
<a name="line-194"></a>    <span class="c1">//! \brief Chares contribute their global row ids and associated Dirichlet</span>
<a name="line-195"></a>    <span class="c1">//!   boundary condition values at which they set BCs</span>
<a name="line-196"></a>    <span class="kt">void</span> <span class="n">charebc</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span>
<a name="line-197"></a>                          <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span> <span class="kt">bool</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">bc</span> <span class="p">);</span>
<a name="line-198"></a>
<a name="line-199"></a>    <span class="c1">//! Reduction target collecting the final aggregated BC node list map</span>
<a name="line-200"></a>    <span class="kt">void</span> <span class="nf">addbc</span><span class="p">(</span> <span class="n">CkReductionMsg</span><span class="o">*</span> <span class="n">msg</span> <span class="p">);</span>
<a name="line-201"></a>
<a name="line-202"></a>    <span class="c1">//! \brief Chares contribute their numerical and analytical solutions</span>
<a name="line-203"></a>    <span class="c1">//!   nonzero values for computing diagnostics</span>
<a name="line-204"></a>    <span class="kt">void</span> <span class="nf">charediag</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-205"></a>                    <span class="kt">uint64_t</span> <span class="n">it</span><span class="p">,</span>
<a name="line-206"></a>                    <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">t</span><span class="p">,</span>
<a name="line-207"></a>                    <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">dt</span><span class="p">,</span>
<a name="line-208"></a>                    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">gid</span><span class="p">,</span>
<a name="line-209"></a>                    <span class="k">const</span> <span class="n">Fields</span><span class="o">&amp;</span> <span class="n">u</span><span class="p">,</span>
<a name="line-210"></a>                    <span class="k">const</span> <span class="n">Fields</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span>
<a name="line-211"></a>                    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;&amp;</span> <span class="n">v</span> <span class="p">);</span>
<a name="line-212"></a>
<a name="line-213"></a>    <span class="c1">//! \brief Receive numerical and analytical solution vector nonzeros from</span>
<a name="line-214"></a>    <span class="c1">//!   fellow group branches for computing diagnostics</span>
<a name="line-215"></a>    <span class="kt">void</span> <span class="nf">adddiag</span><span class="p">(</span> <span class="kt">int</span> <span class="n">fromch</span><span class="p">,</span>
<a name="line-216"></a>                  <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span>
<a name="line-217"></a>                    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">solution</span> <span class="p">);</span>
<a name="line-218"></a>
<a name="line-219"></a>    <span class="c1">//! Return processing element for global mesh row id</span>
<a name="line-220"></a>    <span class="kt">int</span> <span class="nf">pe</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">gid</span> <span class="p">);</span>
<a name="line-221"></a>
<a name="line-222"></a>  <span class="nl">private</span><span class="p">:</span>
<a name="line-223"></a>    <span class="n">CProxy_SolverShadow</span> <span class="n">m_shadow</span><span class="p">;</span>
<a name="line-224"></a>    <span class="n">SolverCallback</span> <span class="n">m_cb</span><span class="p">;</span>        <span class="c1">//!&lt; Charm++ associated to compile-time tags</span>
<a name="line-225"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_ncomp</span><span class="p">;</span>       <span class="c1">//!&lt; Number of scalar components per unknown</span>
<a name="line-226"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nchare</span><span class="p">;</span>      <span class="c1">//!&lt; Number of chares contributing to my PE</span>
<a name="line-227"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nbounds</span><span class="p">;</span>     <span class="c1">//!&lt; Number of chares contributed bounds to my PE</span>
<a name="line-228"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_ncomm</span><span class="p">;</span>       <span class="c1">//!&lt; Number of chares finished commaps on my PE</span>
<a name="line-229"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nperow</span><span class="p">;</span>      <span class="c1">//!&lt; Number of fellow PEs to send row ids to</span>
<a name="line-230"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nchbc</span><span class="p">;</span>       <span class="c1">//!&lt; Number of chares we received bcs from</span>
<a name="line-231"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_lower</span><span class="p">;</span>       <span class="c1">//!&lt; Lower index of the global rows on my PE</span>
<a name="line-232"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_upper</span><span class="p">;</span>       <span class="c1">//!&lt; Upper index of the global rows on my PE</span>
<a name="line-233"></a>    <span class="kt">uint64_t</span> <span class="n">m_it</span><span class="p">;</span>             <span class="c1">//!&lt; Iteration count (original in Discretization)</span>
<a name="line-234"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">m_t</span><span class="p">;</span>              <span class="c1">//!&lt; Physical time (original in Discretization)</span>
<a name="line-235"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">m_dt</span><span class="p">;</span>             <span class="c1">//!&lt; Time step size (original in Discretization)</span>
<a name="line-236"></a>    <span class="kt">bool</span> <span class="n">m_feedback</span><span class="p">;</span>           <span class="c1">//!&lt; Whether to send sub-task feedback to host</span>
<a name="line-237"></a>    <span class="c1">//! Ids of workers on my PE</span>
<a name="line-238"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">m_myworker</span><span class="p">;</span>
<a name="line-239"></a>    <span class="c1">//! \brief Import map associating a list of global row ids to a worker chare</span>
<a name="line-240"></a>    <span class="c1">//!   id during the communication of the global row ids</span>
<a name="line-241"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_rowimport</span><span class="p">;</span>
<a name="line-242"></a>    <span class="c1">//! \brief Import map associating a list of global row ids to a worker chare</span>
<a name="line-243"></a>    <span class="c1">//!   id during the communication of the solution/unknown vector</span>
<a name="line-244"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_solimport</span><span class="p">;</span>
<a name="line-245"></a>    <span class="c1">//! \brief Import map associating a list of global row ids to a worker chare</span>
<a name="line-246"></a>    <span class="c1">//!   id during the communication of the left-hand side matrix</span>
<a name="line-247"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_lhsimport</span><span class="p">;</span>
<a name="line-248"></a>    <span class="c1">//! \brief Import map associating a list of global row ids to a worker chare</span>
<a name="line-249"></a>    <span class="c1">//!   id during the communication of the righ-hand side vector</span>
<a name="line-250"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_rhsimport</span><span class="p">;</span>
<a name="line-251"></a>    <span class="c1">//! \brief Import map associating a list of global row ids to a worker chare</span>
<a name="line-252"></a>    <span class="c1">//!   id during the communication of the low-order rhs vector</span>
<a name="line-253"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_lowrhsimport</span><span class="p">;</span>
<a name="line-254"></a>    <span class="c1">//! \brief Import map associating a list of global row ids to a worker chare</span>
<a name="line-255"></a>    <span class="c1">//!   id during the communication of the low-order lhs vector</span>
<a name="line-256"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_lowlhsimport</span><span class="p">;</span>
<a name="line-257"></a>    <span class="c1">//! Part of global row indices owned by my PE</span>
<a name="line-258"></a>    <span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_row</span><span class="p">;</span>
<a name="line-259"></a>    <span class="c1">//! \brief Part of unknown/solution vector owned by my PE</span>
<a name="line-260"></a>    <span class="c1">//! \details Vector of values (for each scalar equation solved) associated</span>
<a name="line-261"></a>    <span class="c1">//!   to global mesh point row IDs</span>
<a name="line-262"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_sol</span><span class="p">;</span>
<a name="line-263"></a>    <span class="c1">//! \brief Part of left-hand side matrix owned by my PE</span>
<a name="line-264"></a>    <span class="c1">//! \details Nonzero values (for each scalar equation solved) associated to</span>
<a name="line-265"></a>    <span class="c1">//!   global mesh point row and column IDs.</span>
<a name="line-266"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span>
<a name="line-267"></a>              <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_lhs</span><span class="p">;</span>
<a name="line-268"></a>    <span class="c1">//! \brief Part of right-hand side vector owned by my PE</span>
<a name="line-269"></a>    <span class="c1">//! \details Vector of values (for each scalar equation solved) associated</span>
<a name="line-270"></a>    <span class="c1">//!   to global mesh point row ids</span>
<a name="line-271"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_rhs</span><span class="p">;</span>
<a name="line-272"></a>    <span class="c1">//! \brief Part of low-order right-hand side vector owned by my PE</span>
<a name="line-273"></a>    <span class="c1">//! \details Vector of values (for each scalar equation solved) associated</span>
<a name="line-274"></a>    <span class="c1">//!   to global mesh point row ids. This vector collects the rhs</span>
<a name="line-275"></a>    <span class="c1">//!   terms to be combined with the rhs to produce the low-order rhs.</span>
<a name="line-276"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_lowrhs</span><span class="p">;</span>
<a name="line-277"></a>    <span class="c1">//! \brief Part of the low-order system left-hand side vector owned by my PE</span>
<a name="line-278"></a>    <span class="c1">//! \details Vector of values (for each scalar equation solved) associated</span>
<a name="line-279"></a>    <span class="c1">//!   to global mesh point row ids. This vector collects the nonzero values</span>
<a name="line-280"></a>    <span class="c1">//!   of the low-order system lhs &quot;matrix&quot; solution.</span>
<a name="line-281"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_lowlhs</span><span class="p">;</span>
<a name="line-282"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">hypre</span><span class="o">::</span><span class="n">HypreVector</span> <span class="n">m_x</span><span class="p">;</span> <span class="c1">//!&lt; Hypre vector to store the solution/unknowns</span>
<a name="line-283"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">hypre</span><span class="o">::</span><span class="n">HypreMatrix</span> <span class="n">m_A</span><span class="p">;</span> <span class="c1">//!&lt; Hypre matrix to store the left-hand side</span>
<a name="line-284"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">hypre</span><span class="o">::</span><span class="n">HypreVector</span> <span class="n">m_b</span><span class="p">;</span> <span class="c1">//!&lt; Hypre vector to store the right-hand side</span>
<a name="line-285"></a>    <span class="c1">//! Hypre solver</span>
<a name="line-286"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">hypre</span><span class="o">::</span><span class="n">HypreSolver</span> <span class="n">m_solver</span><span class="p">;</span>
<a name="line-287"></a>    <span class="c1">//! Row indices for my PE</span>
<a name="line-288"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">m_hypreRows</span><span class="p">;</span>
<a name="line-289"></a>    <span class="c1">//! Number of matrix columns/rows on my PE</span>
<a name="line-290"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">m_hypreNcols</span><span class="p">;</span>
<a name="line-291"></a>    <span class="c1">//! Matrix column indices for rows on my PE</span>
<a name="line-292"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">m_hypreCols</span><span class="p">;</span>
<a name="line-293"></a>    <span class="c1">//! Matrix nonzero values for my PE</span>
<a name="line-294"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="n">m_hypreMat</span><span class="p">;</span>
<a name="line-295"></a>    <span class="c1">//! RHS vector nonzero values for my PE</span>
<a name="line-296"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="n">m_hypreRhs</span><span class="p">;</span>
<a name="line-297"></a>    <span class="c1">//! Solution vector nonzero values for my PE</span>
<a name="line-298"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="n">m_hypreSol</span><span class="p">;</span>
<a name="line-299"></a>    <span class="c1">//! Global-&gt;local row id map for sending back solution vector parts</span>
<a name="line-300"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_lid</span><span class="p">;</span>
<a name="line-301"></a>    <span class="c1">//! \brief PEs associated to lower and upper global row indices</span>
<a name="line-302"></a>    <span class="c1">//! \details These are the divisions at which the linear system is divided</span>
<a name="line-303"></a>    <span class="c1">//!   along PE boundaries.</span>
<a name="line-304"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span><span class="p">,</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">m_div</span><span class="p">;</span>
<a name="line-305"></a>    <span class="c1">//! \brief PEs associated to global mesh point indices</span>
<a name="line-306"></a>    <span class="c1">//! \details This is used to cache the PE associated to mesh nodes</span>
<a name="line-307"></a>    <span class="c1">//!   communicated, so that a quicker-than-linear-cost search can be used to</span>
<a name="line-308"></a>    <span class="c1">//!   find the PE for a communicated mesh node after the node is in the</span>
<a name="line-309"></a>    <span class="c1">//!   cache.</span>
<a name="line-310"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">m_pe</span><span class="p">;</span>
<a name="line-311"></a>    <span class="c1">//! \brief Values (for each scalar equation solved) of Dirichlet boundary</span>
<a name="line-312"></a>    <span class="c1">//!   conditions assigned to global node IDs we set</span>
<a name="line-313"></a>    <span class="c1">//! \details The map key is the global mesh node/row ID, the value is a</span>
<a name="line-314"></a>    <span class="c1">//!   vector of pairs in which the bool (.first) indicates whether the</span>
<a name="line-315"></a>    <span class="c1">//!   boundary condition value (.second) is set at the given node. The size</span>
<a name="line-316"></a>    <span class="c1">//!   of the vectors is the number of PDEs integrated times the number of</span>
<a name="line-317"></a>    <span class="c1">//!   scalar components in all PDEs. This BC map stores all row IDs at which</span>
<a name="line-318"></a>    <span class="c1">//!   Dirichlet boundary conditions are prescribed, i.e., including boundary</span>
<a name="line-319"></a>    <span class="c1">//!   conditions set across all PEs, not just the ones need to be set on</span>
<a name="line-320"></a>    <span class="c1">//!   this PE.</span>
<a name="line-321"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span>
<a name="line-322"></a>                        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span> <span class="kt">bool</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_bc</span><span class="p">;</span>
<a name="line-323"></a>    <span class="c1">//! Matrix non-zero coefficients for Dirichlet boundary conditions</span>
<a name="line-324"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span>
<a name="line-325"></a>                        <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">tk</span><span class="o">::</span><span class="n">real</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_bca</span><span class="p">;</span>
<a name="line-326"></a>    <span class="c1">//! Worker proxy</span>
<a name="line-327"></a>    <span class="n">inciter</span><span class="o">::</span><span class="n">CProxy_MatCG</span> <span class="n">m_worker</span><span class="p">;</span>
<a name="line-328"></a>
<a name="line-329"></a>    <span class="c1">//! Check if we have done our part in storing and exporting global row ids</span>
<a name="line-330"></a>    <span class="kt">bool</span> <span class="nf">comcomplete</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
<a name="line-331"></a>
<a name="line-332"></a>    <span class="c1">//! Check if our portion of the solution vector values is complete</span>
<a name="line-333"></a>    <span class="kt">bool</span> <span class="nf">solcomplete</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_solimport</span> <span class="o">==</span> <span class="n">m_rowimport</span><span class="p">;</span> <span class="p">}</span>
<a name="line-334"></a>
<a name="line-335"></a>    <span class="c1">//! Check if our portion of the matrix values is complete</span>
<a name="line-336"></a>    <span class="kt">bool</span> <span class="nf">lhscomplete</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_lhsimport</span> <span class="o">==</span> <span class="n">m_rowimport</span><span class="p">;</span> <span class="p">}</span>
<a name="line-337"></a>
<a name="line-338"></a>    <span class="c1">//! Check if our portion of the right-hand side vector values is complete</span>
<a name="line-339"></a>    <span class="kt">bool</span> <span class="nf">rhscomplete</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_rhsimport</span> <span class="o">==</span> <span class="n">m_rowimport</span><span class="p">;</span> <span class="p">}</span>
<a name="line-340"></a>
<a name="line-341"></a>    <span class="c1">//! Check if our portion of the low-order rhs vector values is complete</span>
<a name="line-342"></a>    <span class="kt">bool</span> <span class="nf">lowrhscomplete</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_lowrhsimport</span> <span class="o">==</span> <span class="n">m_rowimport</span><span class="p">;</span> <span class="p">}</span>
<a name="line-343"></a>
<a name="line-344"></a>    <span class="c1">//! Check if our portion of the low-order lhs vector values is complete</span>
<a name="line-345"></a>    <span class="kt">bool</span> <span class="nf">lowlhscomplete</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_lowlhsimport</span> <span class="o">==</span> <span class="n">m_rowimport</span><span class="p">;</span> <span class="p">}</span>
<a name="line-346"></a>
<a name="line-347"></a>    <span class="c1">//! Build Hypre data for our portion of the global row ids</span>
<a name="line-348"></a>    <span class="kt">void</span> <span class="nf">hyprerow</span><span class="p">();</span>
<a name="line-349"></a>
<a name="line-350"></a>    <span class="c1">//! Set boundary conditions on the left-hand side matrix</span>
<a name="line-351"></a>    <span class="kt">void</span> <span class="nf">lhsbc</span><span class="p">();</span>
<a name="line-352"></a>
<a name="line-353"></a>    <span class="c1">//! Set Dirichlet boundary conditions on the right-hand side vector</span>
<a name="line-354"></a>    <span class="kt">void</span> <span class="nf">rhsbc</span><span class="p">();</span>
<a name="line-355"></a>
<a name="line-356"></a>    <span class="c1">//! Build Hypre data for our portion of the solution vector</span>
<a name="line-357"></a>    <span class="kt">void</span> <span class="nf">hypresol</span><span class="p">();</span>
<a name="line-358"></a>
<a name="line-359"></a>    <span class="c1">//! Build Hypre data for our portion of the matrix</span>
<a name="line-360"></a>    <span class="kt">void</span> <span class="nf">hyprelhs</span><span class="p">();</span>
<a name="line-361"></a>
<a name="line-362"></a>    <span class="c1">//! Build Hypre data for our portion of the right-hand side vector</span>
<a name="line-363"></a>    <span class="kt">void</span> <span class="nf">hyprerhs</span><span class="p">();</span>
<a name="line-364"></a>
<a name="line-365"></a>    <span class="c1">//! Set our portion of values of the distributed solution vector</span>
<a name="line-366"></a>    <span class="kt">void</span> <span class="nf">sol</span><span class="p">();</span>
<a name="line-367"></a>
<a name="line-368"></a>    <span class="c1">//! Set our portion of values of the distributed matrix</span>
<a name="line-369"></a>    <span class="kt">void</span> <span class="nf">lhs</span><span class="p">();</span>
<a name="line-370"></a>
<a name="line-371"></a>    <span class="c1">//! Set our portion of values of the distributed right-hand side vector</span>
<a name="line-372"></a>    <span class="kt">void</span> <span class="nf">rhs</span><span class="p">();</span>
<a name="line-373"></a>
<a name="line-374"></a>    <span class="c1">//! Assemble distributed solution vector</span>
<a name="line-375"></a>    <span class="kt">void</span> <span class="nf">assemblesol</span><span class="p">();</span>
<a name="line-376"></a>
<a name="line-377"></a>    <span class="c1">//! Assemble distributed matrix</span>
<a name="line-378"></a>    <span class="kt">void</span> <span class="nf">assemblelhs</span><span class="p">();</span>
<a name="line-379"></a>
<a name="line-380"></a>    <span class="c1">//! Assemble distributed right-hand side vector</span>
<a name="line-381"></a>    <span class="kt">void</span> <span class="nf">assemblerhs</span><span class="p">();</span>
<a name="line-382"></a>
<a name="line-383"></a>    <span class="c1">//! Update solution vector in our PE&#39;s workers</span>
<a name="line-384"></a>    <span class="kt">void</span> <span class="nf">updateSol</span><span class="p">();</span>
<a name="line-385"></a>
<a name="line-386"></a>    <span class="c1">//! Solve hyigh-order linear system</span>
<a name="line-387"></a>    <span class="kt">void</span> <span class="nf">solve</span><span class="p">();</span>
<a name="line-388"></a>
<a name="line-389"></a>    <span class="c1">//! Update low-order solution vector in our PE&#39;s workers</span>
<a name="line-390"></a>    <span class="kt">void</span> <span class="nf">updateLowSol</span><span class="p">();</span>
<a name="line-391"></a>
<a name="line-392"></a>    <span class="c1">//! Solve low-order linear system</span>
<a name="line-393"></a>    <span class="kt">void</span> <span class="nf">lowsolve</span><span class="p">();</span>
<a name="line-394"></a>
<a name="line-395"></a>    <span class="c1">//! Update diagnostics vector</span>
<a name="line-396"></a>    <span class="kt">void</span> <span class="nf">updateDiag</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">row</span><span class="p">,</span>
<a name="line-397"></a>                     <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;&amp;&amp;</span> <span class="n">u</span><span class="p">,</span>
<a name="line-398"></a>                     <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;&amp;&amp;</span> <span class="n">a</span><span class="p">,</span>
<a name="line-399"></a>                     <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">v</span> <span class="p">);</span>
<a name="line-400"></a>
<a name="line-401"></a>    <span class="c1">//! Compute diagnostics (residuals) and contribute them back to host</span>
<a name="line-402"></a>    <span class="kt">void</span> <span class="nf">diagnostics</span><span class="p">();</span>
<a name="line-403"></a><span class="p">};</span>
<a name="line-404"></a>
<a name="line-405"></a><span class="p">}</span> <span class="c1">// tk::</span>
<a name="line-406"></a>
<a name="line-407"></a><span class="cp">#endif </span><span class="c1">// Solver_h</span>
</pre></div>
</td></tr></table>
      </div>
      <div id="footer">
        <p>
         Cppcheck 1.83 - a tool for static C/C++ code analysis</br>
         </br>
         Internet: <a href="http://cppcheck.net">http://cppcheck.net</a></br>
         IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a></br>
        <p>
      </div>
  </body>
</html>
