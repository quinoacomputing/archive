
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [<a href="https://github.com/quinoacomputing/quinoa/commit/a63126c">Quinoa_v0.2-1757-ga63126c</a>]</title>
    <link rel="stylesheet" href="style.css">
    <style>
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script language="javascript">
      function getStyle(el,styleProp) {
        if (el.currentStyle)
          var y = el.currentStyle[styleProp];
        else if (window.getComputedStyle)
          var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
        return y;
      }
      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;
        if (el.style.display == "block") {
          el.style.display = "none";
          mark.innerHTML = "[+]";
        } else {
          el.style.display = "block";
          mark.innerHTML = "[-]";
        }
      }
      function init_expandables() {
        var elts = document.getElementsByClassName("expandable");
        for (var i = 0; i < elts.length; i++) {
          var el = elts[i];
          var clickable = el.getElementsByTagName("span")[0];
          var marker = clickable.getElementsByClassName("marker")[0];
          var content = el.getElementsByClassName("content")[0];
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.onclick = toggle;
        }
      }
      function set_class_display(c, st) {
        var elements = document.querySelectorAll('.' + c),
            len = elements.length;
        for (i = 0; i < len; i++) {
            elements[i].style.display = st;
        }
      }
      function toggle_class_visibility(id) {
        var box = document.getElementById(id);
        set_class_display(id, box.checked ? '' : 'none');
      }
    </script>
  </head>
  <body onload="init_expandables()">
      <div id="header">
        <h1>Cppcheck report - [<a href="https://github.com/quinoacomputing/quinoa/commit/a63126c">Quinoa_v0.2-1757-ga63126c</a>]: /tmp/TeamCity-14/work/821a9fd6f64749d9/src/Inciter/Partitioner.h </h1>
      </div>
      <div id="menu" dir="rtl">
       <p id="filename"><a href="index.html">Defects:</a> Partitioner.h</p>
<a href='39.html#line-38'> noConstructor 38</a><a href='39.html#line-38'> noConstructor 38</a>
      </div>
      <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="c1">// *****************************************************************************</span>
<a name="line-2"></a><span class="cm">/*!</span>
<a name="line-3"></a><span class="cm">  \file      src/Inciter/Partitioner.h</span>
<a name="line-4"></a><span class="cm">  \copyright 2012-2015, J. Bakosi, 2016-2018, Los Alamos National Security, LLC.</span>
<a name="line-5"></a><span class="cm">  \brief     Charm++ chare partitioner group used to perform mesh partitioning</span>
<a name="line-6"></a><span class="cm">  \details   Charm++ chare partitioner group used to perform mesh partitioning.</span>
<a name="line-7"></a><span class="cm">*/</span>
<a name="line-8"></a><span class="c1">// *****************************************************************************</span>
<a name="line-9"></a><span class="cp">#ifndef Partitioner_h</span>
<a name="line-10"></a><span class="cp">#define Partitioner_h</span>
<a name="line-11"></a>
<a name="line-12"></a><span class="cp">#include</span> <span class="cpf">&lt;array&gt;</span><span class="cp"></span>
<a name="line-13"></a><span class="cp">#include</span> <span class="cpf">&lt;stddef.h&gt;</span><span class="cp"></span>
<a name="line-14"></a>
<a name="line-15"></a><span class="cp">#include</span> <span class="cpf">&quot;ContainerUtil.h&quot;</span><span class="cp"></span>
<a name="line-16"></a><span class="cp">#include</span> <span class="cpf">&quot;ZoltanInterOp.h&quot;</span><span class="cp"></span>
<a name="line-17"></a><span class="cp">#include</span> <span class="cpf">&quot;Inciter/InputDeck/InputDeck.h&quot;</span><span class="cp"></span>
<a name="line-18"></a><span class="cp">#include</span> <span class="cpf">&quot;Options/PartitioningAlgorithm.h&quot;</span><span class="cp"></span>
<a name="line-19"></a><span class="cp">#include</span> <span class="cpf">&quot;Solver.h&quot;</span><span class="cp"></span>
<a name="line-20"></a><span class="cp">#include</span> <span class="cpf">&quot;DerivedData.h&quot;</span><span class="cp"></span>
<a name="line-21"></a><span class="cp">#include</span> <span class="cpf">&quot;UnsMesh.h&quot;</span><span class="cp"></span>
<a name="line-22"></a><span class="cp">#include</span> <span class="cpf">&quot;FaceData.h&quot;</span><span class="cp"></span>
<a name="line-23"></a><span class="cp">#include</span> <span class="cpf">&quot;Sorter.h&quot;</span><span class="cp"></span>
<a name="line-24"></a><span class="cp">#include</span> <span class="cpf">&quot;Refiner.h&quot;</span><span class="cp"></span>
<a name="line-25"></a><span class="cp">#include</span> <span class="cpf">&quot;Callback.h&quot;</span><span class="cp"></span>
<a name="line-26"></a>
<a name="line-27"></a><span class="cp">#include</span> <span class="cpf">&quot;NoWarning/partitioner.decl.h&quot;</span><span class="cp"></span>
<a name="line-28"></a>
<a name="line-29"></a><span class="n">namespace</span> <span class="n">inciter</span> <span class="p">{</span>
<a name="line-30"></a>
<a name="line-31"></a><span class="k">extern</span> <span class="n">ctr</span><span class="o">::</span><span class="n">InputDeck</span> <span class="n">g_inputdeck</span><span class="p">;</span>
<a name="line-32"></a>
<a name="line-33"></a><span class="c1">//! Partitioner Charm++ chare group class</span>
<a name="line-34"></a><span class="c1">//! \details Instantiations of Partitioner comprise a processor aware Charm++</span>
<a name="line-35"></a><span class="c1">//!   chare group. When instantiated, a new object is created on each PE and not</span>
<a name="line-36"></a><span class="c1">//!   more (as opposed to individual chares or chare array object elements). See</span>
<a name="line-37"></a><span class="c1">//!   also the Charm++ interface file partitioner.ci.</span>
<a name="line-38"></a><span class="hll"><span class="n">class</span> <span class="nl">Partitioner</span> <span class="p">:</span> <span class="n">public</span> <span class="n">CBase_Partitioner</span> <span class="p">{</span><div class='verbose expandable'><span class='error2'>&lt;--- The class 'Partitioner' does not have a constructor. <span class='marker'>[+]</span></span><div class='content'>The class &apos;Partitioner&apos; does not have a constructor although it has private member variables. Member variables of builtin types are left uninitialized when the class is instantiated. That may cause bugs or undefined behavior.</div></div><div class='verbose expandable'><span class='error2'>&lt;--- The class 'Partitioner' does not have a constructor. <span class='marker'>[+]</span></span><div class='content'>The class &apos;Partitioner&apos; does not have a constructor although it has private member variables. Member variables of builtin types are left uninitialized when the class is instantiated. That may cause bugs or undefined behavior.</div></div>
</span><a name="line-39"></a>
<a name="line-40"></a>  <span class="cp">#if defined(__clang__)</span>
<a name="line-41"></a>    <span class="cp">#pragma clang diagnostic push</span>
<a name="line-42"></a>    <span class="cp">#pragma clang diagnostic ignored &quot;-Wunused-parameter&quot;</span>
<a name="line-43"></a>    <span class="cp">#pragma clang diagnostic ignored &quot;-Wdeprecated-declarations&quot;</span>
<a name="line-44"></a>  <span class="cp">#elif defined(STRICT_GNUC)</span>
<a name="line-45"></a>    <span class="cp">#pragma GCC diagnostic push</span>
<a name="line-46"></a>    <span class="cp">#pragma GCC diagnostic ignored &quot;-Wunused-parameter&quot;</span>
<a name="line-47"></a>    <span class="cp">#pragma GCC diagnostic ignored &quot;-Wdeprecated-declarations&quot;</span>
<a name="line-48"></a>  <span class="cp">#elif defined(__INTEL_COMPILER)</span>
<a name="line-49"></a>    <span class="cp">#pragma warning( push )</span>
<a name="line-50"></a>    <span class="cp">#pragma warning( disable: 1478 )</span>
<a name="line-51"></a>  <span class="cp">#endif</span>
<a name="line-52"></a>  <span class="c1">// Include Charm++ SDAG code. See http://charm.cs.illinois.edu/manuals/html/</span>
<a name="line-53"></a>  <span class="c1">// charm++/manual.html, Sec. &quot;Structured Control Flow: Structured Dagger&quot;.</span>
<a name="line-54"></a>  <span class="n">Partitioner_SDAG_CODE</span>
<a name="line-55"></a>  <span class="cp">#if defined(__clang__)</span>
<a name="line-56"></a>    <span class="cp">#pragma clang diagnostic pop</span>
<a name="line-57"></a>  <span class="cp">#elif defined(STRICT_GNUC)</span>
<a name="line-58"></a>    <span class="cp">#pragma GCC diagnostic pop</span>
<a name="line-59"></a>  <span class="cp">#elif defined(__INTEL_COMPILER)</span>
<a name="line-60"></a>    <span class="cp">#pragma warning( pop )</span>
<a name="line-61"></a>  <span class="cp">#endif</span>
<a name="line-62"></a>
<a name="line-63"></a>  <span class="nl">public</span><span class="p">:</span>
<a name="line-64"></a>    <span class="c1">//! Constructor</span>
<a name="line-65"></a>    <span class="n">Partitioner</span><span class="p">(</span> <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">PartitionerCallback</span><span class="o">&amp;</span> <span class="n">cbp</span><span class="p">,</span>
<a name="line-66"></a>                 <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">RefinerCallback</span><span class="o">&amp;</span> <span class="n">cbr</span><span class="p">,</span>
<a name="line-67"></a>                 <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">SorterCallback</span><span class="o">&amp;</span> <span class="n">cbs</span><span class="p">,</span>
<a name="line-68"></a>                 <span class="k">const</span> <span class="n">CProxy_Transporter</span><span class="o">&amp;</span> <span class="n">host</span><span class="p">,</span>
<a name="line-69"></a>                 <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">CProxy_Solver</span><span class="o">&amp;</span> <span class="n">solver</span><span class="p">,</span>
<a name="line-70"></a>                 <span class="k">const</span> <span class="n">CProxy_Refiner</span><span class="o">&amp;</span> <span class="n">refiner</span><span class="p">,</span>
<a name="line-71"></a>                 <span class="k">const</span> <span class="n">CProxy_Sorter</span><span class="o">&amp;</span> <span class="n">sorter</span><span class="p">,</span>
<a name="line-72"></a>                 <span class="k">const</span> <span class="n">Scheme</span><span class="o">&amp;</span> <span class="n">scheme</span><span class="p">,</span>
<a name="line-73"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">belem</span><span class="p">,</span>
<a name="line-74"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">faces</span><span class="p">,</span>
<a name="line-75"></a>                 <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">bnode</span> <span class="p">);</span>
<a name="line-76"></a>
<a name="line-77"></a>    <span class="c1">//! Turn off automatic load balancing</span>
<a name="line-78"></a>    <span class="kt">void</span> <span class="nf">lboff</span><span class="p">();</span>
<a name="line-79"></a>
<a name="line-80"></a>    <span class="c1">//! Partition the computational mesh into a number of chares</span>
<a name="line-81"></a>    <span class="kt">void</span> <span class="nf">partition</span><span class="p">(</span> <span class="kt">int</span> <span class="n">nchare</span> <span class="p">);</span>
<a name="line-82"></a>
<a name="line-83"></a>    <span class="c1">//! Receive number of uniquely assigned global mesh node IDs from lower PEs</span>
<a name="line-84"></a>    <span class="kt">void</span> <span class="nf">offset</span><span class="p">(</span> <span class="kt">int</span> <span class="n">p</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">u</span> <span class="p">);</span>
<a name="line-85"></a>
<a name="line-86"></a>    <span class="c1">//! Request new global node IDs for old node IDs</span>
<a name="line-87"></a>    <span class="kt">void</span> <span class="nf">request</span><span class="p">(</span> <span class="kt">int</span> <span class="n">p</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_set</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">nd</span> <span class="p">);</span>
<a name="line-88"></a>
<a name="line-89"></a>    <span class="c1">// Request new global node IDs for edges</span>
<a name="line-90"></a>    <span class="kt">void</span> <span class="nf">request</span><span class="p">(</span> <span class="kt">int</span> <span class="n">p</span><span class="p">,</span> <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">EdgeSet</span><span class="o">&amp;</span> <span class="n">ed</span> <span class="p">);</span>
<a name="line-91"></a>
<a name="line-92"></a>    <span class="c1">//! Receive new (reordered) global node IDs and coordinates</span>
<a name="line-93"></a>    <span class="kt">void</span> <span class="nf">neworder</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span>
<a name="line-94"></a>           <span class="n">std</span><span class="o">::</span><span class="n">tuple</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Coord</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">nodes</span> <span class="p">);</span>
<a name="line-95"></a>
<a name="line-96"></a>    <span class="c1">//! Receive mesh elements and their node coordinates after partitioning</span>
<a name="line-97"></a>    <span class="kt">void</span> <span class="nf">addPeMesh</span><span class="p">(</span> <span class="kt">int</span> <span class="n">frompe</span><span class="p">,</span>
<a name="line-98"></a>                    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">inpoel</span><span class="p">,</span>
<a name="line-99"></a>                    <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">CoordMap</span><span class="o">&amp;</span> <span class="n">cm</span> <span class="p">);</span>
<a name="line-100"></a>
<a name="line-101"></a>    <span class="c1">//! Receive mesh associated to chares we own after refinement</span>
<a name="line-102"></a>    <span class="kt">void</span> <span class="nf">addMesh</span><span class="p">(</span> <span class="kt">int</span> <span class="n">frompe</span><span class="p">,</span>
<a name="line-103"></a>                  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span>
<a name="line-104"></a>                          <span class="n">std</span><span class="o">::</span><span class="n">tuple</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span><span class="p">,</span>
<a name="line-105"></a>                            <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">CoordMap</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">chmesh</span> <span class="p">);</span>
<a name="line-106"></a>
<a name="line-107"></a>    <span class="c1">//! Acknowledge received mesh after initial mesh refinement</span>
<a name="line-108"></a>    <span class="kt">void</span> <span class="nf">recvMesh</span><span class="p">();</span>
<a name="line-109"></a>
<a name="line-110"></a>    <span class="c1">//! Optionally start refining the mesh</span>
<a name="line-111"></a>    <span class="kt">void</span> <span class="nf">refine</span><span class="p">();</span>
<a name="line-112"></a>
<a name="line-113"></a>  <span class="nl">private</span><span class="p">:</span>
<a name="line-114"></a>    <span class="c1">//! Charm++ callbacks associated to compile-time tags for partitioner</span>
<a name="line-115"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">PartitionerCallback</span> <span class="n">m_cbp</span><span class="p">;</span>
<a name="line-116"></a>    <span class="c1">//! Charm++ callbacks associated to compile-time tags for refiner</span>
<a name="line-117"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">RefinerCallback</span> <span class="n">m_cbr</span><span class="p">;</span>
<a name="line-118"></a>    <span class="c1">//! Charm++ callbacks associated to compile-time tags for sorter</span>
<a name="line-119"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">SorterCallback</span> <span class="n">m_cbs</span><span class="p">;</span>
<a name="line-120"></a>    <span class="c1">//! Host proxy</span>
<a name="line-121"></a>    <span class="n">CProxy_Transporter</span> <span class="n">m_host</span><span class="p">;</span>
<a name="line-122"></a>    <span class="c1">//! Linear system solver proxy</span>
<a name="line-123"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">CProxy_Solver</span> <span class="n">m_solver</span><span class="p">;</span>
<a name="line-124"></a>    <span class="c1">//! Mesh refiner proxy</span>
<a name="line-125"></a>    <span class="n">CProxy_Refiner</span> <span class="n">m_refiner</span><span class="p">;</span>
<a name="line-126"></a>    <span class="c1">//! Mesh sorter proxy</span>
<a name="line-127"></a>    <span class="n">CProxy_Sorter</span> <span class="n">m_sorter</span><span class="p">;</span>
<a name="line-128"></a>    <span class="c1">//! Discretization scheme</span>
<a name="line-129"></a>    <span class="n">Scheme</span> <span class="n">m_scheme</span><span class="p">;</span>
<a name="line-130"></a>    <span class="c1">//! Element connectivity of this PE&#39;s chunk of the mesh (global ids)</span>
<a name="line-131"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_ginpoel</span><span class="p">;</span>
<a name="line-132"></a>    <span class="c1">//! Coordinates of mesh nodes of this PE&#39;s mesh chunk</span>
<a name="line-133"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Coords</span> <span class="n">m_coord</span><span class="p">;</span>
<a name="line-134"></a>    <span class="c1">//! Element connectivity with local node IDs of this PE&#39;s mesh chunk</span>
<a name="line-135"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_inpoel</span><span class="p">;</span>
<a name="line-136"></a>    <span class="c1">//! Global node IDs of elements of this PE&#39;s mesh chunk</span>
<a name="line-137"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_gid</span><span class="p">;</span>
<a name="line-138"></a>    <span class="c1">//! Global-&gt;local node IDs of elements of this PE&#39;s mesh chunk</span>
<a name="line-139"></a>    <span class="c1">//! \details Key: global node id, value: local node id</span>
<a name="line-140"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_lid</span><span class="p">;</span>
<a name="line-141"></a>    <span class="c1">//! Queue of requested node IDs from PEs</span>
<a name="line-142"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_set</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_reqNodes</span><span class="p">;</span>
<a name="line-143"></a>    <span class="c1">//! \brief Starting global mesh node ID for node reordering on this PE</span>
<a name="line-144"></a>    <span class="c1">//!   during mesh node reordering</span>
<a name="line-145"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_start</span><span class="p">;</span>
<a name="line-146"></a>    <span class="c1">//! Counter during mesh distribution</span>
<a name="line-147"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_ndist</span><span class="p">;</span>
<a name="line-148"></a>    <span class="c1">//! \brief Counter for number of offsets</span>
<a name="line-149"></a>    <span class="c1">//! \details This counts the to-be-received node IDs received while</span>
<a name="line-150"></a>    <span class="c1">//!   computing global mesh node ID offsets for each PE rquired for node</span>
<a name="line-151"></a>    <span class="c1">//!   reordering later</span>
<a name="line-152"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_noffset</span><span class="p">;</span>
<a name="line-153"></a>    <span class="c1">//! \brief Counter for number of queries for global mesh node IDs</span>
<a name="line-154"></a>    <span class="c1">//! \details This counts the number of queries received while</span>
<a name="line-155"></a>    <span class="c1">//!   gathering the node IDs that need to be received (instead of uniquely</span>
<a name="line-156"></a>    <span class="c1">//!   assigned) by each PE</span>
<a name="line-157"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nquery</span><span class="p">;</span>
<a name="line-158"></a>    <span class="c1">//! \brief Counter for number of masks of to-be-received global mesh node</span>
<a name="line-159"></a>    <span class="c1">//!   IDs received</span>
<a name="line-160"></a>    <span class="c1">//! \details This counts the to-be-received node ID masks received while</span>
<a name="line-161"></a>    <span class="c1">//!   gathering the node IDs that need to be received (instead of uniquely</span>
<a name="line-162"></a>    <span class="c1">//!   assigned) by each PE</span>
<a name="line-163"></a>    <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">m_nmask</span><span class="p">;</span>
<a name="line-164"></a>    <span class="c1">//! Coordinates associated to global node IDs of our mesh chunk</span>
<a name="line-165"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">CoordMap</span> <span class="n">m_coordmap</span><span class="p">;</span>
<a name="line-166"></a>    <span class="c1">//! Total number of chares across all PEs</span>
<a name="line-167"></a>    <span class="kt">int</span> <span class="n">m_nchare</span><span class="p">;</span>
<a name="line-168"></a>    <span class="c1">//! Chare IDs (value) associated to global mesh node IDs (key)</span>
<a name="line-169"></a>    <span class="c1">//! \details Multiple chares can contribute to a single node, hence vector</span>
<a name="line-170"></a>    <span class="c1">//!   for map value.</span>
<a name="line-171"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_nodech</span><span class="p">;</span>
<a name="line-172"></a>    <span class="c1">//! \brief Map associating new node IDs (as in producing contiguous-row-id</span>
<a name="line-173"></a>    <span class="c1">//!   linear system contributions) as map-values to old node IDs (as in</span>
<a name="line-174"></a>    <span class="c1">//!   file) as map-keys</span>
<a name="line-175"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_linnodes</span><span class="p">;</span>
<a name="line-176"></a>    <span class="c1">//! Mesh connectivity using global node IDs associated to chares owned</span>
<a name="line-177"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_chinpoel</span><span class="p">;</span>
<a name="line-178"></a>    <span class="c1">//! Coordinates associated to global node IDs of our mesh chunk for chares</span>
<a name="line-179"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">CoordMap</span> <span class="o">&gt;</span> <span class="n">m_chcoordmap</span><span class="p">;</span>
<a name="line-180"></a>    <span class="c1">//! \brief Maps associating old node IDs to new node IDs (as in producing</span>
<a name="line-181"></a>    <span class="c1">//!   contiguous-row-id linear system contributions) categorized by chares.</span>
<a name="line-182"></a>    <span class="c1">//! \details Maps associating old node IDs (as in file) as map-values to new</span>
<a name="line-183"></a>    <span class="c1">//!   node IDs (as in producing contiguous-row-id linear system</span>
<a name="line-184"></a>    <span class="c1">//!   contributions) as map-keys, associated to chare IDs (outer keys).</span>
<a name="line-185"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span>
<a name="line-186"></a>      <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_chfilenodes</span><span class="p">;</span>
<a name="line-187"></a>    <span class="c1">//! Communication cost of linear system merging for our PE</span>
<a name="line-188"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="n">m_cost</span><span class="p">;</span>
<a name="line-189"></a>    <span class="c1">//! \brief Map associating a list of chare IDs to old (as in file) global</span>
<a name="line-190"></a>    <span class="c1">//!   mesh node IDs on the chare boundaries</span>
<a name="line-191"></a>    <span class="c1">//! \details Note that a single global mesh node ID can be associated to</span>
<a name="line-192"></a>    <span class="c1">//!   multiple chare IDs as multiple chares can contribute to a single node.</span>
<a name="line-193"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_bnodechares</span><span class="p">;</span>
<a name="line-194"></a>    <span class="c1">//! \brief Global mesh node IDs associated to chare IDs bordering the mesh</span>
<a name="line-195"></a>    <span class="c1">//!   chunk held by (and associated to) chare IDs this PE owns</span>
<a name="line-196"></a>    <span class="c1">//! \details msum: (M)esh chunks (S)urrounding (M)esh chunks storing mesh</span>
<a name="line-197"></a>    <span class="c1">//!   nodes. Outer map-key: chare IDs this PE owns whose neighbors are</span>
<a name="line-198"></a>    <span class="c1">//!   stored, inner map-key: chare IDs of those chares that hold mesh chunks</span>
<a name="line-199"></a>    <span class="c1">//!   surrounding the outer-key chare&#39;s mesh, map-values: global new</span>
<a name="line-200"></a>    <span class="c1">//!   (reordered, as in producing contiguous-row-id linear system</span>
<a name="line-201"></a>    <span class="c1">//!   contributions) mesh node IDs along the border of chares (at which the</span>
<a name="line-202"></a>    <span class="c1">//!   chares will need to communicate) during time stepping.</span>
<a name="line-203"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span>
<a name="line-204"></a>      <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_set</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_msum</span><span class="p">;</span>
<a name="line-205"></a>    <span class="c1">//! Boundary face IDs associated associated to side set IDs</span>
<a name="line-206"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_bface</span><span class="p">;</span>
<a name="line-207"></a>    <span class="c1">//! Boundary face-node connectivity</span>
<a name="line-208"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="n">m_triinpoel</span><span class="p">;</span>
<a name="line-209"></a>    <span class="c1">//! List of boundary nodes associated to side-set IDs</span>
<a name="line-210"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">m_bnode</span><span class="p">;</span>
<a name="line-211"></a>
<a name="line-212"></a>    <span class="c1">//! Compute element centroid coordinates</span>
<a name="line-213"></a>    <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">tk</span><span class="o">::</span><span class="n">real</span> <span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">&gt;</span>
<a name="line-214"></a>    <span class="n">centroids</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">inpoel</span><span class="p">,</span>
<a name="line-215"></a>               <span class="k">const</span> <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">Coords</span><span class="o">&amp;</span> <span class="n">coord</span> <span class="p">);</span>
<a name="line-216"></a>
<a name="line-217"></a>    <span class="c1">//!  Categorize mesh elements (given by their gobal node IDs) by target</span>
<a name="line-218"></a>    <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;</span>
<a name="line-219"></a>    <span class="n">categorize</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">che</span><span class="p">,</span>
<a name="line-220"></a>                <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">inpoel</span> <span class="p">)</span> <span class="k">const</span><span class="p">;</span>
<a name="line-221"></a>
<a name="line-222"></a>    <span class="c1">//! Extract coordinates associated to global nodes of a mesh chunk</span>
<a name="line-223"></a>    <span class="n">tk</span><span class="o">::</span><span class="n">UnsMesh</span><span class="o">::</span><span class="n">CoordMap</span> <span class="n">coordmap</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">inpoel</span> <span class="p">);</span>
<a name="line-224"></a>
<a name="line-225"></a>    <span class="c1">//! Distribute mesh to target PEs after mesh partitioning</span>
<a name="line-226"></a>    <span class="kt">void</span> <span class="nf">distribute</span><span class="p">(</span>
<a name="line-227"></a>           <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;&amp;</span> <span class="n">elems</span> <span class="p">);</span>
<a name="line-228"></a>
<a name="line-229"></a>    <span class="c1">//! Compute chare (partition) distribution</span>
<a name="line-230"></a>    <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="n">distribution</span><span class="p">(</span> <span class="kt">int</span> <span class="n">npart</span> <span class="p">)</span> <span class="k">const</span><span class="p">;</span>
<a name="line-231"></a>
<a name="line-232"></a>    <span class="c1">//! Return processing element for chare id</span>
<a name="line-233"></a>    <span class="kt">int</span> <span class="nf">pe</span><span class="p">(</span> <span class="kt">int</span> <span class="n">id</span> <span class="p">)</span> <span class="k">const</span><span class="p">;</span>
<a name="line-234"></a>
<a name="line-235"></a>    <span class="c1">//! Keep only those nodes for side sets that reside on this PE</span>
<a name="line-236"></a>    <span class="kt">void</span> <span class="nf">ownBndNodes</span><span class="p">(</span>
<a name="line-237"></a>      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;&amp;</span> <span class="n">lid</span><span class="p">,</span>
<a name="line-238"></a>      <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span> <span class="kt">int</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="o">&gt;</span> <span class="o">&gt;&amp;</span> <span class="n">bnode</span> <span class="p">);</span>
<a name="line-239"></a><span class="p">};</span>
<a name="line-240"></a>
<a name="line-241"></a><span class="p">}</span> <span class="c1">// inciter::</span>
<a name="line-242"></a>
<a name="line-243"></a><span class="cp">#endif </span><span class="c1">// Partitioner_h</span>
</pre></div>
</td></tr></table>
      </div>
      <div id="footer">
        <p>
         Cppcheck 1.83 - a tool for static C/C++ code analysis</br>
         </br>
         Internet: <a href="http://cppcheck.net">http://cppcheck.net</a></br>
         IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a></br>
        <p>
      </div>
  </body>
</html>
