<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quinoa: inciter::FluxCorrector Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quinoa.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceinciter.html">inciter</a></li><li class="navelem"><a class="el" href="classinciter_1_1_flux_corrector.html">FluxCorrector</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classinciter_1_1_flux_corrector-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">inciter::FluxCorrector Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a260166f8f83463a9b99c260d525ef8cd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a260166f8f83463a9b99c260d525ef8cd">FluxCorrector</a> (std::size_t is=0)</td></tr>
<tr class="separator:a260166f8f83463a9b99c260d525ef8cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8ea44becb58f8dd9d0b30f110b73968"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#ac8ea44becb58f8dd9d0b30f110b73968">aec</a> (const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;coord, const std::vector&lt; std::size_t &gt; &amp;inpoel, const std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &amp;vol, const std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; &amp;bc, const std::vector&lt; std::size_t &gt; &amp;gid, const tk::Fields &amp;dUh, const tk::Fields &amp;Un, tk::Fields &amp;P)</td></tr>
<tr class="memdesc:ac8ea44becb58f8dd9d0b30f110b73968"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute antidiffusive element contributions (AEC)  <a href="#ac8ea44becb58f8dd9d0b30f110b73968">More...</a><br /></td></tr>
<tr class="separator:ac8ea44becb58f8dd9d0b30f110b73968"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25aed48b95154ed346b84b539d7acbd1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a25aed48b95154ed346b84b539d7acbd1">verify</a> (std::size_t nchare, const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::Fields &amp;dUh, const tk::Fields &amp;dUl) const</td></tr>
<tr class="memdesc:a25aed48b95154ed346b84b539d7acbd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify the assembled antidiffusive element contributions.  <a href="#a25aed48b95154ed346b84b539d7acbd1">More...</a><br /></td></tr>
<tr class="separator:a25aed48b95154ed346b84b539d7acbd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc0d65b8309fc2f45f07968bcb4e88b1"><td class="memItemLeft" align="right" valign="top">tk::Fields&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#abc0d65b8309fc2f45f07968bcb4e88b1">lump</a> (const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;coord, const std::vector&lt; std::size_t &gt; &amp;inpoel) const</td></tr>
<tr class="memdesc:abc0d65b8309fc2f45f07968bcb4e88b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute lumped mass matrix lhs for low order system.  <a href="#abc0d65b8309fc2f45f07968bcb4e88b1">More...</a><br /></td></tr>
<tr class="separator:abc0d65b8309fc2f45f07968bcb4e88b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c8badb91d36ec42d9951bef40265a42"><td class="memItemLeft" align="right" valign="top">tk::Fields&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a9c8badb91d36ec42d9951bef40265a42">diff</a> (const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;coord, const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::Fields &amp;Un) const</td></tr>
<tr class="memdesc:a9c8badb91d36ec42d9951bef40265a42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute mass diffusion contribution to the rhs of the low order system.  <a href="#a9c8badb91d36ec42d9951bef40265a42">More...</a><br /></td></tr>
<tr class="separator:a9c8badb91d36ec42d9951bef40265a42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14e9e2da85ad9dd61e2922ac4dba5754"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a14e9e2da85ad9dd61e2922ac4dba5754">alw</a> (const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::Fields &amp;Un, const tk::Fields &amp;Ul, tk::Fields &amp;Q) const</td></tr>
<tr class="memdesc:a14e9e2da85ad9dd61e2922ac4dba5754"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the maximum and minimum unknowns of all elements surrounding nodes.  <a href="#a14e9e2da85ad9dd61e2922ac4dba5754">More...</a><br /></td></tr>
<tr class="separator:a14e9e2da85ad9dd61e2922ac4dba5754"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e39fc47bfc20cb48f9d85ef4a995af8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a9e39fc47bfc20cb48f9d85ef4a995af8">lim</a> (const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::Fields &amp;P, const tk::Fields &amp;Ul, tk::Fields &amp;Q, tk::Fields &amp;A) const</td></tr>
<tr class="memdesc:a9e39fc47bfc20cb48f9d85ef4a995af8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute limited antiffusive element contributions and apply to mesh nodes.  <a href="#a9e39fc47bfc20cb48f9d85ef4a995af8">More...</a><br /></td></tr>
<tr class="separator:a9e39fc47bfc20cb48f9d85ef4a995af8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a1281f06d84581b1b5a527a8ad975c2f4"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> = kw::ncomp::info::expect::type</td></tr>
<tr class="separator:a1281f06d84581b1b5a527a8ad975c2f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a5ed244339a9816df09d82a4ce620b5dd"><td class="memItemLeft" align="right" valign="top">tk::Fields&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a></td></tr>
<tr class="memdesc:a5ed244339a9816df09d82a4ce620b5dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Antidiffusive element contributions for all scalar components.  <a href="#a5ed244339a9816df09d82a4ce620b5dd">More...</a><br /></td></tr>
<tr class="separator:a5ed244339a9816df09d82a4ce620b5dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63a87d4dff620c6f905f0403ed0b1764"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a63a87d4dff620c6f905f0403ed0b1764">pup</a> (PUP::er &amp;p)</td></tr>
<tr class="memdesc:a63a87d4dff620c6f905f0403ed0b1764"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack/Unpack serialize member function.  <a href="#a63a87d4dff620c6f905f0403ed0b1764">More...</a><br /></td></tr>
<tr class="separator:a63a87d4dff620c6f905f0403ed0b1764"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a6560d181de19a2239836c77efc2353"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a3a6560d181de19a2239836c77efc2353">operator|</a> (PUP::er &amp;p, <a class="el" href="classinciter_1_1_flux_corrector.html">FluxCorrector</a> &amp;i)</td></tr>
<tr class="memdesc:a3a6560d181de19a2239836c77efc2353"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack/Unpack serialize operator|.  <a href="#a3a6560d181de19a2239836c77efc2353">More...</a><br /></td></tr>
<tr class="separator:a3a6560d181de19a2239836c77efc2353"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classinciter_1_1_flux_corrector.html">FluxCorrector</a> is used to perform flux-corrected transport </p><dl class="section see"><dt>See also</dt><dd>Löhner, R., Morgan, K., Peraire, J. and Vahdati, M. (1987), Finite element flux-corrected transport (FEM–FCT) for the Euler and Navier–Stokes equations. Int. J. Numer. Meth. Fluids, 7: 1093–1109. doi:10.1002/fld.1650071007 </dd></dl>

<p class="definition">Definition at line <a class="el" href="_flux_corrector_8h_source.html#l00033">33</a> of file <a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a1281f06d84581b1b5a527a8ad975c2f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1281f06d84581b1b5a527a8ad975c2f4">&#9670;&nbsp;</a></span>ncomp_t</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a> =  kw::ncomp::info::expect::type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_flux_corrector_8h_source.html#l00094">94</a> of file <a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a260166f8f83463a9b99c260d525ef8cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a260166f8f83463a9b99c260d525ef8cd">&#9670;&nbsp;</a></span>FluxCorrector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">inciter::FluxCorrector::FluxCorrector </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>is</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">is</td><td>Size of the mesh element connectivity vector (inpoel size) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_flux_corrector_8h_source.html#l00038">38</a> of file <a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>.</p>

<p class="reference">References <a class="el" href="_flux_corrector_8_c_source.html#l00027">aec()</a>, <a class="el" href="_flux_corrector_8_c_source.html#l00338">alw()</a>, <a class="el" href="_flux_corrector_8_c_source.html#l00280">diff()</a>, <a class="el" href="_flux_corrector_8_c_source.html#l00388">lim()</a>, <a class="el" href="_flux_corrector_8_c_source.html#l00237">lump()</a>, and <a class="el" href="_flux_corrector_8_c_source.html#l00173">verify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                               :</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>( is, <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop() ) {}</div><div class="ttc" id="classinciter_1_1_flux_corrector_html_a5ed244339a9816df09d82a4ce620b5dd"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">inciter::FluxCorrector::m_aec</a></div><div class="ttdeci">tk::Fields m_aec</div><div class="ttdoc">Antidiffusive element contributions for all scalar components. </div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00097">FluxCorrector.h:97</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00046">Control.h:46</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00129">Tags.h:129</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_d_g_8_c_source.html#l00023">DG.C:23</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_a260166f8f83463a9b99c260d525ef8cd_cgraph.svg" width="100%" height="541"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac8ea44becb58f8dd9d0b30f110b73968"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8ea44becb58f8dd9d0b30f110b73968">&#9670;&nbsp;</a></span>aec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FluxCorrector::aec </td>
          <td>(</td>
          <td class="paramtype">const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unordered_map&lt; std::size_t, std::vector&lt; std::pair&lt; bool, <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>gid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>dUh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Un</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>P</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute antidiffusive element contributions (AEC) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coord</td><td>Mesh node coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vol</td><td>Volume associated to mesh nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bc</td><td>Vector of pairs of bool and boundary condition value associated to mesh node IDs at which to set Dirichlet boundary conditions. Note that this BC data structure must include boundary conditions set across all PEs, not just the ones need to be set on this PE. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gid</td><td>Local to global node ID mapping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dUh</td><td>Increment of the high order solution </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Un</td><td>Solution at the previous time step </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">P</td><td>The sums of positive (negative) AECs to nodes</td></tr>
  </table>
  </dd>
</dl>
<p>The antidiffusive element contributions (AEC) are defined as the difference between the high and low order solution, where the high order solution is obtained from consistent mass Taylor-Galerkin discretization and the low order solution is lumped mass Taylor-Galerkin + diffusion. Note that AEC is not directly computed as dUh - dUl (although that could also be done), but as AEC = M_L^{-1} (M_Le - M_ce) (ctau * Un + dUh), where</p><ul>
<li>M_ce is the element's consistent mass matrix,</li>
<li>M_Le is the element's lumped mass matrix,</li>
<li>ctau is the mass diffusion coefficient on the rhs of the low order solution, see also <a class="el" href="classinciter_1_1_flux_corrector.html#a9c8badb91d36ec42d9951bef40265a42" title="Compute mass diffusion contribution to the rhs of the low order system. ">FluxCorrector::diff()</a>,</li>
<li>Un is the solution at the previous time step</li>
<li>dUh is the increment of the high order solution, and</li>
<li>M_L^{-1} is the inverse of the assembled lumped mass matrix, i.e., the volume associated to a mesh node by summing the quarter of the element volumes surrounding the node. Note that this is the correct node volume taking into account that some nodes are on chare boundaries. <dl class="section see"><dt>See also</dt><dd>Löhner, R., Morgan, K., Peraire, J. and Vahdati, M. (1987), Finite element flux-corrected transport (FEM–FCT) for the Euler and Navier–Stokes equations. Int. J. Numer. Meth. Fluids, 7: 1093–1109. doi:10.1002/fld.1650071007 </dd></dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="_flux_corrector_8_c_source.html#l00027">27</a> of file <a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_d_g_8_c_source.html#l00023">inciter::g_inputdeck</a>, <a class="el" href="_derived_data_8_c_source.html#l00027">tk::genEsup()</a>, <a class="el" href="_control_8h_source.html#l00046">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_flux_corrector_8h_source.html#l00097">m_aec</a>, <a class="el" href="namespaceinciter_1_1ctr.html#aba4e861eef4516f2b2b8f78e99b5af5ea353e47fe83cde0cbcddf72ac555dd1e4">inciter::ctr::MatCG</a>, <a class="el" href="_data_8h_source.html#l00569">tk::max()</a>, <a class="el" href="_data_8h_source.html#l00548">tk::min()</a>, and <a class="el" href="_base_2_vector_8h_source.html#l00062">tk::triple()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_dist_f_c_t_8_c_source.html#l00139">inciter::DistFCT::aec()</a>, and <a class="el" href="_flux_corrector_8h_source.html#l00038">FluxCorrector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">auto</span> ncomp = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keyword">auto</span> ctau = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1discr.html">tag::discr</a>, <a class="code" href="structtag_1_1ctau.html">tag::ctau</a> &gt;();</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keyword">auto</span> sch = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1selected.html">tag::selected</a>, <a class="code" href="structtag_1_1scheme.html">tag::scheme</a> &gt;();</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( vol.size() == coord[0].size(), <span class="stringliteral">&quot;Nodal volume vector size mismatch&quot;</span> );</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>.nunk() == inpoel.size() &amp;&amp; <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>.nprop() == ncomp,</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          <span class="stringliteral">&quot;AEC and mesh connectivity size mismatch&quot;</span> );</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( Un.nunk() == dUh.nunk() &amp;&amp; Un.nprop() == dUh.nprop(),</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;          <span class="stringliteral">&quot;Unknown array size mismatch&quot;</span> );</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( P.nunk() == dUh.nunk() &amp;&amp; P.nprop() == dUh.nprop()*2,</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;          <span class="stringliteral">&quot;Sums of positive (negative) AECs to nodes array size mismatch&quot;</span> );</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; x = coord[0];</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; y = coord[1];</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; z = coord[2];</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>.fill( 0.0 );</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// compute element Jacobi determinant</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">const</span> std::array&lt; tk::real, 3 &gt;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      ba{{ x[N[1]]-x[N[0]], y[N[1]]-y[N[0]], z[N[1]]-z[N[0]] }},</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      ca{{ x[N[2]]-x[N[0]], y[N[2]]-y[N[0]], z[N[2]]-z[N[0]] }},</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      da{{ x[N[3]]-x[N[0]], y[N[3]]-y[N[0]], z[N[3]]-z[N[0]] }};</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> J = <a class="code" href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a>( ba, ca, da );</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( J &gt; 0, <span class="stringliteral">&quot;Element Jacobian non-positive&quot;</span> );</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// lumped - consistent mass</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    std::array&lt; std::array&lt; tk::real, 4 &gt;, 4 &gt; m;       <span class="comment">// nnode*nnode [4][4]</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    m[0][0] = m[1][1] = m[2][2] = m[3][3] = 3.0*J/120.0;<span class="comment">// diagonal</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    m[0][1] = m[0][2] = m[0][3] =                       <span class="comment">// off-diagonal</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    m[1][0] = m[1][2] = m[1][3] =</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    m[2][0] = m[2][1] = m[2][3] =</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    m[3][0] = m[3][1] = m[3][2] = -J/120.0;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// access solution at element nodes at time n</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    std::vector&lt; std::array&lt; tk::real, 4 &gt; &gt; un( ncomp );</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) un[c] = Un.extract( c, 0, N );</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// access high-order solution increment at element nodes</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    std::vector&lt; std::array&lt; tk::real, 4 &gt; &gt; duh( ncomp, {{0,0,0,0}} );</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span> (sch == <a class="code" href="namespaceinciter_1_1ctr.html#aba4e861eef4516f2b2b8f78e99b5af5ea353e47fe83cde0cbcddf72ac555dd1e4">ctr::SchemeType::MatCG</a>)  <span class="comment">// duh = 0 for lumped-mass CG</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) duh[c] = dUh.extract( c, 0, N );</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Compute antidiffusive element contributions (AEC). The high order system</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// is M_c * dUh = r, where M_c is the consistent mass matrix and r is the</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// high order right hand side. The low order system is constructed from the</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// high order one by lumping the consistent mass matrix and adding mass</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// diffusion: M_L * dUl = r + c_tau * (M_c - M_L) Un, where M_L is the</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// lumped mass matrix, c_tau is the mass diffusion coefficient (c_tau = 1.0</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// guarantees a monotonic solution). See also the details in the function</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// header for the notation. Based on the above, the AEC, in general, is</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// computed as AEC = M_L^{-1} (M_Le - M_ce) (ctau * Un + dUh), which can be</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// obtained by subtracting the low order system from the high order system.</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// Note that the solution update is U^{n+1} = Un + dUl + lim(dUh - dUl),</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// where the last term is the limited AEC. (Think of &#39;lim&#39; as the limit</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// coefficient between 0 and 1.)</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">for</span> (std::size_t k=0; k&lt;4; ++k)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+j,c,0) += m[j][k] * (ctau*un[c][k] + duh[c][k]) / vol[N[j]];</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">// At nodes where Dirichlet boundary conditions (BC) are set, we set the AEC</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">// to zero. This is because if the (same) BCs are correctly set for both the</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="comment">// low and the high order solution, there should be no difference between the</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// low and high order increments, thus AEC = dUh - dUl = 0.</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keyword">auto</span> b = bc.find( gid[ N[j] ] );</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">if</span> (b != end(bc))</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          <span class="keywordflow">if</span> (b-&gt;second[c].first)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+j,c,0) = 0.0;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// sum all positive (negative) antidiffusive element contributions to nodes</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// (Lohner: P^{+,-}_i)</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> esup = <a class="code" href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a>( inpoel, 4 );</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">for</span> (std::size_t p=0; p&lt;dUh.nunk(); ++p)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> i=esup.second[p]+1; i&lt;=esup.second[p+1]; ++i) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;       <span class="keyword">const</span> <span class="keyword">auto</span> e = esup.first[i];</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;       <span class="comment">// decide which node&#39;s contribution we need (A, B, C, or D)</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;       std::size_t n = 3;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordflow">if</span> (inpoel[e*4+0] == p) n = 0;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inpoel[e*4+1] == p) n = 1;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inpoel[e*4+2] == p) n = 2;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;       <span class="comment">// add up element contributions to node p</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;       <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;         P(p,c*2+0,0) += <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">std::max</a>( 0.0, <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+n,c,0) );</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;         P(p,c*2+1,0) += <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>( 0.0, <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+n,c,0) );</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;       }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div><div class="ttc" id="namespacetk_html_afd730d099e698f124362ef8c01483e0f"><div class="ttname"><a href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">tk::min</a></div><div class="ttdeci">Data&lt; Layout &gt; min(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00548">Data.h:548</a></div></div>
<div class="ttc" id="namespaceinciter_1_1ctr_html_aba4e861eef4516f2b2b8f78e99b5af5ea353e47fe83cde0cbcddf72ac555dd1e4"><div class="ttname"><a href="namespaceinciter_1_1ctr.html#aba4e861eef4516f2b2b8f78e99b5af5ea353e47fe83cde0cbcddf72ac555dd1e4">inciter::ctr::SchemeType::MatCG</a></div></div>
<div class="ttc" id="structtag_1_1discr_html"><div class="ttname"><a href="structtag_1_1discr.html">tag::discr</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00128">Tags.h:128</a></div></div>
<div class="ttc" id="structtag_1_1ctau_html"><div class="ttname"><a href="structtag_1_1ctau.html">tag::ctau</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00080">Tags.h:80</a></div></div>
<div class="ttc" id="structtag_1_1selected_html"><div class="ttname"><a href="structtag_1_1selected.html">tag::selected</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00127">Tags.h:127</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a5ed244339a9816df09d82a4ce620b5dd"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">inciter::FluxCorrector::m_aec</a></div><div class="ttdeci">tk::Fields m_aec</div><div class="ttdoc">Antidiffusive element contributions for all scalar components. </div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00097">FluxCorrector.h:97</a></div></div>
<div class="ttc" id="namespacetk_html_a66a2889d5d8aeb4a836842c6a1010463"><div class="ttname"><a href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; genEsup(const std::vector&lt; std::size_t &gt; &amp;inpoel, std::size_t nnpe)</div><div class="ttdoc">Generate derived data structure, elements surrounding points. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00027">DerivedData.C:27</a></div></div>
<div class="ttc" id="namespacetk_html_ae5b04b00aa51667b944b7188545ec5ae"><div class="ttname"><a href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a></div><div class="ttdeci">T triple(const std::array&lt; T, 3 &gt; &amp;v1, const std::array&lt; T, 3 &gt; &amp;v2, const std::array&lt; T, 3 &gt; &amp;v3)</div><div class="ttdef"><b>Definition:</b> <a href="_base_2_vector_8h_source.html#l00062">Vector.h:62</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a1281f06d84581b1b5a527a8ad975c2f4"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00094">FluxCorrector.h:94</a></div></div>
<div class="ttc" id="structtag_1_1scheme_html"><div class="ttname"><a href="structtag_1_1scheme.html">tag::scheme</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00069">Tags.h:69</a></div></div>
<div class="ttc" id="namespacetk_html_ac9a26e30d19b940a12990a866a514cb5"><div class="ttname"><a href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">tk::max</a></div><div class="ttdeci">Data&lt; Layout &gt; max(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00569">Data.h:569</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00046">Control.h:46</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00129">Tags.h:129</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_d_g_8_c_source.html#l00023">DG.C:23</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_ac8ea44becb58f8dd9d0b30f110b73968_cgraph.svg" width="526" height="282"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a14e9e2da85ad9dd61e2922ac4dba5754"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14e9e2da85ad9dd61e2922ac4dba5754">&#9670;&nbsp;</a></span>alw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FluxCorrector::alw </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Un</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Ul</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the maximum and minimum unknowns of all elements surrounding nodes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Un</td><td>Solution at the previous time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Ul</td><td>Low order solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Q</td><td>Maximum and mimimum unknowns of elements surrounding nodes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_flux_corrector_8_c_source.html#l00338">338</a> of file <a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_d_g_8_c_source.html#l00023">inciter::g_inputdeck</a>, <a class="el" href="_derived_data_8_c_source.html#l00027">tk::genEsup()</a>, <a class="el" href="_control_8h_source.html#l00046">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_data_8h_source.html#l00569">tk::max()</a>, and <a class="el" href="_data_8h_source.html#l00548">tk::min()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_dist_f_c_t_8_c_source.html#l00214">inciter::DistFCT::alw()</a>, and <a class="el" href="_flux_corrector_8h_source.html#l00038">FluxCorrector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;{</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( Q.nunk() == Un.nunk() &amp;&amp; Q.nprop() == Un.nprop()*2, <span class="stringliteral">&quot;Max and min &quot;</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          <span class="stringliteral">&quot;unknowns of elements surrounding nodes array size mismatch&quot;</span> );</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// compute maximum and minimum nodal values of Ul and Un (Lohner: u^*_i)</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keyword">auto</span> Smax = <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">tk::max</a>( Ul, Un );</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keyword">auto</span> Smin = <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">tk::min</a>( Ul, Un );</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keyword">auto</span> ncomp = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// compute maximum and minimum nodal values of all elements (Lohner: u^*_el)</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  tk::Fields S( inpoel.size()/4, ncomp*2 );</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      S(e,c*2+0,0) = <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">std::max</a>( Smax(N[3],c,0),</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                       <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">std::max</a>( Smax(N[2],c,0),</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                         <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">std::max</a>( Smax(N[0],c,0), Smax(N[1],c,0) ) ) );</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      S(e,c*2+1,0) = <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>( Smin(N[3],c,0),</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                       <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>( Smin(N[2],c,0),</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                         <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>( Smin(N[0],c,0), Smin(N[1],c,0) ) ) );</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">// compute maximum and mimimum unknowns of all elements surrounding each node</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">// (Lohner: u^{max,min}_i)</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> esup = <a class="code" href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a>( inpoel, 4 );</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">for</span> (std::size_t p=0; p&lt;Un.nunk(); ++p)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> i=esup.second[p]+1; i&lt;=esup.second[p+1]; ++i) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> e = esup.first[i];</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">if</span> (S(e,c*2+0,0) &gt; Q(p,c*2+0,0)) Q(p,c*2+0,0) = S(e,c*2+0,0);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">if</span> (S(e,c*2+1,0) &lt; Q(p,c*2+1,0)) Q(p,c*2+1,0) = S(e,c*2+1,0);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}</div><div class="ttc" id="namespacetk_html_afd730d099e698f124362ef8c01483e0f"><div class="ttname"><a href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">tk::min</a></div><div class="ttdeci">Data&lt; Layout &gt; min(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00548">Data.h:548</a></div></div>
<div class="ttc" id="namespacetk_html_a66a2889d5d8aeb4a836842c6a1010463"><div class="ttname"><a href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; genEsup(const std::vector&lt; std::size_t &gt; &amp;inpoel, std::size_t nnpe)</div><div class="ttdoc">Generate derived data structure, elements surrounding points. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00027">DerivedData.C:27</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a1281f06d84581b1b5a527a8ad975c2f4"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00094">FluxCorrector.h:94</a></div></div>
<div class="ttc" id="namespacetk_html_ac9a26e30d19b940a12990a866a514cb5"><div class="ttname"><a href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">tk::max</a></div><div class="ttdeci">Data&lt; Layout &gt; max(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00569">Data.h:569</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00046">Control.h:46</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00129">Tags.h:129</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_d_g_8_c_source.html#l00023">DG.C:23</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_a14e9e2da85ad9dd61e2922ac4dba5754_cgraph.svg" width="523" height="207"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a9c8badb91d36ec42d9951bef40265a42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c8badb91d36ec42d9951bef40265a42">&#9670;&nbsp;</a></span>diff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tk::Fields FluxCorrector::diff </td>
          <td>(</td>
          <td class="paramtype">const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Un</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute mass diffusion contribution to the rhs of the low order system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coord</td><td>Mesh node coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Un</td><td>Solution at the previous time step </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Mass diffusion contribution to the RHS of the low order system </dd></dl>

<p class="definition">Definition at line <a class="el" href="_flux_corrector_8_c_source.html#l00280">280</a> of file <a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_d_g_8_c_source.html#l00023">inciter::g_inputdeck</a>, <a class="el" href="_control_8h_source.html#l00046">tk::Control&lt; Ts &gt;::get()</a>, and <a class="el" href="_base_2_vector_8h_source.html#l00062">tk::triple()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_dist_f_c_t_8_c_source.html#l00097">inciter::DistFCT::diff()</a>, and <a class="el" href="_flux_corrector_8h_source.html#l00038">FluxCorrector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;{</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; x = coord[0];</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; y = coord[1];</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; z = coord[2];</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keyword">auto</span> ncomp = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keyword">auto</span> ctau = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1discr.html">tag::discr</a>, <a class="code" href="structtag_1_1ctau.html">tag::ctau</a> &gt;();</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  tk::Fields D( Un.nunk(), Un.nprop() );</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  D.fill( 0.0 );</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// compute element Jacobi determinant</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keyword">const</span> std::array&lt; tk::real, 3 &gt;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      ba{{ x[N[1]]-x[N[0]], y[N[1]]-y[N[0]], z[N[1]]-z[N[0]] }},</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      ca{{ x[N[2]]-x[N[0]], y[N[2]]-y[N[0]], z[N[2]]-z[N[0]] }},</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      da{{ x[N[3]]-x[N[0]], y[N[3]]-y[N[0]], z[N[3]]-z[N[0]] }};</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> J = <a class="code" href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a>( ba, ca, da );</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( J &gt; 0, <span class="stringliteral">&quot;Element Jacobian non-positive&quot;</span> );</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// lumped - consistent mass</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    std::array&lt; std::array&lt; tk::real, 4 &gt;, 4 &gt; m;       <span class="comment">// nnode*nnode [4][4]</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    m[0][0] = m[1][1] = m[2][2] = m[3][3] = 3.0*J/120.0;<span class="comment">// diagonal</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    m[0][1] = m[0][2] = m[0][3] =                       <span class="comment">// off-diagonal</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    m[1][0] = m[1][2] = m[1][3] =</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    m[2][0] = m[2][1] = m[2][3] =</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    m[3][0] = m[3][1] = m[3][2] = -J/120.0;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// access solution at element nodes at time n</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    std::vector&lt; std::array&lt; tk::real, 4 &gt; &gt; un( ncomp );</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) un[c] = Un.extract( c, 0, N );</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// access pointer to mass diffusion right hand side at element nodes</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    std::vector&lt; const tk::real* &gt; d( ncomp );</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) d[c] = D.cptr( c, 0 );</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// scatter-add mass diffusion element contributions to rhs nodes</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">for</span> (std::size_t k=0; k&lt;4; ++k)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          D.var(d[c],N[j]) -= ctau * m[j][k] * un[c][k];</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordflow">return</span> D;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div><div class="ttc" id="structtag_1_1discr_html"><div class="ttname"><a href="structtag_1_1discr.html">tag::discr</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00128">Tags.h:128</a></div></div>
<div class="ttc" id="structtag_1_1ctau_html"><div class="ttname"><a href="structtag_1_1ctau.html">tag::ctau</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00080">Tags.h:80</a></div></div>
<div class="ttc" id="namespacetk_html_ae5b04b00aa51667b944b7188545ec5ae"><div class="ttname"><a href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a></div><div class="ttdeci">T triple(const std::array&lt; T, 3 &gt; &amp;v1, const std::array&lt; T, 3 &gt; &amp;v2, const std::array&lt; T, 3 &gt; &amp;v3)</div><div class="ttdef"><b>Definition:</b> <a href="_base_2_vector_8h_source.html#l00062">Vector.h:62</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a1281f06d84581b1b5a527a8ad975c2f4"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00094">FluxCorrector.h:94</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00046">Control.h:46</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00129">Tags.h:129</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_d_g_8_c_source.html#l00023">DG.C:23</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_a9c8badb91d36ec42d9951bef40265a42_cgraph.svg" width="454" height="108"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a9e39fc47bfc20cb48f9d85ef4a995af8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e39fc47bfc20cb48f9d85ef4a995af8">&#9670;&nbsp;</a></span>lim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FluxCorrector::lim </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Ul</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute limited antiffusive element contributions and apply to mesh nodes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">P</td><td>The sums of all positive (negative) AECs to nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Ul</td><td>Low order solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Q</td><td>The maximum and mimimum unknowns of elements surrounding each node </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">A</td><td>Limited antidiffusive element contributions scatter-added to nodes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Q is also overwritten to avoid using temporary memory </dd></dl>

<p class="definition">Definition at line <a class="el" href="_flux_corrector_8_c_source.html#l00388">388</a> of file <a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_d_g_8_c_source.html#l00023">inciter::g_inputdeck</a>, <a class="el" href="_control_8h_source.html#l00046">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_flux_corrector_8h_source.html#l00097">m_aec</a>, <a class="el" href="_data_8h_source.html#l00569">tk::max()</a>, and <a class="el" href="_data_8h_source.html#l00548">tk::min()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_flux_corrector_8h_source.html#l00038">FluxCorrector()</a>, and <a class="el" href="_dist_f_c_t_8_c_source.html#l00294">inciter::DistFCT::lim()</a>.</p>
<div class="fragment"><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;{</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( P.nunk() == Q.nunk() &amp;&amp; P.nprop() == Q.nprop(), <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( P.nunk() == Ul.nunk() &amp;&amp; P.nprop() == Ul.nprop()*2, <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( A.nunk() == Ul.nunk() &amp;&amp; A.nprop() == Ul.nprop(), <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keyword">auto</span> ncomp = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// compute the maximum and minimum increments and decrements nodal solution</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="comment">// values are allowed to achieve (Lohner: Q^{+,-}_i)</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">for</span> (std::size_t p=0; p&lt;Ul.nunk(); ++p)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      Q(p,c*2+0,0) -= Ul(p,c,0);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      Q(p,c*2+1,0) -= Ul(p,c,0);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keyword">auto</span> eps = std::numeric_limits&lt; tk::real &gt;::epsilon();</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="comment">// compute the ratios of positive and negative element contributions that</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">// ensure monotonicity (Lohner: R^{+,-})</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordflow">for</span> (std::size_t p=0; p&lt;P.nunk(); ++p)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      Q(p,c*2+0,0) =</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        P(p,c*2+0,0) &gt; 0.0 ? <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>(1.0,Q(p,c*2+0,0)/P(p,c*2+0,0)) : 0.0;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      Q(p,c*2+1,0) =</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        P(p,c*2+1,0) &lt; 0.0 ? <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>(1.0,Q(p,c*2+1,0)/P(p,c*2+1,0)) : 0.0;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// calculate limit coefficient for all elements (Lohner: C_el)</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  tk::Fields C( inpoel.size()/4, ncomp );</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      std::array&lt; tk::real, 4 &gt; R;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j) {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">// ignore Diriclhet BCs when computing cell limit coefficient</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">if</span> (std::abs(<a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+j,c,0)) &lt; eps)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;          R[j] = <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">std::numeric_limits&lt; tk::real &gt;::max</a>();</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;          R[j] = <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+j,c,0) &gt; 0.0 ? Q(N[j],c*2+0,0) : Q(N[j],c*2+1,0);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      C(e,c,0) = *std::min_element( begin(R), end(R) );</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="comment">// if all vertices happened to be on a Dirichlet boundary, ignore limiting</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keywordflow">if</span> (C(e,c,0) &gt; 1.0) C(e,c,0) = 1.0;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( C(e,c,0) &gt; -eps &amp;&amp; C(e,c,0) &lt; 1.0+eps,</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;              <span class="stringliteral">&quot;0 &lt;= AEC &lt;= 1.0 failed: C = &quot;</span> + std::to_string(C(e,c,0)) );</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">// save the limited antidiffusive element contributions (Lohner: AEC^c)</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">// access pointer to solution at element nodes</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    std::vector&lt; const tk::real* &gt; a( ncomp );</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) a[c] = A.cptr( c, 0 );</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">// Scatter-add limited antidiffusive element contributions to nodes. At</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// nodes where Dirichlet boundary conditions are set, the AECs are set to</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// zero so thelimit coefficient has no effect. This yields no increment for</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// those nodes. See the detailed discussion when computing the AECs.</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c)</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        A.var(a[c],N[j]) += C(e,c,0) * <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+j,c,0);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div><div class="ttc" id="namespacetk_html_afd730d099e698f124362ef8c01483e0f"><div class="ttname"><a href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">tk::min</a></div><div class="ttdeci">Data&lt; Layout &gt; min(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00548">Data.h:548</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a5ed244339a9816df09d82a4ce620b5dd"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">inciter::FluxCorrector::m_aec</a></div><div class="ttdeci">tk::Fields m_aec</div><div class="ttdoc">Antidiffusive element contributions for all scalar components. </div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00097">FluxCorrector.h:97</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a1281f06d84581b1b5a527a8ad975c2f4"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00094">FluxCorrector.h:94</a></div></div>
<div class="ttc" id="namespacetk_html_ac9a26e30d19b940a12990a866a514cb5"><div class="ttname"><a href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">tk::max</a></div><div class="ttdeci">Data&lt; Layout &gt; max(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00569">Data.h:569</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00046">Control.h:46</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00129">Tags.h:129</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_d_g_8_c_source.html#l00023">DG.C:23</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_a9e39fc47bfc20cb48f9d85ef4a995af8_cgraph.svg" width="520" height="158"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="abc0d65b8309fc2f45f07968bcb4e88b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc0d65b8309fc2f45f07968bcb4e88b1">&#9670;&nbsp;</a></span>lump()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tk::Fields FluxCorrector::lump </td>
          <td>(</td>
          <td class="paramtype">const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute lumped mass matrix lhs for low order system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coord</td><td>Mesh node coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Lumped mass matrix </dd></dl>

<p class="definition">Definition at line <a class="el" href="_flux_corrector_8_c_source.html#l00237">237</a> of file <a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_d_g_8_c_source.html#l00023">inciter::g_inputdeck</a>, <a class="el" href="_control_8h_source.html#l00046">tk::Control&lt; Ts &gt;::get()</a>, and <a class="el" href="_base_2_vector_8h_source.html#l00062">tk::triple()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_flux_corrector_8h_source.html#l00038">FluxCorrector()</a>, and <a class="el" href="_dist_f_c_t_8_c_source.html#l00086">inciter::DistFCT::lump()</a>.</p>
<div class="fragment"><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;{</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; x = coord[0];</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; y = coord[1];</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; z = coord[2];</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keyword">auto</span> ncomp = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  tk::Fields L( coord[0].size(), ncomp );</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  L.fill( 0.0 );</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// compute element Jacobi determinant</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keyword">const</span> std::array&lt; tk::real, 3 &gt;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      ba{{ x[N[1]]-x[N[0]], y[N[1]]-y[N[0]], z[N[1]]-z[N[0]] }},</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      ca{{ x[N[2]]-x[N[0]], y[N[2]]-y[N[0]], z[N[2]]-z[N[0]] }},</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      da{{ x[N[3]]-x[N[0]], y[N[3]]-y[N[0]], z[N[3]]-z[N[0]] }};</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> J = <a class="code" href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a>( ba, ca, da ) * 5.0 / 120.0;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( J &gt; 0, <span class="stringliteral">&quot;Element Jacobian non-positive&quot;</span> );</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// access pointer to lumped mass left hand side at element nodes</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    std::vector&lt; const tk::real* &gt; l( ncomp );</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) l[c] = L.cptr( c, 0 );</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// scatter-add lumped mass element contributions to lhs nodes</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        L.var(l[c],N[j]) += J;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  }</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">return</span> L;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div><div class="ttc" id="namespacetk_html_ae5b04b00aa51667b944b7188545ec5ae"><div class="ttname"><a href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a></div><div class="ttdeci">T triple(const std::array&lt; T, 3 &gt; &amp;v1, const std::array&lt; T, 3 &gt; &amp;v2, const std::array&lt; T, 3 &gt; &amp;v3)</div><div class="ttdef"><b>Definition:</b> <a href="_base_2_vector_8h_source.html#l00062">Vector.h:62</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a1281f06d84581b1b5a527a8ad975c2f4"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00094">FluxCorrector.h:94</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00046">Control.h:46</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00129">Tags.h:129</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_d_g_8_c_source.html#l00023">DG.C:23</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_abc0d65b8309fc2f45f07968bcb4e88b1_cgraph.svg" width="454" height="108"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a63a87d4dff620c6f905f0403ed0b1764"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63a87d4dff620c6f905f0403ed0b1764">&#9670;&nbsp;</a></span>pup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inciter::FluxCorrector::pup </td>
          <td>(</td>
          <td class="paramtype">PUP::er &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pack/Unpack serialize member function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>Charm++'s PUP::er serializer object reference </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_flux_corrector_8h_source.html#l00084">84</a> of file <a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>.</p>

<p class="reference">References <a class="el" href="_flux_corrector_8h_source.html#l00097">m_aec</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                         {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      p | <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div><div class="ttc" id="classinciter_1_1_flux_corrector_html_a5ed244339a9816df09d82a4ce620b5dd"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">inciter::FluxCorrector::m_aec</a></div><div class="ttdeci">tk::Fields m_aec</div><div class="ttdoc">Antidiffusive element contributions for all scalar components. </div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00097">FluxCorrector.h:97</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a25aed48b95154ed346b84b539d7acbd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25aed48b95154ed346b84b539d7acbd1">&#9670;&nbsp;</a></span>verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FluxCorrector::verify </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>nchare</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>dUh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>dUl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify the assembled antidiffusive element contributions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nchare</td><td>Total number of host chares </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dUh</td><td>Increment of the high order solution </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dUl</td><td>Increment of the low order solution </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if verification has been done</dd></dl>
<p>This verification only makes sense if no communication is to be done, i.e., if there is a single host chare, because the AEC assembled to mesh nodes only contains partial contributions on chare boundaries at this point. Verification in parallel would incure communication of the unlimited AEC, which in general is not necessary, so we will not do that for the sake of verification. </p><dl class="section note"><dt>Note</dt><dd>Client code should ensure that this function is optimized away in RELEASE mode. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_flux_corrector_8_c_source.html#l00173">173</a> of file <a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a>.</p>

<p class="reference">References <a class="el" href="_exception_8h_source.html#l00045">Assert</a>, <a class="el" href="_d_g_8_c_source.html#l00023">inciter::g_inputdeck</a>, <a class="el" href="_control_8h_source.html#l00046">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_flux_corrector_8h_source.html#l00097">m_aec</a>, <a class="el" href="_data_8h_source.html#l00618">tk::maxdiff()</a>, and <a class="el" href="_exception_8h_source.html#l00031">Throw</a>.</p>

<p class="reference">Referenced by <a class="el" href="_flux_corrector_8h_source.html#l00038">FluxCorrector()</a>, and <a class="el" href="_dist_f_c_t_8_c_source.html#l00363">inciter::DistFCT::verify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;{</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( dUl.nunk() == dUh.nunk() &amp;&amp; dUl.nprop() == dUh.nprop(),</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          <span class="stringliteral">&quot;Unknown array size mismatch&quot;</span> );</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">if</span> (nchare == 1) {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keyword">auto</span> ncomp = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    tk::Fields U( dUh.nunk(), dUh.nprop() );</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    U.fill( 0.0 );</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                             inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="comment">// access pointer to solution at element nodes</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      std::vector&lt; const tk::real* &gt; u( ncomp );</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) u[c] = U.cptr( c, 0 );</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="comment">// scatter-add antidiffusive element contributions to nodes</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c)</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          U.var(u[c],N[j]) += <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+j,c,0);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// Compute maximum difference between the assembled AEC and dUh-dUl</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keyword">auto</span> d = <a class="code" href="namespacetk.html#ab7f02155bc2945a0a0c82c1be5cad041">tk::maxdiff</a>( U, dUh-dUl );</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// Tolerance: 10 x the linear solver tolerance for the high order solution.</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">if</span> (d.second &gt; 1.0e-7) {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; duh = dUh.data();</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; dul = dUl.data();</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; u = U.data();</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      std::stringstream ss;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;maximum difference at &quot;</span> &lt;&lt; d.first &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; d.second</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, dUh:&quot;</span> &lt;&lt; duh[d.first] &lt;&lt; <span class="stringliteral">&quot;, dUl:&quot;</span> &lt;&lt; dul[d.first]</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, dUh-dUl:&quot;</span> &lt;&lt; duh[d.first] - dul[d.first]</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, AEC:&quot;</span> &lt;&lt; u[d.first] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <a class="code" href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a>( <span class="stringliteral">&quot;Assembled AEC does not equal dUh-dUl: &quot;</span> + ss.str() );</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;}</div><div class="ttc" id="_exception_8h_html_a0412f798470c18f503a2c2f63c970ba8"><div class="ttname"><a href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a></div><div class="ttdeci">#define Throw(...)</div><div class="ttdoc">Throw macro that always throws an exception. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00031">Exception.h:31</a></div></div>
<div class="ttc" id="namespacetk_html_ab7f02155bc2945a0a0c82c1be5cad041"><div class="ttname"><a href="namespacetk.html#ab7f02155bc2945a0a0c82c1be5cad041">tk::maxdiff</a></div><div class="ttdeci">std::pair&lt; std::size_t, tk::real &gt; maxdiff(const Data&lt; Layout &gt; &amp;lhs, const Data&lt; Layout &gt; &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00618">Data.h:618</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a5ed244339a9816df09d82a4ce620b5dd"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">inciter::FluxCorrector::m_aec</a></div><div class="ttdeci">tk::Fields m_aec</div><div class="ttdoc">Antidiffusive element contributions for all scalar components. </div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00097">FluxCorrector.h:97</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a1281f06d84581b1b5a527a8ad975c2f4"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00094">FluxCorrector.h:94</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00046">Control.h:46</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00129">Tags.h:129</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00045">Exception.h:45</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_d_g_8_c_source.html#l00023">DG.C:23</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_a25aed48b95154ed346b84b539d7acbd1_cgraph.svg" width="494" height="134"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a3a6560d181de19a2239836c77efc2353"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a6560d181de19a2239836c77efc2353">&#9670;&nbsp;</a></span>operator|</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void operator| </td>
          <td>(</td>
          <td class="paramtype">PUP::er &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinciter_1_1_flux_corrector.html">FluxCorrector</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pack/Unpack serialize operator|. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>Charm++'s PUP::er serializer object reference </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">i</td><td><a class="el" href="classinciter_1_1_flux_corrector.html">FluxCorrector</a> object reference </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_flux_corrector_8h_source.html#l00090">90</a> of file <a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{ i.pup(p); }</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a5ed244339a9816df09d82a4ce620b5dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ed244339a9816df09d82a4ce620b5dd">&#9670;&nbsp;</a></span>m_aec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tk::Fields inciter::FluxCorrector::m_aec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Antidiffusive element contributions for all scalar components. </p>

<p class="definition">Definition at line <a class="el" href="_flux_corrector_8h_source.html#l00097">97</a> of file <a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="_flux_corrector_8_c_source.html#l00027">aec()</a>, <a class="el" href="_flux_corrector_8_c_source.html#l00388">lim()</a>, <a class="el" href="_flux_corrector_8h_source.html#l00084">pup()</a>, and <a class="el" href="_flux_corrector_8_c_source.html#l00173">verify()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/tmp/TeamCity-12/work/821a9fd6f64749d9/src/Inciter/<a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a></li>
<li>/tmp/TeamCity-12/work/821a9fd6f64749d9/src/Inciter/<a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 2 2018 13:52:03 for Quinoa by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
