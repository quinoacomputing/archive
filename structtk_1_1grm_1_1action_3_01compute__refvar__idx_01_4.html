<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quinoa: tk::grm::action&lt; compute_refvar_idx &gt; Struct Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quinoa.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacetk.html">tk</a></li><li class="navelem"><a class="el" href="namespacetk_1_1grm.html">grm</a></li><li class="navelem"><a class="el" href="structtk_1_1grm_1_1action_3_01compute__refvar__idx_01_4.html">action&lt; compute_refvar_idx &gt;</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="structtk_1_1grm_1_1action_3_01compute__refvar__idx_01_4-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">tk::grm::action&lt; compute_refvar_idx &gt; Struct Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_inciter_2_input_deck_2_grammar_8h_source.html">Grammar.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a74e5506f423e0cf15f9a0995ba37a2e3"><td class="memTemplParams" colspan="2">template&lt;typename Input , typename Stack &gt; </td></tr>
<tr class="memitem:a74e5506f423e0cf15f9a0995ba37a2e3"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structtk_1_1grm_1_1action_3_01compute__refvar__idx_01_4.html#a74e5506f423e0cf15f9a0995ba37a2e3">apply</a> (const Input &amp;in, Stack &amp;stack)</td></tr>
<tr class="separator:a74e5506f423e0cf15f9a0995ba37a2e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;&gt;<br />
struct tk::grm::action&lt; compute_refvar_idx &gt;</h3>

<p>Compute indices of refinement variables</p>
<p>This functor computes the indices in the unknown vector for all refinement variables in the system of systems of dependent variables after the refvar...end block has been parsed in the amr...end block. After basic error checking, the vector at stack.get&lt;tag::amr,tag::id&gt;() is filled. </p>

<p class="definition">Definition at line <a class="el" href="_inciter_2_input_deck_2_grammar_8h_source.html#l00260">260</a> of file <a class="el" href="_inciter_2_input_deck_2_grammar_8h_source.html">Grammar.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a74e5506f423e0cf15f9a0995ba37a2e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74e5506f423e0cf15f9a0995ba37a2e3">&#9670;&nbsp;</a></span>apply()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Input , typename Stack &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="structtk_1_1grm_1_1action.html">tk::grm::action</a>&lt; <a class="el" href="structtk_1_1grm_1_1compute__refvar__idx.html">compute_refvar_idx</a> &gt;::apply </td>
          <td>(</td>
          <td class="paramtype">const Input &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Stack &amp;&#160;</td>
          <td class="paramname"><em>stack</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_inciter_2_input_deck_2_grammar_8h_source.html#l00262">262</a> of file <a class="el" href="_inciter_2_input_deck_2_grammar_8h_source.html">Grammar.h</a>.</p>

<p class="reference">References <a class="el" href="_container_util_8h_source.html#l00051">tk::cref_find()</a>.</p>
<div class="fragment"><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                                       {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="comment">// reference variables just parsed by refvar...end block</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; refvar = stack.template get&lt; tag::amr, tag::refvar &gt;();</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="comment">// get ncomponents object from this input deck</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="namespaceinciter_1_1ctr.html#a623855ad268c9727e13f3e9772472e17">ncomps</a> = stack.template get&lt; tag::component &gt;();</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="comment">// compute offset map associating offsets to dependent variables</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keyword">auto</span> offsetmap = ncomps.offsetmap( stack );</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="comment">// compute number of components associated to dependent variabels</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keyword">auto</span> ncompmap = ncomps.ncompmap( stack );</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="comment">// reference variable index vector to fill</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keyword">auto</span>&amp; refidx = stack.template get&lt; tag::amr, tag::id &gt;();</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="comment">// Compute indices for all refvars</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; v : refvar) {    <span class="comment">// for all reference variables parsed</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">// depvar is the first char of a refvar</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keyword">auto</span> depvar = v[0];</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">// the field ID is optional and is the rest of the depvar string</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        std::size_t f = (v.size()&gt;1 ? std::stoul(v.substr(1)) : 1) - 1;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment">// field ID must be less than or equal to the number of scalar</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="comment">// components configured for the eq system for this dependent variable</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">if</span> (f &gt;= <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>( ncompmap, depvar ))</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          Message&lt; Stack, ERROR, MsgKey::NOSUCHCOMPONENT &gt;( stack, in );</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="comment">// get offset for depvar</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keyword">auto</span> eqsys_offset = <a class="code" href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a>( offsetmap, depvar );</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">// the index is the eq offset + field ID</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keyword">auto</span> idx = eqsys_offset + f;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="comment">// save refvar index in system of all systems</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        refidx.push_back( idx );</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div><div class="ttc" id="namespaceinciter_1_1ctr_html_a623855ad268c9727e13f3e9772472e17"><div class="ttname"><a href="namespaceinciter_1_1ctr.html#a623855ad268c9727e13f3e9772472e17">inciter::ctr::ncomps</a></div><div class="ttdeci">tk::ctr::ncomponents&lt; tag::transport, std::vector&lt; tk::ctr::ncomp_type &gt;, tag::compflow, std::vector&lt; tk::ctr::ncomp_type &gt; &gt; ncomps</div><div class="ttdoc">Number of components of partial differential equations. </div><div class="ttdef"><b>Definition:</b> <a href="_inciter_2_components_8h_source.html#l00022">Components.h:22</a></div></div>
<div class="ttc" id="namespacetk_html_a2e002561a68875b091a264eb2a1e5f6c"><div class="ttname"><a href="namespacetk.html#a2e002561a68875b091a264eb2a1e5f6c">tk::cref_find</a></div><div class="ttdeci">auto cref_find(const Container &amp;map, const typename Container::key_type &amp;key) -&gt; const typename Container::mapped_type &amp;</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00051">ContainerUtil.h:51</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structtk_1_1grm_1_1action_3_01compute__refvar__idx_01_4_a74e5506f423e0cf15f9a0995ba37a2e3_cgraph.svg" width="339" height="48"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>/tmp/TeamCity-12/work/821a9fd6f64749d9/src/Control/Inciter/InputDeck/<a class="el" href="_inciter_2_input_deck_2_grammar_8h_source.html">Grammar.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jul 16 2018 22:57:56 for Quinoa by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
