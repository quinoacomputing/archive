<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>inciter::DistFCT class | Quinoa docs</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="quinoa.m-dark-noindent+doxygen.compiled.css" />
  <link rel="icon" href="quinoa_sum.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">Quinoa <span class="m-thin">docs</span></a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-dox-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="why.html">Why</a></li>
            <li>
              <a href="build.html">Build</a>
              <ol>
                <li><a href="https://quinoacomputing.org/quinoa.github.io/index.html#mainpage_build">Quickstart</a></li>
                <li><a href="git_submodules_subtrees.html">Modules</a></li>
                <li><a href="licenses.html">Libraries</a></li>
                <li><a href="build_system.html">Internals</a></li>
              </ol>
            </li>
            <li>
              <a href="https://quinoacomputing.org/quinoa.github.io/index.html#mainpage_tools">Tools</a>
              <ol>
                <li><a href="walker_main.html">Walker</a></li>
                <li><a href="inciter_main.html">Inciter</a></li>
                <li><a href="rngtest_main.html">RNGTest</a></li>
                <li><a href="unittest_main.html">UnitTest</a></li>
                <li><a href="meshconv_main.html">MeshConv</a></li>
              </ol>
            </li>
            <li><a href="namespaces.html">Namespaces</a></li>
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="7">
            <li>
              <a href="resources.html">Resources</a>
              <ol>
                <li><a href="https://github.com/quinoacomputing/quinoa">GitHub</a></li>
                <li><a href="https://github.com/quinoacomputing/quinoa/releases">Tarballs</a></li>
                <li><a href="https://github.com/quinoacomputing/quinoa/blob/master/LICENSE">License</a></li>
                <li><a href="roadmap.html">Roadmap</a></li>
                <li><a href="contributing.html">Contributing</a></li>
                <li><a href="papers.html">Publications</a></li>
                <li><a href="https://quinoa.zulipchat.com">Chat</a></li>
                <li><a href="https://quinoa.groups.io">Email list</a></li>
                <li><a href="coverage.html">Coverage</a></li>
                <li><a href="https://dev.azure.com/quinoacomputing/Quinoa">Azure</a></li>
                <li><a href="http://www.openhub.net/p/quinoacomputing">OpenHub</a></li>
                <li><a href="https://bestpractices.coreinfrastructure.org/projects/2120">Practices</a></li>
              </ol>
            </li>
            <li class="m-show-m"><a href="#search" class="m-dox-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="namespaceinciter.html">inciter</a>::<wbr/></span>DistFCT <span class="m-thin">class</span>
        </h1>
        <p><a href="classinciter_1_1_dist_f_c_t.html" class="m-dox">DistFCT</a> Charm++ chare array used to advance PDEs in time with DiagCG+LW+FCT.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#typeless-methods">Constructors, destructors, conversion operators</a></li>
                <li><a href="#pub-methods">Public functions</a></li>
                <li><a href="#packunpack-charm-serialization-routines">Pack/unpack (Charm++ serialization) routines</a></li>
              </ul>
            </li>
          </ul>
        </div>
        <section id="typeless-methods">
          <h2><a href="#typeless-methods">Constructors, destructors, conversion operators</a></h2>
          <dl class="m-dox">
            <dt>
              <span class="m-dox-wrap-bumper"><a href="#a1e9e03190622fc56097f3638b2eabd61" class="m-dox-self" name="a1e9e03190622fc56097f3638b2eabd61">DistFCT</a>(</span><span class="m-dox-wrap">CkMigrateMessage*) <span class="m-label m-flat m-info">explicit</span> </span>
            </dt>
            <dd>Migrate constructor.</dd>
          </dl>
        </section>
        <section id="pub-methods">
          <h2><a href="#pub-methods">Public functions</a></h2>
          <dl class="m-dox">
            <dt>
              <span class="m-dox-wrap-bumper">auto <a href="#abe531fd245e1d5af71dc71f57cb9f06d" class="m-dox">DistFCT</a>(</span><span class="m-dox-wrap">int nchare,
              std::size_t nu,
              std::size_t np,
              const <a href="namespacetk.html#afae1f1be5bf7e58189087d896b6d6ad4" class="m-dox">tk::<wbr />NodeCommMap</a>&amp; nodeCommMap,
              const std::unordered_map&lt;std::size_t, std::size_t&gt;&amp; bid,
              const std::unordered_map&lt;std::size_t, std::size_t&gt;&amp; lid,
              const std::vector&lt;std::size_t&gt;&amp; inpoel) -&gt; DistFCT_SDAG_CODE <span class="m-label m-flat m-info">explicit</span> </span>
            </dt>
            <dd>Constructor.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">auto <a href="#a4e159aa3bd11740f3dbf01560a5089e4" class="m-dox">diff</a>(</span><span class="m-dox-wrap">const <a href="classinciter_1_1_discretization.html" class="m-dox">Discretization</a>&amp; d,
              const tk::Fields&amp; Un) -&gt; tk::Fields</span>
            </dt>
            <dd>Compute mass diffusion rhs contribution required for the low order solution.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">void <a href="#ab906f6ddcef5075a958e3b3257d2c68c" class="m-dox-self" name="ab906f6ddcef5075a958e3b3257d2c68c">next</a>(</span><span class="m-dox-wrap">)</span>
            </dt>
            <dd>Prepare for next time step stage.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">void <a href="#aa226bb9d1f667ce0f5a34421b46eb3e1" class="m-dox">comaec</a>(</span><span class="m-dox-wrap">const std::vector&lt;std::size_t&gt;&amp; gid,
              const std::vector&lt;std::vector&lt;<a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>&gt;&gt;&amp; P)</span>
            </dt>
            <dd>Receive sums of antidiffusive element contributions on chare-boundaries.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">void <a href="#a64665af7ea23ca2d8bd2b4b5da6a6333" class="m-dox">comalw</a>(</span><span class="m-dox-wrap">const std::vector&lt;std::size_t&gt;&amp; gid,
              const std::vector&lt;std::vector&lt;<a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>&gt;&gt;&amp; Q)</span>
            </dt>
            <dd>Receive contributions to the maxima and minima of unknowns of all elements surrounding mesh nodes on chare-boundaries.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">void <a href="#a651df79bcf5b6acdfc7a9cb7d0436295" class="m-dox">comlim</a>(</span><span class="m-dox-wrap">const std::vector&lt;std::size_t&gt;&amp; gid,
              const std::vector&lt;std::vector&lt;<a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>&gt;&gt;&amp; A)</span>
            </dt>
            <dd>Receive contributions of limited antidiffusive element contributions on chare-boundaries.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">void <a href="#a7935e82a17d9c5359c119c0b824b723f" class="m-dox">aec</a>(</span><span class="m-dox-wrap">const <a href="classinciter_1_1_discretization.html" class="m-dox">Discretization</a>&amp; d,
              const tk::Fields&amp; dUh,
              const tk::Fields&amp; Un,
              const std::unordered_map&lt;std::size_t, std::vector&lt;std::pair&lt;bool, <a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>&gt;&gt;&gt;&amp; bcdir,
              const std::unordered_map&lt;int, std::unordered_set&lt;std::size_t&gt;&gt;&amp; symbcnodemap,
              const std::unordered_map&lt;int, std::unordered_map&lt;std::size_t, std::array&lt;<a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>, 4&gt;&gt;&gt;&amp; bnorm)</span>
            </dt>
            <dd>Compute and sum antidiffusive element contributions (AEC) to mesh nodes.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">void <a href="#a923e206df12b6ecfc9e8c89342fbccd5" class="m-dox">alw</a>(</span><span class="m-dox-wrap">const tk::Fields&amp; Un,
              const tk::Fields&amp; Ul,
              tk::Fields&amp;&amp; dUl,
              const CProxy_DiagCG&amp; host)</span>
            </dt>
            <dd>Compute the maximum and minimum unknowns of all elements surrounding nodes.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">void <a href="#a8df13165e6dc3d42eb1572fe6c220dcf" class="m-dox">remap</a>(</span><span class="m-dox-wrap">const <a href="classinciter_1_1_discretization.html" class="m-dox">Discretization</a>&amp; d)</span>
            </dt>
            <dd>Remap local ids after a mesh node reorder.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">void <a href="#ade7b14839d61a63dd0184d370b279919" class="m-dox">resize</a>(</span><span class="m-dox-wrap">std::size_t nu,
              const <a href="namespacetk.html#afae1f1be5bf7e58189087d896b6d6ad4" class="m-dox">tk::<wbr />NodeCommMap</a>&amp; nodeCommMap,
              const std::unordered_map&lt;std::size_t, std::size_t&gt;&amp; bid,
              const std::unordered_map&lt;std::size_t, std::size_t&gt;&amp; lid,
              const std::vector&lt;std::size_t&gt;&amp; inpoel)</span>
            </dt>
            <dd>Resize FCT data structures (e.g., after mesh refinement)</dd>
            <dt>
              <span class="m-dox-wrap-bumper">auto <a href="#a8898f15c4e680c74ad8376d5b0e4dc8a" class="m-dox">fields</a>(</span><span class="m-dox-wrap">) const -&gt; std::tuple&lt;std::vector&lt;std::string&gt;, std::vector&lt;std::vector&lt;<a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>&gt;&gt;, std::vector&lt;std::string&gt;, std::vector&lt;std::vector&lt;<a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>&gt;&gt;&gt;</span>
            </dt>
            <dd>Collect mesh output fields from FCT.</dd>
          </dl>
        </section>
        <section id="packunpack-charm-serialization-routines">
          <h2><a href="#packunpack-charm-serialization-routines">Pack/unpack (Charm++ serialization) routines</a></h2>
          <dl class="m-dox">
            <dt>
              <span class="m-dox-wrap-bumper">void <a href="#a2a97009243d434fdb373a47e713def9b" class="m-dox">pup</a>(</span><span class="m-dox-wrap">PUP::er&amp; p) override</span>
            </dt>
            <dd>Pack/Unpack serialize member function.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">void <a href="#a25985717301173d753aef965b0ef0d15" class="m-dox">operator|</a>(</span><span class="m-dox-wrap">PUP::er&amp; p,
              <a href="classinciter_1_1_dist_f_c_t.html" class="m-dox">DistFCT</a>&amp; i)</span>
            </dt>
            <dd>Pack/Unpack serialize operator|.</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-dox-details" id="abe531fd245e1d5af71dc71f57cb9f06d"><div>
            <h3>
              <span class="m-dox-wrap-bumper">DistFCT_SDAG_CODE inciter::<wbr />DistFCT::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#abe531fd245e1d5af71dc71f57cb9f06d" class="m-dox-self">DistFCT</a>(</span><span class="m-dox-wrap">int nchare,
              std::size_t nu,
              std::size_t np,
              const <a href="namespacetk.html#afae1f1be5bf7e58189087d896b6d6ad4" class="m-dox">tk::<wbr />NodeCommMap</a>&amp; nodeCommMap,
              const std::unordered_map&lt;std::size_t, std::size_t&gt;&amp; bid,
              const std::unordered_map&lt;std::size_t, std::size_t&gt;&amp; lid,
              const std::vector&lt;std::size_t&gt;&amp; inpoel) <span class="m-label m-info">explicit</span> </span></span>
            </h3>
            <p>Constructor.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">nchare&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Total number of worker chares</td>
                </tr>
                <tr>
                  <td>nu&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Number of unknowns in solution vector</td>
                </tr>
                <tr>
                  <td>np&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Total number of properties, i.e., scalar variables or components, per unknown in solution vector</td>
                </tr>
                <tr>
                  <td>nodeCommMap&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Global mesh node IDs associated to chare IDs bordering the mesh chunk we operate on</td>
                </tr>
                <tr>
                  <td>bid&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Local chare-boundary mesh node IDs at which we receive contributions associated to global mesh node IDs of mesh elements we contribute to</td>
                </tr>
                <tr>
                  <td>lid&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Local mesh node ids associated to the global ones of owned elements</td>
                </tr>
                <tr>
                  <td>inpoel&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Mesh connectivity of our chunk of the mesh</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-dox-details" id="a4e159aa3bd11740f3dbf01560a5089e4"><div>
            <h3>
              <span class="m-dox-wrap-bumper">tk::Fields inciter::<wbr />DistFCT::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a4e159aa3bd11740f3dbf01560a5089e4" class="m-dox-self">diff</a>(</span><span class="m-dox-wrap">const <a href="classinciter_1_1_discretization.html" class="m-dox">Discretization</a>&amp; d,
              const tk::Fields&amp; Un)</span></span>
            </h3>
            <p>Compute mass diffusion rhs contribution required for the low order solution.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">d&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td><a href="classinciter_1_1_discretization.html" class="m-dox">Discretization</a> proxy to read mesh data from</td>
                </tr>
                <tr>
                  <td>Un&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Solution at the previous time step</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <th>Returns</th>
                  <td>Mass diffusion contribution to the RHS of the low order system</td>
                </tr>
              </tfoot>
            </table>
          </div></section>
          <section class="m-dox-details" id="aa226bb9d1f667ce0f5a34421b46eb3e1"><div>
            <h3>
              <span class="m-dox-wrap-bumper">void inciter::<wbr />DistFCT::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#aa226bb9d1f667ce0f5a34421b46eb3e1" class="m-dox-self">comaec</a>(</span><span class="m-dox-wrap">const std::vector&lt;std::size_t&gt;&amp; gid,
              const std::vector&lt;std::vector&lt;<a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>&gt;&gt;&amp; P)</span></span>
            </h3>
            <p>Receive sums of antidiffusive element contributions on chare-boundaries.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">gid&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Global mesh node IDs at which we receive AEC contributions</td>
                </tr>
                <tr>
                  <td>P&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Partial sums of positive (negative) antidiffusive element contributions to chare-boundary nodes</td>
                </tr>
              </tbody>
            </table>
<p>This function receives contributions to m_p, which stores the sum of all positive (negative) antidiffusive element contributions to nodes (Lohner: P^{+,-}_i), see also <a href="classinciter_1_1_flux_corrector.html#a2f203bc0368892902399a2a3f4ec4b25" class="m-dox">FluxCorrector::<wbr />aec()</a>. While m_p stores own contributions, m_pc collects the neighbor chare contributions during communication. This way work on m_p and m_pc is overlapped. The two are combined in <a href="classinciter_1_1_dist_f_c_t.html#af5004ffbefdbafab543680fe0e169f81" class="m-dox">lim()</a>.</p>
          </div></section>
          <section class="m-dox-details" id="a64665af7ea23ca2d8bd2b4b5da6a6333"><div>
            <h3>
              <span class="m-dox-wrap-bumper">void inciter::<wbr />DistFCT::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a64665af7ea23ca2d8bd2b4b5da6a6333" class="m-dox-self">comalw</a>(</span><span class="m-dox-wrap">const std::vector&lt;std::size_t&gt;&amp; gid,
              const std::vector&lt;std::vector&lt;<a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>&gt;&gt;&amp; Q)</span></span>
            </h3>
            <p>Receive contributions to the maxima and minima of unknowns of all elements surrounding mesh nodes on chare-boundaries.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">gid&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Global mesh node IDs at which we receive contributions</td>
                </tr>
                <tr>
                  <td>Q&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Partial contributions to maximum and minimum unknowns of all elements surrounding nodes to chare-boundary nodes</td>
                </tr>
              </tbody>
            </table>
<p>This function receives contributions to m_q, which stores the maximum and mimimum unknowns of all elements surrounding each node (Lohner: u^{max,min}_i), see also <a href="classinciter_1_1_flux_corrector.html#a14e9e2da85ad9dd61e2922ac4dba5754" class="m-dox">FluxCorrector::<wbr />alw()</a>. While m_q stores own contributions, m_qc collects the neighbor chare contributions during communication. This way work on m_q and m_qc is overlapped. The two are combined in <a href="classinciter_1_1_dist_f_c_t.html#af5004ffbefdbafab543680fe0e169f81" class="m-dox">lim()</a>.</p>
          </div></section>
          <section class="m-dox-details" id="a651df79bcf5b6acdfc7a9cb7d0436295"><div>
            <h3>
              <span class="m-dox-wrap-bumper">void inciter::<wbr />DistFCT::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a651df79bcf5b6acdfc7a9cb7d0436295" class="m-dox-self">comlim</a>(</span><span class="m-dox-wrap">const std::vector&lt;std::size_t&gt;&amp; gid,
              const std::vector&lt;std::vector&lt;<a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>&gt;&gt;&amp; A)</span></span>
            </h3>
            <p>Receive contributions of limited antidiffusive element contributions on chare-boundaries.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">gid&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Global mesh node IDs at which we receive contributions</td>
                </tr>
                <tr>
                  <td>A&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Partial contributions to antidiffusive element contributions to chare-boundary nodes</td>
                </tr>
              </tbody>
            </table>
<p>This function receives contributions to m_a, which stores the limited antidiffusive element contributions assembled to nodes (Lohner: AEC^c), see also FluxCorrector::limit(). While m_a stores own contributions, m_ac collects the neighbor chare contributions during communication. This way work on m_a and m_ac is overlapped. The two are combined in <a href="classinciter_1_1_dist_f_c_t.html#ab528967a416b85bb007c849f61637a7b" class="m-dox">apply()</a>.</p>
          </div></section>
          <section class="m-dox-details" id="a7935e82a17d9c5359c119c0b824b723f"><div>
            <h3>
              <span class="m-dox-wrap-bumper">void inciter::<wbr />DistFCT::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a7935e82a17d9c5359c119c0b824b723f" class="m-dox-self">aec</a>(</span><span class="m-dox-wrap">const <a href="classinciter_1_1_discretization.html" class="m-dox">Discretization</a>&amp; d,
              const tk::Fields&amp; dUh,
              const tk::Fields&amp; Un,
              const std::unordered_map&lt;std::size_t, std::vector&lt;std::pair&lt;bool, <a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>&gt;&gt;&gt;&amp; bcdir,
              const std::unordered_map&lt;int, std::unordered_set&lt;std::size_t&gt;&gt;&amp; symbcnodemap,
              const std::unordered_map&lt;int, std::unordered_map&lt;std::size_t, std::array&lt;<a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>, 4&gt;&gt;&gt;&amp; bnorm)</span></span>
            </h3>
            <p>Compute and sum antidiffusive element contributions (AEC) to mesh nodes.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">d&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td><a href="classinciter_1_1_discretization.html" class="m-dox">Discretization</a> proxy to read mesh data from</td>
                </tr>
                <tr>
                  <td>dUh&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Increment of the high order solution</td>
                </tr>
                <tr>
                  <td>Un&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Solution at the previous time step</td>
                </tr>
                <tr>
                  <td>bcdir&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Vector of pairs of bool and boundary condition value associated to mesh node IDs at which to set Dirichlet boundary conditions. Note that this BC data structure must include boundary conditions set across all PEs, not just the ones need to be set on this PE.</td>
                </tr>
                <tr>
                  <td>symbcnodemap&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Unique set of node ids at which to set symmetry BCs</td>
                </tr>
                <tr>
                  <td>bnorm&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Face normals in boundary points: key global node id, value: unit normal, outer key: side set id</td>
                </tr>
              </tbody>
            </table>
<p>This function computes and starts communicating m_p, which stores the sum of all positive (negative) antidiffusive element contributions to nodes (Lohner: P^{+,-}_i), see also <a href="classinciter_1_1_flux_corrector.html#a2f203bc0368892902399a2a3f4ec4b25" class="m-dox">FluxCorrector::<wbr />aec()</a>.</p>
          </div></section>
          <section class="m-dox-details" id="a923e206df12b6ecfc9e8c89342fbccd5"><div>
            <h3>
              <span class="m-dox-wrap-bumper">void inciter::<wbr />DistFCT::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a923e206df12b6ecfc9e8c89342fbccd5" class="m-dox-self">alw</a>(</span><span class="m-dox-wrap">const tk::Fields&amp; Un,
              const tk::Fields&amp; Ul,
              tk::Fields&amp;&amp; dUl,
              const CProxy_DiagCG&amp; host)</span></span>
            </h3>
            <p>Compute the maximum and minimum unknowns of all elements surrounding nodes.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">Un&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Solution at the previous time step</td>
                </tr>
                <tr>
                  <td>Ul&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Low order solution</td>
                </tr>
                <tr>
                  <td>dUl&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Low order solution increment</td>
                </tr>
                <tr>
                  <td>host&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td><a href="classinciter_1_1_diag_c_g.html" class="m-dox">DiagCG</a> Charm++ proxy we interoperate with</td>
                </tr>
              </tbody>
            </table>
<p>This function computes and starts communicating m_q, which stores the maximum and mimimum unknowns of all elements surrounding each node (Lohner: u^{max,min}_i), see also <a href="classinciter_1_1_flux_corrector.html#a14e9e2da85ad9dd61e2922ac4dba5754" class="m-dox">FluxCorrector::<wbr />alw()</a>.</p>
          </div></section>
          <section class="m-dox-details" id="a8df13165e6dc3d42eb1572fe6c220dcf"><div>
            <h3>
              <span class="m-dox-wrap-bumper">void inciter::<wbr />DistFCT::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a8df13165e6dc3d42eb1572fe6c220dcf" class="m-dox-self">remap</a>(</span><span class="m-dox-wrap">const <a href="classinciter_1_1_discretization.html" class="m-dox">Discretization</a>&amp; d)</span></span>
            </h3>
            <p>Remap local ids after a mesh node reorder.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">d&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td><a href="classinciter_1_1_discretization.html" class="m-dox">Discretization</a> proxy to read mesh data from</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-dox-details" id="ade7b14839d61a63dd0184d370b279919"><div>
            <h3>
              <span class="m-dox-wrap-bumper">void inciter::<wbr />DistFCT::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#ade7b14839d61a63dd0184d370b279919" class="m-dox-self">resize</a>(</span><span class="m-dox-wrap">std::size_t nu,
              const <a href="namespacetk.html#afae1f1be5bf7e58189087d896b6d6ad4" class="m-dox">tk::<wbr />NodeCommMap</a>&amp; nodeCommMap,
              const std::unordered_map&lt;std::size_t, std::size_t&gt;&amp; bid,
              const std::unordered_map&lt;std::size_t, std::size_t&gt;&amp; lid,
              const std::vector&lt;std::size_t&gt;&amp; inpoel)</span></span>
            </h3>
            <p>Resize FCT data structures (e.g., after mesh refinement)</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">nu&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>New number of unknowns in solution vector</td>
                </tr>
                <tr>
                  <td>nodeCommMap&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>New global mesh node IDs associated to chare IDs bordering the mesh chunk we operate on</td>
                </tr>
                <tr>
                  <td>bid&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>New local chare-boundary mesh node IDs at which we receive contributions associated to global mesh node IDs of mesh elements we contribute to</td>
                </tr>
                <tr>
                  <td>lid&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>New local mesh node ids associated to the global ones of owned elements</td>
                </tr>
                <tr>
                  <td>inpoel&nbsp;<span class="m-label m-flat m-info">in</span></td>
                  <td>Mesh connectivity of our chunk of the mesh</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-dox-details" id="a8898f15c4e680c74ad8376d5b0e4dc8a"><div>
            <h3>
              <span class="m-dox-wrap-bumper">std::tuple&lt;std::vector&lt;std::string&gt;, std::vector&lt;std::vector&lt;<a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>&gt;&gt;, std::vector&lt;std::string&gt;, std::vector&lt;std::vector&lt;<a href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575" class="m-dox">tk::<wbr />real</a>&gt;&gt;&gt; inciter::<wbr />DistFCT::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a8898f15c4e680c74ad8376d5b0e4dc8a" class="m-dox-self">fields</a>(</span><span class="m-dox-wrap">) const</span></span>
            </h3>
            <p>Collect mesh output fields from FCT.</p>
            <table class="m-table m-fullwidth m-flat">
              <tfoot>
                <tr>
                  <th style="width: 1%">Returns</th>
                  <td>Names and fields in mesh cells and nodes</td>
                </tr>
              </tfoot>
            </table>
          </div></section>
          <section class="m-dox-details" id="a2a97009243d434fdb373a47e713def9b"><div>
            <h3>
              <span class="m-dox-wrap-bumper">void inciter::<wbr />DistFCT::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a2a97009243d434fdb373a47e713def9b" class="m-dox-self">pup</a>(</span><span class="m-dox-wrap">PUP::er&amp; p) override</span></span>
            </h3>
            <p>Pack/Unpack serialize member function.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">p&nbsp;<span class="m-label m-flat m-danger">in/out</span></td>
                  <td>Charm++&#x27;s PUP::er serializer object reference</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-dox-details" id="a25985717301173d753aef965b0ef0d15"><div>
            <h3>
              <span class="m-dox-wrap-bumper">void inciter::<wbr />DistFCT::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a25985717301173d753aef965b0ef0d15" class="m-dox-self">operator|</a>(</span><span class="m-dox-wrap">PUP::er&amp; p,
              <a href="classinciter_1_1_dist_f_c_t.html" class="m-dox">DistFCT</a>&amp; i)</span></span>
            </h3>
            <p>Pack/Unpack serialize operator|.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">p&nbsp;<span class="m-label m-flat m-danger">in/out</span></td>
                  <td>Charm++&#x27;s PUP::er serializer object reference</td>
                </tr>
                <tr>
                  <td>i&nbsp;<span class="m-label m-flat m-danger">in/out</span></td>
                  <td><a href="classinciter_1_1_dist_f_c_t.html" class="m-dox">DistFCT</a> object reference</td>
                </tr>
              </tbody>
            </table>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-dox-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-dox-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-dox-search-content">
          <input type="search" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" />
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript. Enable it or <a href="https://google.com/search?q=site:quinoacomputing.org/quinoa.github.io+">use an external search engine</a>.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            Search for symbols, directories, files, pages or modules. You can omit any
            prefix from the symbol or file path; adding a <code>:</code> or <code>/</code>
            suffix lists all members of given symbol or directory. Navigate through the
            list using <span class="m-label m-dim">&darr;</span> and
            <span class="m-label m-dim">&uarr;</span>, press
            <span class="m-label m-dim">Enter</span> to go.
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.<br />Maybe try a full-text <a href="#" id="search-external" data-search-engine="https://google.com/search?q=site:quinoacomputing.org/quinoa.github.io+{query}">search with external engine</a>?</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search.js"></script>
<script src="searchdata.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Quinoa docs, part of the <a href="http://quinoacomputing.org/quinoa.github.io/">Quinoa project</a>. Copyright Â© J. Bakosi 2012&ndash;2015, Los Alamos National Security, LLC, 2016&ndash;2018, <a href="https://www.triadns.org/">Triad National Security, LLC,</a> 2019-2021. Generated on Tuesday, Nov 23, 2021 based on <a href="https://github.com/quinoacomputing/quinoa/commit/167092848">167092848</a> by <a href="http://doxygen.org/">Doxygen</a> and <a href="http://mcss.mosra.cz/">m.css</a>. Contact us via <a href="https://github.com/quinoacomputing/quinoa/">GitHub</a>, <a href="https://groups.io/g/quinoa">Email</a> or <a href="https://quinoa.zulipchat.com">Chat</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>