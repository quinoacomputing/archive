<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quinoa: /scratch/jbakosi/tools/TeamCity/BuildAgent14/work/821a9fd6f64749d9/src/Inciter/CG.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quinoa.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_606df7a4664720c111e6e5b0e11c4e03.html">Inciter</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<div class="title">CG.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>CG advances a system of PDEs with the continuous Galerkin scheme.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;cstddef&gt;</code><br />
<code>#include &lt;iosfwd&gt;</code><br />
<code>#include &lt;utility&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;cstring&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;unordered_map&gt;</code><br />
<code>#include &lt;unordered_set&gt;</code><br />
<code>#include &lt;set&gt;</code><br />
<code>#include &quot;QuinoaConfig.h&quot;</code><br />
<code>#include &quot;Types.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_fields_8h_source.html">Fields.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_derived_data_8h_source.html">DerivedData.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_vector_reducer_8h_source.html">VectorReducer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_inciter_2_input_deck_2_input_deck_8h_source.html">Inciter/InputDeck/InputDeck.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cg_8decl_8h_source.html">NoWarning/cg.decl.h</a>&quot;</code><br />
</div>
<p><a href="_c_g_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_c_g.html">inciter::CG</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classinciter_1_1_c_g.html" title="CG Charm++ chare array used to advance PDEs in time with CG+LW+FCT. ">CG</a> Charm++ chare array used to advance PDEs in time with CG+LW+FCT.  <a href="classinciter_1_1_c_g.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacetk"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetk.html">tk</a></td></tr>
<tr class="memdesc:namespacetk"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toolkit declarations and definitions for general purpose utilities. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceinciter"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceinciter.html">inciter</a></td></tr>
<tr class="memdesc:namespaceinciter"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inciter declarations and definitions. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>CG advances a system of PDEs with the continuous Galerkin scheme. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>2012-2015, J. Bakosi, 2016-2017, Los Alamos National Security, LLC.</dd></dl>
<p>CG advances a system of partial differential equations (PDEs) using continuous Galerkin (CG) finite element (FE) spatial discretization (using linear shapefunctions on tetrahedron elements) combined with a time stepping scheme that is equivalent to the Lax-Wendroff (LW) scheme within the unstructured-mesh FE context and treats discontinuities with flux-corrected transport (FCT).</p>
<p>There are a potentially large number of CG Charm++ chares created by Transporter. Each CG gets a chunk of the full load (part of the mesh) and does the same: initializes and advances a number of PDE systems in time.</p>
<p>The implementation uses the Charm++ runtime system and is fully asynchronous, overlapping computation and communication. The algorithm utilizes the structured dagger (SDAG) Charm++ functionality. The high-level overview of the algorithm structure and how it interfaces with Charm++ is discussed in the Charm++ interface file <a class="el" href="cg_8ci.html">src/Inciter/cg.ci</a>.</p>
<h4>Call graph</h4>
<p>The following is a directed acyclic graph (DAG) that outlines the asynchronous algorithm implemented in this class The detailed discussion of the algorithm is given in the Charm++ interface file <a class="el" href="transporter_8ci.html">transporter.ci</a>, which also repeats the graph below using ASCII graphics. On the DAG orange fills denote global synchronization points that contain or eventually lead to global reductions. Dashed lines are potential shortcuts that allow jumping over some of the task-graph under some circumstances or optional code paths (taken, e.g., only in DEBUG mode). See the detailed discussion in <a class="el" href="cg_8ci.html">cg.ci</a>. </p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_inline_dotgraph_1.svg" width="592" height="352"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
 <div class="fragment"><div class="line">// *****************************************************************************</div><div class="line">/*!</div><div class="line">  \file      src/Inciter/cg.ci</div><div class="line">  \copyright 2012-2015, J. Bakosi, 2016-2017, Los Alamos National Security, LLC.</div><div class="line">  \brief     Charm++ module interface file for the continuous Galerkin scheme</div><div class="line">  \details   Charm++ module interface file for the continuous Galerkin scheme.</div><div class="line">  \see       CG.h and CG.C for more info.</div><div class="line">*/</div><div class="line">// *****************************************************************************</div><div class="line"></div><div class="line">module cg {</div><div class="line"></div><div class="line">  extern module transporter;</div><div class="line">  extern module discretization;</div><div class="line">  extern module solver;</div><div class="line"></div><div class="line">  include &quot;UnsMesh.h&quot;;</div><div class="line">  include &quot;PUPUtil.h&quot;;</div><div class="line"></div><div class="line">  namespace inciter {</div><div class="line"></div><div class="line">    array [1D] CG {</div><div class="line">      entry CG( const CProxy_Discretization&amp; disc,</div><div class="line">                const tk::CProxy_Solver&amp; solver );</div><div class="line">      entry void setup( tk::real v );</div><div class="line">      entry void dt();</div><div class="line">      entry [reductiontarget] void advance( tk::real newdt );</div><div class="line">      entry void updateSol( const std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line">                            const std::vector&lt; tk::real &gt;&amp; sol );</div><div class="line">      entry void updateLowSol( const std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line">                               const std::vector&lt; tk::real &gt;&amp; sol );</div><div class="line">      entry void comaec( const std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line">                         const std::vector&lt; std::vector&lt; tk::real &gt; &gt;&amp; P );</div><div class="line">      entry void comalw( const std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line">                         const std::vector&lt; std::vector&lt; tk::real &gt; &gt;&amp; Q );</div><div class="line">      entry void comlim( const std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line">                         const std::vector&lt; std::vector&lt; tk::real &gt; &gt;&amp; U );</div><div class="line"></div><div class="line">      // SDAG code follows. See http://charm.cs.illinois.edu/manuals/html/</div><div class="line">      // charm++/manual.html, Sec. &quot;Structured Control Flow: Structured Dagger&quot;.</div><div class="line"></div><div class="line">      // High-level overview of the dependency and asynchronous call structure</div><div class="line">      // ---------------------------------------------------------------------</div><div class="line">      //</div><div class="line">      // Directed Acyclic Graph (DAG):</div><div class="line">      // -----------------------------</div><div class="line">      //</div><div class="line">      // See src/Inciter/CG.h.</div><div class="line">      //</div><div class="line">      // Interpretation of the above DAG</div><div class="line">      // -------------------------------</div><div class="line">      // Control flow is from left to right and top to bottom.</div><div class="line">      //</div><div class="line">      // Only in DEBUG mode, wait4ver(): When the low and high order solutions</div><div class="line">      // have been updated, and the own portion of the antidiffusive element</div><div class="line">      // contributions (AEC) have been computed, we optionally (inly in DEBUG</div><div class="line">      // mode) verify that the AECs assembled to nodes equal to the difference</div><div class="line">      // between the high and low order increments. See also</div><div class="line">      // FluxCorrector::aec() and FluxCorrector::verify(). Note that this</div><div class="line">      // verification is only done if there is only a single CG chare as</div><div class="line">      // the correct verification would entail communication for multiple</div><div class="line">      // chares. Note also that the DAG conditions below for wait4ver() require</div><div class="line">      // the own contributions to the AEC and ALW instead of requiring the low</div><div class="line">      // and high order solutions and the own AEC. Requiring the former set (as</div><div class="line">      // implemented) is stronger than the latter, because the former can only</div><div class="line">      // be satisfied when the latter is also satisfied. The former is</div><div class="line">      // implemented because that avoids introducing two more SDAG messages,</div><div class="line">      // e.g., lo_complete() and hi_complete(), and that would require 3</div><div class="line">      // conditions instead of two, leading to simpler code.</div><div class="line">      //</div><div class="line">      // Computing limited antidiffusive element contributions, wait4fct():</div><div class="line">      // Computing and communicating contributions on chare-boundaries of</div><div class="line">      // antidiffusive element contributions (AEC), and the maximum and minimum</div><div class="line">      // unknowns of elements surrounding nodes (ALW) are overlapped. See</div><div class="line">      // aec(), comaec(), alw(), comalw(). When all are complete on a single</div><div class="line">      // chare, computing the limited antidiffusive element contributions can</div><div class="line">      // start.</div><div class="line">      //</div><div class="line">      // Applying the limited antidiffusive element contributions, wait4app():</div><div class="line">      // Computing the limited antidiffusive element contributions assembled and</div><div class="line">      // applied to mesh nodes involves own and contributions on the</div><div class="line">      // chare-boundary nodes. When both are done on a single chare, applying</div><div class="line">      // the new limited AECs can be done.</div><div class="line">      //</div><div class="line">      // Note that the none of wait4ver(), wait4fct(), and wait4app(), nor its</div><div class="line">      // underlying computations and communications involve global reductions or</div><div class="line">      // broadcasts: the entire FCT algorithm runs completely independent on</div><div class="line">      // each CG chare, and exercising task parallelism within.</div><div class="line"></div><div class="line">      #ifndef NDEBUG</div><div class="line">      entry void wait4ver() {</div><div class="line">        when ownaec_complete(), ownalw_complete() serial &quot;ver&quot; { verify(); } };</div><div class="line">      #endif</div><div class="line"></div><div class="line">      entry void wait4fct() {</div><div class="line">        when ownaec_complete(), comaec_complete(),</div><div class="line">             ownalw_complete(), comalw_complete() serial &quot;fct&quot; { lim(); } };</div><div class="line"></div><div class="line">      entry void wait4app() {</div><div class="line">        when ownlim_complete(), comlim_complete() serial &quot;app&quot; { apply(); } };</div><div class="line"></div><div class="line">      entry void ownaec_complete();</div><div class="line">      entry void ownalw_complete();</div><div class="line">      entry void ownlim_complete();</div><div class="line">      entry void comaec_complete();</div><div class="line">      entry void comalw_complete();</div><div class="line">      entry void comlim_complete();</div><div class="line">    };</div><div class="line"></div><div class="line">  } // inciter::</div><div class="line"></div><div class="line">}</div></div><!-- fragment --> 
<p class="definition">Definition in file <a class="el" href="_c_g_8h_source.html">CG.h</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Nov 8 2017 08:06:10 for Quinoa by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
