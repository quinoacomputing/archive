<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Build | Quinoa docs</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="quinoa.m-dark-noindent+doxygen.compiled.css" />
  <link rel="icon" href="quinoa_sum.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">Quinoa <span class="m-thin">docs</span></a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-dox-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="why.html">Why</a></li>
            <li>
              <a href="build.html" id="m-navbar-current">Build</a>
              <ol>
                <li><a href="https://quinoacomputing.org/archive/index.html#mainpage_build">Quickstart</a></li>
                <li><a href="git_submodules_subtrees.html">Modules</a></li>
                <li><a href="licenses.html">Libraries</a></li>
                <li><a href="build_system.html">Internals</a></li>
              </ol>
            </li>
            <li>
              <a href="https://quinoacomputing.org/archive/index.html#mainpage_tools">Tools</a>
              <ol>
                <li><a href="walker_main.html">Walker</a></li>
                <li><a href="inciter_main.html">Inciter</a></li>
                <li><a href="rngtest_main.html">RNGTest</a></li>
                <li><a href="unittest_main.html">UnitTest</a></li>
                <li><a href="meshconv_main.html">MeshConv</a></li>
              </ol>
            </li>
            <li><a href="namespaces.html">Namespaces</a></li>
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="7">
            <li>
              <a href="resources.html">Resources</a>
              <ol>
                <li><a href="https://github.com/quinoacomputing/quinoa">GitHub</a></li>
                <li><a href="https://github.com/quinoacomputing/quinoa/releases">Tarballs</a></li>
                <li><a href="https://github.com/quinoacomputing/quinoa/blob/master/LICENSE">License</a></li>
                <li><a href="roadmap.html">Roadmap</a></li>
                <li><a href="contributing.html">Contributing</a></li>
                <li><a href="papers.html">Publications</a></li>
                <li><a href="https://quinoa.zulipchat.com">Chat</a></li>
                <li><a href="https://quinoa.groups.io">Email list</a></li>
                <li><a href="coverage.html">Coverage</a></li>
                <li><a href="https://dev.azure.com/quinoacomputing/Quinoa">Azure</a></li>
                <li><a href="http://www.openhub.net/p/quinoacomputing">OpenHub</a></li>
                <li><a href="https://bestpractices.coreinfrastructure.org/projects/2120">Practices</a></li>
              </ol>
            </li>
            <li class="m-show-m"><a href="#search" class="m-dox-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          Build
        </h1>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li><a href="#build_quick">Quick start</a></li>
            <li><a href="#build_requirements">Minimum requirements</a></li>
            <li><a href="#build_supported">Routinely tested</a></li>
            <li><a href="#build_stages">Two-stage build</a></li>
            <li><a href="#build_default">Build using the defaults</a></li>
            <li><a href="#build_nonrecursive">Working with a non-recursive clone</a></li>
            <li><a href="#build_specific_executables">Build specific executables only</a></li>
            <li><a href="#build_systemlibs">Using system-wide packages</a></li>
            <li><a href="#build_mac">Build on Mac OS</a></li>
            <li><a href="#build_clang">Build using Clang or Intel compilers</a></li>
            <li><a href="#build_rndq">Build using Charm++&#x27;s randomized message queues</a></li>
            <li><a href="#build_smp">Build using Charm++&#x27;s SMP mode</a></li>
            <li><a href="#build_static">Static build</a></li>
            <li><a href="#build_projections">Build with Charm++&#x27;s Projections enabled</a></li>
            <li><a href="#build_ninja">Using ninja instead of make</a></li>
            <li><a href="#build_optional">Optional third-party libraries</a></li>
            <li><a href="#build_debug">Build in Debug mode</a></li>
            <li><a href="#build_disable">Disabling packages</a></li>
            <li><a href="#build_cpplibrary">Configuring the C++ standard library</a></li>
            <li><a href="#build_system_specs">Build system features, requirements, and defaults</a></li>
            <li><a href="#build_docker">Helpful docker image configurations</a></li>
            <li><a href="#build_cmake">Main cmake files</a></li>
            <li><a href="#build_feedback">Feedback</a></li>
          </ul>
        </div>
<p>This page discusses various ways of building Quinoa, including requirements, optional libraries, defaults, and build system options.</p><section id="build_quick"><h2><a href="#build_quick">Quick start</a></h2><p>See section <a href="index.html#mainpage_build" class="m-dox">Build</a> on the main page.</p></section><section id="build_requirements"><h2><a href="#build_requirements">Minimum requirements</a></h2><ul><li>Fortran compiler</li><li>C and C++ compilers, the latter implementing the C++17 standard</li><li>Message Passing Interface library, e.g., <a href="https://www.open-mpi.org">OpenMPI</a></li></ul></section><section id="build_supported"><h2><a href="#build_supported">Routinely tested</a></h2><p>Compilers:</p><ul><li>GNU</li><li>Clang</li><li>Intel</li></ul><p>C++ standard library:</p><ul><li>libc++</li><li>libstdc++</li></ul><p>MPI:</p><ul><li>OpenMPI</li><li>Intel MPI</li></ul><p>Operating systems:</p><ul><li>Debian Linux</li><li>Alpine Linux</li><li>RedHat Enterprise Linux</li><li>MacOS</li></ul></section><section id="build_stages"><h2><a href="#build_stages">Two-stage build</a></h2><p>Quinoa is built in two stages, of which the first one may be optional:</p><ol><li>Build third-party libraries (TPLs)</li><li>Build Quinoa</li></ol><p>Both stages consist of the following two steps</p><ul><li>Use cmake to configure the build</li><li>Perform the build</li></ul><p>The first step may be optional if all TPLs are found on the system or are pre-installed and/or configured, e.g., via environment modules.</p><aside class="m-note m-info"><h4>Note</h4><p>If some libraries are not found by the Quinoa cmake step, not all executable targets will be configured. Examples are builds configured for only a single executable, see <a href="build.html#build_specific_executables" class="m-dox">Build specific executables only</a>, or a build configured for only building the documentation, see <a href="https://github.com/quinoacomputing/buildenv/blob/master/debian-doc">https:/<wbr />/<wbr />github.com/<wbr />quinoacomputing/<wbr />buildenv/<wbr />blob/<wbr />master/<wbr />debian-doc</a>.</p></aside></section><section id="build_default"><h2><a href="#build_default">Build using the defaults</a></h2><p>The easiest, but not necessarily the quickest, way to build Quinoa is to use the defaults.</p><p>Install the prerequisites on a Debian-based Linux do</p><pre>   sudo apt-get install cmake gfortran gcc g++ openmpi-bin libopenmpi-dev
</pre><p>Clone the code with the external packages (third party libraries, TPLs):</p><pre>   git clone --recurse-submodules https://github.com/quinoacomputing/quinoa.git
</pre><p>Build the TPLs in an empty directory:</p><pre>   cd quinoa
   mkdir external/build
   cd external/build
   cmake -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_C_COMPILER=mpicc -DCMAKE_Fortran_COMPILER=mpif90 ..
   make -sj$(grep -c processor /proc/cpuinfo)
</pre><p>If the above went fine, we build the code, in a new empty build directory:</p><pre>   cd quinoa
   mkdir build
   cd build
   cmake -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_C_COMPILER=mpicc ../src
   make -sj$(grep -c processor /proc/cpuinfo)
</pre><p>If this also went fine, let&#x27;s run the unit-, and regression tests in the build directory:</p><pre>   cd quinoa/build
   ./charmrun +p$(grep -c processor /proc/cpuinfo) Main/unittest -v -q
   ctest -j$(grep -c processor /proc/cpuinfo) -LE extreme
</pre><p>This will run all tests, except those that would take a long time. If all of the above steps finished without error, you have successfully built Quinoa. You can run the executables from <code>build/Main</code> or install them with</p><pre>    make install
</pre><p>The default install directory is <code>/usr/local</code>, which usually needs root permissions. You can change that by configuring a different path in the <code>CMAKE_INSTALL_PREFIX</code> cmake variable.</p></section><section id="build_nonrecursive"><h2><a href="#build_nonrecursive">Working with a non-recursive clone</a></h2><p>The default build process, described in section <a href="build.html#build_default" class="m-dox">Build using the defaults</a>, instructs you to do a <em>recursive</em> clone, which clones not only the source code for Quinoa but also all external packages (third-party libraries, TPLs). The TPLs are pulled in to directory <code>external/</code> as git submodules and contain significantly more data and files than the Quinoa source. If you plan to do code development, it is quicker to work with the repository (changing branches, stashing, etc.) if you work with a <em>non-recursive</em> clone.</p><p>To make this work, we need to clone the TPLs separately:</p><pre>   git clone --recurse-submodules https://github.com/quinoacomputing/quinoa-tpl.git
</pre><p>Then build the TPLs using a similar process as in <a href="build.html#build_default" class="m-dox">Build using the defaults</a> :</p><pre>   cd quinoa-tpl
   mkdir build
   cd build
   cmake -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_C_COMPILER=mpicc -DCMAKE_Fortran_COMPILER=mpif90 ..
   make -sj$(grep -c processor /proc/cpuinfo)
</pre><p>By default, this will install all TPLs in <code>quinoa-tpl/install/&lt;compiler&gt;-&lt;arch&gt;/</code>, e.g., <code>quinoa-tpl/install/gnu-x86_64/</code>. Now we can clone Quinoa without cloning the TPLs:</p><pre>   git clone https://github.com/quinoacomputing/quinoa.git
</pre><p>To build the code using the TPLs installed above, we tell that location to cmake using the cmake variable <code>TPL_DIR</code>:</p><pre>   cd quinoa
   mkdir build
   cd build
   cmake -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_C_COMPILER=mpicc -DTPL_DIR=&lt;path-to-quinoa-tpl&gt;/install/gnu-x86_64/ ../src
   make -sj$(grep -c processor /proc/cpuinfo)
</pre><p>Since the Quinoa clone no longer contains initialized submodules, git operations are faster. This difference can be significant on network-mounted or shared drives.</p><p>If the need arises, e.g., to pull in changes from the TPL submodules into such a non-recursive clone, the <code>external/</code> directory can still be populated under the quinoa clone by initializing the submodules:</p><pre>   cd quinoa
   git submodule init
   git submodule update --recursive
   cd external
   git submodule init
   git submodule update --recursive
   cd ..
   git submodule status --recursive
</pre><p>As you can see form the output of the commands above, there are two layers of git submodules. You can also just use the above as a single, chained command:</p><pre>   cd quinoa
   git submodule init &amp;&amp; git submodule update --recursive &amp;&amp; cd external &amp;&amp; git submodule init &amp;&amp; git submodule update --recursive &amp;&amp; cd .. &amp;&amp; git submodule status --recursive
</pre><p>After this under <code>quinoa/external/</code> the TPLs can be updated, e.g., <code>git pull</code>, etc. When the TPL sources are, again, no longer needed, we de-populate it:</p><pre>   cd quinoa
   git submodule deinit --all
</pre><aside class="m-note m-info"><h4>Note</h4><p>To effect code-reuse between <a href="https://github.com/quinoacomputing/quinoa">quinoa</a> and <a href="https://github.com/quinoacomputing/quinoa-tpl">quinoa-tpl</a> the <code>cmake/</code> directory is pulled into <em>quinoa</em> as a git subtree, (and as a submodule into <em>quinoa-tpl</em>) whose origin is <a href="https://github.com/quinoacomputing/cmake-modules">https:/<wbr />/<wbr />github.com/<wbr />quinoacomputing/<wbr />cmake-modules</a>. Therefore changes to files under <code>cmake/</code> should be made to the <a href="https://github.com/quinoacomputing/cmake-modules">cmake-modules</a> repository and then pulled in to <em>quinoa</em> and <em>quinoa-tpl</em>. See also the page on on <a href="git_submodules_subtrees.html" class="m-dox">Modules</a>.</p></aside></section><section id="build_specific_executables"><h2><a href="#build_specific_executables">Build specific executables only</a></h2><p>The default build process, described in section <a href="build.html#build_default" class="m-dox">Build using the defaults</a>, does a recursive clone of <em>most</em> TPLs and builds <em>all</em> executables. If you only care about a particular tool, e.g., <a href="inciter_main.html" class="m-dox">Inciter</a>, you can</p><ol><li><p>Clone only those TPLs that are required for the given tool (instead of cloning them all), e.g.,</p><pre> git clone https://github.com/quinoacomputing/quinoa.git &amp;&amp; cd quinoa
 git submodule init &amp;&amp; git submodule update &amp;&amp; cd external
 git -c submodule.&quot;src/pugixml&quot;.update=none -c submodule.&quot;src/rngsse2&quot;.update=none -c submodule.&quot;src/testu01&quot;.update=none -c submodule.&quot;src/tut&quot;.update=none -c submodule.&quot;src/backward-cpp&quot;.update=none -c submodule.&quot;src/omega_h&quot;.update=none -c submodule.&quot;src/doxygen&quot;.update=none -c submodule.&quot;src/m.css&quot;.update=none -c submodule.&quot;src/root&quot;.update=none -c submodule.&quot;src/aec&quot;.update=none submodule update --init --recursive
</pre></li><li><p>Build only those TPLs that are required for the given executable by setting the <code>&lt;executable&gt;_ONLY</code> cmake variable to <code>true</code>, e.g.,</p><pre> cd quinoa &amp;&amp; mkdir external/build &amp;&amp; cd external/build
 cmake -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_C_COMPILER=mpicc -DCMAKE_Fortran_COMPILER=mpif90 -DINCITER_ONLY=true ..
 make -sj$(grep -c processor /proc/cpuinfo)
</pre><p>This will build only the TPLs required for <a href="inciter_main.html" class="m-dox">Inciter</a>. The rest of the build process is the same as in <a href="build.html#build_default" class="m-dox">Build using the defaults</a> : running cmake configuring Quinoa will enable only those build targets for which it finds the required TPLs. Such <code>*_ONLY</code> cmake variables are defined for all executable targets in <a href="https://github.com/quinoacomputing/quinoa-tpl/blob/master/CMakeLists.txt">&lt;quinoa-tpl&gt;/<wbr />CMakeLists.txt</a>, in the section starting with the comment line</p><pre>   # Set which libraries are built/searched by default
</pre><p>Here are the <code>git submodule update</code> commands that pull in <em>only</em> the TPLs required for the given tool for each executable:</p></li></ol><p><a href="walker_main.html" class="m-dox">Walker</a></p><pre>   git -c submodule.&quot;src/pugixml&quot;.update=none -c submodule.&quot;src/rngsse2&quot;.update=none -c submodule.&quot;src/aec&quot;.update=none -c submodule.&quot;src/testu01&quot;.update=none -c submodule.&quot;src/tut&quot;.update=none -c submodule.&quot;src/root&quot;.update=none -c submodule.&quot;src/backward-cpp&quot;.update=none -c submodule.&quot;src/omega_h&quot;.update=none -c submodule.&quot;src/doxygen&quot;.update=none -c submodule.&quot;src/m.css&quot;.update=none -c submodule.&quot;src/sol2&quot;.update=none submodule update --init --recursive
</pre> <p><a href="inciter_main.html" class="m-dox">Inciter</a></p><pre>   git -c submodule.&quot;src/pugixml&quot;.update=none -c submodule.&quot;src/rngsse2&quot;.update=none -c submodule.&quot;src/testu01&quot;.update=none -c submodule.&quot;src/tut&quot;.update=none -c submodule.&quot;src/backward-cpp&quot;.update=none -c submodule.&quot;src/omega_h&quot;.update=none -c submodule.&quot;src/doxygen&quot;.update=none -c submodule.&quot;src/m.css&quot;.update=none -c submodule.&quot;src/root&quot;.update=none -c submodule.&quot;src/aec&quot;.update=none -c submodule.&quot;src/sol2&quot;.update=none submodule update --init --recursive
</pre> <p><a href="rngtest_main.html" class="m-dox">RNGTest</a></p><pre>   git -c submodule.&quot;src/hdf5&quot;.update=none -c submodule.&quot;src/netcdf&quot;.update=none -c submodule.&quot;src/pugixml&quot;.update=none -c submodule.&quot;src/h5part&quot;.update=none -c submodule.&quot;src/trilinos&quot;.update=none -c submodule.&quot;src/tut&quot;.update=none -c submodule.&quot;src/numdiff&quot;.update=none -c submodule.&quot;src/root&quot;.update=none -c submodule.&quot;src/backward-cpp&quot;.update=none -c submodule.&quot;src/highwayhash&quot;.update=none -c submodule.&quot;src/omega_h&quot;.update=none -c submodule.&quot;src/doxygen&quot;.update=none -c submodule.&quot;src/m.css&quot;.update=none -c submodule.&quot;src/aec&quot;.update=none -c submodule.&quot;src/sol2&quot;.update=none submodule update --init --recursive
</pre> <p><a href="unittest_main.html" class="m-dox">UnitTest</a></p><pre>   git -c submodule.&quot;src/rngsse2&quot;.update=none -c submodule.&quot;src/testu01&quot;.update=none -c submodule.&quot;src/numdiff&quot;.update=none -c submodule.&quot;src/root&quot;.update=none  -c submodule.&quot;src/backward-cpp&quot;.update=none -c submodule.&quot;src/omega_h&quot;.update=none -c submodule.&quot;src/doxygen&quot;.update=none  -c submodule.&quot;src/m.css&quot;.update=none -c submodule.&quot;src/aec&quot;.update=none -c submodule.&quot;src/sol2&quot;.update=none submodule update --init --recursive
</pre> <p><a href="meshconv_main.html" class="m-dox">MeshConv</a></p><pre>   git -c submodule.&quot;src/random123&quot;.update=none -c submodule.&quot;src/rngsse2&quot;.update=none -c submodule.&quot;src/lapack&quot;.update=none -c submodule.&quot;src/aec&quot;.update=none -c submodule.&quot;src/h5part&quot;.update=none -c submodule.&quot;src/testu01&quot;.update=none -c submodule.&quot;src/tut&quot;.update=none -c submodule.&quot;src/root&quot;.update=none -c submodule.&quot;src/backward-cpp&quot;.update=none -c submodule.&quot;src/omega_h&quot;.update=none -c submodule.&quot;src/doxygen&quot;.update=none -c submodule.&quot;src/m.css&quot;.update=none -c submodule.&quot;src/sol2&quot;.update=none submodule update --init --recursive
</pre> <p><a href="fileconv_main.html" class="m-dox">FileConv</a></p><pre>   git -c submodule.&quot;src/random123&quot;.update=none -c submodule.&quot;src/rngsse2&quot;.update=none -c submodule.&quot;src/lapack&quot;.update=none -c submodule.&quot;src/aec&quot;.update=none -c submodule.&quot;src/h5part&quot;.update=none -c submodule.&quot;src/testu01&quot;.update=none -c submodule.&quot;src/tut&quot;.update=none -c submodule.&quot;src/numdiff&quot;.update=none -c submodule.&quot;src/backward-cpp&quot;.update=none -c submodule.&quot;src/omega_h&quot;.update=none -c submodule.&quot;src/doxygen&quot;.update=none -c submodule.&quot;src/m.css&quot;.update=none -c submodule.&quot;src/sol2&quot;.update=none submodule update --init --recursive
</pre></section><section id="build_systemlibs"><h2><a href="#build_systemlibs">Using system-wide packages</a></h2><p>The default build process, described in section <a href="build.html#build_default" class="m-dox">Build using the defaults</a>, attempts to find (and if not found, build) all required and most optional packages that are enabled by default. See the section on <a href="build.html#build_optional" class="m-dox">Optional third-party libraries</a> for what packages are enabled by default. On some platforms, it is advantageous (and could be faster) to use the packages provided by the system.</p><p>On a Debian-based Linux you can pre-install the packages given in</p><pre>   quinoa/tools/docker/Dockerfile.quinoa-build-debian
</pre><p>On Alpine Linux you can pre-install the packages given in</p><pre>   quinoa/tools/docker/Dockerfile.quinoa-build-alpine
</pre></section><section id="build_mac"><h2><a href="#build_mac">Build on Mac OS</a></h2><p>On Mac OS we do <em>not</em> recommend using the system-wide compilers. Instead, we use <a href="https://spack.readthedocs.io">spack</a> to install compilers and OpenMPI:</p><pre>   spack install cmake libtool autoconf automake
   spack install environment-modules cmake gcc openmpi%gcc hdf5%gcc+hl
</pre><p>The above will use install gcc and OpenMPI on top of it. You will have to load the environment modules as, e.g.,</p><pre>   module load gcc-9.2.0-clang-10.0.0-apple-vcpkolh openmpi-3.1.4-gcc-9.2.0-my2rkcv hdf5-1.10.5-gcc-9.2.0-prdkirn
</pre><p>Then follow <a href="build.html#build_default" class="m-dox">Build using the defaults</a>.</p></section><section id="build_clang"><h2><a href="#build_clang">Build using Clang or Intel compilers</a></h2><p>The default build process on Linux, described in section <a href="build.html#build_default" class="m-dox">Build using the defaults</a>, uses the system-wide gnu compiler suite. You can also use the clang or the Intel compilers. We do this by either building OpenMPI using clang or Intel or by using the machine-specific MPI wrappers pointing to the compiler and then use the build process given in section <a href="build.html#build_default" class="m-dox">Build using the defaults</a>.</p></section><section id="build_rndq"><h2><a href="#build_rndq">Build using Charm++&#x27;s randomized message queues</a></h2><p>For serious development work, especially involving asynchronous parallel programming, we also build and test with Charm++ using randomized message queues. This enables more thorough testing of the available space for scheduling messages and thus more heavily testing the asynchronous logic. We do this by configuring the TPL build as</p><pre>   cmake -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_C_COMPILER=mpicc -DCMAKE_Fortran_COMPILER=mpif90 -DCHARM_EXTRA_ARGS=&quot;--enable-error-checking;--with-prio-type=int;--enable-randomized-msgq;--suffix;randq-debug&quot; &lt;path-to-TPL-CMakeLists.txt&gt;
</pre></section><section id="build_smp"><h2><a href="#build_smp">Build using Charm++&#x27;s SMP mode</a></h2><p>For better performance computing large problems using many threads, Quinoa can also be used using Charm++&#x27;s symmetric multi-processing (SMP) mode. This can be done by configuring the TPL build as</p><pre>   cmake -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_C_COMPILER=mpicc -DCMAKE_Fortran_COMPILER=mpif90 -DCHARM_EXTRA_ARGS=&quot;smp&quot; &lt;path-to-TPL-CMakeLists.txt&gt;
</pre><aside class="m-note m-info"><h4>Note</h4><p>Multiple extra arguments to the Charm++ build can be passed to the cmake variable <code>CMAKE_EXTRA_ARGS</code> separated by semi-colons.</p></aside><p>You can run the unit-, and regression tests in SMP mode as, e.g.,</p><pre>   ./charmrun +p 34 --bind-to none Main/unittest -v -q +ppn 17
   ctest -j 36 --output-on-failure -LE extreme
</pre><p>The above will use 36 PEs, distributed into two logical (compute) nodes. See also the Charm++ manual on how to run in SMP mode.</p><aside class="m-note m-info"><h4>Note</h4><p>SMP mode configures more regression tests, specifically exercising SMP, compared to non-SMP mode, thus enables a more thorough testing.</p></aside></section><section id="build_static"><h2><a href="#build_static">Static build</a></h2><p>Some machines, e.g., Crays, prefer builds using static libraries. This can be done by passing the cmake argument <code>-DBUILD_SHARED_LIBS=off</code> to <em>both</em> TPL and Quinoa configure steps. See also section <a href="build.html#build_default" class="m-dox">Build using the defaults</a>.</p></section><section id="build_projections"><h2><a href="#build_projections">Build with Charm++&#x27;s Projections enabled</a></h2><p>To use Charm++&#x27;s performance analysis tool, Projections, you can build Charm++ with</p><pre>   cmake -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_C_COMPILER=mpicc -DCMAKE_Fortran_COMPILER=mpif90 -DCHARM_EXTRA_ARGS=&quot;--enable-tracing;--enable-commthread-tracing&quot; &lt;path-to-TPL-CMakeLists.txt&gt;
</pre><p>Then configure the Quinoa build with the extra link arguments:</p><pre>   cmake -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_C_COMPILER=mpicc -DEXTRA_LINK_ARGS=&quot;-tracemode projections&quot; &lt;path-to-Quinoa-src-CMakeLists.txt&gt;
</pre><p>See also the Charm++ Projections manual.</p></section><section id="build_ninja"><h2><a href="#build_ninja">Using ninja instead of make</a></h2><p>Similar to other CMake/C++ projects, Quinoa can also be built with <a href="https://ninja-build.org">ninja</a> instead of make, by configuring the Quinoa build with</p><pre>   cmake -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_C_COMPILER=mpicc -GNinja &lt;path-to-Quinoa-src-CMakeLists.txt&gt;
</pre></section><section id="build_optional"><h2><a href="#build_optional">Optional third-party libraries</a></h2><p>The default build process, described in section <a href="build.html#build_default" class="m-dox">Build using the defaults</a>, will attempt to build a set of default TPLs. Not all TPLs are required: some are optional, some must be specifically enabled if needed. Then Quinoa can be configured to build whatever it can based on the libraries it can find. See also the section on <a href="build.html#build_specific_executables" class="m-dox">Build specific executables only</a>.</p><p>All libraries, required or optional, are listed on page <a href="licenses.html" class="m-dox">Libraries</a>.</p></section><section id="build_debug"><h2><a href="#build_debug">Build in Debug mode</a></h2><p>Similar to other cmake projects, Quinoa can be configured for <code>Debug</code>, <code>Release</code>, or other types of builds cmake supports. As usual, this is done by setting the <code>CMAKE_BUILD_TYPE</code> variable, e.g., <code>-DCMAKE_BUILD_TYPE=Debug</code>. The default is <code>Release</code>.</p></section><section id="build_disable"><h2><a href="#build_disable">Disabling packages</a></h2><p>Sometimes it may be necessary to disable searching for packages, e.g., due to broken or unsuitable system-wide installs, etc. This can be done by configuring the TPL build by passing to cmake, e.g.,</p><pre>   -DCMAKE_DISABLE_FIND_PACKAGE_Boost=true
</pre></section><section id="build_cpplibrary"><h2><a href="#build_cpplibrary">Configuring the C++ standard library</a></h2><p>We routinely use and test <em>libc++</em> and <em>libstdc++</em>. Which one to use can be configured by the cmake variable <code>STDLIBCPP</code>, as</p><pre>   -DSTDLIBCPP=libc++
</pre><p>or</p><pre>   -DSTDLIBCPP=libstdc++
</pre><aside class="m-note m-info"><h4>Note</h4><p>The <code>STDLIBCPP</code> cmake variable is ignored if the gnu compiler is used. With the gnu compilers <em>libstdc++</em> is the only option.</p></aside><aside class="m-note m-danger"><h4>Warning</h4><p>The configuration for the standard library must be specified so that <em>both</em> the TPL and the Quinoa builds use the same implementation. See the section on <a href="build.html#build_stages" class="m-dox">Two-stage build</a>.</p></aside></section><section id="build_system_specs"><h2><a href="#build_system_specs">Build system features, requirements, and defaults</a></h2><p>General requirements for configuring the TPL as well as Quinoa builds:</p><ul><li>In-source builds are not allowed.</li><li>The default build type for both TPLs and Quinoa is <code>Release</code>.</li><li>Shared cmake code is in <a href="https://github.com/quinoacomputing/cmake-modules.git">https:/<wbr />/<wbr />github.com/<wbr />quinoacomputing/<wbr />cmake-modules.git</a>, pulled in as a git submodule into the TPL build and as a git subtree into the Quinoa build. See also the page on <a href="git_submodules_subtrees.html" class="m-dox">Modules</a>.</li><li>The TPL build requires a Fortran, C, and a C++ compiler.</li><li>The Quinoa build requires only a C and a C++ compiler.</li><li>If unspecified, the default install directory, configured by the cmake variable <code>CMAKE_INSTALL_PREFIX</code>, for the TPL build is <code>&lt;root&gt;/install/&lt;compiler&gt;-&lt;architecture&gt;/</code>, where <code>&lt;root&gt;</code> is the root of the TPL repository clone. In a recursive clone <code>&lt;root&gt;</code> is <code>quinoa/external</code>. See also the section on <a href="build.html#build_nonrecursive" class="m-dox">Working with a non-recursive clone</a>.</li><li>If unspecified, the default TPL directory, configured by the cmake variable <code>TPL_DIR</code>, for the Quinoa build is <code>&lt;root&gt;/external/install/&lt;compiler&gt;-architecture&gt;/</code>, where <code>&lt;root&gt;</code> is the root of the Quinoa repository clone. See also the section on <a href="build.html#build_nonrecursive" class="m-dox">Working with a non-recursive clone</a>.</li><li><p>For the list of TPLs searched (and if not found, built) by default, see <a href="https://github.com/quinoacomputing/quinoa-tpl/blob/master/CMakeLists.txt">&lt;quinoa-tpl&gt;/<wbr />CMakeLists.txt</a>, section starting with the comment line</p><pre> # Set which libraries are built/searched by default
</pre></li><li>MPI is required and Charm++ is built on top of MPI.</li><li>The default C++ standard library is <em>libstdc++</em> for gnu compilers, and <em>libc++</em> for clang and Intel.</li></ul></section><section id="build_docker"><h2><a href="#build_docker">Helpful docker image configurations</a></h2><p>You can get more examples on ways we build Quinoa by browsing the following docker images:</p><ul><li><a href="https://github.com/quinoacomputing/quinoa/tree/master/tools/docker">https:/<wbr />/<wbr />github.com/<wbr />quinoacomputing/<wbr />quinoa/<wbr />tree/<wbr />master/<wbr />tools/<wbr />docker</a></li><li><a href="https://github.com/quinoacomputing/quinoa-tpl/tree/master/docker">https:/<wbr />/<wbr />github.com/<wbr />quinoacomputing/<wbr />quinoa-tpl/<wbr />tree/<wbr />master/<wbr />docker</a></li><li><a href="https://github.com/quinoacomputing/buildenv">https:/<wbr />/<wbr />github.com/<wbr />quinoacomputing/<wbr />buildenv</a></li></ul></section><section id="build_cmake"><h2><a href="#build_cmake">Main cmake files</a></h2><p>The most important (top-level) files responsible for configuring the build system are</p><ul><li><a href="https://github.com/quinoacomputing/quinoa-tpl/blob/master/CMakeLists.txt">external/<wbr />CMakeLists.txt</a></li><li><a href="https://github.com/quinoacomputing/quinoa/blob/develop/cmake/TPLs.cmake">cmake/<wbr />TPLs.cmake</a></li><li><a href="https://github.com/quinoacomputing/quinoa/blob/develop/src/CMakeLists.txt">src/<wbr />CMakeLists.txt</a></li></ul><p>If you have questions not answered here, consult the above.</p></section><section id="build_feedback"><h2><a href="#build_feedback">Feedback</a></h2><p>If you would like to improve this page, contact us using the links in the footer below or submit a pull request on <a href="https://github.com/quinoacomputing/quinoa">github</a>.</p></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-dox-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-dox-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-dox-search-content">
          <input type="search" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" />
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript. Enable it or <a href="https://www.startpage.com/sp/search?query=site:quinoacomputing.org/archive ">use an external search engine</a>.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            Search for symbols, directories, files, pages or modules. You can omit any
            prefix from the symbol or file path; adding a <code>:</code> or <code>/</code>
            suffix lists all members of given symbol or directory. Navigate through the
            list using <span class="m-label m-dim">&darr;</span> and
            <span class="m-label m-dim">&uarr;</span>, press
            <span class="m-label m-dim">Enter</span> to go.
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.<br />Maybe try a full-text <a href="#" id="search-external" data-search-engine="https://www.startpage.com/sp/search?query=site:quinoacomputing.org/archive {query}">search with external engine</a>?</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search.js"></script>
<script src="searchdata.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Quinoa docs, part of the <a href="http://quinoacomputing.org/archive/">Quinoa project</a>. Copyright Â© J. Bakosi 2012&ndash;2015, Los Alamos National Security, LLC, 2016&ndash;2018, <a href="https://www.triadns.org/">Triad National Security, LLC,</a> 2019-2021. Generated on Tuesday, Nov 23, 2021 based on <a href="https://github.com/quinoacomputing/quinoa/commit/d19f93694">d19f93694</a> by <a href="http://doxygen.org/">Doxygen</a> and <a href="http://mcss.mosra.cz/">m.css</a>. Contact us via <a href="https://github.com/quinoacomputing/quinoa/">GitHub</a>, <a href="https://groups.io/g/quinoa">Email</a> or <a href="https://quinoa.zulipchat.com">Chat</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>